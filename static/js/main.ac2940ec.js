/*! For license information please see main.ac2940ec.js.LICENSE.txt */
!function(){var e={4753:function(e,t,n){"use strict";n.r(t),n.d(t,{a:function(){return A},animated:function(){return A}});var r=n(9439),o=n(3144),i=n(5671),a=n(136),s=n(7277),u=n(9389),c={};for(var l in u)["default","a","animated"].indexOf(l)<0&&(c[l]=function(e){return u[e]}.bind(0,l));n.d(t,c);var f=n(4164),h=n(6330),d=n(8183);function p(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}var v=["style","children","scrollTop","scrollLeft"],m=/^--/;function g(e,t){return null==t||"boolean"===typeof t||""===t?"":"number"!==typeof t||0===t||m.test(e)||b.hasOwnProperty(e)&&b[e]?(""+t).trim():t+"px"}var y={};var b={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},w=["Webkit","Ms","Moz","O"];b=Object.keys(b).reduce((function(e,t){return w.forEach((function(n){return e[function(e,t){return e+t.charAt(0).toUpperCase()+t.substring(1)}(n,t)]=e[t]})),e}),b);var x=["x","y","z"],k=/^(matrix|translate|scale|rotate|skew)/,_=/^(translate)/,E=/^(rotate|skew)/,C=function(e,t){return h.is.num(e)&&0!==e?e+t:e},S=function e(t,n){return h.is.arr(t)?t.every((function(t){return e(t,n)})):h.is.num(t)?t===n:parseFloat(t)===n},I=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(e){(0,i.Z)(this,n);var o=e.x,a=e.y,s=e.z,u=p(e,x),c=[],l=[];return(o||a||s)&&(c.push([o||0,a||0,s||0]),l.push((function(e){return["translate3d(".concat(e.map((function(e){return C(e,"px")})).join(","),")"),S(e,0)]}))),(0,h.rU)(u,(function(e,t){if("transform"===t)c.push([e||""]),l.push((function(e){return[e,""===e]}));else if(k.test(t)){if(delete u[t],h.is.und(e))return;var n=_.test(t)?"px":E.test(t)?"deg":"";c.push((0,h.qo)(e)),l.push("rotate3d"===t?function(e){var t=(0,r.Z)(e,4),o=t[0],i=t[1],a=t[2],s=t[3];return["rotate3d(".concat(o,",").concat(i,",").concat(a,",").concat(C(s,n),")"),S(s,0)]}:function(e){return["".concat(t,"(").concat(e.map((function(e){return C(e,n)})).join(","),")"),S(e,t.startsWith("scale")?1:0)]})}})),c.length&&(u.transform=new R(c,l)),t.call(this,u)}return(0,o.Z)(n)}(d.rS),R=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(e,r){var o;return(0,i.Z)(this,n),(o=t.call(this))._value=null,o.inputs=e,o.transforms=r,o}return(0,o.Z)(n,[{key:"get",value:function(){return this._value||(this._value=this._get())}},{key:"_get",value:function(){var e=this,t="",n=!0;return(0,h.S6)(this.inputs,(function(o,i){var a=(0,h.je)(o[0]),s=e.transforms[i](h.is.arr(a)?a:o.map(h.je)),u=(0,r.Z)(s,2),c=u[0],l=u[1];t+=" "+c,n=n&&l})),n?"none":t}},{key:"observerAdded",value:function(e){var t=this;1==e&&(0,h.S6)(this.inputs,(function(e){return(0,h.S6)(e,(function(e){return(0,h.j$)(e)&&(0,h.UI)(e,t)}))}))}},{key:"observerRemoved",value:function(e){var t=this;0==e&&(0,h.S6)(this.inputs,(function(e){return(0,h.S6)(e,(function(e){return(0,h.j$)(e)&&(0,h.iL)(e,t)}))}))}},{key:"eventObserved",value:function(e){"change"==e.type&&(this._value=null),(0,h.k0)(this,e)}}]),n}(h.B0),T=["scrollTop","scrollLeft"];u.Globals.assign({batchedUpdates:f.unstable_batchedUpdates,createStringInterpolator:h.qS,colors:h.O9});var A=(0,d.Ld)(["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],{applyAnimatedValues:function(e,t){if(!e.nodeType||!e.setAttribute)return!1;var n="filter"===e.nodeName||e.parentNode&&"filter"===e.parentNode.nodeName,r=t,o=r.style,i=r.children,a=r.scrollTop,s=r.scrollLeft,u=p(r,v),c=Object.values(u),l=Object.keys(u).map((function(t){return n||e.hasAttribute(t)?t:y[t]||(y[t]=t.replace(/([A-Z])/g,(function(e){return"-"+e.toLowerCase()})))}));for(var f in void 0!==i&&(e.textContent=i),o)if(o.hasOwnProperty(f)){var h=g(f,o[f]);m.test(f)?e.style.setProperty(f,h):e.style[f]=h}l.forEach((function(t,n){e.setAttribute(t,c[n])})),void 0!==a&&(e.scrollTop=a),void 0!==s&&(e.scrollLeft=s)},createAnimatedStyle:function(e){return new I(e)},getComponentProps:function(e){return p(e,T)}}).animated},8183:function(e,t,n){"use strict";n.d(t,{He:function(){return v},Ld:function(){return R},eC:function(){return y},f3:function(){return p},iG:function(){return g},rS:function(){return w},sb:function(){return _},ys:function(){return d}});var r=n(9439),o=n(1752),i=n(1120),a=n(136),s=n(7277),u=n(5671),c=n(3144),l=n(6330),f=n(2791),h=Symbol.for("Animated:node"),d=function(e){return e&&e[h]},p=function(e,t){return(0,l.dE)(e,h,t)},v=function(e){return e&&e[h]&&e[h].getPayload()},m=function(){function e(){(0,u.Z)(this,e),this.payload=void 0,p(this,this)}return(0,c.Z)(e,[{key:"getPayload",value:function(){return this.payload||[]}}]),e}(),g=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this)).done=!0,r.elapsedTime=void 0,r.lastPosition=void 0,r.lastVelocity=void 0,r.v0=void 0,r.durationProgress=0,r._value=e,l.is.num(r._value)&&(r.lastPosition=r._value),r}return(0,c.Z)(n,[{key:"getPayload",value:function(){return[this]}},{key:"getValue",value:function(){return this._value}},{key:"setValue",value:function(e,t){return l.is.num(e)&&(this.lastPosition=e,t&&(e=Math.round(e/t)*t,this.done&&(this.lastPosition=e))),this._value!==e&&(this._value=e,!0)}},{key:"reset",value:function(){var e=this.done;this.done=!1,l.is.num(this._value)&&(this.elapsedTime=0,this.durationProgress=0,this.lastPosition=this._value,e&&(this.lastVelocity=null),this.v0=null)}}],[{key:"create",value:function(e){return new n(e)}}]),n}(m),y=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this,0))._string=null,r._toString=void 0,r._toString=(0,l.mD)({output:[e,e]}),r}return(0,c.Z)(n,[{key:"getValue",value:function(){var e=this._string;return null==e?this._string=this._toString(this._value):e}},{key:"setValue",value:function(e){if(l.is.str(e)){if(e==this._string)return!1;this._string=e,this._value=1}else{if(!(0,o.Z)((0,i.Z)(n.prototype),"setValue",this).call(this,e))return!1;this._string=null}return!0}},{key:"reset",value:function(e){e&&(this._toString=(0,l.mD)({output:[this.getValue(),e]})),this._value=0,(0,o.Z)((0,i.Z)(n.prototype),"reset",this).call(this)}}],[{key:"create",value:function(e){return new n(e)}}]),n}(g),b={dependencies:null},w=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(e){var r;return(0,u.Z)(this,n),(r=t.call(this)).source=e,r.setValue(e),r}return(0,c.Z)(n,[{key:"getValue",value:function(e){var t={};return(0,l.rU)(this.source,(function(n,r){var o;(o=n)&&o[h]===o?t[r]=n.getValue(e):(0,l.j$)(n)?t[r]=(0,l.je)(n):e||(t[r]=n)})),t}},{key:"setValue",value:function(e){this.source=e,this.payload=this._makePayload(e)}},{key:"reset",value:function(){this.payload&&(0,l.S6)(this.payload,(function(e){return e.reset()}))}},{key:"_makePayload",value:function(e){if(e){var t=new Set;return(0,l.rU)(e,this._addToPayload,t),Array.from(t)}}},{key:"_addToPayload",value:function(e){var t=this;b.dependencies&&(0,l.j$)(e)&&b.dependencies.add(e);var n=v(e);n&&(0,l.S6)(n,(function(e){return t.add(e)}))}}]),n}(m),x=function(e){(0,a.Z)(n,e);var t=(0,s.Z)(n);function n(e){return(0,u.Z)(this,n),t.call(this,e)}return(0,c.Z)(n,[{key:"getValue",value:function(){return this.source.map((function(e){return e.getValue()}))}},{key:"setValue",value:function(e){var t=this.getPayload();return e.length==t.length?t.map((function(t,n){return t.setValue(e[n])})).some(Boolean):((0,o.Z)((0,i.Z)(n.prototype),"setValue",this).call(this,e.map(k)),!0)}}],[{key:"create",value:function(e){return new n(e)}}]),n}(w);function k(e){return((0,l.Df)(e)?y:g).create(e)}function _(e){var t=d(e);return t?t.constructor:l.is.arr(e)?x:(0,l.Df)(e)?y:g}function E(){return E=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},E.apply(this,arguments)}var C=function(e,t){var n=!l.is.fun(e)||e.prototype&&e.prototype.isReactComponent;return(0,f.forwardRef)((function(o,i){var a=(0,f.useRef)(null),s=n&&(0,f.useCallback)((function(e){a.current=function(e,t){e&&(l.is.fun(e)?e(t):e.current=t);return t}(i,e)}),[i]),u=function(e,t){var n=new Set;b.dependencies=n,e.style&&(e=E({},e,{style:t.createAnimatedStyle(e.style)}));return e=new w(e),b.dependencies=null,[e,n]}(o,t),c=(0,r.Z)(u,2),h=c[0],d=c[1],p=(0,l.NW)(),v=function(){var e=a.current;n&&!e||!1===(!!e&&t.applyAnimatedValues(e,h.getValue(!0)))&&p()},m=new S(v,d),g=(0,f.useRef)();(0,l.LI)((function(){return g.current=m,(0,l.S6)(d,(function(e){return(0,l.UI)(e,m)})),function(){g.current&&((0,l.S6)(g.current.deps,(function(e){return(0,l.iL)(e,g.current)})),l.Wn.cancel(g.current.update))}})),(0,f.useEffect)(v,[]),(0,l.tf)((function(){return function(){var e=g.current;(0,l.S6)(e.deps,(function(t){return(0,l.iL)(t,e)}))}}));var y=t.getComponentProps(h.getValue());return f.createElement(e,E({},y,{ref:s}))}))},S=function(){function e(t,n){(0,u.Z)(this,e),this.update=t,this.deps=n}return(0,c.Z)(e,[{key:"eventObserved",value:function(e){"change"==e.type&&l.Wn.write(this.update)}}]),e}();var I=Symbol.for("AnimatedComponent"),R=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.applyAnimatedValues,r=void 0===n?function(){return!1}:n,o=t.createAnimatedStyle,i=void 0===o?function(e){return new w(e)}:o,a=t.getComponentProps,s={applyAnimatedValues:r,createAnimatedStyle:i,getComponentProps:void 0===a?function(e){return e}:a},u=function e(t){var n=T(t)||"Anonymous";return(t=l.is.str(t)?e[t]||(e[t]=C(t,s)):t[I]||(t[I]=C(t,s))).displayName="Animated(".concat(n,")"),t};return(0,l.rU)(e,(function(t,n){l.is.arr(e)&&(n=T(t)),u[n]=u(t)})),{animated:u}},T=function(e){return l.is.str(e)?e:e&&l.is.str(e.displayName)?e.displayName:l.is.fun(e)&&e.name||null}},9389:function(e,t,n){"use strict";n.r(t),n.d(t,{BailSignal:function(){return ie},Controller:function(){return Ie},FrameValue:function(){return ce},Globals:function(){return m.OH},Interpolation:function(){return rt},Spring:function(){return Qe},SpringContext:function(){return je},SpringRef:function(){return We},SpringValue:function(){return me},Trail:function(){return et},Transition:function(){return nt},config:function(){return U},createInterpolator:function(){return m.mD},easings:function(){return q},inferTo:function(){return O},interpolate:function(){return ut},to:function(){return st},update:function(){return ct},useChain:function(){return B},useIsomorphicLayoutEffect:function(){return m.LI},useReducedMotion:function(){return m.JZ},useSpring:function(){return Ve},useSpringRef:function(){return Ge},useSprings:function(){return ze},useTrail:function(){return Ke},useTransition:function(){return Xe}});var r=n(7326),o=n(3433),i=n(9439),a=n(1752),s=n(1120),u=n(136),c=n(7277),l=n(8737),f=n(4165),h=n(5861),d=n(3144),p=n(5671),v=n(7762),m=n(6330),g=n(2791),y=n(8183),b=n(2185),w={};for(var x in b)["default","Globals","createInterpolator","useIsomorphicLayoutEffect","useReducedMotion","BailSignal","Controller","FrameValue","Interpolation","Spring","SpringContext","SpringRef","SpringValue","Trail","Transition","config","easings","inferTo","interpolate","to","update","useChain","useSpring","useSpringRef","useSprings","useTrail","useTransition"].indexOf(x)<0&&(w[x]=function(e){return b[e]}.bind(0,x));n.d(t,w);var k=n(5290);w={};for(var x in k)["default","Globals","createInterpolator","useIsomorphicLayoutEffect","useReducedMotion","BailSignal","Controller","FrameValue","Interpolation","Spring","SpringContext","SpringRef","SpringValue","Trail","Transition","config","easings","inferTo","interpolate","to","update","useChain","useSpring","useSpringRef","useSprings","useTrail","useTransition"].indexOf(x)<0&&(w[x]=function(e){return k[e]}.bind(0,x));function _(){return _=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_.apply(this,arguments)}function E(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return m.is.fun(e)?e.apply(void 0,n):e}n.d(t,w);var C=function(e,t){return!0===e||!!(t&&e&&(m.is.fun(e)?e(t):(0,m.qo)(e).includes(t)))},S=function(e,t){return m.is.obj(e)?t&&e[t]:e},I=function(e,t){return!0===e.default?e[t]:e.default?e.default[t]:void 0},R=function(e){return e},T=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:R,n=A;e.default&&!0!==e.default&&(e=e.default,n=Object.keys(e));var r,o={},i=(0,v.Z)(n);try{for(i.s();!(r=i.n()).done;){var a=r.value,s=t(e[a],a);m.is.und(s)||(o[a]=s)}}catch(u){i.e(u)}finally{i.f()}return o},A=["config","onProps","onStart","onChange","onPause","onResume","onRest"],N={config:1,from:1,to:1,ref:1,loop:1,reset:1,pause:1,cancel:1,reverse:1,immediate:1,default:1,delay:1,onProps:1,onStart:1,onChange:1,onPause:1,onResume:1,onRest:1,onResolve:1,items:1,trail:1,sort:1,expires:1,initial:1,enter:1,update:1,leave:1,children:1,onDestroyed:1,keys:1,callId:1,parentId:1};function O(e){var t=function(e){var t={},n=0;if((0,m.rU)(e,(function(e,r){N[r]||(t[r]=e,n++)})),n)return t}(e);if(t){var n={to:t};return(0,m.rU)(e,(function(e,r){return r in t||(n[r]=e)})),n}return _({},e)}function D(e){return e=(0,m.je)(e),m.is.arr(e)?e.map(D):(0,m.Df)(e)?m.OH.createStringInterpolator({range:[0,1],output:[e,e]})(1):e}function P(e){for(var t in e)return!0;return!1}function M(e){return m.is.fun(e)||m.is.arr(e)&&m.is.obj(e[0])}function F(e,t){var n;null==(n=e.ref)||n.delete(e),null==t||t.delete(e)}function L(e,t){var n;t&&e.ref!==t&&(null==(n=e.ref)||n.delete(e),t.add(e),e.ref=t)}function B(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;(0,m.LI)((function(){if(t){var r=0;(0,m.S6)(e,(function(e,o){var i=e.current;if(i.length){var a=n*t[o];isNaN(a)?a=r:r=a,(0,m.S6)(i,(function(e){(0,m.S6)(e.queue,(function(e){var t=e.delay;e.delay=function(e){return a+E(t||0,e)}}))})),e.start()}}))}else{var o=Promise.resolve();(0,m.S6)(e,(function(e){var t=e.current;if(t.length){var n=t.map((function(e){var t=e.queue;return e.queue=[],t}));o=o.then((function(){return(0,m.S6)(t,(function(e,t){return(0,m.S6)(n[t]||[],(function(t){return e.queue.push(t)}))})),Promise.all(e.start())}))}}))}}))}var U={default:{tension:170,friction:26},gentle:{tension:120,friction:14},wobbly:{tension:180,friction:12},stiff:{tension:210,friction:20},slow:{tension:280,friction:60},molasses:{tension:280,friction:120}},j=1.70158,Z=1.525*j,W=j+1,z=2*Math.PI/3,V=2*Math.PI/4.5,H=function(e){var t=7.5625,n=2.75;return e<1/n?t*e*e:e<2/n?t*(e-=1.5/n)*e+.75:e<2.5/n?t*(e-=2.25/n)*e+.9375:t*(e-=2.625/n)*e+.984375},q={linear:function(e){return e},easeInQuad:function(e){return e*e},easeOutQuad:function(e){return 1-(1-e)*(1-e)},easeInOutQuad:function(e){return e<.5?2*e*e:1-Math.pow(-2*e+2,2)/2},easeInCubic:function(e){return e*e*e},easeOutCubic:function(e){return 1-Math.pow(1-e,3)},easeInOutCubic:function(e){return e<.5?4*e*e*e:1-Math.pow(-2*e+2,3)/2},easeInQuart:function(e){return e*e*e*e},easeOutQuart:function(e){return 1-Math.pow(1-e,4)},easeInOutQuart:function(e){return e<.5?8*e*e*e*e:1-Math.pow(-2*e+2,4)/2},easeInQuint:function(e){return e*e*e*e*e},easeOutQuint:function(e){return 1-Math.pow(1-e,5)},easeInOutQuint:function(e){return e<.5?16*e*e*e*e*e:1-Math.pow(-2*e+2,5)/2},easeInSine:function(e){return 1-Math.cos(e*Math.PI/2)},easeOutSine:function(e){return Math.sin(e*Math.PI/2)},easeInOutSine:function(e){return-(Math.cos(Math.PI*e)-1)/2},easeInExpo:function(e){return 0===e?0:Math.pow(2,10*e-10)},easeOutExpo:function(e){return 1===e?1:1-Math.pow(2,-10*e)},easeInOutExpo:function(e){return 0===e?0:1===e?1:e<.5?Math.pow(2,20*e-10)/2:(2-Math.pow(2,-20*e+10))/2},easeInCirc:function(e){return 1-Math.sqrt(1-Math.pow(e,2))},easeOutCirc:function(e){return Math.sqrt(1-Math.pow(e-1,2))},easeInOutCirc:function(e){return e<.5?(1-Math.sqrt(1-Math.pow(2*e,2)))/2:(Math.sqrt(1-Math.pow(-2*e+2,2))+1)/2},easeInBack:function(e){return W*e*e*e-j*e*e},easeOutBack:function(e){return 1+W*Math.pow(e-1,3)+j*Math.pow(e-1,2)},easeInOutBack:function(e){return e<.5?Math.pow(2*e,2)*(7.189819*e-Z)/2:(Math.pow(2*e-2,2)*((Z+1)*(2*e-2)+Z)+2)/2},easeInElastic:function(e){return 0===e?0:1===e?1:-Math.pow(2,10*e-10)*Math.sin((10*e-10.75)*z)},easeOutElastic:function(e){return 0===e?0:1===e?1:Math.pow(2,-10*e)*Math.sin((10*e-.75)*z)+1},easeInOutElastic:function(e){return 0===e?0:1===e?1:e<.5?-Math.pow(2,20*e-10)*Math.sin((20*e-11.125)*V)/2:Math.pow(2,-20*e+10)*Math.sin((20*e-11.125)*V)/2+1},easeInBounce:function(e){return 1-H(1-e)},easeOutBounce:H,easeInOutBounce:function(e){return e<.5?(1-H(1-2*e))/2:(1+H(2*e-1))/2}},G=_({},U.default,{mass:1,damping:1,easing:q.linear,clamp:!1}),K=(0,d.Z)((function e(){(0,p.Z)(this,e),this.tension=void 0,this.friction=void 0,this.frequency=void 0,this.damping=void 0,this.mass=void 0,this.velocity=0,this.restVelocity=void 0,this.precision=void 0,this.progress=void 0,this.duration=void 0,this.easing=void 0,this.clamp=void 0,this.bounce=void 0,this.decay=void 0,this.round=void 0,Object.assign(this,G)}));function X(e,t){if(m.is.und(t.decay)){var n=!m.is.und(t.tension)||!m.is.und(t.friction);!n&&m.is.und(t.frequency)&&m.is.und(t.damping)&&m.is.und(t.mass)||(e.duration=void 0,e.decay=void 0),n&&(e.frequency=void 0)}else e.duration=void 0}var $=[],Y=(0,d.Z)((function e(){(0,p.Z)(this,e),this.changed=!1,this.values=$,this.toValues=null,this.fromValues=$,this.to=void 0,this.from=void 0,this.config=new K,this.immediate=!1}));function Q(e,t){var n=t.key,r=t.props,o=t.defaultProps,i=t.state,a=t.actions;return new Promise((function(t,s){var u,c,l,f=C(null!=(u=r.cancel)?u:null==o?void 0:o.cancel,n);if(f)v();else{m.is.und(r.pause)||(i.paused=C(r.pause,n));var h=null==o?void 0:o.pause;!0!==h&&(h=i.paused||C(h,n)),c=E(r.delay||0,n),h?(i.resumeQueue.add(p),a.pause()):(a.resume(),p())}function d(){i.resumeQueue.add(p),i.timeouts.delete(l),l.cancel(),c=l.time-m.Wn.now()}function p(){c>0&&!m.OH.skipAnimation?(i.delayed=!0,l=m.Wn.setTimeout(v,c),i.pauseQueue.add(d),i.timeouts.add(l)):v()}function v(){i.delayed&&(i.delayed=!1),i.pauseQueue.delete(d),i.timeouts.delete(l),e<=(i.cancelId||0)&&(f=!0);try{a.start(_({},r,{callId:e,cancel:f}),t)}catch(n){s(n)}}}))}var J=function(e,t){return 1==t.length?t[0]:t.some((function(e){return e.cancelled}))?ne(e.get()):t.every((function(e){return e.noop}))?ee(e.get()):te(e.get(),t.every((function(e){return e.finished})))},ee=function(e){return{value:e,noop:!0,finished:!0,cancelled:!1}},te=function(e,t){return{value:e,finished:t,cancelled:arguments.length>2&&void 0!==arguments[2]&&arguments[2]}},ne=function(e){return{value:e,cancelled:!0,finished:!1}};function re(e,t,n,r){var o=t.callId,i=t.parentId,a=t.onRest,s=n.asyncTo,u=n.promise;return i||e!==s||t.reset?n.promise=(0,h.Z)((0,f.Z)().mark((function c(){var l,d,p,g,y,b,w,x;return(0,f.Z)().wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(n.asyncId=o,n.asyncTo=e,l=T(t,(function(e,t){return"onRest"===t?void 0:e})),g=new Promise((function(e,t){return d=e,p=t})),y=function(e){var t=o<=(n.cancelId||0)&&ne(r)||o!==n.asyncId&&te(r,!1);if(t)throw e.result=t,p(e),e},b=function(e,t){var i=new ie,a=new ae;return(0,h.Z)((0,f.Z)().mark((function s(){var u,c;return(0,f.Z)().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(!m.OH.skipAnimation){s.next=5;break}throw oe(n),a.result=te(r,!1),p(a),a;case 5:return y(i),(u=m.is.obj(e)?_({},e):_({},t,{to:e})).parentId=o,(0,m.rU)(l,(function(e,t){m.is.und(u[t])&&(u[t]=e)})),s.next=11,r.start(u);case 11:if(c=s.sent,y(i),!n.paused){s.next=16;break}return s.next=16,new Promise((function(e){n.resumeQueue.add(e)}));case 16:return s.abrupt("return",c);case 17:case"end":return s.stop()}}),s)})))()},!m.OH.skipAnimation){c.next=9;break}return oe(n),c.abrupt("return",te(r,!1));case 9:return c.prev=9,x=m.is.arr(e)?function(){var e=(0,h.Z)((0,f.Z)().mark((function e(t){var n,r,o;return(0,f.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=(0,v.Z)(t),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=9;break}return o=r.value,e.next=7,b(o);case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),n.e(e.t0);case 14:return e.prev=14,n.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[1,11,14,17]])})));return function(t){return e.apply(this,arguments)}}()(e):Promise.resolve(e(b,r.stop.bind(r))),c.next=13,Promise.all([x.then(d),g]);case 13:w=te(r.get(),!0,!1),c.next=27;break;case 16:if(c.prev=16,c.t0=c.catch(9),!(c.t0 instanceof ie)){c.next=22;break}w=c.t0.result,c.next=27;break;case 22:if(!(c.t0 instanceof ae)){c.next=26;break}w=c.t0.result,c.next=27;break;case 26:throw c.t0;case 27:return c.prev=27,o==n.asyncId&&(n.asyncId=i,n.asyncTo=i?s:void 0,n.promise=i?u:void 0),c.finish(27);case 30:return m.is.fun(a)&&m.Wn.batchedUpdates((function(){a(w,r,r.item)})),c.abrupt("return",w);case 32:case"end":return c.stop()}}),c,null,[[9,16,27,30]])})))():u}function oe(e,t){(0,m.yl)(e.timeouts,(function(e){return e.cancel()})),e.pauseQueue.clear(),e.resumeQueue.clear(),e.asyncId=e.asyncTo=e.promise=void 0,t&&(e.cancelId=t)}var ie=function(e){(0,u.Z)(n,e);var t=(0,c.Z)(n);function n(){var e;return(0,p.Z)(this,n),(e=t.call(this,"An async animation has been interrupted. You see this error because you forgot to use `await` or `.catch(...)` on its returned promise.")).result=void 0,e}return(0,d.Z)(n)}((0,l.Z)(Error)),ae=function(e){(0,u.Z)(n,e);var t=(0,c.Z)(n);function n(){var e;return(0,p.Z)(this,n),(e=t.call(this,"SkipAnimationSignal")).result=void 0,e}return(0,d.Z)(n)}((0,l.Z)(Error)),se=function(e){return e instanceof ce},ue=1,ce=function(e){(0,u.Z)(n,e);var t=(0,c.Z)(n);function n(){var e;(0,p.Z)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).id=ue++,e.key=void 0,e._priority=0,e}return(0,d.Z)(n,[{key:"priority",get:function(){return this._priority},set:function(e){this._priority!=e&&(this._priority=e,this._onPriorityChange(e))}},{key:"get",value:function(){var e=(0,y.ys)(this);return e&&e.getValue()}},{key:"to",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return m.OH.to(this,t)}},{key:"interpolate",value:function(){(0,m.LW)();for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return m.OH.to(this,t)}},{key:"toJSON",value:function(){return this.get()}},{key:"observerAdded",value:function(e){1==e&&this._attach()}},{key:"observerRemoved",value:function(e){0==e&&this._detach()}},{key:"_attach",value:function(){}},{key:"_detach",value:function(){}},{key:"_onChange",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(0,m.k0)(this,{type:"change",parent:this,value:e,idle:t})}},{key:"_onPriorityChange",value:function(e){this.idle||m.fT.sort(this),(0,m.k0)(this,{type:"priority",parent:this,priority:e})}}]),n}(m.B0),le=Symbol.for("SpringPhase"),fe=function(e){return(1&e[le])>0},he=function(e){return(2&e[le])>0},de=function(e){return(4&e[le])>0},pe=function(e,t){return t?e[le]|=3:e[le]&=-3},ve=function(e,t){return t?e[le]|=4:e[le]&=-5},me=function(e){(0,u.Z)(n,e);var t=(0,c.Z)(n);function n(e,r){var o;if((0,p.Z)(this,n),(o=t.call(this)).key=void 0,o.animation=new Y,o.queue=void 0,o.defaultProps={},o._state={paused:!1,delayed:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},o._pendingCalls=new Set,o._lastCallId=0,o._lastToId=0,o._memoizedDuration=0,!m.is.und(e)||!m.is.und(r)){var i=m.is.obj(e)?_({},e):_({},r,{from:e});m.is.und(i.default)&&(i.default=!0),o.start(i)}return o}return(0,d.Z)(n,[{key:"idle",get:function(){return!(he(this)||this._state.asyncTo)||de(this)}},{key:"goal",get:function(){return(0,m.je)(this.animation.to)}},{key:"velocity",get:function(){var e=(0,y.ys)(this);return e instanceof y.iG?e.lastVelocity||0:e.getPayload().map((function(e){return e.lastVelocity||0}))}},{key:"hasAnimated",get:function(){return fe(this)}},{key:"isAnimating",get:function(){return he(this)}},{key:"isPaused",get:function(){return de(this)}},{key:"isDelayed",get:function(){return this._state.delayed}},{key:"advance",value:function(e){var t=this,n=!0,r=!1,o=this.animation,i=o.config,a=o.toValues,s=(0,y.He)(o.to);!s&&(0,m.j$)(o.to)&&(a=(0,m.qo)((0,m.je)(o.to))),o.values.forEach((function(u,c){if(!u.done){var l=u.constructor==y.eC?1:s?s[c].lastPosition:a[c],f=o.immediate,h=l;if(!f){if(h=u.lastPosition,i.tension<=0)return void(u.done=!0);var d,p=u.elapsedTime+=e,v=o.fromValues[c],g=null!=u.v0?u.v0:u.v0=m.is.arr(i.velocity)?i.velocity[c]:i.velocity,b=i.precision||(v==l?.005:Math.min(1,.001*Math.abs(l-v)));if(m.is.und(i.duration))if(i.decay){var w=!0===i.decay?.998:i.decay,x=Math.exp(-(1-w)*p);h=v+g/(1-w)*(1-x),f=Math.abs(u.lastPosition-h)<=b,d=g*x}else{d=null==u.lastVelocity?g:u.lastVelocity;for(var k=i.restVelocity||b/10,_=i.clamp?0:i.bounce,E=!m.is.und(_),C=v==l?u.v0>0:v<l,S=Math.ceil(e/1),I=0;I<S&&(Math.abs(d)>k||!(f=Math.abs(l-h)<=b));++I){E&&(h==l||h>l==C)&&(d=-d*_,h=l),h+=1*(d+=1*((1e-6*-i.tension*(h-l)+.001*-i.friction*d)/i.mass))}}else{var R=1;i.duration>0&&(t._memoizedDuration!==i.duration&&(t._memoizedDuration=i.duration,u.durationProgress>0&&(u.elapsedTime=i.duration*u.durationProgress,p=u.elapsedTime+=e)),R=(R=(i.progress||0)+p/t._memoizedDuration)>1?1:R<0?0:R,u.durationProgress=R),d=((h=v+i.easing(R)*(l-v))-u.lastPosition)/e,f=1==R}u.lastVelocity=d,Number.isNaN(h)&&(console.warn("Got NaN while animating:",t),f=!0)}s&&!s[c].done&&(f=!1),f?u.done=!0:n=!1,u.setValue(h,i.round)&&(r=!0)}}));var u=(0,y.ys)(this),c=u.getValue();if(n){var l=(0,m.je)(o.to);c===l&&!r||i.decay?r&&i.decay&&this._onChange(c):(u.setValue(l),this._onChange(l)),this._stop()}else r&&this._onChange(c)}},{key:"set",value:function(e){var t=this;return m.Wn.batchedUpdates((function(){t._stop(),t._focus(e),t._set(e)})),this}},{key:"pause",value:function(){this._update({pause:!0})}},{key:"resume",value:function(){this._update({pause:!1})}},{key:"finish",value:function(){var e=this;if(he(this)){var t=this.animation,n=t.to,r=t.config;m.Wn.batchedUpdates((function(){e._onStart(),r.decay||e._set(n,!1),e._stop()}))}return this}},{key:"update",value:function(e){return(this.queue||(this.queue=[])).push(e),this}},{key:"start",value:function(e,t){var n,r=this;return m.is.und(e)?(n=this.queue||[],this.queue=[]):n=[m.is.obj(e)?e:_({},t,{to:e})],Promise.all(n.map((function(e){return r._update(e)}))).then((function(e){return J(r,e)}))}},{key:"stop",value:function(e){var t=this,n=this.animation.to;return this._focus(this.get()),oe(this._state,e&&this._lastCallId),m.Wn.batchedUpdates((function(){return t._stop(n,e)})),this}},{key:"reset",value:function(){this._update({reset:!0})}},{key:"eventObserved",value:function(e){"change"==e.type?this._start():"priority"==e.type&&(this.priority=e.priority+1)}},{key:"_prepareNode",value:function(e){var t=this.key||"",n=e.to,r=e.from;(null==(n=m.is.obj(n)?n[t]:n)||M(n))&&(n=void 0),null==(r=m.is.obj(r)?r[t]:r)&&(r=void 0);var o={to:n,from:r};if(!fe(this)){if(e.reverse){var i=[r,n];n=i[0],r=i[1]}r=(0,m.je)(r),m.is.und(r)?(0,y.ys)(this)||this._set(n):this._set(r)}return o}},{key:"_update",value:function(e,t){var n=this,r=_({},e),o=this.key,i=this.defaultProps;r.default&&Object.assign(i,T(r,(function(e,t){return/^on/.test(t)?S(e,o):e}))),_e(this,r,"onProps"),Ee(this,"onProps",r,this);var a=this._prepareNode(r);if(Object.isFrozen(this))throw Error("Cannot animate a `SpringValue` object that is frozen. Did you forget to pass your component to `animated(...)` before animating its props?");var s=this._state;return Q(++this._lastCallId,{key:o,props:r,defaultProps:i,state:s,actions:{pause:function(){de(n)||(ve(n,!0),(0,m.bl)(s.pauseQueue),Ee(n,"onPause",te(n,ge(n,n.animation.to)),n))},resume:function(){de(n)&&(ve(n,!1),he(n)&&n._resume(),(0,m.bl)(s.resumeQueue),Ee(n,"onResume",te(n,ge(n,n.animation.to)),n))},start:this._merge.bind(this,a)}}).then((function(e){if(r.loop&&e.finished&&(!t||!e.noop)){var o=ye(r);if(o)return n._update(o,!0)}return e}))}},{key:"_merge",value:function(e,t,n){var r=this;if(t.cancel)return this.stop(!0),n(ne(this));var o=!m.is.und(e.to),i=!m.is.und(e.from);if(o||i){if(!(t.callId>this._lastToId))return n(ne(this));this._lastToId=t.callId}var a=this.key,s=this.defaultProps,u=this.animation,c=u.to,l=u.from,f=e.to,h=void 0===f?c:f,d=e.from,p=void 0===d?l:d;if(!i||o||t.default&&!m.is.und(h)||(h=p),t.reverse){var v=[p,h];h=v[0],p=v[1]}var g=!(0,m.Xy)(p,l);g&&(u.from=p),p=(0,m.je)(p);var b=!(0,m.Xy)(h,c);b&&this._focus(h);var w=M(t.to),x=u.config,k=x.decay,S=x.velocity;(o||i)&&(x.velocity=0),t.config&&!w&&function(e,t,n){for(var r in n&&(X(n=_({},n),t),t=_({},n,t)),X(e,t),Object.assign(e,t),G)null==e[r]&&(e[r]=G[r]);var o=e.mass,i=e.frequency,a=e.damping;m.is.und(i)||(i<.01&&(i=.01),a<0&&(a=0),e.tension=Math.pow(2*Math.PI/i,2)*o,e.friction=4*Math.PI*a*o/i)}(x,E(t.config,a),t.config!==s.config?E(s.config,a):void 0);var I=(0,y.ys)(this);if(!I||m.is.und(h))return n(te(this,!0));var R=m.is.und(t.reset)?i&&!t.default:!m.is.und(p)&&C(t.reset,a),T=R?p:this.get(),A=D(h),N=m.is.num(A)||m.is.arr(A)||(0,m.Df)(A),O=!w&&(!N||C(s.immediate||t.immediate,a));if(b){var P=(0,y.sb)(h);if(P!==I.constructor){if(!O)throw Error("Cannot animate between ".concat(I.constructor.name," and ").concat(P.name,', as the "to" prop suggests'));I=this._set(A)}}var F=I.constructor,L=(0,m.j$)(h),B=!1;if(!L){var U=R||!fe(this)&&g;(b||U)&&(L=!(B=(0,m.Xy)(D(T),A))),((0,m.Xy)(u.immediate,O)||O)&&(0,m.Xy)(x.decay,k)&&(0,m.Xy)(x.velocity,S)||(L=!0)}if(B&&he(this)&&(u.changed&&!R?L=!0:L||this._stop(c)),!w&&((L||(0,m.j$)(c))&&(u.values=I.getPayload(),u.toValues=(0,m.j$)(h)?null:F==y.eC?[1]:(0,m.qo)(A)),u.immediate!=O&&(u.immediate=O,O||R||this._set(c)),L)){var j=u.onRest;(0,m.S6)(ke,(function(e){return _e(r,t,e)}));var Z=te(this,ge(this,c));(0,m.bl)(this._pendingCalls,Z),this._pendingCalls.add(n),u.changed&&m.Wn.batchedUpdates((function(){u.changed=!R,null==j||j(Z,r),R?E(s.onRest,Z):null==u.onStart||u.onStart(Z,r)}))}R&&this._set(T),w?n(re(t.to,t,this._state,this)):L?this._start():he(this)&&!b?this._pendingCalls.add(n):n(ee(T))}},{key:"_focus",value:function(e){var t=this.animation;e!==t.to&&((0,m.Ll)(this)&&this._detach(),t.to=e,(0,m.Ll)(this)&&this._attach())}},{key:"_attach",value:function(){var e=0,t=this.animation.to;(0,m.j$)(t)&&((0,m.UI)(t,this),se(t)&&(e=t.priority+1)),this.priority=e}},{key:"_detach",value:function(){var e=this.animation.to;(0,m.j$)(e)&&(0,m.iL)(e,this)}},{key:"_set",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=(0,m.je)(e);if(!m.is.und(r)){var o=(0,y.ys)(this);if(!o||!(0,m.Xy)(r,o.getValue())){var i=(0,y.sb)(r);o&&o.constructor==i?o.setValue(r):(0,y.f3)(this,i.create(r)),o&&m.Wn.batchedUpdates((function(){t._onChange(r,n)}))}}return(0,y.ys)(this)}},{key:"_onStart",value:function(){var e=this.animation;e.changed||(e.changed=!0,Ee(this,"onStart",te(this,ge(this,e.to)),this))}},{key:"_onChange",value:function(e,t){t||(this._onStart(),E(this.animation.onChange,e,this)),E(this.defaultProps.onChange,e,this),(0,a.Z)((0,s.Z)(n.prototype),"_onChange",this).call(this,e,t)}},{key:"_start",value:function(){var e=this.animation;(0,y.ys)(this).reset((0,m.je)(e.to)),e.immediate||(e.fromValues=e.values.map((function(e){return e.lastPosition}))),he(this)||(pe(this,!0),de(this)||this._resume())}},{key:"_resume",value:function(){m.OH.skipAnimation?this.finish():m.fT.start(this)}},{key:"_stop",value:function(e,t){if(he(this)){pe(this,!1);var n=this.animation;(0,m.S6)(n.values,(function(e){e.done=!0})),n.toValues&&(n.onChange=n.onPause=n.onResume=void 0),(0,m.k0)(this,{type:"idle",parent:this});var r=t?ne(this.get()):te(this.get(),ge(this,null!=e?e:n.to));(0,m.bl)(this._pendingCalls,r),n.changed&&(n.changed=!1,Ee(this,"onRest",r,this))}}}]),n}(ce);function ge(e,t){var n=D(t),r=D(e.get());return(0,m.Xy)(r,n)}function ye(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.loop,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.to,r=E(t);if(r){var o=!0!==r&&O(r),i=(o||e).reverse,a=!o||o.reset;return be(_({},e,{loop:t,default:!1,pause:void 0,to:!i||M(n)?n:void 0,from:a?e.from:void 0,reset:a},o))}}function be(e){var t=e=O(e),n=t.to,r=t.from,o=new Set;return m.is.obj(n)&&xe(n,o),m.is.obj(r)&&xe(r,o),e.keys=o.size?Array.from(o):null,e}function we(e){var t=be(e);return m.is.und(t.default)&&(t.default=T(t)),t}function xe(e,t){(0,m.rU)(e,(function(e,n){return null!=e&&t.add(n)}))}var ke=["onStart","onRest","onChange","onPause","onResume"];function _e(e,t,n){e.animation[n]=t[n]!==I(t,n)?S(t[n],e.key):void 0}function Ee(e,t){for(var n,r,o,i,a,s,u=arguments.length,c=new Array(u>2?u-2:0),l=2;l<u;l++)c[l-2]=arguments[l];null==(o=(i=e.animation)[t])||(n=o).call.apply(n,[i].concat(c)),null==(a=(s=e.defaultProps)[t])||(r=a).call.apply(r,[s].concat(c))}var Ce=["onStart","onChange","onRest"],Se=1,Ie=function(){function e(t,n){(0,p.Z)(this,e),this.id=Se++,this.springs={},this.queue=[],this.ref=void 0,this._flush=void 0,this._initialProps=void 0,this._lastAsyncId=0,this._active=new Set,this._changed=new Set,this._started=!1,this._item=void 0,this._state={paused:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._events={onStart:new Map,onChange:new Map,onRest:new Map},this._onFrame=this._onFrame.bind(this),n&&(this._flush=n),t&&this.start(_({default:!0},t))}return(0,d.Z)(e,[{key:"idle",get:function(){return!this._state.asyncTo&&Object.values(this.springs).every((function(e){return e.idle&&!e.isDelayed&&!e.isPaused}))}},{key:"item",get:function(){return this._item},set:function(e){this._item=e}},{key:"get",value:function(){var e={};return this.each((function(t,n){return e[n]=t.get()})),e}},{key:"set",value:function(e){for(var t in e){var n=e[t];m.is.und(n)||this.springs[t].set(n)}}},{key:"update",value:function(e){return e&&this.queue.push(be(e)),this}},{key:"start",value:function(e){var t=this.queue;return e?t=(0,m.qo)(e).map(be):this.queue=[],this._flush?this._flush(this,t):(Me(this,t),Re(this,t))}},{key:"stop",value:function(e,t){if(e!==!!e&&(t=e),t){var n=this.springs;(0,m.S6)((0,m.qo)(t),(function(t){return n[t].stop(!!e)}))}else oe(this._state,this._lastAsyncId),this.each((function(t){return t.stop(!!e)}));return this}},{key:"pause",value:function(e){if(m.is.und(e))this.start({pause:!0});else{var t=this.springs;(0,m.S6)((0,m.qo)(e),(function(e){return t[e].pause()}))}return this}},{key:"resume",value:function(e){if(m.is.und(e))this.start({pause:!1});else{var t=this.springs;(0,m.S6)((0,m.qo)(e),(function(e){return t[e].resume()}))}return this}},{key:"each",value:function(e){(0,m.rU)(this.springs,e)}},{key:"_onFrame",value:function(){var e=this,t=this._events,n=t.onStart,r=t.onChange,o=t.onRest,a=this._active.size>0,s=this._changed.size>0;(a&&!this._started||s&&!this._started)&&(this._started=!0,(0,m.yl)(n,(function(t){var n=(0,i.Z)(t,2),r=n[0],o=n[1];o.value=e.get(),r(o,e,e._item)})));var u=!a&&this._started,c=s||u&&o.size?this.get():null;s&&r.size&&(0,m.yl)(r,(function(t){var n=(0,i.Z)(t,2),r=n[0],o=n[1];o.value=c,r(o,e,e._item)})),u&&(this._started=!1,(0,m.yl)(o,(function(t){var n=(0,i.Z)(t,2),r=n[0],o=n[1];o.value=c,r(o,e,e._item)})))}},{key:"eventObserved",value:function(e){if("change"==e.type)this._changed.add(e.parent),e.idle||this._active.add(e.parent);else{if("idle"!=e.type)return;this._active.delete(e.parent)}m.Wn.onFrame(this._onFrame)}}]),e}();function Re(e,t){return Promise.all(t.map((function(t){return Te(e,t)}))).then((function(t){return J(e,t)}))}function Te(e,t,n){return Ae.apply(this,arguments)}function Ae(){return Ae=(0,h.Z)((0,f.Z)().mark((function e(t,n,r){var o,i,a,s,u,c,l,h,d,p,v,g,y;return(0,f.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=n.keys,i=n.to,a=n.from,s=n.loop,u=n.onRest,c=n.onResolve,l=m.is.obj(n.default)&&n.default,s&&(n.loop=!1),!1===i&&(n.to=null),!1===a&&(n.from=null),(h=m.is.arr(i)||m.is.fun(i)?i:void 0)?(n.to=void 0,n.onRest=void 0,l&&(l.onRest=void 0)):(0,m.S6)(Ce,(function(e){var r=n[e];if(m.is.fun(r)){var o=t._events[e];n[e]=function(e){var t=e.finished,n=e.cancelled,i=o.get(r);i?(t||(i.finished=!1),n&&(i.cancelled=!0)):o.set(r,{value:null,finished:t||!1,cancelled:n||!1})},l&&(l[e]=n[e])}})),d=t._state,n.pause===!d.paused?(d.paused=n.pause,(0,m.bl)(n.pause?d.pauseQueue:d.resumeQueue)):d.paused&&(n.pause=!0),p=(o||Object.keys(t.springs)).map((function(e){return t.springs[e].start(n)})),v=!0===n.cancel||!0===I(n,"cancel"),(h||v&&d.asyncId)&&p.push(Q(++t._lastAsyncId,{props:n,state:d,actions:{pause:m.ZT,resume:m.ZT,start:function(e,n){v?(oe(d,t._lastAsyncId),n(ne(t))):(e.onRest=u,n(re(h,e,d,t)))}}})),!d.paused){e.next=15;break}return e.next=15,new Promise((function(e){d.resumeQueue.add(e)}));case 15:return e.t0=J,e.t1=t,e.next=19,Promise.all(p);case 19:if(e.t2=e.sent,g=(0,e.t0)(e.t1,e.t2),!s||!g.finished||r&&g.noop){e.next=26;break}if(!(y=ye(n,s,i))){e.next=26;break}return Me(t,[y]),e.abrupt("return",Te(t,y,!0));case 26:return c&&m.Wn.batchedUpdates((function(){return c(g,t,t.item)})),e.abrupt("return",g);case 28:case"end":return e.stop()}}),e)}))),Ae.apply(this,arguments)}function Ne(e,t){var n=_({},e.springs);return t&&(0,m.S6)((0,m.qo)(t),(function(e){m.is.und(e.keys)&&(e=be(e)),m.is.obj(e.to)||(e=_({},e,{to:void 0})),Pe(n,e,(function(e){return De(e)}))})),Oe(e,n),n}function Oe(e,t){(0,m.rU)(t,(function(t,n){e.springs[n]||(e.springs[n]=t,(0,m.UI)(t,e))}))}function De(e,t){var n=new me;return n.key=e,t&&(0,m.UI)(n,t),n}function Pe(e,t,n){t.keys&&(0,m.S6)(t.keys,(function(r){(e[r]||(e[r]=n(r)))._prepareNode(t)}))}function Me(e,t){(0,m.S6)(t,(function(t){Pe(e.springs,t,(function(t){return De(t,e)}))}))}function Fe(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}var Le,Be,Ue=["children"],je=function(e){var t=e.children,n=Fe(e,Ue),r=(0,g.useContext)(Ze),o=n.pause||!!r.pause,i=n.immediate||!!r.immediate;n=(0,m.Pr)((function(){return{pause:o,immediate:i}}),[o,i]);var a=Ze.Provider;return g.createElement(a,{value:n},t)},Ze=(Le=je,Be={},Object.assign(Le,g.createContext(Be)),Le.Provider._context=Le,Le.Consumer._context=Le,Le);je.Provider=Ze.Provider,je.Consumer=Ze.Consumer;var We=function(){var e=[],t=function(t){(0,m.ZR)();var r=[];return(0,m.S6)(e,(function(e,o){if(m.is.und(t))r.push(e.start());else{var i=n(t,e,o);i&&r.push(e.start(i))}})),r};t.current=e,t.add=function(t){e.includes(t)||e.push(t)},t.delete=function(t){var n=e.indexOf(t);~n&&e.splice(n,1)},t.pause=function(){var t=arguments;return(0,m.S6)(e,(function(e){return e.pause.apply(e,(0,o.Z)(t))})),this},t.resume=function(){var t=arguments;return(0,m.S6)(e,(function(e){return e.resume.apply(e,(0,o.Z)(t))})),this},t.set=function(t){(0,m.S6)(e,(function(e){return e.set(t)}))},t.start=function(t){var n=this,r=[];return(0,m.S6)(e,(function(e,o){if(m.is.und(t))r.push(e.start());else{var i=n._getProps(t,e,o);i&&r.push(e.start(i))}})),r},t.stop=function(){var t=arguments;return(0,m.S6)(e,(function(e){return e.stop.apply(e,(0,o.Z)(t))})),this},t.update=function(t){var n=this;return(0,m.S6)(e,(function(e,r){return e.update(n._getProps(t,e,r))})),this};var n=function(e,t,n){return m.is.fun(e)?e(n,t):e};return t._getProps=n,t};function ze(e,t,n){var r=arguments,i=m.is.fun(t)&&t;i&&!n&&(n=[]);var a=(0,g.useMemo)((function(){return i||3==r.length?We():void 0}),[]),s=(0,g.useRef)(0),u=(0,m.NW)(),c=(0,g.useMemo)((function(){return{ctrls:[],queue:[],flush:function(e,t){var n=Ne(e,t);return s.current>0&&!c.queue.length&&!Object.keys(n).some((function(t){return!e.springs[t]}))?Re(e,t):new Promise((function(r){Oe(e,n),c.queue.push((function(){r(Re(e,t))})),u()}))}}}),[]),l=(0,g.useRef)((0,o.Z)(c.ctrls)),f=[],h=(0,m.zH)(e)||0;function d(e,n){for(var r=e;r<n;r++){var o=l.current[r]||(l.current[r]=new Ie(null,c.flush)),a=i?i(r,o):t[r];a&&(f[r]=we(a))}}(0,g.useMemo)((function(){(0,m.S6)(l.current.slice(e,h),(function(e){F(e,a),e.stop(!0)})),l.current.length=e,d(h,e)}),[e]),(0,g.useMemo)((function(){d(0,Math.min(h,e))}),n);var p=l.current.map((function(e,t){return Ne(e,f[t])})),v=(0,g.useContext)(je),y=(0,m.zH)(v),b=v!==y&&P(v);(0,m.LI)((function(){s.current++,c.ctrls=l.current;var e=c.queue;e.length&&(c.queue=[],(0,m.S6)(e,(function(e){return e()}))),(0,m.S6)(l.current,(function(e,t){null==a||a.add(e),b&&e.start({default:v});var n=f[t];n&&(L(e,n.ref),e.ref?e.queue.push(n):e.start(n))}))})),(0,m.tf)((function(){return function(){(0,m.S6)(c.ctrls,(function(e){return e.stop(!0)}))}}));var w=p.map((function(e){return _({},e)}));return a?[w,a]:w}function Ve(e,t){var n=m.is.fun(e),r=ze(1,n?e:[e],n?t||[]:t),o=(0,i.Z)(r,2),a=(0,i.Z)(o[0],1)[0],s=o[1];return n||2==arguments.length?[a,s]:a}var He,qe=function(){return We()},Ge=function(){return(0,g.useState)(qe)[0]};function Ke(e,t,n){var r,o=m.is.fun(t)&&t;o&&!n&&(n=[]);var i=!0,a=void 0,s=ze(e,(function(e,n){var r=o?o(e,n):t;return a=r.ref,i=i&&r.reverse,r}),n||[{}]),u=null!=(r=a)?r:s[1];return(0,m.LI)((function(){(0,m.S6)(u.current,(function(e,t){var n=u.current[t+(i?1:-1)];n?e.start({to:n.springs}):e.start()}))}),n),o||3==arguments.length?(u._getProps=function(e,t,n){var r=m.is.fun(e)?e(n,t):e;if(r){var o=u.current[n+(r.reverse?1:-1)];return o&&(r.to=o.springs),r}},s):(u.start=function(e){var t=[];return(0,m.S6)(u.current,(function(n,r){var o=m.is.fun(e)?e(r,n):e,a=u.current[r+(i?1:-1)];a?t.push(n.start(_({},o,{to:a.springs}))):t.push(n.start(_({},o)))})),t},s[0])}function Xe(e,t,n){var r=arguments,o=m.is.fun(t)&&t,i=o?o():t,a=i.reset,s=i.sort,u=i.trail,c=void 0===u?0:u,l=i.expires,f=void 0===l||l,h=i.exitBeforeEnter,d=void 0!==h&&h,p=i.onDestroyed,v=i.ref,y=i.config,b=(0,g.useMemo)((function(){return o||3==r.length?We():void 0}),[]),w=(0,m.qo)(e),x=[],k=(0,g.useRef)(null),C=a?null:k.current;(0,m.LI)((function(){k.current=x})),(0,m.tf)((function(){return(0,m.S6)(x,(function(e){null==b||b.add(e.ctrl),e.ctrl.ref=b})),function(){(0,m.S6)(k.current,(function(e){e.expired&&clearTimeout(e.expirationId),F(e.ctrl,b),e.ctrl.stop(!0)}))}}));var S=function(e,t,n){var r=t.key,o=t.keys,i=void 0===o?r:o;if(null===i){var a=new Set;return e.map((function(e){var t=n&&n.find((function(t){return t.item===e&&t.phase!==He.LEAVE&&!a.has(t)}));return t?(a.add(t),t.key):$e++}))}return m.is.und(i)?e:m.is.fun(i)?e.map(i):(0,m.qo)(i)}(w,o?o():t,C),I=a&&k.current||[];(0,m.LI)((function(){return(0,m.S6)(I,(function(e){var t=e.ctrl,n=e.item,r=e.key;F(t,b),E(p,n,r)}))}));var R=[];if(C&&(0,m.S6)(C,(function(e,t){e.expired?(clearTimeout(e.expirationId),I.push(e)):~(t=R[t]=S.indexOf(e.key))&&(x[t]=e)})),(0,m.S6)(w,(function(e,t){x[t]||(x[t]={key:S[t],item:e,phase:He.MOUNT,ctrl:new Ie},x[t].ctrl.item=e)})),R.length){var A=-1,N=(o?o():t).leave;(0,m.S6)(R,(function(e,t){var n=C[t];~e?(A=x.indexOf(n),x[A]=_({},n,{item:w[e]})):N&&x.splice(++A,0,n)}))}m.is.fun(s)&&x.sort((function(e,t){return s(e.item,t.item)}));var D=-c,M=(0,m.NW)(),B=T(t),U=new Map,j=(0,g.useRef)(new Map),Z=(0,g.useRef)(!1);(0,m.S6)(x,(function(e,n){var r,i,a=e.key,s=e.phase,u=o?o():t,l=E(u.delay||0,a);if(s==He.MOUNT)r=u.enter,i=He.ENTER;else{var h=S.indexOf(a)<0;if(s!=He.LEAVE)if(h)r=u.leave,i=He.LEAVE;else{if(!(r=u.update))return;i=He.UPDATE}else{if(h)return;r=u.enter,i=He.ENTER}}if(r=E(r,e.item,n),!(r=m.is.obj(r)?O(r):{to:r}).config){var p=y||B.config;r.config=E(p,e.item,n,i)}var g=_({},B,{delay:l+(D+=c),ref:v,immediate:u.immediate,reset:!1},r);if(i==He.ENTER&&m.is.und(g.from)){var b=o?o():t,w=m.is.und(b.initial)||C?b.from:b.initial;g.from=E(w,e.item,n)}var x=g.onResolve;g.onResolve=function(e){E(x,e);var t=k.current,n=t.find((function(e){return e.key===a}));if(n&&(!e.cancelled||n.phase==He.UPDATE)&&n.ctrl.idle){var r=t.every((function(e){return e.ctrl.idle}));if(n.phase==He.LEAVE){var o=E(f,n.item);if(!1!==o){var i=!0===o?0:o;if(n.expired=!0,!r&&i>0)return void(i<=2147483647&&(n.expirationId=setTimeout(M,i)))}}r&&t.some((function(e){return e.expired}))&&(j.current.delete(n),d&&(Z.current=!0),M())}};var I=Ne(e.ctrl,g);i===He.LEAVE&&d?j.current.set(e,{phase:i,springs:I,payload:g}):U.set(e,{phase:i,springs:I,payload:g})}));var W=(0,g.useContext)(je),z=(0,m.zH)(W),V=W!==z&&P(W);(0,m.LI)((function(){V&&(0,m.S6)(x,(function(e){e.ctrl.start({default:W})}))}),[W]),(0,m.S6)(U,(function(e,t){if(j.current.size){var n=x.findIndex((function(e){return e.key===t.key}));x.splice(n,1)}})),(0,m.LI)((function(){(0,m.S6)(j.current.size?j.current:U,(function(e,t){var n=e.phase,r=e.payload,o=t.ctrl;t.phase=n,null==b||b.add(o),V&&n==He.ENTER&&o.start({default:W}),r&&(L(o,r.ref),!o.ref&&!b||Z.current?(o.start(r),Z.current&&(Z.current=!1)):o.update(r))}))}),a?void 0:n);var H=function(e){return g.createElement(g.Fragment,null,x.map((function(t,n){var r=(U.get(t)||t.ctrl).springs,o=e(_({},r),t.item,t,n);return o&&o.type?g.createElement(o.type,_({},o.props,{key:m.is.str(t.key)||m.is.num(t.key)?t.key:t.ctrl.id,ref:o.ref})):o})))};return b?[H,b]:H}!function(e){e.MOUNT="mount",e.ENTER="enter",e.UPDATE="update",e.LEAVE="leave"}(He||(He={}));var $e=1;var Ye=["children"];function Qe(e){return(0,e.children)(Ve(Fe(e,Ye)))}var Je=["items","children"];function et(e){var t=e.items,n=e.children,r=Fe(e,Je),o=Ke(t.length,r);return t.map((function(e,t){var r=n(e,t);return m.is.fun(r)?r(o[t]):r}))}var tt=["items","children"];function nt(e){var t=e.items,n=e.children;return Xe(t,Fe(e,tt))(n)}var rt=function(e){(0,u.Z)(n,e);var t=(0,c.Z)(n);function n(e,i){var a;(0,p.Z)(this,n),(a=t.call(this)).key=void 0,a.idle=!0,a.calc=void 0,a._active=new Set,a.source=e,a.calc=m.mD.apply(void 0,(0,o.Z)(i));var s=a._get(),u=(0,y.sb)(s);return(0,y.f3)((0,r.Z)(a),u.create(s)),a}return(0,d.Z)(n,[{key:"advance",value:function(e){var t=this._get(),n=this.get();(0,m.Xy)(t,n)||((0,y.ys)(this).setValue(t),this._onChange(t,this.idle)),!this.idle&&it(this._active)&&at(this)}},{key:"_get",value:function(){var e=m.is.arr(this.source)?this.source.map(m.je):(0,m.qo)((0,m.je)(this.source));return this.calc.apply(this,(0,o.Z)(e))}},{key:"_start",value:function(){var e=this;this.idle&&!it(this._active)&&(this.idle=!1,(0,m.S6)((0,y.He)(this),(function(e){e.done=!1})),m.OH.skipAnimation?(m.Wn.batchedUpdates((function(){return e.advance()})),at(this)):m.fT.start(this))}},{key:"_attach",value:function(){var e=this,t=1;(0,m.S6)((0,m.qo)(this.source),(function(n){(0,m.j$)(n)&&(0,m.UI)(n,e),se(n)&&(n.idle||e._active.add(n),t=Math.max(t,n.priority+1))})),this.priority=t,this._start()}},{key:"_detach",value:function(){var e=this;(0,m.S6)((0,m.qo)(this.source),(function(t){(0,m.j$)(t)&&(0,m.iL)(t,e)})),this._active.clear(),at(this)}},{key:"eventObserved",value:function(e){"change"==e.type?e.idle?this.advance():(this._active.add(e.parent),this._start()):"idle"==e.type?this._active.delete(e.parent):"priority"==e.type&&(this.priority=(0,m.qo)(this.source).reduce((function(e,t){return Math.max(e,(se(t)?t.priority:0)+1)}),0))}}]),n}(ce);function ot(e){return!1!==e.idle}function it(e){return!e.size||Array.from(e).every(ot)}function at(e){e.idle||(e.idle=!0,(0,m.S6)((0,y.He)(e),(function(e){e.done=!0})),(0,m.k0)(e,{type:"idle",parent:e}))}var st=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return new rt(e,n)},ut=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return(0,m.LW)(),new rt(e,n)};m.OH.assign({createStringInterpolator:m.qS,to:function(e,t){return new rt(e,t)}});var ct=m.fT.advance},6330:function(e,t,n){"use strict";n.d(t,{B0:function(){return Ce},OH:function(){return W},UI:function(){return Ie},k0:function(){return Ee},O9:function(){return Q},mD:function(){return ge},qS:function(){return Ue},dE:function(){return I},ZR:function(){return He},LW:function(){return ze},S6:function(){return A},rU:function(){return N},yl:function(){return D},bl:function(){return F},fT:function(){return G},Ll:function(){return _e},je:function(){return ke},j$:function(){return xe},is:function(){return R},Df:function(){return qe},Xy:function(){return T},ZT:function(){return S},Wn:function(){return u},iL:function(){return Re},qo:function(){return O},NW:function(){return Xe},LI:function(){return Ge},Pr:function(){return $e},tf:function(){return Ye},zH:function(){return Je},JZ:function(){return et}});var r=n(9439),o=n(3144),i=n(5671),a=n(3433),s=_(),u=function(e){return b(e,s)},c=_();u.write=function(e){return b(e,c)};var l=_();u.onStart=function(e){return b(e,l)};var f=_();u.onFrame=function(e){return b(e,f)};var h=_();u.onFinish=function(e){return b(e,h)};var d=[];u.setTimeout=function(e,t){var n=u.now()+t,r={time:n,handler:e,cancel:function e(){var t=d.findIndex((function(t){return t.cancel==e}));~t&&d.splice(t,1),g-=~t?1:0}};return d.splice(p(n),0,r),g+=1,w(),r};var p=function(e){return~(~d.findIndex((function(t){return t.time>e}))||~d.length)};u.cancel=function(e){l.delete(e),f.delete(e),h.delete(e),s.delete(e),c.delete(e)},u.sync=function(e){y=!0,u.batchedUpdates(e),y=!1},u.throttle=function(e){var t;function n(){try{e.apply(void 0,(0,a.Z)(t))}finally{t=null}}function r(){for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];t=r,u.onStart(n)}return r.handler=e,r.cancel=function(){l.delete(n),t=null},r};var v="undefined"!=typeof window?window.requestAnimationFrame:function(){};u.use=function(e){return v=e},u.now="undefined"!=typeof performance?function(){return performance.now()}:Date.now,u.batchedUpdates=function(e){return e()},u.catch=console.error,u.frameLoop="always",u.advance=function(){"demand"!==u.frameLoop?console.warn("Cannot call the manual advancement of rafz whilst frameLoop is not set as demand"):k()};var m=-1,g=0,y=!1;function b(e,t){y?(t.delete(e),e(0)):(t.add(e),w())}function w(){m<0&&(m=0,"demand"!==u.frameLoop&&v(x))}function x(){~m&&(v(x),u.batchedUpdates(k))}function k(){var e=m;m=u.now();var t=p(m);t&&(E(d.splice(0,t),(function(e){return e.handler()})),g-=t),g?(l.flush(),s.flush(e?Math.min(64,m-e):16.667),f.flush(),c.flush(),h.flush()):m=-1}function _(){var e=new Set,t=e;return{add:function(n){g+=t!=e||e.has(n)?0:1,e.add(n)},delete:function(n){return g-=t==e&&e.has(n)?1:0,e.delete(n)},flush:function(n){t.size&&(e=new Set,g-=t.size,E(t,(function(t){return t(n)&&e.add(t)})),g+=e.size,t=e)}}}function E(e,t){e.forEach((function(e){try{t(e)}catch(n){u.catch(n)}}))}var C=n(2791);function S(){}var I=function(e,t,n){return Object.defineProperty(e,t,{value:n,writable:!0,configurable:!0})},R={arr:Array.isArray,obj:function(e){return!!e&&"Object"===e.constructor.name},fun:function(e){return"function"===typeof e},str:function(e){return"string"===typeof e},num:function(e){return"number"===typeof e},und:function(e){return void 0===e}};function T(e,t){if(R.arr(e)){if(!R.arr(t)||e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}return e===t}var A=function(e,t){return e.forEach(t)};function N(e,t,n){if(R.arr(e))for(var r=0;r<e.length;r++)t.call(n,e[r],"".concat(r));else for(var o in e)e.hasOwnProperty(o)&&t.call(n,e[o],o)}var O=function(e){return R.und(e)?[]:R.arr(e)?e:[e]};function D(e,t){if(e.size){var n=Array.from(e);e.clear(),A(n,t)}}var P,M,F=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return D(e,(function(e){return e.apply(void 0,n)}))},L=function(){return"undefined"===typeof window||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent)},B=null,U=!1,j=S,Z=function(e){e.to&&(M=e.to),e.now&&(u.now=e.now),void 0!==e.colors&&(B=e.colors),null!=e.skipAnimation&&(U=e.skipAnimation),e.createStringInterpolator&&(P=e.createStringInterpolator),e.requestAnimationFrame&&u.use(e.requestAnimationFrame),e.batchedUpdates&&(u.batchedUpdates=e.batchedUpdates),e.willAdvance&&(j=e.willAdvance),e.frameLoop&&(u.frameLoop=e.frameLoop)},W=Object.freeze({__proto__:null,get createStringInterpolator(){return P},get to(){return M},get colors(){return B},get skipAnimation(){return U},get willAdvance(){return j},assign:Z}),z=new Set,V=[],H=[],q=0,G={get idle(){return!z.size&&!V.length},start:function(e){q>e.priority?(z.add(e),u.onStart(K)):(X(e),u(Y))},advance:Y,sort:function(e){if(q)u.onFrame((function(){return G.sort(e)}));else{var t=V.indexOf(e);~t&&(V.splice(t,1),$(e))}},clear:function(){V=[],z.clear()}};function K(){z.forEach(X),z.clear(),u(Y)}function X(e){V.includes(e)||$(e)}function $(e){V.splice(function(e,t){var n=e.findIndex(t);return n<0?e.length:n}(V,(function(t){return t.priority>e.priority})),0,e)}function Y(e){for(var t=H,n=0;n<V.length;n++){var r=V[n];q=r.priority,r.idle||(j(r),r.advance(e),r.idle||t.push(r))}return q=0,(H=V).length=0,(V=t).length>0}var Q={transparent:0,aliceblue:4042850303,antiquewhite:4209760255,aqua:16777215,aquamarine:2147472639,azure:4043309055,beige:4126530815,bisque:4293182719,black:255,blanchedalmond:4293643775,blue:65535,blueviolet:2318131967,brown:2771004159,burlywood:3736635391,burntsienna:3934150143,cadetblue:1604231423,chartreuse:2147418367,chocolate:3530104575,coral:4286533887,cornflowerblue:1687547391,cornsilk:4294499583,crimson:3692313855,cyan:16777215,darkblue:35839,darkcyan:9145343,darkgoldenrod:3095792639,darkgray:2846468607,darkgreen:6553855,darkgrey:2846468607,darkkhaki:3182914559,darkmagenta:2332068863,darkolivegreen:1433087999,darkorange:4287365375,darkorchid:2570243327,darkred:2332033279,darksalmon:3918953215,darkseagreen:2411499519,darkslateblue:1211993087,darkslategray:793726975,darkslategrey:793726975,darkturquoise:13554175,darkviolet:2483082239,deeppink:4279538687,deepskyblue:12582911,dimgray:1768516095,dimgrey:1768516095,dodgerblue:512819199,firebrick:2988581631,floralwhite:4294635775,forestgreen:579543807,fuchsia:4278255615,gainsboro:3705462015,ghostwhite:4177068031,gold:4292280575,goldenrod:3668254975,gray:2155905279,green:8388863,greenyellow:2919182335,grey:2155905279,honeydew:4043305215,hotpink:4285117695,indianred:3445382399,indigo:1258324735,ivory:4294963455,khaki:4041641215,lavender:3873897215,lavenderblush:4293981695,lawngreen:2096890111,lemonchiffon:4294626815,lightblue:2916673279,lightcoral:4034953471,lightcyan:3774873599,lightgoldenrodyellow:4210742015,lightgray:3553874943,lightgreen:2431553791,lightgrey:3553874943,lightpink:4290167295,lightsalmon:4288707327,lightseagreen:548580095,lightskyblue:2278488831,lightslategray:2005441023,lightslategrey:2005441023,lightsteelblue:2965692159,lightyellow:4294959359,lime:16711935,limegreen:852308735,linen:4210091775,magenta:4278255615,maroon:2147483903,mediumaquamarine:1724754687,mediumblue:52735,mediumorchid:3126187007,mediumpurple:2473647103,mediumseagreen:1018393087,mediumslateblue:2070474495,mediumspringgreen:16423679,mediumturquoise:1221709055,mediumvioletred:3340076543,midnightblue:421097727,mintcream:4127193855,mistyrose:4293190143,moccasin:4293178879,navajowhite:4292783615,navy:33023,oldlace:4260751103,olive:2155872511,olivedrab:1804477439,orange:4289003775,orangered:4282712319,orchid:3664828159,palegoldenrod:4008225535,palegreen:2566625535,paleturquoise:2951671551,palevioletred:3681588223,papayawhip:4293907967,peachpuff:4292524543,peru:3448061951,pink:4290825215,plum:3718307327,powderblue:2967529215,purple:2147516671,rebeccapurple:1714657791,red:4278190335,rosybrown:3163525119,royalblue:1097458175,saddlebrown:2336560127,salmon:4202722047,sandybrown:4104413439,seagreen:780883967,seashell:4294307583,sienna:2689740287,silver:3233857791,skyblue:2278484991,slateblue:1784335871,slategray:1887473919,slategrey:1887473919,snow:4294638335,springgreen:16744447,steelblue:1182971135,tan:3535047935,teal:8421631,thistle:3636451583,tomato:4284696575,turquoise:1088475391,violet:4001558271,wheat:4125012991,white:4294967295,whitesmoke:4126537215,yellow:4294902015,yellowgreen:2597139199},J="[-+]?\\d*\\.?\\d+",ee=J+"%";function te(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return"\\(\\s*("+t.join(")\\s*,\\s*(")+")\\s*\\)"}var ne=new RegExp("rgb"+te(J,J,J)),re=new RegExp("rgba"+te(J,J,J,J)),oe=new RegExp("hsl"+te(J,ee,ee)),ie=new RegExp("hsla"+te(J,ee,ee,J)),ae=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,se=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,ue=/^#([0-9a-fA-F]{6})$/,ce=/^#([0-9a-fA-F]{8})$/;function le(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function fe(e,t,n){var r=n<.5?n*(1+t):n+t-n*t,o=2*n-r,i=le(o,r,e+1/3),a=le(o,r,e),s=le(o,r,e-1/3);return Math.round(255*i)<<24|Math.round(255*a)<<16|Math.round(255*s)<<8}function he(e){var t=parseInt(e,10);return t<0?0:t>255?255:t}function de(e){return(parseFloat(e)%360+360)%360/360}function pe(e){var t=parseFloat(e);return t<0?0:t>1?255:Math.round(255*t)}function ve(e){var t=parseFloat(e);return t<0?0:t>100?1:t/100}function me(e){var t=function(e){var t;return"number"===typeof e?e>>>0===e&&e>=0&&e<=4294967295?e:null:(t=ue.exec(e))?parseInt(t[1]+"ff",16)>>>0:B&&void 0!==B[e]?B[e]:(t=ne.exec(e))?(he(t[1])<<24|he(t[2])<<16|he(t[3])<<8|255)>>>0:(t=re.exec(e))?(he(t[1])<<24|he(t[2])<<16|he(t[3])<<8|pe(t[4]))>>>0:(t=ae.exec(e))?parseInt(t[1]+t[1]+t[2]+t[2]+t[3]+t[3]+"ff",16)>>>0:(t=ce.exec(e))?parseInt(t[1],16)>>>0:(t=se.exec(e))?parseInt(t[1]+t[1]+t[2]+t[2]+t[3]+t[3]+t[4]+t[4],16)>>>0:(t=oe.exec(e))?(255|fe(de(t[1]),ve(t[2]),ve(t[3])))>>>0:(t=ie.exec(e))?(fe(de(t[1]),ve(t[2]),ve(t[3]))|pe(t[4]))>>>0:null}(e);if(null===t)return e;var n=(16711680&(t=t||0))>>>16,r=(65280&t)>>>8,o=(255&t)/255;return"rgba(".concat((4278190080&t)>>>24,", ").concat(n,", ").concat(r,", ").concat(o,")")}var ge=function e(t,n,r){if(R.fun(t))return t;if(R.arr(t))return e({range:t,output:n,extrapolate:r});if(R.str(t.output[0]))return P(t);var o=t,i=o.output,a=o.range||[0,1],s=o.extrapolateLeft||o.extrapolate||"extend",u=o.extrapolateRight||o.extrapolate||"extend",c=o.easing||function(e){return e};return function(e){var t=function(e,t){for(var n=1;n<t.length-1&&!(t[n]>=e);++n);return n-1}(e,a);return function(e,t,n,r,o,i,a,s,u){var c=u?u(e):e;if(c<t){if("identity"===a)return c;"clamp"===a&&(c=t)}if(c>n){if("identity"===s)return c;"clamp"===s&&(c=n)}if(r===o)return r;if(t===n)return e<=t?r:o;t===-1/0?c=-c:n===1/0?c-=t:c=(c-t)/(n-t);c=i(c),r===-1/0?c=-c:o===1/0?c+=r:c=c*(o-r)+r;return c}(e,a[t],a[t+1],i[t],i[t+1],c,s,u,o.map)}};function ye(){return ye=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ye.apply(this,arguments)}var be=Symbol.for("FluidValue.get"),we=Symbol.for("FluidValue.observers"),xe=function(e){return Boolean(e&&e[be])},ke=function(e){return e&&e[be]?e[be]():e},_e=function(e){return e[we]||null};function Ee(e,t){var n=e[we];n&&n.forEach((function(e){!function(e,t){e.eventObserved?e.eventObserved(t):e(t)}(e,t)}))}var Ce=(0,o.Z)((function e(t){if((0,i.Z)(this,e),this[be]=void 0,this[we]=void 0,!t&&!(t=this.get))throw Error("Unknown getter");Se(this,t)})),Se=function(e,t){return Ae(e,be,t)};function Ie(e,t){if(e[be]){var n=e[we];n||Ae(e,we,n=new Set),n.has(t)||(n.add(t),e.observerAdded&&e.observerAdded(n.size,t))}return t}function Re(e,t){var n=e[we];if(n&&n.has(t)){var r=n.size-1;r?n.delete(t):e[we]=null,e.observerRemoved&&e.observerRemoved(r,t)}}var Te,Ae=function(e,t,n){return Object.defineProperty(e,t,{value:n,writable:!0,configurable:!0})},Ne=/[+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,Oe=/(#(?:[0-9a-f]{2}){2,4}|(#[0-9a-f]{3})|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))/gi,De=new RegExp("(".concat(Ne.source,")(%|[a-z]+)"),"i"),Pe=/rgba\(([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+)\)/gi,Me=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/,Fe=function e(t){var n=Le(t),o=(0,r.Z)(n,2),i=o[0],a=o[1];if(!i||L())return t;var s=window.getComputedStyle(document.documentElement).getPropertyValue(i);if(s)return s.trim();if(a&&a.startsWith("--")){var u=window.getComputedStyle(document.documentElement).getPropertyValue(a);return u||t}return a&&Me.test(a)?e(a):a||t},Le=function(e){var t=Me.exec(e);if(!t)return[,];var n=(0,r.Z)(t,3);return[n[1],n[2]]},Be=function(e,t,n,r,o){return"rgba(".concat(Math.round(t),", ").concat(Math.round(n),", ").concat(Math.round(r),", ").concat(o,")")},Ue=function(e){Te||(Te=B?new RegExp("(".concat(Object.keys(B).join("|"),")(?!\\w)"),"g"):/^\b$/);var t=e.output.map((function(e){return ke(e).replace(Me,Fe).replace(Oe,me).replace(Te,me)})),n=t.map((function(e){return e.match(Ne).map(Number)})),r=n[0].map((function(e,t){return n.map((function(e){if(!(t in e))throw Error('The arity of each "output" value must be equal');return e[t]}))})).map((function(t){return ge(ye({},e,{output:t}))}));return function(e){var n,o=!De.test(t[0])&&(null==(n=t.find((function(e){return De.test(e)})))?void 0:n.replace(Ne,"")),i=0;return t[0].replace(Ne,(function(){return"".concat(r[i++](e)).concat(o||"")})).replace(Pe,Be)}},je="react-spring: ",Ze=function(e){var t=e,n=!1;if("function"!=typeof t)throw new TypeError("".concat(je,"once requires a function parameter"));return function(){n||(t.apply(void 0,arguments),n=!0)}},We=Ze(console.warn);function ze(){We("".concat(je,'The "interpolate" function is deprecated in v9 (use "to" instead)'))}var Ve=Ze(console.warn);function He(){Ve("".concat(je,'Directly calling start instead of using the api object is deprecated in v9 (use ".start" instead), this will be removed in later 0.X.0 versions'))}function qe(e){return R.str(e)&&("#"==e[0]||/\d/.test(e)||!L()&&Me.test(e)||e in(B||{}))}var Ge=L()?C.useEffect:C.useLayoutEffect,Ke=function(){var e=(0,C.useRef)(!1);return Ge((function(){return e.current=!0,function(){e.current=!1}}),[]),e};function Xe(){var e=(0,C.useState)()[1],t=Ke();return function(){t.current&&e(Math.random())}}function $e(e,t){var n=(0,C.useState)((function(){return{inputs:t,result:e()}})),o=(0,r.Z)(n,1)[0],i=(0,C.useRef)(),a=i.current,s=a;s?Boolean(t&&s.inputs&&function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}(t,s.inputs))||(s={inputs:t,result:e()}):s=o;return(0,C.useEffect)((function(){i.current=s,a==o&&(o.inputs=o.result=void 0)}),[s]),s.result}var Ye=function(e){return(0,C.useEffect)(e,Qe)},Qe=[];function Je(e){var t=(0,C.useRef)();return(0,C.useEffect)((function(){t.current=e})),t.current}var et=function(){var e=(0,C.useState)(null),t=(0,r.Z)(e,2),n=t[0],o=t[1];return Ge((function(){var e=window.matchMedia("(prefers-reduced-motion)"),t=function(e){o(e.matches),Z({skipAnimation:e.matches})};return t(e),e.addEventListener("change",t),function(){e.removeEventListener("change",t)}}),[]),n}},2185:function(){},5290:function(){},9702:function(e,t){"use strict";t.Q=function(e,t){if("string"!==typeof e)throw new TypeError("argument str must be a string");for(var r={},o=t||{},a=e.split(";"),s=o.decode||n,u=0;u<a.length;u++){var c=a[u],l=c.indexOf("=");if(!(l<0)){var f=c.substring(0,l).trim();if(void 0==r[f]){var h=c.substring(l+1,c.length).trim();'"'===h[0]&&(h=h.slice(1,-1)),r[f]=i(h,s)}}}return r},t.q=function(e,t,n){var i=n||{},a=i.encode||r;if("function"!==typeof a)throw new TypeError("option encode is invalid");if(!o.test(e))throw new TypeError("argument name is invalid");var s=a(t);if(s&&!o.test(s))throw new TypeError("argument val is invalid");var u=e+"="+s;if(null!=i.maxAge){var c=i.maxAge-0;if(isNaN(c)||!isFinite(c))throw new TypeError("option maxAge is invalid");u+="; Max-Age="+Math.floor(c)}if(i.domain){if(!o.test(i.domain))throw new TypeError("option domain is invalid");u+="; Domain="+i.domain}if(i.path){if(!o.test(i.path))throw new TypeError("option path is invalid");u+="; Path="+i.path}if(i.expires){if("function"!==typeof i.expires.toUTCString)throw new TypeError("option expires is invalid");u+="; Expires="+i.expires.toUTCString()}i.httpOnly&&(u+="; HttpOnly");i.secure&&(u+="; Secure");if(i.sameSite){switch("string"===typeof i.sameSite?i.sameSite.toLowerCase():i.sameSite){case!0:u+="; SameSite=Strict";break;case"lax":u+="; SameSite=Lax";break;case"strict":u+="; SameSite=Strict";break;case"none":u+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}}return u};var n=decodeURIComponent,r=encodeURIComponent,o=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;function i(e,t){try{return t(e)}catch(n){return e}}},1725:function(e){"use strict";var t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(o){return!1}}()?Object.assign:function(e,o){for(var i,a,s=function(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),u=1;u<arguments.length;u++){for(var c in i=Object(arguments[u]))n.call(i,c)&&(s[c]=i[c]);if(t){a=t(i);for(var l=0;l<a.length;l++)r.call(i,a[l])&&(s[a[l]]=i[a[l]])}}return s}},4463:function(e,t,n){"use strict";var r=n(2791),o=n(1725),i=n(5296);function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!r)throw Error(a(227));var s=new Set,u={};function c(e,t){l(e,t),l(e+"Capture",t)}function l(e,t){for(u[e]=t,e=0;e<t.length;e++)s.add(t[e])}var f=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d=Object.prototype.hasOwnProperty,p={},v={};function m(e,t,n,r,o,i,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=a}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new m(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new m(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new m(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new m(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new m(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)}));var y=/[\-:]([a-z])/g;function b(e){return e[1].toUpperCase()}function w(e,t,n,r){var o=g.hasOwnProperty(t)?g[t]:null;(null!==o?0===o.type:!r&&(2<t.length&&("o"===t[0]||"O"===t[0])&&("n"===t[1]||"N"===t[1])))||(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,o,r)&&(n=null),r||null===o?function(e){return!!d.call(v,e)||!d.call(p,e)&&(h.test(e)?v[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):o.mustUseProperty?e[o.propertyName]=null===n?3!==o.type&&"":n:(t=o.attributeName,r=o.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(o=o.type)||4===o&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(y,b);g[t]=new m(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(y,b);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(y,b);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)}));var x=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,k=60103,_=60106,E=60107,C=60108,S=60114,I=60109,R=60110,T=60112,A=60113,N=60120,O=60115,D=60116,P=60121,M=60128,F=60129,L=60130,B=60131;if("function"===typeof Symbol&&Symbol.for){var U=Symbol.for;k=U("react.element"),_=U("react.portal"),E=U("react.fragment"),C=U("react.strict_mode"),S=U("react.profiler"),I=U("react.provider"),R=U("react.context"),T=U("react.forward_ref"),A=U("react.suspense"),N=U("react.suspense_list"),O=U("react.memo"),D=U("react.lazy"),P=U("react.block"),U("react.scope"),M=U("react.opaque.id"),F=U("react.debug_trace_mode"),L=U("react.offscreen"),B=U("react.legacy_hidden")}var j,Z="function"===typeof Symbol&&Symbol.iterator;function W(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=Z&&e[Z]||e["@@iterator"])?e:null}function z(e){if(void 0===j)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);j=t&&t[1]||""}return"\n"+j+e}var V=!1;function H(e,t){if(!e||V)return"";V=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var r=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){r=u}e.call(t.prototype)}else{try{throw Error()}catch(u){r=u}e()}}catch(u){if(u&&r&&"string"===typeof u.stack){for(var o=u.stack.split("\n"),i=r.stack.split("\n"),a=o.length-1,s=i.length-1;1<=a&&0<=s&&o[a]!==i[s];)s--;for(;1<=a&&0<=s;a--,s--)if(o[a]!==i[s]){if(1!==a||1!==s)do{if(a--,0>--s||o[a]!==i[s])return"\n"+o[a].replace(" at new "," at ")}while(1<=a&&0<=s);break}}}finally{V=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?z(e):""}function q(e){switch(e.tag){case 5:return z(e.type);case 16:return z("Lazy");case 13:return z("Suspense");case 19:return z("SuspenseList");case 0:case 2:case 15:return e=H(e.type,!1);case 11:return e=H(e.type.render,!1);case 22:return e=H(e.type._render,!1);case 1:return e=H(e.type,!0);default:return""}}function G(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case E:return"Fragment";case _:return"Portal";case S:return"Profiler";case C:return"StrictMode";case A:return"Suspense";case N:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case R:return(e.displayName||"Context")+".Consumer";case I:return(e._context.displayName||"Context")+".Provider";case T:var t=e.render;return t=t.displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case O:return G(e.type);case P:return G(e._render);case D:t=e._payload,e=e._init;try{return G(e(t))}catch(n){}}return null}function K(e){switch(typeof e){case"boolean":case"number":case"object":case"string":case"undefined":return e;default:return""}}function X(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function $(e){e._valueTracker||(e._valueTracker=function(e){var t=X(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var o=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(e){r=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function Y(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=X(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function Q(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function J(e,t){var n=t.checked;return o({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function ee(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=K(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function te(e,t){null!=(t=t.checked)&&w(e,"checked",t,!1)}function ne(e,t){te(e,t);var n=K(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?oe(e,t.type,n):t.hasOwnProperty("defaultValue")&&oe(e,t.type,K(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function re(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function oe(e,t,n){"number"===t&&Q(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}function ie(e,t){return e=o({children:void 0},t),(t=function(e){var t="";return r.Children.forEach(e,(function(e){null!=e&&(t+=e)})),t}(t.children))&&(e.children=t),e}function ae(e,t,n,r){if(e=e.options,t){t={};for(var o=0;o<n.length;o++)t["$"+n[o]]=!0;for(n=0;n<e.length;n++)o=t.hasOwnProperty("$"+e[n].value),e[n].selected!==o&&(e[n].selected=o),o&&r&&(e[n].defaultSelected=!0)}else{for(n=""+K(n),t=null,o=0;o<e.length;o++){if(e[o].value===n)return e[o].selected=!0,void(r&&(e[o].defaultSelected=!0));null!==t||e[o].disabled||(t=e[o])}null!==t&&(t.selected=!0)}}function se(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(a(91));return o({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ue(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(a(92));if(Array.isArray(n)){if(!(1>=n.length))throw Error(a(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:K(n)}}function ce(e,t){var n=K(t.value),r=K(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function le(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}var fe={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg"};function he(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function de(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?he(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var pe,ve,me=(ve=function(e,t){if(e.namespaceURI!==fe.svg||"innerHTML"in e)e.innerHTML=t;else{for((pe=pe||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=pe.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return ve(e,t)}))}:ve);function ge(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var ye={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},be=["Webkit","ms","Moz","O"];function we(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||ye.hasOwnProperty(e)&&ye[e]?(""+t).trim():t+"px"}function xe(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),o=we(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,o):e[n]=o}}Object.keys(ye).forEach((function(e){be.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ye[t]=ye[e]}))}));var ke=o({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function _e(e,t){if(t){if(ke[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(a(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(a(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(a(62))}}function Ee(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function Ce(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Se=null,Ie=null,Re=null;function Te(e){if(e=no(e)){if("function"!==typeof Se)throw Error(a(280));var t=e.stateNode;t&&(t=oo(t),Se(e.stateNode,e.type,t))}}function Ae(e){Ie?Re?Re.push(e):Re=[e]:Ie=e}function Ne(){if(Ie){var e=Ie,t=Re;if(Re=Ie=null,Te(e),t)for(e=0;e<t.length;e++)Te(t[e])}}function Oe(e,t){return e(t)}function De(e,t,n,r,o){return e(t,n,r,o)}function Pe(){}var Me=Oe,Fe=!1,Le=!1;function Be(){null===Ie&&null===Re||(Pe(),Ne())}function Ue(e,t){var n=e.stateNode;if(null===n)return null;var r=oo(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(a(231,t,typeof n));return n}var je=!1;if(f)try{var Ze={};Object.defineProperty(Ze,"passive",{get:function(){je=!0}}),window.addEventListener("test",Ze,Ze),window.removeEventListener("test",Ze,Ze)}catch(ve){je=!1}function We(e,t,n,r,o,i,a,s,u){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(l){this.onError(l)}}var ze=!1,Ve=null,He=!1,qe=null,Ge={onError:function(e){ze=!0,Ve=e}};function Ke(e,t,n,r,o,i,a,s,u){ze=!1,Ve=null,We.apply(Ge,arguments)}function Xe(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(1026&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function $e(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ye(e){if(Xe(e)!==e)throw Error(a(188))}function Qe(e){if(e=function(e){var t=e.alternate;if(!t){if(null===(t=Xe(e)))throw Error(a(188));return t!==e?null:e}for(var n=e,r=t;;){var o=n.return;if(null===o)break;var i=o.alternate;if(null===i){if(null!==(r=o.return)){n=r;continue}break}if(o.child===i.child){for(i=o.child;i;){if(i===n)return Ye(o),e;if(i===r)return Ye(o),t;i=i.sibling}throw Error(a(188))}if(n.return!==r.return)n=o,r=i;else{for(var s=!1,u=o.child;u;){if(u===n){s=!0,n=o,r=i;break}if(u===r){s=!0,r=o,n=i;break}u=u.sibling}if(!s){for(u=i.child;u;){if(u===n){s=!0,n=i,r=o;break}if(u===r){s=!0,r=i,n=o;break}u=u.sibling}if(!s)throw Error(a(189))}}if(n.alternate!==r)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?e:t}(e),!e)return null;for(var t=e;;){if(5===t.tag||6===t.tag)return t;if(t.child)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}function Je(e,t){for(var n=e.alternate;null!==t;){if(t===e||t===n)return!0;t=t.return}return!1}var et,tt,nt,rt,ot=!1,it=[],at=null,st=null,ut=null,ct=new Map,lt=new Map,ft=[],ht="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function dt(e,t,n,r,o){return{blockedOn:e,domEventName:t,eventSystemFlags:16|n,nativeEvent:o,targetContainers:[r]}}function pt(e,t){switch(e){case"focusin":case"focusout":at=null;break;case"dragenter":case"dragleave":st=null;break;case"mouseover":case"mouseout":ut=null;break;case"pointerover":case"pointerout":ct.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":lt.delete(t.pointerId)}}function vt(e,t,n,r,o,i){return null===e||e.nativeEvent!==i?(e=dt(t,n,r,o,i),null!==t&&(null!==(t=no(t))&&tt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==o&&-1===t.indexOf(o)&&t.push(o),e)}function mt(e){var t=to(e.target);if(null!==t){var n=Xe(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=$e(n)))return e.blockedOn=t,void rt(e.lanePriority,(function(){i.unstable_runWithPriority(e.priority,(function(){nt(n)}))}))}else if(3===t&&n.stateNode.hydrate)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function gt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Qt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=no(n))&&tt(t),e.blockedOn=n,!1;t.shift()}return!0}function yt(e,t,n){gt(e)&&n.delete(t)}function bt(){for(ot=!1;0<it.length;){var e=it[0];if(null!==e.blockedOn){null!==(e=no(e.blockedOn))&&et(e);break}for(var t=e.targetContainers;0<t.length;){var n=Qt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n){e.blockedOn=n;break}t.shift()}null===e.blockedOn&&it.shift()}null!==at&&gt(at)&&(at=null),null!==st&&gt(st)&&(st=null),null!==ut&&gt(ut)&&(ut=null),ct.forEach(yt),lt.forEach(yt)}function wt(e,t){e.blockedOn===t&&(e.blockedOn=null,ot||(ot=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,bt)))}function xt(e){function t(t){return wt(t,e)}if(0<it.length){wt(it[0],e);for(var n=1;n<it.length;n++){var r=it[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==at&&wt(at,e),null!==st&&wt(st,e),null!==ut&&wt(ut,e),ct.forEach(t),lt.forEach(t),n=0;n<ft.length;n++)(r=ft[n]).blockedOn===e&&(r.blockedOn=null);for(;0<ft.length&&null===(n=ft[0]).blockedOn;)mt(n),null===n.blockedOn&&ft.shift()}function kt(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var _t={animationend:kt("Animation","AnimationEnd"),animationiteration:kt("Animation","AnimationIteration"),animationstart:kt("Animation","AnimationStart"),transitionend:kt("Transition","TransitionEnd")},Et={},Ct={};function St(e){if(Et[e])return Et[e];if(!_t[e])return e;var t,n=_t[e];for(t in n)if(n.hasOwnProperty(t)&&t in Ct)return Et[e]=n[t];return e}f&&(Ct=document.createElement("div").style,"AnimationEvent"in window||(delete _t.animationend.animation,delete _t.animationiteration.animation,delete _t.animationstart.animation),"TransitionEvent"in window||delete _t.transitionend.transition);var It=St("animationend"),Rt=St("animationiteration"),Tt=St("animationstart"),At=St("transitionend"),Nt=new Map,Ot=new Map,Dt=["abort","abort",It,"animationEnd",Rt,"animationIteration",Tt,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",At,"transitionEnd","waiting","waiting"];function Pt(e,t){for(var n=0;n<e.length;n+=2){var r=e[n],o=e[n+1];o="on"+(o[0].toUpperCase()+o.slice(1)),Ot.set(r,t),Nt.set(r,o),c(o,[r])}}(0,i.unstable_now)();var Mt=8;function Ft(e){if(0!==(1&e))return Mt=15,1;if(0!==(2&e))return Mt=14,2;if(0!==(4&e))return Mt=13,4;var t=24&e;return 0!==t?(Mt=12,t):0!==(32&e)?(Mt=11,32):0!==(t=192&e)?(Mt=10,t):0!==(256&e)?(Mt=9,256):0!==(t=3584&e)?(Mt=8,t):0!==(4096&e)?(Mt=7,4096):0!==(t=4186112&e)?(Mt=6,t):0!==(t=62914560&e)?(Mt=5,t):67108864&e?(Mt=4,67108864):0!==(134217728&e)?(Mt=3,134217728):0!==(t=805306368&e)?(Mt=2,t):0!==(1073741824&e)?(Mt=1,1073741824):(Mt=8,e)}function Lt(e,t){var n=e.pendingLanes;if(0===n)return Mt=0;var r=0,o=0,i=e.expiredLanes,a=e.suspendedLanes,s=e.pingedLanes;if(0!==i)r=i,o=Mt=15;else if(0!==(i=134217727&n)){var u=i&~a;0!==u?(r=Ft(u),o=Mt):0!==(s&=i)&&(r=Ft(s),o=Mt)}else 0!==(i=n&~a)?(r=Ft(i),o=Mt):0!==s&&(r=Ft(s),o=Mt);if(0===r)return 0;if(r=n&((0>(r=31-zt(r))?0:1<<r)<<1)-1,0!==t&&t!==r&&0===(t&a)){if(Ft(t),o<=Mt)return t;Mt=o}if(0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)o=1<<(n=31-zt(t)),r|=e[n],t&=~o;return r}function Bt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function Ut(e,t){switch(e){case 15:return 1;case 14:return 2;case 12:return 0===(e=jt(24&~t))?Ut(10,t):e;case 10:return 0===(e=jt(192&~t))?Ut(8,t):e;case 8:return 0===(e=jt(3584&~t))&&(0===(e=jt(4186112&~t))&&(e=512)),e;case 2:return 0===(t=jt(805306368&~t))&&(t=268435456),t}throw Error(a(358,e))}function jt(e){return e&-e}function Zt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Wt(e,t,n){e.pendingLanes|=t;var r=t-1;e.suspendedLanes&=r,e.pingedLanes&=r,(e=e.eventTimes)[t=31-zt(t)]=n}var zt=Math.clz32?Math.clz32:function(e){return 0===e?32:31-(Vt(e)/Ht|0)|0},Vt=Math.log,Ht=Math.LN2;var qt=i.unstable_UserBlockingPriority,Gt=i.unstable_runWithPriority,Kt=!0;function Xt(e,t,n,r){Fe||Pe();var o=Yt,i=Fe;Fe=!0;try{De(o,e,t,n,r)}finally{(Fe=i)||Be()}}function $t(e,t,n,r){Gt(qt,Yt.bind(null,e,t,n,r))}function Yt(e,t,n,r){var o;if(Kt)if((o=0===(4&t))&&0<it.length&&-1<ht.indexOf(e))e=dt(null,e,t,n,r),it.push(e);else{var i=Qt(e,t,n,r);if(null===i)o&&pt(e,r);else{if(o){if(-1<ht.indexOf(e))return e=dt(i,e,t,n,r),void it.push(e);if(function(e,t,n,r,o){switch(t){case"focusin":return at=vt(at,e,t,n,r,o),!0;case"dragenter":return st=vt(st,e,t,n,r,o),!0;case"mouseover":return ut=vt(ut,e,t,n,r,o),!0;case"pointerover":var i=o.pointerId;return ct.set(i,vt(ct.get(i)||null,e,t,n,r,o)),!0;case"gotpointercapture":return i=o.pointerId,lt.set(i,vt(lt.get(i)||null,e,t,n,r,o)),!0}return!1}(i,e,t,n,r))return;pt(e,r)}Pr(e,t,r,null,n)}}}function Qt(e,t,n,r){var o=Ce(r);if(null!==(o=to(o))){var i=Xe(o);if(null===i)o=null;else{var a=i.tag;if(13===a){if(null!==(o=$e(i)))return o;o=null}else if(3===a){if(i.stateNode.hydrate)return 3===i.tag?i.stateNode.containerInfo:null;o=null}else i!==o&&(o=null)}}return Pr(e,t,r,o,n),null}var Jt=null,en=null,tn=null;function nn(){if(tn)return tn;var e,t,n=en,r=n.length,o="value"in Jt?Jt.value:Jt.textContent,i=o.length;for(e=0;e<r&&n[e]===o[e];e++);var a=r-e;for(t=1;t<=a&&n[r-t]===o[i-t];t++);return tn=o.slice(e,1<t?1-t:void 0)}function rn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function on(){return!0}function an(){return!1}function sn(e){function t(t,n,r,o,i){for(var a in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=o,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(o):o[a]);return this.isDefaultPrevented=(null!=o.defaultPrevented?o.defaultPrevented:!1===o.returnValue)?on:an,this.isPropagationStopped=an,this}return o(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=on)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=on)},persist:function(){},isPersistent:on}),t}var un,cn,ln,fn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},hn=sn(fn),dn=o({},fn,{view:0,detail:0}),pn=sn(dn),vn=o({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:In,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(un=e.screenX-ln.screenX,cn=e.screenY-ln.screenY):cn=un=0,ln=e),un)},movementY:function(e){return"movementY"in e?e.movementY:cn}}),mn=sn(vn),gn=sn(o({},vn,{dataTransfer:0})),yn=sn(o({},dn,{relatedTarget:0})),bn=sn(o({},fn,{animationName:0,elapsedTime:0,pseudoElement:0})),wn=o({},fn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),xn=sn(wn),kn=sn(o({},fn,{data:0})),_n={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},En={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Cn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Cn[e])&&!!t[e]}function In(){return Sn}var Rn=o({},dn,{key:function(e){if(e.key){var t=_n[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=rn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?En[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:In,charCode:function(e){return"keypress"===e.type?rn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?rn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Tn=sn(Rn),An=sn(o({},vn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Nn=sn(o({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:In})),On=sn(o({},fn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Dn=o({},vn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Pn=sn(Dn),Mn=[9,13,27,32],Fn=f&&"CompositionEvent"in window,Ln=null;f&&"documentMode"in document&&(Ln=document.documentMode);var Bn=f&&"TextEvent"in window&&!Ln,Un=f&&(!Fn||Ln&&8<Ln&&11>=Ln),jn=String.fromCharCode(32),Zn=!1;function Wn(e,t){switch(e){case"keyup":return-1!==Mn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Vn=!1;var Hn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Hn[e.type]:"textarea"===t}function Gn(e,t,n,r){Ae(r),0<(t=Fr(t,"onChange")).length&&(n=new hn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Kn=null,Xn=null;function $n(e){Rr(e,0)}function Yn(e){if(Y(ro(e)))return e}function Qn(e,t){if("change"===e)return t}var Jn=!1;if(f){var er;if(f){var tr="oninput"in document;if(!tr){var nr=document.createElement("div");nr.setAttribute("oninput","return;"),tr="function"===typeof nr.oninput}er=tr}else er=!1;Jn=er&&(!document.documentMode||9<document.documentMode)}function rr(){Kn&&(Kn.detachEvent("onpropertychange",or),Xn=Kn=null)}function or(e){if("value"===e.propertyName&&Yn(Xn)){var t=[];if(Gn(t,Xn,e,Ce(e)),e=$n,Fe)e(t);else{Fe=!0;try{Oe(e,t)}finally{Fe=!1,Be()}}}}function ir(e,t,n){"focusin"===e?(rr(),Xn=n,(Kn=t).attachEvent("onpropertychange",or)):"focusout"===e&&rr()}function ar(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Yn(Xn)}function sr(e,t){if("click"===e)return Yn(t)}function ur(e,t){if("input"===e||"change"===e)return Yn(t)}var cr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},lr=Object.prototype.hasOwnProperty;function fr(e,t){if(cr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++)if(!lr.call(t,n[r])||!cr(e[n[r]],t[n[r]]))return!1;return!0}function hr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function dr(e,t){var n,r=hr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=hr(r)}}function pr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?pr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function vr(){for(var e=window,t=Q();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=Q((e=t.contentWindow).document)}return t}function mr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var gr=f&&"documentMode"in document&&11>=document.documentMode,yr=null,br=null,wr=null,xr=!1;function kr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;xr||null==yr||yr!==Q(r)||("selectionStart"in(r=yr)&&mr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},wr&&fr(wr,r)||(wr=r,0<(r=Fr(br,"onSelect")).length&&(t=new hn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=yr)))}Pt("cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focusin focus focusout blur input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0),Pt("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1),Pt(Dt,2);for(var _r="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),Er=0;Er<_r.length;Er++)Ot.set(_r[Er],0);l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),c("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),c("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),c("onBeforeInput",["compositionend","keypress","textInput","paste"]),c("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Cr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Sr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Cr));function Ir(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,o,i,s,u,c){if(Ke.apply(this,arguments),ze){if(!ze)throw Error(a(198));var l=Ve;ze=!1,Ve=null,He||(He=!0,qe=l)}}(r,t,void 0,e),e.currentTarget=null}function Rr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],o=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var a=r.length-1;0<=a;a--){var s=r[a],u=s.instance,c=s.currentTarget;if(s=s.listener,u!==i&&o.isPropagationStopped())break e;Ir(o,s,c),i=u}else for(a=0;a<r.length;a++){if(u=(s=r[a]).instance,c=s.currentTarget,s=s.listener,u!==i&&o.isPropagationStopped())break e;Ir(o,s,c),i=u}}}if(He)throw e=qe,He=!1,qe=null,e}function Tr(e,t){var n=io(t),r=e+"__bubble";n.has(r)||(Dr(t,e,2,!1),n.add(r))}var Ar="_reactListening"+Math.random().toString(36).slice(2);function Nr(e){e[Ar]||(e[Ar]=!0,s.forEach((function(t){Sr.has(t)||Or(t,!1,e,null),Or(t,!0,e,null)})))}function Or(e,t,n,r){var o=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,i=n;if("selectionchange"===e&&9!==n.nodeType&&(i=n.ownerDocument),null!==r&&!t&&Sr.has(e)){if("scroll"!==e)return;o|=2,i=r}var a=io(i),s=e+"__"+(t?"capture":"bubble");a.has(s)||(t&&(o|=4),Dr(i,e,o,t),a.add(s))}function Dr(e,t,n,r){var o=Ot.get(t);switch(void 0===o?2:o){case 0:o=Xt;break;case 1:o=$t;break;default:o=Yt}n=o.bind(null,t,n,e),o=void 0,!je||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(o=!0),r?void 0!==o?e.addEventListener(t,n,{capture:!0,passive:o}):e.addEventListener(t,n,!0):void 0!==o?e.addEventListener(t,n,{passive:o}):e.addEventListener(t,n,!1)}function Pr(e,t,n,r,o){var i=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var a=r.tag;if(3===a||4===a){var s=r.stateNode.containerInfo;if(s===o||8===s.nodeType&&s.parentNode===o)break;if(4===a)for(a=r.return;null!==a;){var u=a.tag;if((3===u||4===u)&&((u=a.stateNode.containerInfo)===o||8===u.nodeType&&u.parentNode===o))return;a=a.return}for(;null!==s;){if(null===(a=to(s)))return;if(5===(u=a.tag)||6===u){r=i=a;continue e}s=s.parentNode}}r=r.return}!function(e,t,n){if(Le)return e(t,n);Le=!0;try{return Me(e,t,n)}finally{Le=!1,Be()}}((function(){var r=i,o=Ce(n),a=[];e:{var s=Nt.get(e);if(void 0!==s){var u=hn,c=e;switch(e){case"keypress":if(0===rn(n))break e;case"keydown":case"keyup":u=Tn;break;case"focusin":c="focus",u=yn;break;case"focusout":c="blur",u=yn;break;case"beforeblur":case"afterblur":u=yn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":u=mn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":u=gn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":u=Nn;break;case It:case Rt:case Tt:u=bn;break;case At:u=On;break;case"scroll":u=pn;break;case"wheel":u=Pn;break;case"copy":case"cut":case"paste":u=xn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":u=An}var l=0!==(4&t),f=!l&&"scroll"===e,h=l?null!==s?s+"Capture":null:s;l=[];for(var d,p=r;null!==p;){var v=(d=p).stateNode;if(5===d.tag&&null!==v&&(d=v,null!==h&&(null!=(v=Ue(p,h))&&l.push(Mr(p,v,d)))),f)break;p=p.return}0<l.length&&(s=new u(s,c,null,n,o),a.push({event:s,listeners:l}))}}if(0===(7&t)){if(u="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||0!==(16&t)||!(c=n.relatedTarget||n.fromElement)||!to(c)&&!c[Jr])&&(u||s)&&(s=o.window===o?o:(s=o.ownerDocument)?s.defaultView||s.parentWindow:window,u?(u=r,null!==(c=(c=n.relatedTarget||n.toElement)?to(c):null)&&(c!==(f=Xe(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(u=null,c=r),u!==c)){if(l=mn,v="onMouseLeave",h="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(l=An,v="onPointerLeave",h="onPointerEnter",p="pointer"),f=null==u?s:ro(u),d=null==c?s:ro(c),(s=new l(v,p+"leave",u,n,o)).target=f,s.relatedTarget=d,v=null,to(o)===r&&((l=new l(h,p+"enter",c,n,o)).target=d,l.relatedTarget=f,v=l),f=v,u&&c)e:{for(h=c,p=0,d=l=u;d;d=Lr(d))p++;for(d=0,v=h;v;v=Lr(v))d++;for(;0<p-d;)l=Lr(l),p--;for(;0<d-p;)h=Lr(h),d--;for(;p--;){if(l===h||null!==h&&l===h.alternate)break e;l=Lr(l),h=Lr(h)}l=null}else l=null;null!==u&&Br(a,s,u,l,!1),null!==c&&null!==f&&Br(a,f,c,l,!0)}if("select"===(u=(s=r?ro(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===u&&"file"===s.type)var m=Qn;else if(qn(s))if(Jn)m=ur;else{m=ar;var g=ir}else(u=s.nodeName)&&"input"===u.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(m=sr);switch(m&&(m=m(e,r))?Gn(a,m,n,o):(g&&g(e,s,r),"focusout"===e&&(g=s._wrapperState)&&g.controlled&&"number"===s.type&&oe(s,"number",s.value)),g=r?ro(r):window,e){case"focusin":(qn(g)||"true"===g.contentEditable)&&(yr=g,br=r,wr=null);break;case"focusout":wr=br=yr=null;break;case"mousedown":xr=!0;break;case"contextmenu":case"mouseup":case"dragend":xr=!1,kr(a,n,o);break;case"selectionchange":if(gr)break;case"keydown":case"keyup":kr(a,n,o)}var y;if(Fn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Vn?Wn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Un&&"ko"!==n.locale&&(Vn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Vn&&(y=nn()):(en="value"in(Jt=o)?Jt.value:Jt.textContent,Vn=!0)),0<(g=Fr(r,b)).length&&(b=new kn(b,e,null,n,o),a.push({event:b,listeners:g}),y?b.data=y:null!==(y=zn(n))&&(b.data=y))),(y=Bn?function(e,t){switch(e){case"compositionend":return zn(t);case"keypress":return 32!==t.which?null:(Zn=!0,jn);case"textInput":return(e=t.data)===jn&&Zn?null:e;default:return null}}(e,n):function(e,t){if(Vn)return"compositionend"===e||!Fn&&Wn(e,t)?(e=nn(),tn=en=Jt=null,Vn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Un&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Fr(r,"onBeforeInput")).length&&(o=new kn("onBeforeInput","beforeinput",null,n,o),a.push({event:o,listeners:r}),o.data=y))}Rr(a,t)}))}function Mr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Fr(e,t){for(var n=t+"Capture",r=[];null!==e;){var o=e,i=o.stateNode;5===o.tag&&null!==i&&(o=i,null!=(i=Ue(e,n))&&r.unshift(Mr(e,i,o)),null!=(i=Ue(e,t))&&r.push(Mr(e,i,o))),e=e.return}return r}function Lr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Br(e,t,n,r,o){for(var i=t._reactName,a=[];null!==n&&n!==r;){var s=n,u=s.alternate,c=s.stateNode;if(null!==u&&u===r)break;5===s.tag&&null!==c&&(s=c,o?null!=(u=Ue(n,i))&&a.unshift(Mr(n,u,s)):o||null!=(u=Ue(n,i))&&a.push(Mr(n,u,s))),n=n.return}0!==a.length&&e.push({event:t,listeners:a})}function Ur(){}var jr=null,Zr=null;function Wr(e,t){switch(e){case"button":case"input":case"select":case"textarea":return!!t.autoFocus}return!1}function zr(e,t){return"textarea"===e||"option"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var Vr="function"===typeof setTimeout?setTimeout:void 0,Hr="function"===typeof clearTimeout?clearTimeout:void 0;function qr(e){1===e.nodeType?e.textContent="":9===e.nodeType&&(null!=(e=e.body)&&(e.textContent=""))}function Gr(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break}return e}function Kr(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var Xr=0;var $r=Math.random().toString(36).slice(2),Yr="__reactFiber$"+$r,Qr="__reactProps$"+$r,Jr="__reactContainer$"+$r,eo="__reactEvents$"+$r;function to(e){var t=e[Yr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Jr]||n[Yr]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=Kr(e);null!==e;){if(n=e[Yr])return n;e=Kr(e)}return t}n=(e=n).parentNode}return null}function no(e){return!(e=e[Yr]||e[Jr])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function ro(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(a(33))}function oo(e){return e[Qr]||null}function io(e){var t=e[eo];return void 0===t&&(t=e[eo]=new Set),t}var ao=[],so=-1;function uo(e){return{current:e}}function co(e){0>so||(e.current=ao[so],ao[so]=null,so--)}function lo(e,t){so++,ao[so]=e.current,e.current=t}var fo={},ho=uo(fo),po=uo(!1),vo=fo;function mo(e,t){var n=e.type.contextTypes;if(!n)return fo;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var o,i={};for(o in n)i[o]=t[o];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function go(e){return null!==(e=e.childContextTypes)&&void 0!==e}function yo(){co(po),co(ho)}function bo(e,t,n){if(ho.current!==fo)throw Error(a(168));lo(ho,t),lo(po,n)}function wo(e,t,n){var r=e.stateNode;if(e=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in e))throw Error(a(108,G(t)||"Unknown",i));return o({},n,r)}function xo(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||fo,vo=ho.current,lo(ho,e),lo(po,po.current),!0}function ko(e,t,n){var r=e.stateNode;if(!r)throw Error(a(169));n?(e=wo(e,t,vo),r.__reactInternalMemoizedMergedChildContext=e,co(po),co(ho),lo(ho,e)):co(po),lo(po,n)}var _o=null,Eo=null,Co=i.unstable_runWithPriority,So=i.unstable_scheduleCallback,Io=i.unstable_cancelCallback,Ro=i.unstable_shouldYield,To=i.unstable_requestPaint,Ao=i.unstable_now,No=i.unstable_getCurrentPriorityLevel,Oo=i.unstable_ImmediatePriority,Do=i.unstable_UserBlockingPriority,Po=i.unstable_NormalPriority,Mo=i.unstable_LowPriority,Fo=i.unstable_IdlePriority,Lo={},Bo=void 0!==To?To:function(){},Uo=null,jo=null,Zo=!1,Wo=Ao(),zo=1e4>Wo?Ao:function(){return Ao()-Wo};function Vo(){switch(No()){case Oo:return 99;case Do:return 98;case Po:return 97;case Mo:return 96;case Fo:return 95;default:throw Error(a(332))}}function Ho(e){switch(e){case 99:return Oo;case 98:return Do;case 97:return Po;case 96:return Mo;case 95:return Fo;default:throw Error(a(332))}}function qo(e,t){return e=Ho(e),Co(e,t)}function Go(e,t,n){return e=Ho(e),So(e,t,n)}function Ko(){if(null!==jo){var e=jo;jo=null,Io(e)}Xo()}function Xo(){if(!Zo&&null!==Uo){Zo=!0;var e=0;try{var t=Uo;qo(99,(function(){for(;e<t.length;e++){var n=t[e];do{n=n(!0)}while(null!==n)}})),Uo=null}catch(n){throw null!==Uo&&(Uo=Uo.slice(e+1)),So(Oo,Ko),n}finally{Zo=!1}}}var $o=x.ReactCurrentBatchConfig;function Yo(e,t){if(e&&e.defaultProps){for(var n in t=o({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var Qo=uo(null),Jo=null,ei=null,ti=null;function ni(){ti=ei=Jo=null}function ri(e){var t=Qo.current;co(Qo),e.type._context._currentValue=t}function oi(e,t){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)===t){if(null===n||(n.childLanes&t)===t)break;n.childLanes|=t}else e.childLanes|=t,null!==n&&(n.childLanes|=t);e=e.return}}function ii(e,t){Jo=e,ti=ei=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(Fa=!0),e.firstContext=null)}function ai(e,t){if(ti!==e&&!1!==t&&0!==t)if("number"===typeof t&&1073741823!==t||(ti=e,t=1073741823),t={context:e,observedBits:t,next:null},null===ei){if(null===Jo)throw Error(a(308));ei=t,Jo.dependencies={lanes:0,firstContext:t,responders:null}}else ei=ei.next=t;return e._currentValue}var si=!1;function ui(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null},effects:null}}function ci(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function li(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function fi(e,t){if(null!==(e=e.updateQueue)){var n=(e=e.shared).pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}}function hi(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var o=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===i?o=i=a:i=i.next=a,n=n.next}while(null!==n);null===i?o=i=t:i=i.next=t}else o=i=t;return n={baseState:r.baseState,firstBaseUpdate:o,lastBaseUpdate:i,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function di(e,t,n,r){var i=e.updateQueue;si=!1;var a=i.firstBaseUpdate,s=i.lastBaseUpdate,u=i.shared.pending;if(null!==u){i.shared.pending=null;var c=u,l=c.next;c.next=null,null===s?a=l:s.next=l,s=c;var f=e.alternate;if(null!==f){var h=(f=f.updateQueue).lastBaseUpdate;h!==s&&(null===h?f.firstBaseUpdate=l:h.next=l,f.lastBaseUpdate=c)}}if(null!==a){for(h=i.baseState,s=0,f=l=c=null;;){u=a.lane;var d=a.eventTime;if((r&u)===u){null!==f&&(f=f.next={eventTime:d,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=e,v=a;switch(u=t,d=n,v.tag){case 1:if("function"===typeof(p=v.payload)){h=p.call(d,h,u);break e}h=p;break e;case 3:p.flags=-4097&p.flags|64;case 0:if(null===(u="function"===typeof(p=v.payload)?p.call(d,h,u):p)||void 0===u)break e;h=o({},h,u);break e;case 2:si=!0}}null!==a.callback&&(e.flags|=32,null===(u=i.effects)?i.effects=[a]:u.push(a))}else d={eventTime:d,lane:u,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===f?(l=f=d,c=h):f=f.next=d,s|=u;if(null===(a=a.next)){if(null===(u=i.shared.pending))break;a=u.next,u.next=null,i.lastBaseUpdate=u,i.shared.pending=null}}null===f&&(c=h),i.baseState=c,i.firstBaseUpdate=l,i.lastBaseUpdate=f,Zs|=s,e.lanes=s,e.memoizedState=h}}function pi(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],o=r.callback;if(null!==o){if(r.callback=null,r=n,"function"!==typeof o)throw Error(a(191,o));o.call(r)}}}var vi=(new r.Component).refs;function mi(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:o({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var gi={isMounted:function(e){return!!(e=e._reactInternals)&&Xe(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=hu(),o=du(e),i=li(r,o);i.payload=t,void 0!==n&&null!==n&&(i.callback=n),fi(e,i),pu(e,o,r)},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=hu(),o=du(e),i=li(r,o);i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),fi(e,i),pu(e,o,r)},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=hu(),r=du(e),o=li(n,r);o.tag=2,void 0!==t&&null!==t&&(o.callback=t),fi(e,o),pu(e,r,n)}};function yi(e,t,n,r,o,i,a){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,a):!t.prototype||!t.prototype.isPureReactComponent||(!fr(n,r)||!fr(o,i))}function bi(e,t,n){var r=!1,o=fo,i=t.contextType;return"object"===typeof i&&null!==i?i=ai(i):(o=go(t)?vo:ho.current,i=(r=null!==(r=t.contextTypes)&&void 0!==r)?mo(e,o):fo),t=new t(n,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=gi,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=i),t}function wi(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&gi.enqueueReplaceState(t,t.state,null)}function xi(e,t,n,r){var o=e.stateNode;o.props=n,o.state=e.memoizedState,o.refs=vi,ui(e);var i=t.contextType;"object"===typeof i&&null!==i?o.context=ai(i):(i=go(t)?vo:ho.current,o.context=mo(e,i)),di(e,n,o,r),o.state=e.memoizedState,"function"===typeof(i=t.getDerivedStateFromProps)&&(mi(e,t,i,n),o.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof o.getSnapshotBeforeUpdate||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||(t=o.state,"function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount(),t!==o.state&&gi.enqueueReplaceState(o,o.state,null),di(e,n,o,r),o.state=e.memoizedState),"function"===typeof o.componentDidMount&&(e.flags|=4)}var ki=Array.isArray;function _i(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(a(309));var r=n.stateNode}if(!r)throw Error(a(147,e));var o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=r.refs;t===vi&&(t=r.refs={}),null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(a(284));if(!n._owner)throw Error(a(290,e))}return e}function Ei(e,t){if("textarea"!==e.type)throw Error(a(31,"[object Object]"===Object.prototype.toString.call(t)?"object with keys {"+Object.keys(t).join(", ")+"}":t))}function Ci(e){function t(t,n){if(e){var r=t.lastEffect;null!==r?(r.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n,n.nextEffect=null,n.flags=8}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function o(e,t){return(e=qu(e,t)).index=0,e.sibling=null,e}function i(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags=2,n):r:(t.flags=2,n):n}function s(t){return e&&null===t.alternate&&(t.flags=2),t}function u(e,t,n,r){return null===t||6!==t.tag?((t=$u(n,e.mode,r)).return=e,t):((t=o(t,n)).return=e,t)}function c(e,t,n,r){return null!==t&&t.elementType===n.type?((r=o(t,n.props)).ref=_i(e,t,n),r.return=e,r):((r=Gu(n.type,n.key,n.props,null,e.mode,r)).ref=_i(e,t,n),r.return=e,r)}function l(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Yu(n,e.mode,r)).return=e,t):((t=o(t,n.children||[])).return=e,t)}function f(e,t,n,r,i){return null===t||7!==t.tag?((t=Ku(n,e.mode,r,i)).return=e,t):((t=o(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t||"number"===typeof t)return(t=$u(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case k:return(n=Gu(t.type,t.key,t.props,null,e.mode,n)).ref=_i(e,null,t),n.return=e,n;case _:return(t=Yu(t,e.mode,n)).return=e,t}if(ki(t)||W(t))return(t=Ku(t,e.mode,n,null)).return=e,t;Ei(e,t)}return null}function d(e,t,n,r){var o=null!==t?t.key:null;if("string"===typeof n||"number"===typeof n)return null!==o?null:u(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case k:return n.key===o?n.type===E?f(e,t,n.props.children,r,o):c(e,t,n,r):null;case _:return n.key===o?l(e,t,n,r):null}if(ki(n)||W(n))return null!==o?null:f(e,t,n,r,null);Ei(e,n)}return null}function p(e,t,n,r,o){if("string"===typeof r||"number"===typeof r)return u(t,e=e.get(n)||null,""+r,o);if("object"===typeof r&&null!==r){switch(r.$$typeof){case k:return e=e.get(null===r.key?n:r.key)||null,r.type===E?f(t,e,r.props.children,o,r.key):c(t,e,r,o);case _:return l(t,e=e.get(null===r.key?n:r.key)||null,r,o)}if(ki(r)||W(r))return f(t,e=e.get(n)||null,r,o,null);Ei(t,r)}return null}function v(o,a,s,u){for(var c=null,l=null,f=a,v=a=0,m=null;null!==f&&v<s.length;v++){f.index>v?(m=f,f=null):m=f.sibling;var g=d(o,f,s[v],u);if(null===g){null===f&&(f=m);break}e&&f&&null===g.alternate&&t(o,f),a=i(g,a,v),null===l?c=g:l.sibling=g,l=g,f=m}if(v===s.length)return n(o,f),c;if(null===f){for(;v<s.length;v++)null!==(f=h(o,s[v],u))&&(a=i(f,a,v),null===l?c=f:l.sibling=f,l=f);return c}for(f=r(o,f);v<s.length;v++)null!==(m=p(f,o,v,s[v],u))&&(e&&null!==m.alternate&&f.delete(null===m.key?v:m.key),a=i(m,a,v),null===l?c=m:l.sibling=m,l=m);return e&&f.forEach((function(e){return t(o,e)})),c}function m(o,s,u,c){var l=W(u);if("function"!==typeof l)throw Error(a(150));if(null==(u=l.call(u)))throw Error(a(151));for(var f=l=null,v=s,m=s=0,g=null,y=u.next();null!==v&&!y.done;m++,y=u.next()){v.index>m?(g=v,v=null):g=v.sibling;var b=d(o,v,y.value,c);if(null===b){null===v&&(v=g);break}e&&v&&null===b.alternate&&t(o,v),s=i(b,s,m),null===f?l=b:f.sibling=b,f=b,v=g}if(y.done)return n(o,v),l;if(null===v){for(;!y.done;m++,y=u.next())null!==(y=h(o,y.value,c))&&(s=i(y,s,m),null===f?l=y:f.sibling=y,f=y);return l}for(v=r(o,v);!y.done;m++,y=u.next())null!==(y=p(v,o,m,y.value,c))&&(e&&null!==y.alternate&&v.delete(null===y.key?m:y.key),s=i(y,s,m),null===f?l=y:f.sibling=y,f=y);return e&&v.forEach((function(e){return t(o,e)})),l}return function(e,r,i,u){var c="object"===typeof i&&null!==i&&i.type===E&&null===i.key;c&&(i=i.props.children);var l="object"===typeof i&&null!==i;if(l)switch(i.$$typeof){case k:e:{for(l=i.key,c=r;null!==c;){if(c.key===l){if(7===c.tag){if(i.type===E){n(e,c.sibling),(r=o(c,i.props.children)).return=e,e=r;break e}}else if(c.elementType===i.type){n(e,c.sibling),(r=o(c,i.props)).ref=_i(e,c,i),r.return=e,e=r;break e}n(e,c);break}t(e,c),c=c.sibling}i.type===E?((r=Ku(i.props.children,e.mode,u,i.key)).return=e,e=r):((u=Gu(i.type,i.key,i.props,null,e.mode,u)).ref=_i(e,r,i),u.return=e,e=u)}return s(e);case _:e:{for(c=i.key;null!==r;){if(r.key===c){if(4===r.tag&&r.stateNode.containerInfo===i.containerInfo&&r.stateNode.implementation===i.implementation){n(e,r.sibling),(r=o(r,i.children||[])).return=e,e=r;break e}n(e,r);break}t(e,r),r=r.sibling}(r=Yu(i,e.mode,u)).return=e,e=r}return s(e)}if("string"===typeof i||"number"===typeof i)return i=""+i,null!==r&&6===r.tag?(n(e,r.sibling),(r=o(r,i)).return=e,e=r):(n(e,r),(r=$u(i,e.mode,u)).return=e,e=r),s(e);if(ki(i))return v(e,r,i,u);if(W(i))return m(e,r,i,u);if(l&&Ei(e,i),"undefined"===typeof i&&!c)switch(e.tag){case 1:case 22:case 0:case 11:case 15:throw Error(a(152,G(e.type)||"Component"))}return n(e,r)}}var Si=Ci(!0),Ii=Ci(!1),Ri={},Ti=uo(Ri),Ai=uo(Ri),Ni=uo(Ri);function Oi(e){if(e===Ri)throw Error(a(174));return e}function Di(e,t){switch(lo(Ni,t),lo(Ai,e),lo(Ti,Ri),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:de(null,"");break;default:t=de(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}co(Ti),lo(Ti,t)}function Pi(){co(Ti),co(Ai),co(Ni)}function Mi(e){Oi(Ni.current);var t=Oi(Ti.current),n=de(t,e.type);t!==n&&(lo(Ai,e),lo(Ti,n))}function Fi(e){Ai.current===e&&(co(Ti),co(Ai))}var Li=uo(0);function Bi(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(64&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Ui=null,ji=null,Zi=!1;function Wi(e,t){var n=Vu(5,null,null,0);n.elementType="DELETED",n.type="DELETED",n.stateNode=t,n.return=e,n.flags=8,null!==e.lastEffect?(e.lastEffect.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n}function zi(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,!0);default:return!1}}function Vi(e){if(Zi){var t=ji;if(t){var n=t;if(!zi(e,t)){if(!(t=Gr(n.nextSibling))||!zi(e,t))return e.flags=-1025&e.flags|2,Zi=!1,void(Ui=e);Wi(Ui,n)}Ui=e,ji=Gr(t.firstChild)}else e.flags=-1025&e.flags|2,Zi=!1,Ui=e}}function Hi(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;Ui=e}function qi(e){if(e!==Ui)return!1;if(!Zi)return Hi(e),Zi=!0,!1;var t=e.type;if(5!==e.tag||"head"!==t&&"body"!==t&&!zr(t,e.memoizedProps))for(t=ji;t;)Wi(e,t),t=Gr(t.nextSibling);if(Hi(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ji=Gr(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ji=null}}else ji=Ui?Gr(e.stateNode.nextSibling):null;return!0}function Gi(){ji=Ui=null,Zi=!1}var Ki=[];function Xi(){for(var e=0;e<Ki.length;e++)Ki[e]._workInProgressVersionPrimary=null;Ki.length=0}var $i=x.ReactCurrentDispatcher,Yi=x.ReactCurrentBatchConfig,Qi=0,Ji=null,ea=null,ta=null,na=!1,ra=!1;function oa(){throw Error(a(321))}function ia(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!cr(e[n],t[n]))return!1;return!0}function aa(e,t,n,r,o,i){if(Qi=i,Ji=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,$i.current=null===e||null===e.memoizedState?Oa:Da,e=n(r,o),ra){i=0;do{if(ra=!1,!(25>i))throw Error(a(301));i+=1,ta=ea=null,t.updateQueue=null,$i.current=Pa,e=n(r,o)}while(ra)}if($i.current=Na,t=null!==ea&&null!==ea.next,Qi=0,ta=ea=Ji=null,na=!1,t)throw Error(a(300));return e}function sa(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ta?Ji.memoizedState=ta=e:ta=ta.next=e,ta}function ua(){if(null===ea){var e=Ji.alternate;e=null!==e?e.memoizedState:null}else e=ea.next;var t=null===ta?Ji.memoizedState:ta.next;if(null!==t)ta=t,ea=e;else{if(null===e)throw Error(a(310));e={memoizedState:(ea=e).memoizedState,baseState:ea.baseState,baseQueue:ea.baseQueue,queue:ea.queue,next:null},null===ta?Ji.memoizedState=ta=e:ta=ta.next=e}return ta}function ca(e,t){return"function"===typeof t?t(e):t}function la(e){var t=ua(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=ea,o=r.baseQueue,i=n.pending;if(null!==i){if(null!==o){var s=o.next;o.next=i.next,i.next=s}r.baseQueue=o=i,n.pending=null}if(null!==o){o=o.next,r=r.baseState;var u=s=i=null,c=o;do{var l=c.lane;if((Qi&l)===l)null!==u&&(u=u.next={lane:0,action:c.action,eagerReducer:c.eagerReducer,eagerState:c.eagerState,next:null}),r=c.eagerReducer===e?c.eagerState:e(r,c.action);else{var f={lane:l,action:c.action,eagerReducer:c.eagerReducer,eagerState:c.eagerState,next:null};null===u?(s=u=f,i=r):u=u.next=f,Ji.lanes|=l,Zs|=l}c=c.next}while(null!==c&&c!==o);null===u?i=r:u.next=s,cr(r,t.memoizedState)||(Fa=!0),t.memoizedState=r,t.baseState=i,t.baseQueue=u,n.lastRenderedState=r}return[t.memoizedState,n.dispatch]}function fa(e){var t=ua(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=n.dispatch,o=n.pending,i=t.memoizedState;if(null!==o){n.pending=null;var s=o=o.next;do{i=e(i,s.action),s=s.next}while(s!==o);cr(i,t.memoizedState)||(Fa=!0),t.memoizedState=i,null===t.baseQueue&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function ha(e,t,n){var r=t._getVersion;r=r(t._source);var o=t._workInProgressVersionPrimary;if(null!==o?e=o===r:(e=e.mutableReadLanes,(e=(Qi&e)===e)&&(t._workInProgressVersionPrimary=r,Ki.push(t))),e)return n(t._source);throw Ki.push(t),Error(a(350))}function da(e,t,n,r){var o=Ds;if(null===o)throw Error(a(349));var i=t._getVersion,s=i(t._source),u=$i.current,c=u.useState((function(){return ha(o,t,n)})),l=c[1],f=c[0];c=ta;var h=e.memoizedState,d=h.refs,p=d.getSnapshot,v=h.source;h=h.subscribe;var m=Ji;return e.memoizedState={refs:d,source:t,subscribe:r},u.useEffect((function(){d.getSnapshot=n,d.setSnapshot=l;var e=i(t._source);if(!cr(s,e)){e=n(t._source),cr(f,e)||(l(e),e=du(m),o.mutableReadLanes|=e&o.pendingLanes),e=o.mutableReadLanes,o.entangledLanes|=e;for(var r=o.entanglements,a=e;0<a;){var u=31-zt(a),c=1<<u;r[u]|=e,a&=~c}}}),[n,t,r]),u.useEffect((function(){return r(t._source,(function(){var e=d.getSnapshot,n=d.setSnapshot;try{n(e(t._source));var r=du(m);o.mutableReadLanes|=r&o.pendingLanes}catch(i){n((function(){throw i}))}}))}),[t,r]),cr(p,n)&&cr(v,t)&&cr(h,r)||((e={pending:null,dispatch:null,lastRenderedReducer:ca,lastRenderedState:f}).dispatch=l=Aa.bind(null,Ji,e),c.queue=e,c.baseQueue=null,f=ha(o,t,n),c.memoizedState=c.baseState=f),f}function pa(e,t,n){return da(ua(),e,t,n)}function va(e){var t=sa();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e=(e=t.queue={pending:null,dispatch:null,lastRenderedReducer:ca,lastRenderedState:e}).dispatch=Aa.bind(null,Ji,e),[t.memoizedState,e]}function ma(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=Ji.updateQueue)?(t={lastEffect:null},Ji.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function ga(e){return e={current:e},sa().memoizedState=e}function ya(){return ua().memoizedState}function ba(e,t,n,r){var o=sa();Ji.flags|=e,o.memoizedState=ma(1|t,n,void 0,void 0===r?null:r)}function wa(e,t,n,r){var o=ua();r=void 0===r?null:r;var i=void 0;if(null!==ea){var a=ea.memoizedState;if(i=a.destroy,null!==r&&ia(r,a.deps))return void ma(t,n,i,r)}Ji.flags|=e,o.memoizedState=ma(1|t,n,i,r)}function xa(e,t){return ba(516,4,e,t)}function ka(e,t){return wa(516,4,e,t)}function _a(e,t){return wa(4,2,e,t)}function Ea(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ca(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,wa(4,2,Ea.bind(null,t,e),n)}function Sa(){}function Ia(e,t){var n=ua();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ia(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Ra(e,t){var n=ua();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ia(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Ta(e,t){var n=Vo();qo(98>n?98:n,(function(){e(!0)})),qo(97<n?97:n,(function(){var n=Yi.transition;Yi.transition=1;try{e(!1),t()}finally{Yi.transition=n}}))}function Aa(e,t,n){var r=hu(),o=du(e),i={lane:o,action:n,eagerReducer:null,eagerState:null,next:null},a=t.pending;if(null===a?i.next=i:(i.next=a.next,a.next=i),t.pending=i,a=e.alternate,e===Ji||null!==a&&a===Ji)ra=na=!0;else{if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var s=t.lastRenderedState,u=a(s,n);if(i.eagerReducer=a,i.eagerState=u,cr(u,s))return}catch(c){}pu(e,o,r)}}var Na={readContext:ai,useCallback:oa,useContext:oa,useEffect:oa,useImperativeHandle:oa,useLayoutEffect:oa,useMemo:oa,useReducer:oa,useRef:oa,useState:oa,useDebugValue:oa,useDeferredValue:oa,useTransition:oa,useMutableSource:oa,useOpaqueIdentifier:oa,unstable_isNewReconciler:!1},Oa={readContext:ai,useCallback:function(e,t){return sa().memoizedState=[e,void 0===t?null:t],e},useContext:ai,useEffect:xa,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,ba(4,2,Ea.bind(null,t,e),n)},useLayoutEffect:function(e,t){return ba(4,2,e,t)},useMemo:function(e,t){var n=sa();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=sa();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e=(e=r.queue={pending:null,dispatch:null,lastRenderedReducer:e,lastRenderedState:t}).dispatch=Aa.bind(null,Ji,e),[r.memoizedState,e]},useRef:ga,useState:va,useDebugValue:Sa,useDeferredValue:function(e){var t=va(e),n=t[0],r=t[1];return xa((function(){var t=Yi.transition;Yi.transition=1;try{r(e)}finally{Yi.transition=t}}),[e]),n},useTransition:function(){var e=va(!1),t=e[0];return ga(e=Ta.bind(null,e[1])),[e,t]},useMutableSource:function(e,t,n){var r=sa();return r.memoizedState={refs:{getSnapshot:t,setSnapshot:null},source:e,subscribe:n},da(r,e,t,n)},useOpaqueIdentifier:function(){if(Zi){var e=!1,t=function(e){return{$$typeof:M,toString:e,valueOf:e}}((function(){throw e||(e=!0,n("r:"+(Xr++).toString(36))),Error(a(355))})),n=va(t)[1];return 0===(2&Ji.mode)&&(Ji.flags|=516,ma(5,(function(){n("r:"+(Xr++).toString(36))}),void 0,null)),t}return va(t="r:"+(Xr++).toString(36)),t},unstable_isNewReconciler:!1},Da={readContext:ai,useCallback:Ia,useContext:ai,useEffect:ka,useImperativeHandle:Ca,useLayoutEffect:_a,useMemo:Ra,useReducer:la,useRef:ya,useState:function(){return la(ca)},useDebugValue:Sa,useDeferredValue:function(e){var t=la(ca),n=t[0],r=t[1];return ka((function(){var t=Yi.transition;Yi.transition=1;try{r(e)}finally{Yi.transition=t}}),[e]),n},useTransition:function(){var e=la(ca)[0];return[ya().current,e]},useMutableSource:pa,useOpaqueIdentifier:function(){return la(ca)[0]},unstable_isNewReconciler:!1},Pa={readContext:ai,useCallback:Ia,useContext:ai,useEffect:ka,useImperativeHandle:Ca,useLayoutEffect:_a,useMemo:Ra,useReducer:fa,useRef:ya,useState:function(){return fa(ca)},useDebugValue:Sa,useDeferredValue:function(e){var t=fa(ca),n=t[0],r=t[1];return ka((function(){var t=Yi.transition;Yi.transition=1;try{r(e)}finally{Yi.transition=t}}),[e]),n},useTransition:function(){var e=fa(ca)[0];return[ya().current,e]},useMutableSource:pa,useOpaqueIdentifier:function(){return fa(ca)[0]},unstable_isNewReconciler:!1},Ma=x.ReactCurrentOwner,Fa=!1;function La(e,t,n,r){t.child=null===e?Ii(t,null,n,r):Si(t,e.child,n,r)}function Ba(e,t,n,r,o){n=n.render;var i=t.ref;return ii(t,o),r=aa(e,t,n,r,i,o),null===e||Fa?(t.flags|=1,La(e,t,r,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~o,is(e,t,o))}function Ua(e,t,n,r,o,i){if(null===e){var a=n.type;return"function"!==typeof a||Hu(a)||void 0!==a.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Gu(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,ja(e,t,a,r,o,i))}return a=e.child,0===(o&i)&&(o=a.memoizedProps,(n=null!==(n=n.compare)?n:fr)(o,r)&&e.ref===t.ref)?is(e,t,i):(t.flags|=1,(e=qu(a,r)).ref=t.ref,e.return=t,t.child=e)}function ja(e,t,n,r,o,i){if(null!==e&&fr(e.memoizedProps,r)&&e.ref===t.ref){if(Fa=!1,0===(i&o))return t.lanes=e.lanes,is(e,t,i);0!==(16384&e.flags)&&(Fa=!0)}return za(e,t,n,r,i)}function Za(e,t,n){var r=t.pendingProps,o=r.children,i=null!==e?e.memoizedState:null;if("hidden"===r.mode||"unstable-defer-without-hiding"===r.mode)if(0===(4&t.mode))t.memoizedState={baseLanes:0},ku(t,n);else{if(0===(1073741824&n))return e=null!==i?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e},ku(t,e),null;t.memoizedState={baseLanes:0},ku(t,null!==i?i.baseLanes:n)}else null!==i?(r=i.baseLanes|n,t.memoizedState=null):r=n,ku(t,r);return La(e,t,o,n),t.child}function Wa(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=128)}function za(e,t,n,r,o){var i=go(n)?vo:ho.current;return i=mo(t,i),ii(t,o),n=aa(e,t,n,r,i,o),null===e||Fa?(t.flags|=1,La(e,t,n,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~o,is(e,t,o))}function Va(e,t,n,r,o){if(go(n)){var i=!0;xo(t)}else i=!1;if(ii(t,o),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),bi(t,n,r),xi(t,n,r,o),r=!0;else if(null===e){var a=t.stateNode,s=t.memoizedProps;a.props=s;var u=a.context,c=n.contextType;"object"===typeof c&&null!==c?c=ai(c):c=mo(t,c=go(n)?vo:ho.current);var l=n.getDerivedStateFromProps,f="function"===typeof l||"function"===typeof a.getSnapshotBeforeUpdate;f||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==r||u!==c)&&wi(t,a,r,c),si=!1;var h=t.memoizedState;a.state=h,di(t,r,a,o),u=t.memoizedState,s!==r||h!==u||po.current||si?("function"===typeof l&&(mi(t,n,l,r),u=t.memoizedState),(s=si||yi(t,n,s,r,h,u,c))?(f||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(t.flags|=4)):("function"===typeof a.componentDidMount&&(t.flags|=4),t.memoizedProps=r,t.memoizedState=u),a.props=r,a.state=u,a.context=c,r=s):("function"===typeof a.componentDidMount&&(t.flags|=4),r=!1)}else{a=t.stateNode,ci(e,t),s=t.memoizedProps,c=t.type===t.elementType?s:Yo(t.type,s),a.props=c,f=t.pendingProps,h=a.context,"object"===typeof(u=n.contextType)&&null!==u?u=ai(u):u=mo(t,u=go(n)?vo:ho.current);var d=n.getDerivedStateFromProps;(l="function"===typeof d||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==f||h!==u)&&wi(t,a,r,u),si=!1,h=t.memoizedState,a.state=h,di(t,r,a,o);var p=t.memoizedState;s!==f||h!==p||po.current||si?("function"===typeof d&&(mi(t,n,d,r),p=t.memoizedState),(c=si||yi(t,n,c,r,h,p,u))?(l||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(r,p,u),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(r,p,u)),"function"===typeof a.componentDidUpdate&&(t.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(t.flags|=256)):("function"!==typeof a.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=256),t.memoizedProps=r,t.memoizedState=p),a.props=r,a.state=p,a.context=u,r=c):("function"!==typeof a.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=256),r=!1)}return Ha(e,t,n,r,i,o)}function Ha(e,t,n,r,o,i){Wa(e,t);var a=0!==(64&t.flags);if(!r&&!a)return o&&ko(t,n,!1),is(e,t,i);r=t.stateNode,Ma.current=t;var s=a&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&a?(t.child=Si(t,e.child,null,i),t.child=Si(t,null,s,i)):La(e,t,s,i),t.memoizedState=r.state,o&&ko(t,n,!0),t.child}function qa(e){var t=e.stateNode;t.pendingContext?bo(0,t.pendingContext,t.pendingContext!==t.context):t.context&&bo(0,t.context,!1),Di(e,t.containerInfo)}var Ga,Ka,Xa,$a,Ya={dehydrated:null,retryLane:0};function Qa(e,t,n){var r,o=t.pendingProps,i=Li.current,a=!1;return(r=0!==(64&t.flags))||(r=(null===e||null!==e.memoizedState)&&0!==(2&i)),r?(a=!0,t.flags&=-65):null!==e&&null===e.memoizedState||void 0===o.fallback||!0===o.unstable_avoidThisFallback||(i|=1),lo(Li,1&i),null===e?(void 0!==o.fallback&&Vi(t),e=o.children,i=o.fallback,a?(e=Ja(t,e,i,n),t.child.memoizedState={baseLanes:n},t.memoizedState=Ya,e):"number"===typeof o.unstable_expectedLoadTime?(e=Ja(t,e,i,n),t.child.memoizedState={baseLanes:n},t.memoizedState=Ya,t.lanes=33554432,e):((n=Xu({mode:"visible",children:e},t.mode,n,null)).return=t,t.child=n)):(e.memoizedState,a?(o=ts(e,t,o.children,o.fallback,n),a=t.child,i=e.child.memoizedState,a.memoizedState=null===i?{baseLanes:n}:{baseLanes:i.baseLanes|n},a.childLanes=e.childLanes&~n,t.memoizedState=Ya,o):(n=es(e,t,o.children,n),t.memoizedState=null,n))}function Ja(e,t,n,r){var o=e.mode,i=e.child;return t={mode:"hidden",children:t},0===(2&o)&&null!==i?(i.childLanes=0,i.pendingProps=t):i=Xu(t,o,0,null),n=Ku(n,o,r,null),i.return=e,n.return=e,i.sibling=n,e.child=i,n}function es(e,t,n,r){var o=e.child;return e=o.sibling,n=qu(o,{mode:"visible",children:n}),0===(2&t.mode)&&(n.lanes=r),n.return=t,n.sibling=null,null!==e&&(e.nextEffect=null,e.flags=8,t.firstEffect=t.lastEffect=e),t.child=n}function ts(e,t,n,r,o){var i=t.mode,a=e.child;e=a.sibling;var s={mode:"hidden",children:n};return 0===(2&i)&&t.child!==a?((n=t.child).childLanes=0,n.pendingProps=s,null!==(a=n.lastEffect)?(t.firstEffect=n.firstEffect,t.lastEffect=a,a.nextEffect=null):t.firstEffect=t.lastEffect=null):n=qu(a,s),null!==e?r=qu(e,r):(r=Ku(r,i,o,null)).flags|=2,r.return=t,n.return=t,n.sibling=r,t.child=n,r}function ns(e,t){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),oi(e.return,t)}function rs(e,t,n,r,o,i){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:o,lastEffect:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=o,a.lastEffect=i)}function os(e,t,n){var r=t.pendingProps,o=r.revealOrder,i=r.tail;if(La(e,t,r.children,n),0!==(2&(r=Li.current)))r=1&r|2,t.flags|=64;else{if(null!==e&&0!==(64&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&ns(e,n);else if(19===e.tag)ns(e,n);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(lo(Li,r),0===(2&t.mode))t.memoizedState=null;else switch(o){case"forwards":for(n=t.child,o=null;null!==n;)null!==(e=n.alternate)&&null===Bi(e)&&(o=n),n=n.sibling;null===(n=o)?(o=t.child,t.child=null):(o=n.sibling,n.sibling=null),rs(t,!1,o,n,i,t.lastEffect);break;case"backwards":for(n=null,o=t.child,t.child=null;null!==o;){if(null!==(e=o.alternate)&&null===Bi(e)){t.child=o;break}e=o.sibling,o.sibling=n,n=o,o=e}rs(t,!0,n,null,i,t.lastEffect);break;case"together":rs(t,!1,null,null,void 0,t.lastEffect);break;default:t.memoizedState=null}return t.child}function is(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Zs|=t.lanes,0!==(n&t.childLanes)){if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(n=qu(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=qu(e,e.pendingProps)).return=t;n.sibling=null}return t.child}return null}function as(e,t){if(!Zi)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function ss(e,t,n){var r=t.pendingProps;switch(t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:case 17:return go(t.type)&&yo(),null;case 3:return Pi(),co(po),co(ho),Xi(),(r=t.stateNode).pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(qi(t)?t.flags|=4:r.hydrate||(t.flags|=256)),Ka(t),null;case 5:Fi(t);var i=Oi(Ni.current);if(n=t.type,null!==e&&null!=t.stateNode)Xa(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=128);else{if(!r){if(null===t.stateNode)throw Error(a(166));return null}if(e=Oi(Ti.current),qi(t)){r=t.stateNode,n=t.type;var s=t.memoizedProps;switch(r[Yr]=t,r[Qr]=s,n){case"dialog":Tr("cancel",r),Tr("close",r);break;case"iframe":case"object":case"embed":Tr("load",r);break;case"video":case"audio":for(e=0;e<Cr.length;e++)Tr(Cr[e],r);break;case"source":Tr("error",r);break;case"img":case"image":case"link":Tr("error",r),Tr("load",r);break;case"details":Tr("toggle",r);break;case"input":ee(r,s),Tr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Tr("invalid",r);break;case"textarea":ue(r,s),Tr("invalid",r)}for(var c in _e(n,s),e=null,s)s.hasOwnProperty(c)&&(i=s[c],"children"===c?"string"===typeof i?r.textContent!==i&&(e=["children",i]):"number"===typeof i&&r.textContent!==""+i&&(e=["children",""+i]):u.hasOwnProperty(c)&&null!=i&&"onScroll"===c&&Tr("scroll",r));switch(n){case"input":$(r),re(r,s,!0);break;case"textarea":$(r),le(r);break;case"select":case"option":break;default:"function"===typeof s.onClick&&(r.onclick=Ur)}r=e,t.updateQueue=r,null!==r&&(t.flags|=4)}else{switch(c=9===i.nodeType?i:i.ownerDocument,e===fe.html&&(e=he(n)),e===fe.html?"script"===n?((e=c.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=c.createElement(n,{is:r.is}):(e=c.createElement(n),"select"===n&&(c=e,r.multiple?c.multiple=!0:r.size&&(c.size=r.size))):e=c.createElementNS(e,n),e[Yr]=t,e[Qr]=r,Ga(e,t,!1,!1),t.stateNode=e,c=Ee(n,r),n){case"dialog":Tr("cancel",e),Tr("close",e),i=r;break;case"iframe":case"object":case"embed":Tr("load",e),i=r;break;case"video":case"audio":for(i=0;i<Cr.length;i++)Tr(Cr[i],e);i=r;break;case"source":Tr("error",e),i=r;break;case"img":case"image":case"link":Tr("error",e),Tr("load",e),i=r;break;case"details":Tr("toggle",e),i=r;break;case"input":ee(e,r),i=J(e,r),Tr("invalid",e);break;case"option":i=ie(e,r);break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=o({},r,{value:void 0}),Tr("invalid",e);break;case"textarea":ue(e,r),i=se(e,r),Tr("invalid",e);break;default:i=r}_e(n,i);var l=i;for(s in l)if(l.hasOwnProperty(s)){var f=l[s];"style"===s?xe(e,f):"dangerouslySetInnerHTML"===s?null!=(f=f?f.__html:void 0)&&me(e,f):"children"===s?"string"===typeof f?("textarea"!==n||""!==f)&&ge(e,f):"number"===typeof f&&ge(e,""+f):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(u.hasOwnProperty(s)?null!=f&&"onScroll"===s&&Tr("scroll",e):null!=f&&w(e,s,f,c))}switch(n){case"input":$(e),re(e,r,!1);break;case"textarea":$(e),le(e);break;case"option":null!=r.value&&e.setAttribute("value",""+K(r.value));break;case"select":e.multiple=!!r.multiple,null!=(s=r.value)?ae(e,!!r.multiple,s,!1):null!=r.defaultValue&&ae(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=Ur)}Wr(n,r)&&(t.flags|=4)}null!==t.ref&&(t.flags|=128)}return null;case 6:if(e&&null!=t.stateNode)$a(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(a(166));n=Oi(Ni.current),Oi(Ti.current),qi(t)?(r=t.stateNode,n=t.memoizedProps,r[Yr]=t,r.nodeValue!==n&&(t.flags|=4)):((r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[Yr]=t,t.stateNode=r)}return null;case 13:return co(Li),r=t.memoizedState,0!==(64&t.flags)?(t.lanes=n,t):(r=null!==r,n=!1,null===e?void 0!==t.memoizedProps.fallback&&qi(t):n=null!==e.memoizedState,r&&!n&&0!==(2&t.mode)&&(null===e&&!0!==t.memoizedProps.unstable_avoidThisFallback||0!==(1&Li.current)?0===Bs&&(Bs=3):(0!==Bs&&3!==Bs||(Bs=4),null===Ds||0===(134217727&Zs)&&0===(134217727&Ws)||yu(Ds,Ms))),(r||n)&&(t.flags|=4),null);case 4:return Pi(),Ka(t),null===e&&Nr(t.stateNode.containerInfo),null;case 10:return ri(t),null;case 19:if(co(Li),null===(r=t.memoizedState))return null;if(s=0!==(64&t.flags),null===(c=r.rendering))if(s)as(r,!1);else{if(0!==Bs||null!==e&&0!==(64&e.flags))for(e=t.child;null!==e;){if(null!==(c=Bi(e))){for(t.flags|=64,as(r,!1),null!==(s=c.updateQueue)&&(t.updateQueue=s,t.flags|=4),null===r.lastEffect&&(t.firstEffect=null),t.lastEffect=r.lastEffect,r=n,n=t.child;null!==n;)e=r,(s=n).flags&=2,s.nextEffect=null,s.firstEffect=null,s.lastEffect=null,null===(c=s.alternate)?(s.childLanes=0,s.lanes=e,s.child=null,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=c.childLanes,s.lanes=c.lanes,s.child=c.child,s.memoizedProps=c.memoizedProps,s.memoizedState=c.memoizedState,s.updateQueue=c.updateQueue,s.type=c.type,e=c.dependencies,s.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return lo(Li,1&Li.current|2),t.child}e=e.sibling}null!==r.tail&&zo()>qs&&(t.flags|=64,s=!0,as(r,!1),t.lanes=33554432)}else{if(!s)if(null!==(e=Bi(c))){if(t.flags|=64,s=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),as(r,!0),null===r.tail&&"hidden"===r.tailMode&&!c.alternate&&!Zi)return null!==(t=t.lastEffect=r.lastEffect)&&(t.nextEffect=null),null}else 2*zo()-r.renderingStartTime>qs&&1073741824!==n&&(t.flags|=64,s=!0,as(r,!1),t.lanes=33554432);r.isBackwards?(c.sibling=t.child,t.child=c):(null!==(n=r.last)?n.sibling=c:t.child=c,r.last=c)}return null!==r.tail?(n=r.tail,r.rendering=n,r.tail=n.sibling,r.lastEffect=t.lastEffect,r.renderingStartTime=zo(),n.sibling=null,t=Li.current,lo(Li,s?1&t|2:1&t),n):null;case 23:case 24:return _u(),null!==e&&null!==e.memoizedState!==(null!==t.memoizedState)&&"unstable-defer-without-hiding"!==r.mode&&(t.flags|=4),null}throw Error(a(156,t.tag))}function us(e){switch(e.tag){case 1:go(e.type)&&yo();var t=e.flags;return 4096&t?(e.flags=-4097&t|64,e):null;case 3:if(Pi(),co(po),co(ho),Xi(),0!==(64&(t=e.flags)))throw Error(a(285));return e.flags=-4097&t|64,e;case 5:return Fi(e),null;case 13:return co(Li),4096&(t=e.flags)?(e.flags=-4097&t|64,e):null;case 19:return co(Li),null;case 4:return Pi(),null;case 10:return ri(e),null;case 23:case 24:return _u(),null;default:return null}}function cs(e,t){try{var n="",r=t;do{n+=q(r),r=r.return}while(r);var o=n}catch(i){o="\nError generating stack: "+i.message+"\n"+i.stack}return{value:e,source:t,stack:o}}function ls(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}Ga=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ka=function(){},Xa=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Oi(Ti.current);var a,s=null;switch(n){case"input":i=J(e,i),r=J(e,r),s=[];break;case"option":i=ie(e,i),r=ie(e,r),s=[];break;case"select":i=o({},i,{value:void 0}),r=o({},r,{value:void 0}),s=[];break;case"textarea":i=se(e,i),r=se(e,r),s=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(e.onclick=Ur)}for(f in _e(n,r),n=null,i)if(!r.hasOwnProperty(f)&&i.hasOwnProperty(f)&&null!=i[f])if("style"===f){var c=i[f];for(a in c)c.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else"dangerouslySetInnerHTML"!==f&&"children"!==f&&"suppressContentEditableWarning"!==f&&"suppressHydrationWarning"!==f&&"autoFocus"!==f&&(u.hasOwnProperty(f)?s||(s=[]):(s=s||[]).push(f,null));for(f in r){var l=r[f];if(c=null!=i?i[f]:void 0,r.hasOwnProperty(f)&&l!==c&&(null!=l||null!=c))if("style"===f)if(c){for(a in c)!c.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in l)l.hasOwnProperty(a)&&c[a]!==l[a]&&(n||(n={}),n[a]=l[a])}else n||(s||(s=[]),s.push(f,n)),n=l;else"dangerouslySetInnerHTML"===f?(l=l?l.__html:void 0,c=c?c.__html:void 0,null!=l&&c!==l&&(s=s||[]).push(f,l)):"children"===f?"string"!==typeof l&&"number"!==typeof l||(s=s||[]).push(f,""+l):"suppressContentEditableWarning"!==f&&"suppressHydrationWarning"!==f&&(u.hasOwnProperty(f)?(null!=l&&"onScroll"===f&&Tr("scroll",e),s||c===l||(s=[])):"object"===typeof l&&null!==l&&l.$$typeof===M?l.toString():(s=s||[]).push(f,l))}n&&(s=s||[]).push("style",n);var f=s;(t.updateQueue=f)&&(t.flags|=4)}},$a=function(e,t,n,r){n!==r&&(t.flags|=4)};var fs="function"===typeof WeakMap?WeakMap:Map;function hs(e,t,n){(n=li(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){$s||($s=!0,Ys=r),ls(0,t)},n}function ds(e,t,n){(n=li(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var o=t.value;n.payload=function(){return ls(0,t),r(o)}}var i=e.stateNode;return null!==i&&"function"===typeof i.componentDidCatch&&(n.callback=function(){"function"!==typeof r&&(null===Qs?Qs=new Set([this]):Qs.add(this),ls(0,t));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}var ps="function"===typeof WeakSet?WeakSet:Set;function vs(e){var t=e.ref;if(null!==t)if("function"===typeof t)try{t(null)}catch(n){ju(e,n)}else t.current=null}function ms(e,t){switch(t.tag){case 0:case 11:case 15:case 22:case 5:case 6:case 4:case 17:return;case 1:if(256&t.flags&&null!==e){var n=e.memoizedProps,r=e.memoizedState;t=(e=t.stateNode).getSnapshotBeforeUpdate(t.elementType===t.type?n:Yo(t.type,n),r),e.__reactInternalSnapshotBeforeUpdate=t}return;case 3:return void(256&t.flags&&qr(t.stateNode.containerInfo))}throw Error(a(163))}function gs(e,t,n){switch(n.tag){case 0:case 11:case 15:case 22:if(null!==(t=null!==(t=n.updateQueue)?t.lastEffect:null)){e=t=t.next;do{if(3===(3&e.tag)){var r=e.create;e.destroy=r()}e=e.next}while(e!==t)}if(null!==(t=null!==(t=n.updateQueue)?t.lastEffect:null)){e=t=t.next;do{var o=e;r=o.next,0!==(4&(o=o.tag))&&0!==(1&o)&&(Lu(n,e),Fu(n,e)),e=r}while(e!==t)}return;case 1:return e=n.stateNode,4&n.flags&&(null===t?e.componentDidMount():(r=n.elementType===n.type?t.memoizedProps:Yo(n.type,t.memoizedProps),e.componentDidUpdate(r,t.memoizedState,e.__reactInternalSnapshotBeforeUpdate))),void(null!==(t=n.updateQueue)&&pi(n,t,e));case 3:if(null!==(t=n.updateQueue)){if(e=null,null!==n.child)switch(n.child.tag){case 5:case 1:e=n.child.stateNode}pi(n,t,e)}return;case 5:return e=n.stateNode,void(null===t&&4&n.flags&&Wr(n.type,n.memoizedProps)&&e.focus());case 6:case 4:case 12:case 19:case 17:case 20:case 21:case 23:case 24:return;case 13:return void(null===n.memoizedState&&(n=n.alternate,null!==n&&(n=n.memoizedState,null!==n&&(n=n.dehydrated,null!==n&&xt(n)))))}throw Error(a(163))}function ys(e,t){for(var n=e;;){if(5===n.tag){var r=n.stateNode;if(t)"function"===typeof(r=r.style).setProperty?r.setProperty("display","none","important"):r.display="none";else{r=n.stateNode;var o=n.memoizedProps.style;o=void 0!==o&&null!==o&&o.hasOwnProperty("display")?o.display:null,r.style.display=we("display",o)}}else if(6===n.tag)n.stateNode.nodeValue=t?"":n.memoizedProps;else if((23!==n.tag&&24!==n.tag||null===n.memoizedState||n===e)&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}}function bs(e,t){if(Eo&&"function"===typeof Eo.onCommitFiberUnmount)try{Eo.onCommitFiberUnmount(_o,t)}catch(i){}switch(t.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(e=t.updateQueue)&&null!==(e=e.lastEffect)){var n=e=e.next;do{var r=n,o=r.destroy;if(r=r.tag,void 0!==o)if(0!==(4&r))Lu(t,n);else{r=t;try{o()}catch(i){ju(r,i)}}n=n.next}while(n!==e)}break;case 1:if(vs(t),"function"===typeof(e=t.stateNode).componentWillUnmount)try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(i){ju(t,i)}break;case 5:vs(t);break;case 4:Cs(e,t)}}function ws(e){e.alternate=null,e.child=null,e.dependencies=null,e.firstEffect=null,e.lastEffect=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.return=null,e.updateQueue=null}function xs(e){return 5===e.tag||3===e.tag||4===e.tag}function ks(e){e:{for(var t=e.return;null!==t;){if(xs(t))break e;t=t.return}throw Error(a(160))}var n=t;switch(t=n.stateNode,n.tag){case 5:var r=!1;break;case 3:case 4:t=t.containerInfo,r=!0;break;default:throw Error(a(161))}16&n.flags&&(ge(t,""),n.flags&=-17);e:t:for(n=e;;){for(;null===n.sibling;){if(null===n.return||xs(n.return)){n=null;break e}n=n.return}for(n.sibling.return=n.return,n=n.sibling;5!==n.tag&&6!==n.tag&&18!==n.tag;){if(2&n.flags)continue t;if(null===n.child||4===n.tag)continue t;n.child.return=n,n=n.child}if(!(2&n.flags)){n=n.stateNode;break e}}r?_s(e,n,t):Es(e,n,t)}function _s(e,t,n){var r=e.tag,o=5===r||6===r;if(o)e=o?e.stateNode:e.stateNode.instance,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Ur));else if(4!==r&&null!==(e=e.child))for(_s(e,t,n),e=e.sibling;null!==e;)_s(e,t,n),e=e.sibling}function Es(e,t,n){var r=e.tag,o=5===r||6===r;if(o)e=o?e.stateNode:e.stateNode.instance,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(Es(e,t,n),e=e.sibling;null!==e;)Es(e,t,n),e=e.sibling}function Cs(e,t){for(var n,r,o=t,i=!1;;){if(!i){i=o.return;e:for(;;){if(null===i)throw Error(a(160));switch(n=i.stateNode,i.tag){case 5:r=!1;break e;case 3:case 4:n=n.containerInfo,r=!0;break e}i=i.return}i=!0}if(5===o.tag||6===o.tag){e:for(var s=e,u=o,c=u;;)if(bs(s,c),null!==c.child&&4!==c.tag)c.child.return=c,c=c.child;else{if(c===u)break e;for(;null===c.sibling;){if(null===c.return||c.return===u)break e;c=c.return}c.sibling.return=c.return,c=c.sibling}r?(s=n,u=o.stateNode,8===s.nodeType?s.parentNode.removeChild(u):s.removeChild(u)):n.removeChild(o.stateNode)}else if(4===o.tag){if(null!==o.child){n=o.stateNode.containerInfo,r=!0,o.child.return=o,o=o.child;continue}}else if(bs(e,o),null!==o.child){o.child.return=o,o=o.child;continue}if(o===t)break;for(;null===o.sibling;){if(null===o.return||o.return===t)return;4===(o=o.return).tag&&(i=!1)}o.sibling.return=o.return,o=o.sibling}}function Ss(e,t){switch(t.tag){case 0:case 11:case 14:case 15:case 22:var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var r=n=n.next;do{3===(3&r.tag)&&(e=r.destroy,r.destroy=void 0,void 0!==e&&e()),r=r.next}while(r!==n)}return;case 1:case 12:case 17:return;case 5:if(null!=(n=t.stateNode)){r=t.memoizedProps;var o=null!==e?e.memoizedProps:r;e=t.type;var i=t.updateQueue;if(t.updateQueue=null,null!==i){for(n[Qr]=r,"input"===e&&"radio"===r.type&&null!=r.name&&te(n,r),Ee(e,o),t=Ee(e,r),o=0;o<i.length;o+=2){var s=i[o],u=i[o+1];"style"===s?xe(n,u):"dangerouslySetInnerHTML"===s?me(n,u):"children"===s?ge(n,u):w(n,s,u,t)}switch(e){case"input":ne(n,r);break;case"textarea":ce(n,r);break;case"select":e=n._wrapperState.wasMultiple,n._wrapperState.wasMultiple=!!r.multiple,null!=(i=r.value)?ae(n,!!r.multiple,i,!1):e!==!!r.multiple&&(null!=r.defaultValue?ae(n,!!r.multiple,r.defaultValue,!0):ae(n,!!r.multiple,r.multiple?[]:"",!1))}}}return;case 6:if(null===t.stateNode)throw Error(a(162));return void(t.stateNode.nodeValue=t.memoizedProps);case 3:return void((n=t.stateNode).hydrate&&(n.hydrate=!1,xt(n.containerInfo)));case 13:return null!==t.memoizedState&&(Hs=zo(),ys(t.child,!0)),void Is(t);case 19:return void Is(t);case 23:case 24:return void ys(t,null!==t.memoizedState)}throw Error(a(163))}function Is(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new ps),t.forEach((function(t){var r=Wu.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function Rs(e,t){return null!==e&&(null===(e=e.memoizedState)||null!==e.dehydrated)&&(null!==(t=t.memoizedState)&&null===t.dehydrated)}var Ts=Math.ceil,As=x.ReactCurrentDispatcher,Ns=x.ReactCurrentOwner,Os=0,Ds=null,Ps=null,Ms=0,Fs=0,Ls=uo(0),Bs=0,Us=null,js=0,Zs=0,Ws=0,zs=0,Vs=null,Hs=0,qs=1/0;function Gs(){qs=zo()+500}var Ks,Xs=null,$s=!1,Ys=null,Qs=null,Js=!1,eu=null,tu=90,nu=[],ru=[],ou=null,iu=0,au=null,su=-1,uu=0,cu=0,lu=null,fu=!1;function hu(){return 0!==(48&Os)?zo():-1!==su?su:su=zo()}function du(e){if(0===(2&(e=e.mode)))return 1;if(0===(4&e))return 99===Vo()?1:2;if(0===uu&&(uu=js),0!==$o.transition){0!==cu&&(cu=null!==Vs?Vs.pendingLanes:0),e=uu;var t=4186112&~cu;return 0===(t&=-t)&&(0===(t=(e=4186112&~e)&-e)&&(t=8192)),t}return e=Vo(),0!==(4&Os)&&98===e?e=Ut(12,uu):e=Ut(e=function(e){switch(e){case 99:return 15;case 98:return 10;case 97:case 96:return 8;case 95:return 2;default:return 0}}(e),uu),e}function pu(e,t,n){if(50<iu)throw iu=0,au=null,Error(a(185));if(null===(e=vu(e,t)))return null;Wt(e,t,n),e===Ds&&(Ws|=t,4===Bs&&yu(e,Ms));var r=Vo();1===t?0!==(8&Os)&&0===(48&Os)?bu(e):(mu(e,n),0===Os&&(Gs(),Ko())):(0===(4&Os)||98!==r&&99!==r||(null===ou?ou=new Set([e]):ou.add(e)),mu(e,n)),Vs=e}function vu(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}function mu(e,t){for(var n=e.callbackNode,r=e.suspendedLanes,o=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var u=31-zt(s),c=1<<u,l=i[u];if(-1===l){if(0===(c&r)||0!==(c&o)){l=t,Ft(c);var f=Mt;i[u]=10<=f?l+250:6<=f?l+5e3:-1}}else l<=t&&(e.expiredLanes|=c);s&=~c}if(r=Lt(e,e===Ds?Ms:0),t=Mt,0===r)null!==n&&(n!==Lo&&Io(n),e.callbackNode=null,e.callbackPriority=0);else{if(null!==n){if(e.callbackPriority===t)return;n!==Lo&&Io(n)}15===t?(n=bu.bind(null,e),null===Uo?(Uo=[n],jo=So(Oo,Xo)):Uo.push(n),n=Lo):14===t?n=Go(99,bu.bind(null,e)):(n=function(e){switch(e){case 15:case 14:return 99;case 13:case 12:case 11:case 10:return 98;case 9:case 8:case 7:case 6:case 4:case 5:return 97;case 3:case 2:case 1:return 95;case 0:return 90;default:throw Error(a(358,e))}}(t),n=Go(n,gu.bind(null,e))),e.callbackPriority=t,e.callbackNode=n}}function gu(e){if(su=-1,cu=uu=0,0!==(48&Os))throw Error(a(327));var t=e.callbackNode;if(Mu()&&e.callbackNode!==t)return null;var n=Lt(e,e===Ds?Ms:0);if(0===n)return null;var r=n,o=Os;Os|=16;var i=Su();for(Ds===e&&Ms===r||(Gs(),Eu(e,r));;)try{Tu();break}catch(u){Cu(e,u)}if(ni(),As.current=i,Os=o,null!==Ps?r=0:(Ds=null,Ms=0,r=Bs),0!==(js&Ws))Eu(e,0);else if(0!==r){if(2===r&&(Os|=64,e.hydrate&&(e.hydrate=!1,qr(e.containerInfo)),0!==(n=Bt(e))&&(r=Iu(e,n))),1===r)throw t=Us,Eu(e,0),yu(e,n),mu(e,zo()),t;switch(e.finishedWork=e.current.alternate,e.finishedLanes=n,r){case 0:case 1:throw Error(a(345));case 2:case 5:Ou(e);break;case 3:if(yu(e,n),(62914560&n)===n&&10<(r=Hs+500-zo())){if(0!==Lt(e,0))break;if(((o=e.suspendedLanes)&n)!==n){hu(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=Vr(Ou.bind(null,e),r);break}Ou(e);break;case 4:if(yu(e,n),(4186112&n)===n)break;for(r=e.eventTimes,o=-1;0<n;){var s=31-zt(n);i=1<<s,(s=r[s])>o&&(o=s),n&=~i}if(n=o,10<(n=(120>(n=zo()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Ts(n/1960))-n)){e.timeoutHandle=Vr(Ou.bind(null,e),n);break}Ou(e);break;default:throw Error(a(329))}}return mu(e,zo()),e.callbackNode===t?gu.bind(null,e):null}function yu(e,t){for(t&=~zs,t&=~Ws,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-zt(t),r=1<<n;e[n]=-1,t&=~r}}function bu(e){if(0!==(48&Os))throw Error(a(327));if(Mu(),e===Ds&&0!==(e.expiredLanes&Ms)){var t=Ms,n=Iu(e,t);0!==(js&Ws)&&(n=Iu(e,t=Lt(e,t)))}else n=Iu(e,t=Lt(e,0));if(0!==e.tag&&2===n&&(Os|=64,e.hydrate&&(e.hydrate=!1,qr(e.containerInfo)),0!==(t=Bt(e))&&(n=Iu(e,t))),1===n)throw n=Us,Eu(e,0),yu(e,t),mu(e,zo()),n;return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ou(e),mu(e,zo()),null}function wu(e,t){var n=Os;Os|=1;try{return e(t)}finally{0===(Os=n)&&(Gs(),Ko())}}function xu(e,t){var n=Os;Os&=-2,Os|=8;try{return e(t)}finally{0===(Os=n)&&(Gs(),Ko())}}function ku(e,t){lo(Ls,Fs),Fs|=t,js|=t}function _u(){Fs=Ls.current,co(Ls)}function Eu(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,Hr(n)),null!==Ps)for(n=Ps.return;null!==n;){var r=n;switch(r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&yo();break;case 3:Pi(),co(po),co(ho),Xi();break;case 5:Fi(r);break;case 4:Pi();break;case 13:case 19:co(Li);break;case 10:ri(r);break;case 23:case 24:_u()}n=n.return}Ds=e,Ps=qu(e.current,null),Ms=Fs=js=t,Bs=0,Us=null,zs=Ws=Zs=0}function Cu(e,t){for(;;){var n=Ps;try{if(ni(),$i.current=Na,na){for(var r=Ji.memoizedState;null!==r;){var o=r.queue;null!==o&&(o.pending=null),r=r.next}na=!1}if(Qi=0,ta=ea=Ji=null,ra=!1,Ns.current=null,null===n||null===n.return){Bs=1,Us=t,Ps=null;break}e:{var i=e,a=n.return,s=n,u=t;if(t=Ms,s.flags|=2048,s.firstEffect=s.lastEffect=null,null!==u&&"object"===typeof u&&"function"===typeof u.then){var c=u;if(0===(2&s.mode)){var l=s.alternate;l?(s.updateQueue=l.updateQueue,s.memoizedState=l.memoizedState,s.lanes=l.lanes):(s.updateQueue=null,s.memoizedState=null)}var f=0!==(1&Li.current),h=a;do{var d;if(d=13===h.tag){var p=h.memoizedState;if(null!==p)d=null!==p.dehydrated;else{var v=h.memoizedProps;d=void 0!==v.fallback&&(!0!==v.unstable_avoidThisFallback||!f)}}if(d){var m=h.updateQueue;if(null===m){var g=new Set;g.add(c),h.updateQueue=g}else m.add(c);if(0===(2&h.mode)){if(h.flags|=64,s.flags|=16384,s.flags&=-2981,1===s.tag)if(null===s.alternate)s.tag=17;else{var y=li(-1,1);y.tag=2,fi(s,y)}s.lanes|=1;break e}u=void 0,s=t;var b=i.pingCache;if(null===b?(b=i.pingCache=new fs,u=new Set,b.set(c,u)):void 0===(u=b.get(c))&&(u=new Set,b.set(c,u)),!u.has(s)){u.add(s);var w=Zu.bind(null,i,c,s);c.then(w,w)}h.flags|=4096,h.lanes=t;break e}h=h.return}while(null!==h);u=Error((G(s.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.")}5!==Bs&&(Bs=2),u=cs(u,s),h=a;do{switch(h.tag){case 3:i=u,h.flags|=4096,t&=-t,h.lanes|=t,hi(h,hs(0,i,t));break e;case 1:i=u;var x=h.type,k=h.stateNode;if(0===(64&h.flags)&&("function"===typeof x.getDerivedStateFromError||null!==k&&"function"===typeof k.componentDidCatch&&(null===Qs||!Qs.has(k)))){h.flags|=4096,t&=-t,h.lanes|=t,hi(h,ds(h,i,t));break e}}h=h.return}while(null!==h)}Nu(n)}catch(_){t=_,Ps===n&&null!==n&&(Ps=n=n.return);continue}break}}function Su(){var e=As.current;return As.current=Na,null===e?Na:e}function Iu(e,t){var n=Os;Os|=16;var r=Su();for(Ds===e&&Ms===t||Eu(e,t);;)try{Ru();break}catch(o){Cu(e,o)}if(ni(),Os=n,As.current=r,null!==Ps)throw Error(a(261));return Ds=null,Ms=0,Bs}function Ru(){for(;null!==Ps;)Au(Ps)}function Tu(){for(;null!==Ps&&!Ro();)Au(Ps)}function Au(e){var t=Ks(e.alternate,e,Fs);e.memoizedProps=e.pendingProps,null===t?Nu(e):Ps=t,Ns.current=null}function Nu(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(2048&t.flags)){if(null!==(n=ss(n,t,Fs)))return void(Ps=n);if(24!==(n=t).tag&&23!==n.tag||null===n.memoizedState||0!==(1073741824&Fs)||0===(4&n.mode)){for(var r=0,o=n.child;null!==o;)r|=o.lanes|o.childLanes,o=o.sibling;n.childLanes=r}null!==e&&0===(2048&e.flags)&&(null===e.firstEffect&&(e.firstEffect=t.firstEffect),null!==t.lastEffect&&(null!==e.lastEffect&&(e.lastEffect.nextEffect=t.firstEffect),e.lastEffect=t.lastEffect),1<t.flags&&(null!==e.lastEffect?e.lastEffect.nextEffect=t:e.firstEffect=t,e.lastEffect=t))}else{if(null!==(n=us(t)))return n.flags&=2047,void(Ps=n);null!==e&&(e.firstEffect=e.lastEffect=null,e.flags|=2048)}if(null!==(t=t.sibling))return void(Ps=t);Ps=t=e}while(null!==t);0===Bs&&(Bs=5)}function Ou(e){var t=Vo();return qo(99,Du.bind(null,e,t)),null}function Du(e,t){do{Mu()}while(null!==eu);if(0!==(48&Os))throw Error(a(327));var n=e.finishedWork;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(a(177));e.callbackNode=null;var r=n.lanes|n.childLanes,o=r,i=e.pendingLanes&~o;e.pendingLanes=o,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=o,e.mutableReadLanes&=o,e.entangledLanes&=o,o=e.entanglements;for(var s=e.eventTimes,u=e.expirationTimes;0<i;){var c=31-zt(i),l=1<<c;o[c]=0,s[c]=-1,u[c]=-1,i&=~l}if(null!==ou&&0===(24&r)&&ou.has(e)&&ou.delete(e),e===Ds&&(Ps=Ds=null,Ms=0),1<n.flags?null!==n.lastEffect?(n.lastEffect.nextEffect=n,r=n.firstEffect):r=n:r=n.firstEffect,null!==r){if(o=Os,Os|=32,Ns.current=null,jr=Kt,mr(s=vr())){if("selectionStart"in s)u={start:s.selectionStart,end:s.selectionEnd};else e:if(u=(u=s.ownerDocument)&&u.defaultView||window,(l=u.getSelection&&u.getSelection())&&0!==l.rangeCount){u=l.anchorNode,i=l.anchorOffset,c=l.focusNode,l=l.focusOffset;try{u.nodeType,c.nodeType}catch(S){u=null;break e}var f=0,h=-1,d=-1,p=0,v=0,m=s,g=null;t:for(;;){for(var y;m!==u||0!==i&&3!==m.nodeType||(h=f+i),m!==c||0!==l&&3!==m.nodeType||(d=f+l),3===m.nodeType&&(f+=m.nodeValue.length),null!==(y=m.firstChild);)g=m,m=y;for(;;){if(m===s)break t;if(g===u&&++p===i&&(h=f),g===c&&++v===l&&(d=f),null!==(y=m.nextSibling))break;g=(m=g).parentNode}m=y}u=-1===h||-1===d?null:{start:h,end:d}}else u=null;u=u||{start:0,end:0}}else u=null;Zr={focusedElem:s,selectionRange:u},Kt=!1,lu=null,fu=!1,Xs=r;do{try{Pu()}catch(S){if(null===Xs)throw Error(a(330));ju(Xs,S),Xs=Xs.nextEffect}}while(null!==Xs);lu=null,Xs=r;do{try{for(s=e;null!==Xs;){var b=Xs.flags;if(16&b&&ge(Xs.stateNode,""),128&b){var w=Xs.alternate;if(null!==w){var x=w.ref;null!==x&&("function"===typeof x?x(null):x.current=null)}}switch(1038&b){case 2:ks(Xs),Xs.flags&=-3;break;case 6:ks(Xs),Xs.flags&=-3,Ss(Xs.alternate,Xs);break;case 1024:Xs.flags&=-1025;break;case 1028:Xs.flags&=-1025,Ss(Xs.alternate,Xs);break;case 4:Ss(Xs.alternate,Xs);break;case 8:Cs(s,u=Xs);var k=u.alternate;ws(u),null!==k&&ws(k)}Xs=Xs.nextEffect}}catch(S){if(null===Xs)throw Error(a(330));ju(Xs,S),Xs=Xs.nextEffect}}while(null!==Xs);if(x=Zr,w=vr(),b=x.focusedElem,s=x.selectionRange,w!==b&&b&&b.ownerDocument&&pr(b.ownerDocument.documentElement,b)){null!==s&&mr(b)&&(w=s.start,void 0===(x=s.end)&&(x=w),"selectionStart"in b?(b.selectionStart=w,b.selectionEnd=Math.min(x,b.value.length)):(x=(w=b.ownerDocument||document)&&w.defaultView||window).getSelection&&(x=x.getSelection(),u=b.textContent.length,k=Math.min(s.start,u),s=void 0===s.end?k:Math.min(s.end,u),!x.extend&&k>s&&(u=s,s=k,k=u),u=dr(b,k),i=dr(b,s),u&&i&&(1!==x.rangeCount||x.anchorNode!==u.node||x.anchorOffset!==u.offset||x.focusNode!==i.node||x.focusOffset!==i.offset)&&((w=w.createRange()).setStart(u.node,u.offset),x.removeAllRanges(),k>s?(x.addRange(w),x.extend(i.node,i.offset)):(w.setEnd(i.node,i.offset),x.addRange(w))))),w=[];for(x=b;x=x.parentNode;)1===x.nodeType&&w.push({element:x,left:x.scrollLeft,top:x.scrollTop});for("function"===typeof b.focus&&b.focus(),b=0;b<w.length;b++)(x=w[b]).element.scrollLeft=x.left,x.element.scrollTop=x.top}Kt=!!jr,Zr=jr=null,e.current=n,Xs=r;do{try{for(b=e;null!==Xs;){var _=Xs.flags;if(36&_&&gs(b,Xs.alternate,Xs),128&_){w=void 0;var E=Xs.ref;if(null!==E){var C=Xs.stateNode;Xs.tag,w=C,"function"===typeof E?E(w):E.current=w}}Xs=Xs.nextEffect}}catch(S){if(null===Xs)throw Error(a(330));ju(Xs,S),Xs=Xs.nextEffect}}while(null!==Xs);Xs=null,Bo(),Os=o}else e.current=n;if(Js)Js=!1,eu=e,tu=t;else for(Xs=r;null!==Xs;)t=Xs.nextEffect,Xs.nextEffect=null,8&Xs.flags&&((_=Xs).sibling=null,_.stateNode=null),Xs=t;if(0===(r=e.pendingLanes)&&(Qs=null),1===r?e===au?iu++:(iu=0,au=e):iu=0,n=n.stateNode,Eo&&"function"===typeof Eo.onCommitFiberRoot)try{Eo.onCommitFiberRoot(_o,n,void 0,64===(64&n.current.flags))}catch(S){}if(mu(e,zo()),$s)throw $s=!1,e=Ys,Ys=null,e;return 0!==(8&Os)||Ko(),null}function Pu(){for(;null!==Xs;){var e=Xs.alternate;fu||null===lu||(0!==(8&Xs.flags)?Je(Xs,lu)&&(fu=!0):13===Xs.tag&&Rs(e,Xs)&&Je(Xs,lu)&&(fu=!0));var t=Xs.flags;0!==(256&t)&&ms(e,Xs),0===(512&t)||Js||(Js=!0,Go(97,(function(){return Mu(),null}))),Xs=Xs.nextEffect}}function Mu(){if(90!==tu){var e=97<tu?97:tu;return tu=90,qo(e,Bu)}return!1}function Fu(e,t){nu.push(t,e),Js||(Js=!0,Go(97,(function(){return Mu(),null})))}function Lu(e,t){ru.push(t,e),Js||(Js=!0,Go(97,(function(){return Mu(),null})))}function Bu(){if(null===eu)return!1;var e=eu;if(eu=null,0!==(48&Os))throw Error(a(331));var t=Os;Os|=32;var n=ru;ru=[];for(var r=0;r<n.length;r+=2){var o=n[r],i=n[r+1],s=o.destroy;if(o.destroy=void 0,"function"===typeof s)try{s()}catch(c){if(null===i)throw Error(a(330));ju(i,c)}}for(n=nu,nu=[],r=0;r<n.length;r+=2){o=n[r],i=n[r+1];try{var u=o.create;o.destroy=u()}catch(c){if(null===i)throw Error(a(330));ju(i,c)}}for(u=e.current.firstEffect;null!==u;)e=u.nextEffect,u.nextEffect=null,8&u.flags&&(u.sibling=null,u.stateNode=null),u=e;return Os=t,Ko(),!0}function Uu(e,t,n){fi(e,t=hs(0,t=cs(n,t),1)),t=hu(),null!==(e=vu(e,1))&&(Wt(e,1,t),mu(e,t))}function ju(e,t){if(3===e.tag)Uu(e,e,t);else for(var n=e.return;null!==n;){if(3===n.tag){Uu(n,e,t);break}if(1===n.tag){var r=n.stateNode;if("function"===typeof n.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Qs||!Qs.has(r))){var o=ds(n,e=cs(t,e),1);if(fi(n,o),o=hu(),null!==(n=vu(n,1)))Wt(n,1,o),mu(n,o);else if("function"===typeof r.componentDidCatch&&(null===Qs||!Qs.has(r)))try{r.componentDidCatch(t,e)}catch(i){}break}}n=n.return}}function Zu(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=hu(),e.pingedLanes|=e.suspendedLanes&n,Ds===e&&(Ms&n)===n&&(4===Bs||3===Bs&&(62914560&Ms)===Ms&&500>zo()-Hs?Eu(e,0):zs|=n),mu(e,t)}function Wu(e,t){var n=e.stateNode;null!==n&&n.delete(t),0===(t=0)&&(0===(2&(t=e.mode))?t=1:0===(4&t)?t=99===Vo()?1:2:(0===uu&&(uu=js),0===(t=jt(62914560&~uu))&&(t=4194304))),n=hu(),null!==(e=vu(e,t))&&(Wt(e,t,n),mu(e,n))}function zu(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.flags=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childLanes=this.lanes=0,this.alternate=null}function Vu(e,t,n,r){return new zu(e,t,n,r)}function Hu(e){return!(!(e=e.prototype)||!e.isReactComponent)}function qu(e,t){var n=e.alternate;return null===n?((n=Vu(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null),n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Gu(e,t,n,r,o,i){var s=2;if(r=e,"function"===typeof e)Hu(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case E:return Ku(n.children,o,i,t);case F:s=8,o|=16;break;case C:s=8,o|=1;break;case S:return(e=Vu(12,n,t,8|o)).elementType=S,e.type=S,e.lanes=i,e;case A:return(e=Vu(13,n,t,o)).type=A,e.elementType=A,e.lanes=i,e;case N:return(e=Vu(19,n,t,o)).elementType=N,e.lanes=i,e;case L:return Xu(n,o,i,t);case B:return(e=Vu(24,n,t,o)).elementType=B,e.lanes=i,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case I:s=10;break e;case R:s=9;break e;case T:s=11;break e;case O:s=14;break e;case D:s=16,r=null;break e;case P:s=22;break e}throw Error(a(130,null==e?e:typeof e,""))}return(t=Vu(s,n,t,o)).elementType=e,t.type=r,t.lanes=i,t}function Ku(e,t,n,r){return(e=Vu(7,e,r,t)).lanes=n,e}function Xu(e,t,n,r){return(e=Vu(23,e,r,t)).elementType=L,e.lanes=n,e}function $u(e,t,n){return(e=Vu(6,e,null,t)).lanes=n,e}function Yu(e,t,n){return(t=Vu(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Qu(e,t,n){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=n,this.callbackNode=null,this.callbackPriority=0,this.eventTimes=Zt(0),this.expirationTimes=Zt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Zt(0),this.mutableSourceEagerHydrationData=null}function Ju(e,t,n,r){var o=t.current,i=hu(),s=du(o);e:if(n){t:{if(Xe(n=n._reactInternals)!==n||1!==n.tag)throw Error(a(170));var u=n;do{switch(u.tag){case 3:u=u.stateNode.context;break t;case 1:if(go(u.type)){u=u.stateNode.__reactInternalMemoizedMergedChildContext;break t}}u=u.return}while(null!==u);throw Error(a(171))}if(1===n.tag){var c=n.type;if(go(c)){n=wo(n,c,u);break e}}n=u}else n=fo;return null===t.context?t.context=n:t.pendingContext=n,(t=li(i,s)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),fi(o,t),pu(o,s,i),s}function ec(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function tc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function nc(e,t){tc(e,t),(e=e.alternate)&&tc(e,t)}function rc(e,t,n){var r=null!=n&&null!=n.hydrationOptions&&n.hydrationOptions.mutableSources||null;if(n=new Qu(e,t,null!=n&&!0===n.hydrate),t=Vu(3,null,null,2===t?7:1===t?3:0),n.current=t,t.stateNode=n,ui(t),e[Jr]=n.current,Nr(8===e.nodeType?e.parentNode:e),r)for(e=0;e<r.length;e++){var o=(t=r[e])._getVersion;o=o(t._source),null==n.mutableSourceEagerHydrationData?n.mutableSourceEagerHydrationData=[t,o]:n.mutableSourceEagerHydrationData.push(t,o)}this._internalRoot=n}function oc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function ic(e,t,n,r,o){var i=n._reactRootContainer;if(i){var a=i._internalRoot;if("function"===typeof o){var s=o;o=function(){var e=ec(a);s.call(e)}}Ju(t,a,e,o)}else{if(i=n._reactRootContainer=function(e,t){if(t||(t=!(!(t=e?9===e.nodeType?e.documentElement:e.firstChild:null)||1!==t.nodeType||!t.hasAttribute("data-reactroot"))),!t)for(var n;n=e.lastChild;)e.removeChild(n);return new rc(e,0,t?{hydrate:!0}:void 0)}(n,r),a=i._internalRoot,"function"===typeof o){var u=o;o=function(){var e=ec(a);u.call(e)}}xu((function(){Ju(t,a,e,o)}))}return ec(a)}function ac(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!oc(t))throw Error(a(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:_,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)}Ks=function(e,t,n){var r=t.lanes;if(null!==e)if(e.memoizedProps!==t.pendingProps||po.current)Fa=!0;else{if(0===(n&r)){switch(Fa=!1,t.tag){case 3:qa(t),Gi();break;case 5:Mi(t);break;case 1:go(t.type)&&xo(t);break;case 4:Di(t,t.stateNode.containerInfo);break;case 10:r=t.memoizedProps.value;var o=t.type._context;lo(Qo,o._currentValue),o._currentValue=r;break;case 13:if(null!==t.memoizedState)return 0!==(n&t.child.childLanes)?Qa(e,t,n):(lo(Li,1&Li.current),null!==(t=is(e,t,n))?t.sibling:null);lo(Li,1&Li.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(64&e.flags)){if(r)return os(e,t,n);t.flags|=64}if(null!==(o=t.memoizedState)&&(o.rendering=null,o.tail=null,o.lastEffect=null),lo(Li,Li.current),r)break;return null;case 23:case 24:return t.lanes=0,Za(e,t,n)}return is(e,t,n)}Fa=0!==(16384&e.flags)}else Fa=!1;switch(t.lanes=0,t.tag){case 2:if(r=t.type,null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,o=mo(t,ho.current),ii(t,n),o=aa(null,t,r,e,o,n),t.flags|=1,"object"===typeof o&&null!==o&&"function"===typeof o.render&&void 0===o.$$typeof){if(t.tag=1,t.memoizedState=null,t.updateQueue=null,go(r)){var i=!0;xo(t)}else i=!1;t.memoizedState=null!==o.state&&void 0!==o.state?o.state:null,ui(t);var s=r.getDerivedStateFromProps;"function"===typeof s&&mi(t,r,s,e),o.updater=gi,t.stateNode=o,o._reactInternals=t,xi(t,r,e,n),t=Ha(null,t,r,!0,i,n)}else t.tag=0,La(null,t,o,n),t=t.child;return t;case 16:o=t.elementType;e:{switch(null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,o=(i=o._init)(o._payload),t.type=o,i=t.tag=function(e){if("function"===typeof e)return Hu(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===T)return 11;if(e===O)return 14}return 2}(o),e=Yo(o,e),i){case 0:t=za(null,t,o,e,n);break e;case 1:t=Va(null,t,o,e,n);break e;case 11:t=Ba(null,t,o,e,n);break e;case 14:t=Ua(null,t,o,Yo(o.type,e),r,n);break e}throw Error(a(306,o,""))}return t;case 0:return r=t.type,o=t.pendingProps,za(e,t,r,o=t.elementType===r?o:Yo(r,o),n);case 1:return r=t.type,o=t.pendingProps,Va(e,t,r,o=t.elementType===r?o:Yo(r,o),n);case 3:if(qa(t),r=t.updateQueue,null===e||null===r)throw Error(a(282));if(r=t.pendingProps,o=null!==(o=t.memoizedState)?o.element:null,ci(e,t),di(t,r,null,n),(r=t.memoizedState.element)===o)Gi(),t=is(e,t,n);else{if((i=(o=t.stateNode).hydrate)&&(ji=Gr(t.stateNode.containerInfo.firstChild),Ui=t,i=Zi=!0),i){if(null!=(e=o.mutableSourceEagerHydrationData))for(o=0;o<e.length;o+=2)(i=e[o])._workInProgressVersionPrimary=e[o+1],Ki.push(i);for(n=Ii(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|1024,n=n.sibling}else La(e,t,r,n),Gi();t=t.child}return t;case 5:return Mi(t),null===e&&Vi(t),r=t.type,o=t.pendingProps,i=null!==e?e.memoizedProps:null,s=o.children,zr(r,o)?s=null:null!==i&&zr(r,i)&&(t.flags|=16),Wa(e,t),La(e,t,s,n),t.child;case 6:return null===e&&Vi(t),null;case 13:return Qa(e,t,n);case 4:return Di(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Si(t,null,r,n):La(e,t,r,n),t.child;case 11:return r=t.type,o=t.pendingProps,Ba(e,t,r,o=t.elementType===r?o:Yo(r,o),n);case 7:return La(e,t,t.pendingProps,n),t.child;case 8:case 12:return La(e,t,t.pendingProps.children,n),t.child;case 10:e:{r=t.type._context,o=t.pendingProps,s=t.memoizedProps,i=o.value;var u=t.type._context;if(lo(Qo,u._currentValue),u._currentValue=i,null!==s)if(u=s.value,0===(i=cr(u,i)?0:0|("function"===typeof r._calculateChangedBits?r._calculateChangedBits(u,i):1073741823))){if(s.children===o.children&&!po.current){t=is(e,t,n);break e}}else for(null!==(u=t.child)&&(u.return=t);null!==u;){var c=u.dependencies;if(null!==c){s=u.child;for(var l=c.firstContext;null!==l;){if(l.context===r&&0!==(l.observedBits&i)){1===u.tag&&((l=li(-1,n&-n)).tag=2,fi(u,l)),u.lanes|=n,null!==(l=u.alternate)&&(l.lanes|=n),oi(u.return,n),c.lanes|=n;break}l=l.next}}else s=10===u.tag&&u.type===t.type?null:u.child;if(null!==s)s.return=u;else for(s=u;null!==s;){if(s===t){s=null;break}if(null!==(u=s.sibling)){u.return=s.return,s=u;break}s=s.return}u=s}La(e,t,o.children,n),t=t.child}return t;case 9:return o=t.type,r=(i=t.pendingProps).children,ii(t,n),r=r(o=ai(o,i.unstable_observedBits)),t.flags|=1,La(e,t,r,n),t.child;case 14:return i=Yo(o=t.type,t.pendingProps),Ua(e,t,o,i=Yo(o.type,i),r,n);case 15:return ja(e,t,t.type,t.pendingProps,r,n);case 17:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:Yo(r,o),null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),t.tag=1,go(r)?(e=!0,xo(t)):e=!1,ii(t,n),bi(t,r,o),xi(t,r,o,n),Ha(null,t,r,!0,e,n);case 19:return os(e,t,n);case 23:case 24:return Za(e,t,n)}throw Error(a(156,t.tag))},rc.prototype.render=function(e){Ju(e,this._internalRoot,null,null)},rc.prototype.unmount=function(){var e=this._internalRoot,t=e.containerInfo;Ju(null,e,null,(function(){t[Jr]=null}))},et=function(e){13===e.tag&&(pu(e,4,hu()),nc(e,4))},tt=function(e){13===e.tag&&(pu(e,67108864,hu()),nc(e,67108864))},nt=function(e){if(13===e.tag){var t=hu(),n=du(e);pu(e,n,t),nc(e,n)}},rt=function(e,t){return t()},Se=function(e,t,n){switch(t){case"input":if(ne(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var o=oo(r);if(!o)throw Error(a(90));Y(r),ne(r,o)}}}break;case"textarea":ce(e,n);break;case"select":null!=(t=n.value)&&ae(e,!!n.multiple,t,!1)}},Oe=wu,De=function(e,t,n,r,o){var i=Os;Os|=4;try{return qo(98,e.bind(null,t,n,r,o))}finally{0===(Os=i)&&(Gs(),Ko())}},Pe=function(){0===(49&Os)&&(function(){if(null!==ou){var e=ou;ou=null,e.forEach((function(e){e.expiredLanes|=24&e.pendingLanes,mu(e,zo())}))}Ko()}(),Mu())},Me=function(e,t){var n=Os;Os|=2;try{return e(t)}finally{0===(Os=n)&&(Gs(),Ko())}};var sc={Events:[no,ro,oo,Ae,Ne,Mu,{current:!1}]},uc={findFiberByHostInstance:to,bundleType:0,version:"17.0.2",rendererPackageName:"react-dom"},cc={bundleType:uc.bundleType,version:uc.version,rendererPackageName:uc.rendererPackageName,rendererConfig:uc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:x.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Qe(e))?null:e.stateNode},findFiberByHostInstance:uc.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var lc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!lc.isDisabled&&lc.supportsFiber)try{_o=lc.inject(cc),Eo=lc}catch(ve){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sc,t.createPortal=ac,t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(a(188));throw Error(a(268,Object.keys(e)))}return e=null===(e=Qe(t))?null:e.stateNode},t.flushSync=function(e,t){var n=Os;if(0!==(48&n))return e(t);Os|=1;try{if(e)return qo(99,e.bind(null,t))}finally{Os=n,Ko()}},t.hydrate=function(e,t,n){if(!oc(t))throw Error(a(200));return ic(null,e,t,!0,n)},t.render=function(e,t,n){if(!oc(t))throw Error(a(200));return ic(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!oc(e))throw Error(a(40));return!!e._reactRootContainer&&(xu((function(){ic(null,null,e,!1,(function(){e._reactRootContainer=null,e[Jr]=null}))})),!0)},t.unstable_batchedUpdates=wu,t.unstable_createPortal=function(e,t){return ac(e,t,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)},t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!oc(n))throw Error(a(200));if(null==e||void 0===e._reactInternals)throw Error(a(38));return ic(e,t,n,!1,r)},t.version="17.0.2"},4164:function(e,t,n){"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(4463)},8892:function(e,t,n){var r=n(7424).default,o=n(7061).default,i=n(7156).default,a=n(2791),s=n(4753),u=s.useSpring,c=s.animated,l=window.innerHeight,f=window.innerWidth,h={maxTilt:25,rotationPower:50,swipeThreshold:.5},d={touchResponsive:{friction:50,tension:2e3},animateOut:{friction:30,tension:400},animateBack:{friction:10,tension:200}},p=function(e,t){return Math.sqrt(Math.pow(e,2)+Math.pow(t,2))},v=function(e){var t=Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2));return{x:e.x/t,y:e.y/t}},m=function(){var e=i(o().mark((function e(t,n){var r,i,a,s,u,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=p(l,f),i=p(t.x,t.y),a=r*t.x,s=r*t.y,u=45*t.x,c=r/i,n.start({xyrot:[a,s,u],config:{duration:c}}),e.next=9,new Promise((function(e){return setTimeout((function(){e()}),c)}));case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),g=function(e){return new Promise((function(t){e.start({xyrot:[0,0,0],config:d.animateBack,onRest:t})}))},y=function(e){if(Math.abs(e.x)>Math.abs(e.y)){if(e.x>h.swipeThreshold)return"right";if(e.x<-h.swipeThreshold)return"left"}else{if(e.y>h.swipeThreshold)return"down";if(e.y<-h.swipeThreshold)return"up"}return"none"},b=c.div,w=a.forwardRef((function(e,t){var n=e.flickOnSwipe,s=void 0===n||n,c=e.children,l=e.onSwipe,f=e.onCardLeftScreen,p=e.className,w=e.preventSwipe,x=void 0===w?[]:w,k=e.swipeRequirementType,_=void 0===k?"velocity":k,E=e.swipeThreshold,C=void 0===E?h.swipeThreshold:E,S=e.onSwipeRequirementFulfilled,I=e.onSwipeRequirementUnfulfilled,R=u((function(){return{xyrot:[0,0,0],config:d.touchResponsive}})),T=r(R,2),A=T[0].xyrot,N=T[1];h.swipeThreshold=C,a.useImperativeHandle(t,(function(){return{swipe:function(){var e=arguments;return i(o().mark((function t(){var n,r,i;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.length>0&&void 0!==e[0]?e[0]:"right",l&&l(n),r=1.3,i=(Math.random()-.5)/2,"right"!==n){t.next=9;break}return t.next=7,m({x:r,y:i},N);case 7:t.next=22;break;case 9:if("left"!==n){t.next=14;break}return t.next=12,m({x:-r,y:i},N);case 12:t.next=22;break;case 14:if("up"!==n){t.next=19;break}return t.next=17,m({x:i,y:r},N);case 17:t.next=22;break;case 19:if("down"!==n){t.next=22;break}return t.next=22,m({x:i,y:-r},N);case 22:f&&f(n);case 23:case"end":return t.stop()}}),t)})))()},restoreCard:function(){return i(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g(N);case 2:case"end":return e.stop()}}),e)})))()}}}));var O=a.useCallback(function(){var e=i(o().mark((function e(t,n){var r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("none"===(r=y({x:"velocity"===_?n.vx:n.dx,y:"velocity"===_?n.vy:n.dy}))){e.next=9;break}if(!s){e.next=9;break}if(x.includes(r)){e.next=9;break}return l&&l(r),e.next=7,m("velocity"===_?{x:n.vx,y:n.vy}:v({x:n.dx,y:n.dy}),t,_);case 7:return f&&f(r),e.abrupt("return");case 9:g(t);case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),[_,s,x,l,f]),D="none",P=function(e,t,n,r){var o=r?e.touches[0].clientX-t.x:e.clientX-t.x,i=r?e.touches[0].clientY-t.y:e.clientY-t.y;return 0===t.x&&0===t.y&&(o=0,i=0),{dx:o,dy:i,vx:-(o-n.dx)/(n.timeStamp-Date.now()),vy:-(i-n.dy)/(n.timeStamp-Date.now()),timeStamp:Date.now()}};a.useLayoutEffect((function(){var e={x:0,y:0},t={dx:0,dy:0,vx:0,vy:0,timeStamp:Date.now()},n=!1;M.current.addEventListener("touchstart",(function(n){!n.srcElement.className.includes("pressable")&&n.cancelable&&n.preventDefault();var r=P(n,e,t,!0);t=r,e={x:n.touches[0].clientX,y:n.touches[0].clientY}})),M.current.addEventListener("mousedown",(function(r){n=!0;var o=P(r,e,t,!1);t=o,e={x:r.clientX,y:r.clientY}}));var r=function(e){if(S||I){var t=y({x:"velocity"===_?e.vx:e.dx,y:"velocity"===_?e.vy:e.dy});t!==D&&("none"===(D=t)?I&&I():S&&S(t))}var n=15*e.vx;n=Math.max(Math.min(n,h.maxTilt),-h.maxTilt),N.start({xyrot:[e.dx,e.dy,n],config:d.touchResponsive})};window.addEventListener("mousemove",(function(o){if(n){var i=P(o,e,t,!1);t=i,r(i)}})),window.addEventListener("mouseup",(function(r){n&&(n=!1,O(N,t),e={x:0,y:0},t={dx:0,dy:0,vx:0,vy:0,timeStamp:Date.now()})})),M.current.addEventListener("touchmove",(function(n){var o=P(n,e,t,!0);t=o,r(o)})),M.current.addEventListener("touchend",(function(n){O(N,t),e={x:0,y:0},t={dx:0,dy:0,vx:0,vy:0,timeStamp:Date.now()}}))}));var M=a.useRef();return a.createElement(b,{ref:M,className:p,style:{transform:A.to((function(e,t,n){return"translate3d(".concat(e,"px, ").concat(t,"px, ",0,"px) rotate(").concat(n,"deg)")}))},children:c})}));e.exports=w},6374:function(e,t,n){"use strict";n(1725);var r=n(2791),o=60103;if(t.Fragment=60107,"function"===typeof Symbol&&Symbol.for){var i=Symbol.for;o=i("react.element"),t.Fragment=i("react.fragment")}var a=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s=Object.prototype.hasOwnProperty,u={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,i={},c=null,l=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(l=t.ref),t)s.call(t,r)&&!u.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===i[r]&&(i[r]=t[r]);return{$$typeof:o,type:e,key:c,ref:l,props:i,_owner:a.current}}t.jsx=c,t.jsxs=c},9117:function(e,t,n){"use strict";var r=n(1725),o=60103,i=60106;t.Fragment=60107,t.StrictMode=60108,t.Profiler=60114;var a=60109,s=60110,u=60112;t.Suspense=60113;var c=60115,l=60116;if("function"===typeof Symbol&&Symbol.for){var f=Symbol.for;o=f("react.element"),i=f("react.portal"),t.Fragment=f("react.fragment"),t.StrictMode=f("react.strict_mode"),t.Profiler=f("react.profiler"),a=f("react.provider"),s=f("react.context"),u=f("react.forward_ref"),t.Suspense=f("react.suspense"),c=f("react.memo"),l=f("react.lazy")}var h="function"===typeof Symbol&&Symbol.iterator;function d(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v={};function m(e,t,n){this.props=e,this.context=t,this.refs=v,this.updater=n||p}function g(){}function y(e,t,n){this.props=e,this.context=t,this.refs=v,this.updater=n||p}m.prototype.isReactComponent={},m.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error(d(85));this.updater.enqueueSetState(this,e,t,"setState")},m.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},g.prototype=m.prototype;var b=y.prototype=new g;b.constructor=y,r(b,m.prototype),b.isPureReactComponent=!0;var w={current:null},x=Object.prototype.hasOwnProperty,k={key:!0,ref:!0,__self:!0,__source:!0};function _(e,t,n){var r,i={},a=null,s=null;if(null!=t)for(r in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(a=""+t.key),t)x.call(t,r)&&!k.hasOwnProperty(r)&&(i[r]=t[r]);var u=arguments.length-2;if(1===u)i.children=n;else if(1<u){for(var c=Array(u),l=0;l<u;l++)c[l]=arguments[l+2];i.children=c}if(e&&e.defaultProps)for(r in u=e.defaultProps)void 0===i[r]&&(i[r]=u[r]);return{$$typeof:o,type:e,key:a,ref:s,props:i,_owner:w.current}}function E(e){return"object"===typeof e&&null!==e&&e.$$typeof===o}var C=/\/+/g;function S(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function I(e,t,n,r,a){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var u=!1;if(null===e)u=!0;else switch(s){case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case o:case i:u=!0}}if(u)return a=a(u=e),e=""===r?"."+S(u,0):r,Array.isArray(a)?(n="",null!=e&&(n=e.replace(C,"$&/")+"/"),I(a,t,n,"",(function(e){return e}))):null!=a&&(E(a)&&(a=function(e,t){return{$$typeof:o,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(a,n+(!a.key||u&&u.key===a.key?"":(""+a.key).replace(C,"$&/")+"/")+e)),t.push(a)),1;if(u=0,r=""===r?".":r+":",Array.isArray(e))for(var c=0;c<e.length;c++){var l=r+S(s=e[c],c);u+=I(s,t,n,l,a)}else if(l=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=h&&e[h]||e["@@iterator"])?e:null}(e),"function"===typeof l)for(e=l.call(e),c=0;!(s=e.next()).done;)u+=I(s=s.value,t,n,l=r+S(s,c++),a);else if("object"===s)throw t=""+e,Error(d(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t));return u}function R(e,t,n){if(null==e)return e;var r=[],o=0;return I(e,r,"","",(function(e){return t.call(n,e,o++)})),r}function T(e){if(-1===e._status){var t=e._result;t=t(),e._status=0,e._result=t,t.then((function(t){0===e._status&&(t=t.default,e._status=1,e._result=t)}),(function(t){0===e._status&&(e._status=2,e._result=t)}))}if(1===e._status)return e._result;throw e._result}var A={current:null};function N(){var e=A.current;if(null===e)throw Error(d(321));return e}var O={ReactCurrentDispatcher:A,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:w,IsSomeRendererActing:{current:!1},assign:r};t.Children={map:R,forEach:function(e,t,n){R(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return R(e,(function(){t++})),t},toArray:function(e){return R(e,(function(e){return e}))||[]},only:function(e){if(!E(e))throw Error(d(143));return e}},t.Component=m,t.PureComponent=y,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=O,t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error(d(267,e));var i=r({},e.props),a=e.key,s=e.ref,u=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,u=w.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(l in t)x.call(t,l)&&!k.hasOwnProperty(l)&&(i[l]=void 0===t[l]&&void 0!==c?c[l]:t[l])}var l=arguments.length-2;if(1===l)i.children=n;else if(1<l){c=Array(l);for(var f=0;f<l;f++)c[f]=arguments[f+2];i.children=c}return{$$typeof:o,type:e.type,key:a,ref:s,props:i,_owner:u}},t.createContext=function(e,t){return void 0===t&&(t=null),(e={$$typeof:s,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=_,t.createFactory=function(e){var t=_.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:u,render:e}},t.isValidElement=E,t.lazy=function(e){return{$$typeof:l,_payload:{_status:-1,_result:e},_init:T}},t.memo=function(e,t){return{$$typeof:c,type:e,compare:void 0===t?null:t}},t.useCallback=function(e,t){return N().useCallback(e,t)},t.useContext=function(e,t){return N().useContext(e,t)},t.useDebugValue=function(){},t.useEffect=function(e,t){return N().useEffect(e,t)},t.useImperativeHandle=function(e,t,n){return N().useImperativeHandle(e,t,n)},t.useLayoutEffect=function(e,t){return N().useLayoutEffect(e,t)},t.useMemo=function(e,t){return N().useMemo(e,t)},t.useReducer=function(e,t,n){return N().useReducer(e,t,n)},t.useRef=function(e){return N().useRef(e)},t.useState=function(e){return N().useState(e)},t.version="17.0.2"},2791:function(e,t,n){"use strict";e.exports=n(9117)},184:function(e,t,n){"use strict";e.exports=n(6374)},6813:function(e,t){"use strict";var n,r,o,i;if("object"===typeof performance&&"function"===typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var s=Date,u=s.now();t.unstable_now=function(){return s.now()-u}}if("undefined"===typeof window||"function"!==typeof MessageChannel){var c=null,l=null,f=function e(){if(null!==c)try{var n=t.unstable_now();c(!0,n),c=null}catch(r){throw setTimeout(e,0),r}};n=function(e){null!==c?setTimeout(n,0,e):(c=e,setTimeout(f,0))},r=function(e,t){l=setTimeout(e,t)},o=function(){clearTimeout(l)},t.unstable_shouldYield=function(){return!1},i=t.unstable_forceFrameRate=function(){}}else{var h=window.setTimeout,d=window.clearTimeout;if("undefined"!==typeof console){var p=window.cancelAnimationFrame;"function"!==typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),"function"!==typeof p&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills")}var v=!1,m=null,g=-1,y=5,b=0;t.unstable_shouldYield=function(){return t.unstable_now()>=b},i=function(){},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):y=0<e?Math.floor(1e3/e):5};var w=new MessageChannel,x=w.port2;w.port1.onmessage=function(){if(null!==m){var e=t.unstable_now();b=e+y;try{m(!0,e)?x.postMessage(null):(v=!1,m=null)}catch(n){throw x.postMessage(null),n}}else v=!1},n=function(e){m=e,v||(v=!0,x.postMessage(null))},r=function(e,n){g=h((function(){e(t.unstable_now())}),n)},o=function(){d(g),g=-1}}function k(e,t){var n=e.length;e.push(t);e:for(;;){var r=n-1>>>1,o=e[r];if(!(void 0!==o&&0<C(o,t)))break e;e[r]=t,e[n]=o,n=r}}function _(e){return void 0===(e=e[0])?null:e}function E(e){var t=e[0];if(void 0!==t){var n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,o=e.length;r<o;){var i=2*(r+1)-1,a=e[i],s=i+1,u=e[s];if(void 0!==a&&0>C(a,n))void 0!==u&&0>C(u,a)?(e[r]=u,e[s]=n,r=s):(e[r]=a,e[i]=n,r=i);else{if(!(void 0!==u&&0>C(u,n)))break e;e[r]=u,e[s]=n,r=s}}}return t}return null}function C(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}var S=[],I=[],R=1,T=null,A=3,N=!1,O=!1,D=!1;function P(e){for(var t=_(I);null!==t;){if(null===t.callback)E(I);else{if(!(t.startTime<=e))break;E(I),t.sortIndex=t.expirationTime,k(S,t)}t=_(I)}}function M(e){if(D=!1,P(e),!O)if(null!==_(S))O=!0,n(F);else{var t=_(I);null!==t&&r(M,t.startTime-e)}}function F(e,n){O=!1,D&&(D=!1,o()),N=!0;var i=A;try{for(P(n),T=_(S);null!==T&&(!(T.expirationTime>n)||e&&!t.unstable_shouldYield());){var a=T.callback;if("function"===typeof a){T.callback=null,A=T.priorityLevel;var s=a(T.expirationTime<=n);n=t.unstable_now(),"function"===typeof s?T.callback=s:T===_(S)&&E(S),P(n)}else E(S);T=_(S)}if(null!==T)var u=!0;else{var c=_(I);null!==c&&r(M,c.startTime-n),u=!1}return u}finally{T=null,A=i,N=!1}}var L=i;t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){O||N||(O=!0,n(F))},t.unstable_getCurrentPriorityLevel=function(){return A},t.unstable_getFirstCallbackNode=function(){return _(S)},t.unstable_next=function(e){switch(A){case 1:case 2:case 3:var t=3;break;default:t=A}var n=A;A=t;try{return e()}finally{A=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=L,t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=A;A=e;try{return t()}finally{A=n}},t.unstable_scheduleCallback=function(e,i,a){var s=t.unstable_now();switch("object"===typeof a&&null!==a?a="number"===typeof(a=a.delay)&&0<a?s+a:s:a=s,e){case 1:var u=-1;break;case 2:u=250;break;case 5:u=1073741823;break;case 4:u=1e4;break;default:u=5e3}return e={id:R++,callback:i,priorityLevel:e,startTime:a,expirationTime:u=a+u,sortIndex:-1},a>s?(e.sortIndex=a,k(I,e),null===_(S)&&e===_(I)&&(D?o():D=!0,r(M,a-s))):(e.sortIndex=u,k(S,e),O||N||(O=!0,n(F))),e},t.unstable_wrapCallback=function(e){var t=A;return function(){var n=A;A=t;try{return e.apply(this,arguments)}finally{A=n}}}},5296:function(e,t,n){"use strict";e.exports=n(6813)},4902:function(){},522:function(){},753:function(){},3897:function(e){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r},e.exports.__esModule=!0,e.exports.default=e.exports},5372:function(e){e.exports=function(e){if(Array.isArray(e))return e},e.exports.__esModule=!0,e.exports.default=e.exports},7156:function(e){function t(e,t,n,r,o,i,a){try{var s=e[i](a),u=s.value}catch(c){return void n(c)}s.done?t(u):Promise.resolve(u).then(r,o)}e.exports=function(e){return function(){var n=this,r=arguments;return new Promise((function(o,i){var a=e.apply(n,r);function s(e){t(a,o,i,s,u,"next",e)}function u(e){t(a,o,i,s,u,"throw",e)}s(void 0)}))}},e.exports.__esModule=!0,e.exports.default=e.exports},8872:function(e){e.exports=function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],u=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){c=!0,o=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw o}}return s}},e.exports.__esModule=!0,e.exports.default=e.exports},2218:function(e){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},7061:function(e,t,n){var r=n(8698).default;function o(){"use strict";e.exports=o=function(){return n},e.exports.__esModule=!0,e.exports.default=e.exports;var t,n={},i=Object.prototype,a=i.hasOwnProperty,s=Object.defineProperty||function(e,t,n){e[t]=n.value},u="function"==typeof Symbol?Symbol:{},c=u.iterator||"@@iterator",l=u.asyncIterator||"@@asyncIterator",f=u.toStringTag||"@@toStringTag";function h(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{h({},"")}catch(t){h=function(e,t,n){return e[t]=n}}function d(e,t,n,r){var o=t&&t.prototype instanceof w?t:w,i=Object.create(o.prototype),a=new D(r||[]);return s(i,"_invoke",{value:T(e,n,a)}),i}function p(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}n.wrap=d;var v="suspendedStart",m="suspendedYield",g="executing",y="completed",b={};function w(){}function x(){}function k(){}var _={};h(_,c,(function(){return this}));var E=Object.getPrototypeOf,C=E&&E(E(P([])));C&&C!==i&&a.call(C,c)&&(_=C);var S=k.prototype=w.prototype=Object.create(_);function I(e){["next","throw","return"].forEach((function(t){h(e,t,(function(e){return this._invoke(t,e)}))}))}function R(e,t){function n(o,i,s,u){var c=p(e[o],e,i);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==r(f)&&a.call(f,"__await")?t.resolve(f.__await).then((function(e){n("next",e,s,u)}),(function(e){n("throw",e,s,u)})):t.resolve(f).then((function(e){l.value=e,s(l)}),(function(e){return n("throw",e,s,u)}))}u(c.arg)}var o;s(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,o){n(e,r,t,o)}))}return o=o?o.then(i,i):i()}})}function T(e,n,r){var o=v;return function(i,a){if(o===g)throw new Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var s=r.delegate;if(s){var u=A(s,r);if(u){if(u===b)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===v)throw o=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=g;var c=p(e,n,r);if("normal"===c.type){if(o=r.done?y:m,c.arg===b)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(o=y,r.method="throw",r.arg=c.arg)}}}function A(e,n){var r=n.method,o=e.iterator[r];if(o===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,A(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),b;var i=p(o,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,b;var a=i.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,b):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,b)}function N(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(N,this),this.reset(!0)}function P(e){if(e||""===e){var n=e[c];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function n(){for(;++o<e.length;)if(a.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return i.next=i}}throw new TypeError(r(e)+" is not iterable")}return x.prototype=k,s(S,"constructor",{value:k,configurable:!0}),s(k,"constructor",{value:x,configurable:!0}),x.displayName=h(k,f,"GeneratorFunction"),n.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===x||"GeneratorFunction"===(t.displayName||t.name))},n.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,k):(e.__proto__=k,h(e,f,"GeneratorFunction")),e.prototype=Object.create(S),e},n.awrap=function(e){return{__await:e}},I(R.prototype),h(R.prototype,l,(function(){return this})),n.AsyncIterator=R,n.async=function(e,t,r,o,i){void 0===i&&(i=Promise);var a=new R(d(e,t,r,o),i);return n.isGeneratorFunction(t)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},I(S),h(S,f,"Generator"),h(S,c,(function(){return this})),h(S,"toString",(function(){return"[object Generator]"})),n.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},n.values=P,D.prototype={constructor:D,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var n in this)"t"===n.charAt(0)&&a.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(r,o){return s.type="throw",s.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],s=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var u=a.call(i,"catchLoc"),c=a.call(i,"finallyLoc");if(u&&c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,b):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),b},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),O(n),b}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;O(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:P(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),b}},n}e.exports=o,e.exports.__esModule=!0,e.exports.default=e.exports},7424:function(e,t,n){var r=n(5372),o=n(8872),i=n(6116),a=n(2218);e.exports=function(e,t){return r(e)||o(e,t)||i(e,t)||a()},e.exports.__esModule=!0,e.exports.default=e.exports},8698:function(e){function t(n){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},6116:function(e,t,n){var r=n(3897);e.exports=function(e,t){if(e){if("string"===typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}},e.exports.__esModule=!0,e.exports.default=e.exports},907:function(e,t,n){"use strict";function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,{Z:function(){return r}})},3878:function(e,t,n){"use strict";function r(e){if(Array.isArray(e))return e}n.d(t,{Z:function(){return r}})},7326:function(e,t,n){"use strict";function r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}n.d(t,{Z:function(){return r}})},5861:function(e,t,n){"use strict";function r(e,t,n,r,o,i,a){try{var s=e[i](a),u=s.value}catch(c){return void n(c)}s.done?t(u):Promise.resolve(u).then(r,o)}function o(e){return function(){var t=this,n=arguments;return new Promise((function(o,i){var a=e.apply(t,n);function s(e){r(a,o,i,s,u,"next",e)}function u(e){r(a,o,i,s,u,"throw",e)}s(void 0)}))}}n.d(t,{Z:function(){return o}})},5671:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,{Z:function(){return r}})},3144:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(9142);function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(0,r.Z)(o.key),o)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}},7762:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(181);function o(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=(0,r.Z)(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw a}}}}},7277:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(1120),o=n(8814),i=n(1002),a=n(7326);function s(e){var t=(0,o.Z)();return function(){var n,o=(0,r.Z)(e);if(t){var s=(0,r.Z)(this).constructor;n=Reflect.construct(o,arguments,s)}else n=o.apply(this,arguments);return function(e,t){if(t&&("object"===(0,i.Z)(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return(0,a.Z)(e)}(this,n)}}},1752:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(1120);function o(){return o="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=(0,r.Z)(e)););return e}(e,t);if(o){var i=Object.getOwnPropertyDescriptor(o,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},o.apply(this,arguments)}},1120:function(e,t,n){"use strict";function r(e){return r=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},r(e)}n.d(t,{Z:function(){return r}})},136:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(9611);function o(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&(0,r.Z)(e,t)}},8814:function(e,t,n){"use strict";function r(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}n.d(t,{Z:function(){return r}})},9199:function(e,t,n){"use strict";function r(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}n.d(t,{Z:function(){return r}})},5267:function(e,t,n){"use strict";function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}n.d(t,{Z:function(){return r}})},4165:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(1002);function o(){o=function(){return t};var e,t={},n=Object.prototype,i=n.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},s="function"==typeof Symbol?Symbol:{},u=s.iterator||"@@iterator",c=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function f(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{f({},"")}catch(e){f=function(e,t,n){return e[t]=n}}function h(e,t,n,r){var o=t&&t.prototype instanceof b?t:b,i=Object.create(o.prototype),s=new O(r||[]);return a(i,"_invoke",{value:R(e,n,s)}),i}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=h;var p="suspendedStart",v="suspendedYield",m="executing",g="completed",y={};function b(){}function w(){}function x(){}var k={};f(k,u,(function(){return this}));var _=Object.getPrototypeOf,E=_&&_(_(D([])));E&&E!==n&&i.call(E,u)&&(k=E);var C=x.prototype=b.prototype=Object.create(k);function S(e){["next","throw","return"].forEach((function(t){f(e,t,(function(e){return this._invoke(t,e)}))}))}function I(e,t){function n(o,a,s,u){var c=d(e[o],e,a);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==(0,r.Z)(f)&&i.call(f,"__await")?t.resolve(f.__await).then((function(e){n("next",e,s,u)}),(function(e){n("throw",e,s,u)})):t.resolve(f).then((function(e){l.value=e,s(l)}),(function(e){return n("throw",e,s,u)}))}u(c.arg)}var o;a(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,o){n(e,r,t,o)}))}return o=o?o.then(i,i):i()}})}function R(t,n,r){var o=p;return function(i,a){if(o===m)throw new Error("Generator is already running");if(o===g){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var s=r.delegate;if(s){var u=T(s,r);if(u){if(u===y)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=m;var c=d(t,n,r);if("normal"===c.type){if(o=r.done?g:v,c.arg===y)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(o=g,r.method="throw",r.arg=c.arg)}}}function T(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,T(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var i=d(o,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,y;var a=i.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,y):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function N(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function D(t){if(t||""===t){var n=t[u];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function n(){for(;++o<t.length;)if(i.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError((0,r.Z)(t)+" is not iterable")}return w.prototype=x,a(C,"constructor",{value:x,configurable:!0}),a(x,"constructor",{value:w,configurable:!0}),w.displayName=f(x,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===w||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,x):(e.__proto__=x,f(e,l,"GeneratorFunction")),e.prototype=Object.create(C),e},t.awrap=function(e){return{__await:e}},S(I.prototype),f(I.prototype,c,(function(){return this})),t.AsyncIterator=I,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new I(h(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},S(C),f(C,l,"Generator"),f(C,u,(function(){return this})),f(C,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=D,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(N),!t)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(r,o){return s.type="throw",s.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var u=i.call(a,"catchLoc"),c=i.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),N(n),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;N(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:D(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),y}},t}},9611:function(e,t,n){"use strict";function r(e,t){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},r(e,t)}n.d(t,{Z:function(){return r}})},9439:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(3878);var o=n(181),i=n(5267);function a(e,t){return(0,r.Z)(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,s=[],u=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){c=!0,o=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw o}}return s}}(e,t)||(0,o.Z)(e,t)||(0,i.Z)()}},3433:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(907);var o=n(9199),i=n(181);function a(e){return function(e){if(Array.isArray(e))return(0,r.Z)(e)}(e)||(0,o.Z)(e)||(0,i.Z)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},9142:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(1002);function o(e){var t=function(e,t){if("object"!==(0,r.Z)(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!==(0,r.Z)(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===(0,r.Z)(t)?t:String(t)}},1002:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}n.d(t,{Z:function(){return r}})},181:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(907);function o(e,t){if(e){if("string"===typeof e)return(0,r.Z)(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?(0,r.Z)(e,t):void 0}}},8737:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(1120),o=n(9611);var i=n(8814);function a(e,t,n){return a=(0,i.Z)()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&(0,o.Z)(i,n.prototype),i},a.apply(null,arguments)}function s(e){var t="function"===typeof Map?new Map:void 0;return s=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof t){if(t.has(e))return t.get(e);t.set(e,i)}function i(){return a(e,arguments,(0,r.Z)(this).constructor)}return i.prototype=Object.create(e.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),(0,o.Z)(i,e)},s(e)}}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},function(){var e,t=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__};n.t=function(r,o){if(1&o&&(r=this(r)),8&o)return r;if("object"===typeof r&&r){if(4&o&&r.__esModule)return r;if(16&o&&"function"===typeof r.then)return r}var i=Object.create(null);n.r(i);var a={};e=e||[null,t({}),t([]),t(t)];for(var s=2&o&&r;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((function(e){a[e]=function(){return r[e]}}));return a.default=function(){return r},n.d(i,a),i}}(),n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},function(){"use strict";var e=n(2791),t=n.t(e,2),r=n(4164),o=n(9439),i=n(184),a=function(e){var t=e.authToken,n=e.minimal,r=e.setShowModal,o=e.showModal,a=e.setIsSignUp;return(0,i.jsxs)("nav",{children:[(0,i.jsx)("div",{className:"logoContainer",children:(0,i.jsx)("img",{src:"/logo.png"})}),!t&&!n&&(0,i.jsx)("button",{className:"nav-button",onClick:function(){r(!0),a(!1)},disabled:o,children:"Log in"})]})},s=n(4165),u=n(5861);function c(e,t){return function(){return e.apply(t,arguments)}}var l,f=Object.prototype.toString,h=Object.getPrototypeOf,d=(l=Object.create(null),function(e){var t=f.call(e);return l[t]||(l[t]=t.slice(8,-1).toLowerCase())}),p=function(e){return e=e.toLowerCase(),function(t){return d(t)===e}},v=function(e){return function(t){return typeof t===e}},m=Array.isArray,g=v("undefined");var y=p("ArrayBuffer");var b=v("string"),w=v("function"),x=v("number"),k=function(e){return null!==e&&"object"===typeof e},_=function(e){if("object"!==d(e))return!1;var t=h(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},E=p("Date"),C=p("File"),S=p("Blob"),I=p("FileList"),R=p("URLSearchParams");function T(e,t){var n,r,o=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).allOwnKeys,i=void 0!==o&&o;if(null!==e&&"undefined"!==typeof e)if("object"!==typeof e&&(e=[e]),m(e))for(n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else{var a,s=i?Object.getOwnPropertyNames(e):Object.keys(e),u=s.length;for(n=0;n<u;n++)a=s[n],t.call(null,e[a],a,e)}}function A(e,t){t=t.toLowerCase();for(var n,r=Object.keys(e),o=r.length;o-- >0;)if(t===(n=r[o]).toLowerCase())return n;return null}var N="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:global,O=function(e){return!g(e)&&e!==N};var D,P=(D="undefined"!==typeof Uint8Array&&h(Uint8Array),function(e){return D&&e instanceof D}),M=p("HTMLFormElement"),F=function(e){var t=Object.prototype.hasOwnProperty;return function(e,n){return t.call(e,n)}}(),L=p("RegExp"),B=function(e,t){var n=Object.getOwnPropertyDescriptors(e),r={};T(n,(function(n,o){var i;!1!==(i=t(n,o,e))&&(r[o]=i||n)})),Object.defineProperties(e,r)},U="abcdefghijklmnopqrstuvwxyz",j="0123456789",Z={DIGIT:j,ALPHA:U,ALPHA_DIGIT:U+U.toUpperCase()+j};var W=p("AsyncFunction"),z={isArray:m,isArrayBuffer:y,isBuffer:function(e){return null!==e&&!g(e)&&null!==e.constructor&&!g(e.constructor)&&w(e.constructor.isBuffer)&&e.constructor.isBuffer(e)},isFormData:function(e){var t;return e&&("function"===typeof FormData&&e instanceof FormData||w(e.append)&&("formdata"===(t=d(e))||"object"===t&&w(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){return"undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&y(e.buffer)},isString:b,isNumber:x,isBoolean:function(e){return!0===e||!1===e},isObject:k,isPlainObject:_,isUndefined:g,isDate:E,isFile:C,isBlob:S,isRegExp:L,isFunction:w,isStream:function(e){return k(e)&&w(e.pipe)},isURLSearchParams:R,isTypedArray:P,isFileList:I,forEach:T,merge:function e(){for(var t=(O(this)&&this||{}).caseless,n={},r=function(r,o){var i=t&&A(n,o)||o;_(n[i])&&_(r)?n[i]=e(n[i],r):_(r)?n[i]=e({},r):m(r)?n[i]=r.slice():n[i]=r},o=0,i=arguments.length;o<i;o++)arguments[o]&&T(arguments[o],r);return n},extend:function(e,t,n){return T(t,(function(t,r){n&&w(t)?e[r]=c(t,n):e[r]=t}),{allOwnKeys:(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}).allOwnKeys}),e},trim:function(e){return e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e},inherits:function(e,t,n,r){e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},toFlatObject:function(e,t,n,r){var o,i,a,s={};if(t=t||{},null==e)return t;do{for(i=(o=Object.getOwnPropertyNames(e)).length;i-- >0;)a=o[i],r&&!r(a,e,t)||s[a]||(t[a]=e[a],s[a]=!0);e=!1!==n&&h(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},kindOf:d,kindOfTest:p,endsWith:function(e,t,n){e=String(e),(void 0===n||n>e.length)&&(n=e.length),n-=t.length;var r=e.indexOf(t,n);return-1!==r&&r===n},toArray:function(e){if(!e)return null;if(m(e))return e;var t=e.length;if(!x(t))return null;for(var n=new Array(t);t-- >0;)n[t]=e[t];return n},forEachEntry:function(e,t){for(var n,r=(e&&e[Symbol.iterator]).call(e);(n=r.next())&&!n.done;){var o=n.value;t.call(e,o[0],o[1])}},matchAll:function(e,t){for(var n,r=[];null!==(n=e.exec(t));)r.push(n);return r},isHTMLForm:M,hasOwnProperty:F,hasOwnProp:F,reduceDescriptors:B,freezeMethods:function(e){B(e,(function(t,n){if(w(e)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;var r=e[n];w(r)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=function(){throw Error("Can not rewrite read-only method '"+n+"'")}))}))},toObjectSet:function(e,t){var n={},r=function(e){e.forEach((function(e){n[e]=!0}))};return m(e)?r(e):r(String(e).split(t)),n},toCamelCase:function(e){return e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,(function(e,t,n){return t.toUpperCase()+n}))},noop:function(){},toFiniteNumber:function(e,t){return e=+e,Number.isFinite(e)?e:t},findKey:A,global:N,isContextDefined:O,ALPHABET:Z,generateString:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Z.ALPHA_DIGIT,n="",r=t.length;e--;)n+=t[Math.random()*r|0];return n},isSpecCompliantForm:function(e){return!!(e&&w(e.append)&&"FormData"===e[Symbol.toStringTag]&&e[Symbol.iterator])},toJSONObject:function(e){var t=new Array(10);return function e(n,r){if(k(n)){if(t.indexOf(n)>=0)return;if(!("toJSON"in n)){t[r]=n;var o=m(n)?[]:{};return T(n,(function(t,n){var i=e(t,r+1);!g(i)&&(o[n]=i)})),t[r]=void 0,o}}return n}(e,0)},isAsyncFn:W,isThenable:function(e){return e&&(k(e)||w(e))&&w(e.then)&&w(e.catch)}},V=n(5671),H=n(3144);function q(e,t,n,r,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),o&&(this.response=o)}z.inherits(q,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:z.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});var G=q.prototype,K={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach((function(e){K[e]={value:e}})),Object.defineProperties(q,K),Object.defineProperty(G,"isAxiosError",{value:!0}),q.from=function(e,t,n,r,o,i){var a=Object.create(G);return z.toFlatObject(e,a,(function(e){return e!==Error.prototype}),(function(e){return"isAxiosError"!==e})),q.call(a,e.message,t,n,r,o),a.cause=e,a.name=e.name,i&&Object.assign(a,i),a};var X=q;function $(e){return z.isPlainObject(e)||z.isArray(e)}function Y(e){return z.endsWith(e,"[]")?e.slice(0,-2):e}function Q(e,t,n){return e?e.concat(t).map((function(e,t){return e=Y(e),!n&&t?"["+e+"]":e})).join(n?".":""):t}var J=z.toFlatObject(z,{},null,(function(e){return/^is[A-Z]/.test(e)}));var ee=function(e,t,n){if(!z.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;var r=(n=z.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,(function(e,t){return!z.isUndefined(t[e])}))).metaTokens,o=n.visitor||c,i=n.dots,a=n.indexes,s=(n.Blob||"undefined"!==typeof Blob&&Blob)&&z.isSpecCompliantForm(t);if(!z.isFunction(o))throw new TypeError("visitor must be a function");function u(e){if(null===e)return"";if(z.isDate(e))return e.toISOString();if(!s&&z.isBlob(e))throw new X("Blob is not supported. Use a Buffer instead.");return z.isArrayBuffer(e)||z.isTypedArray(e)?s&&"function"===typeof Blob?new Blob([e]):Buffer.from(e):e}function c(e,n,o){var s=e;if(e&&!o&&"object"===typeof e)if(z.endsWith(n,"{}"))n=r?n:n.slice(0,-2),e=JSON.stringify(e);else if(z.isArray(e)&&function(e){return z.isArray(e)&&!e.some($)}(e)||(z.isFileList(e)||z.endsWith(n,"[]"))&&(s=z.toArray(e)))return n=Y(n),s.forEach((function(e,r){!z.isUndefined(e)&&null!==e&&t.append(!0===a?Q([n],r,i):null===a?n:n+"[]",u(e))})),!1;return!!$(e)||(t.append(Q(o,n,i),u(e)),!1)}var l=[],f=Object.assign(J,{defaultVisitor:c,convertValue:u,isVisitable:$});if(!z.isObject(e))throw new TypeError("data must be an object");return function e(n,r){if(!z.isUndefined(n)){if(-1!==l.indexOf(n))throw Error("Circular reference detected in "+r.join("."));l.push(n),z.forEach(n,(function(n,i){!0===(!(z.isUndefined(n)||null===n)&&o.call(t,n,z.isString(i)?i.trim():i,r,f))&&e(n,r?r.concat(i):[i])})),l.pop()}}(e),t};function te(e){var t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,(function(e){return t[e]}))}function ne(e,t){this._pairs=[],e&&ee(e,this,t)}var re=ne.prototype;re.append=function(e,t){this._pairs.push([e,t])},re.toString=function(e){var t=e?function(t){return e.call(this,t,te)}:te;return this._pairs.map((function(e){return t(e[0])+"="+t(e[1])}),"").join("&")};var oe=ne;function ie(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function ae(e,t,n){if(!t)return e;var r,o=n&&n.encode||ie,i=n&&n.serialize;if(r=i?i(t,n):z.isURLSearchParams(t)?t.toString():new oe(t,n).toString(o)){var a=e.indexOf("#");-1!==a&&(e=e.slice(0,a)),e+=(-1===e.indexOf("?")?"?":"&")+r}return e}var se=function(){function e(){(0,V.Z)(this,e),this.handlers=[]}return(0,H.Z)(e,[{key:"use",value:function(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}},{key:"eject",value:function(e){this.handlers[e]&&(this.handlers[e]=null)}},{key:"clear",value:function(){this.handlers&&(this.handlers=[])}},{key:"forEach",value:function(e){z.forEach(this.handlers,(function(t){null!==t&&e(t)}))}}]),e}(),ue=se,ce={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},le={isBrowser:!0,classes:{URLSearchParams:"undefined"!==typeof URLSearchParams?URLSearchParams:oe,FormData:"undefined"!==typeof FormData?FormData:null,Blob:"undefined"!==typeof Blob?Blob:null},isStandardBrowserEnv:function(){var e;return("undefined"===typeof navigator||"ReactNative"!==(e=navigator.product)&&"NativeScript"!==e&&"NS"!==e)&&("undefined"!==typeof window&&"undefined"!==typeof document)}(),isStandardBrowserWebWorkerEnv:"undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"===typeof self.importScripts,protocols:["http","https","file","blob","url","data"]};var fe=function(e){function t(e,n,r,o){var i=e[o++],a=Number.isFinite(+i),s=o>=e.length;return i=!i&&z.isArray(r)?r.length:i,s?(z.hasOwnProp(r,i)?r[i]=[r[i],n]:r[i]=n,!a):(r[i]&&z.isObject(r[i])||(r[i]=[]),t(e,n,r[i],o)&&z.isArray(r[i])&&(r[i]=function(e){var t,n,r={},o=Object.keys(e),i=o.length;for(t=0;t<i;t++)r[n=o[t]]=e[n];return r}(r[i])),!a)}if(z.isFormData(e)&&z.isFunction(e.entries)){var n={};return z.forEachEntry(e,(function(e,r){t(function(e){return z.matchAll(/\w+|\[(\w*)]/g,e).map((function(e){return"[]"===e[0]?"":e[1]||e[0]}))}(e),r,n,0)})),n}return null};var he={transitional:ce,adapter:le.isNode?"http":"xhr",transformRequest:[function(e,t){var n,r=t.getContentType()||"",o=r.indexOf("application/json")>-1,i=z.isObject(e);if(i&&z.isHTMLForm(e)&&(e=new FormData(e)),z.isFormData(e))return o&&o?JSON.stringify(fe(e)):e;if(z.isArrayBuffer(e)||z.isBuffer(e)||z.isStream(e)||z.isFile(e)||z.isBlob(e))return e;if(z.isArrayBufferView(e))return e.buffer;if(z.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();if(i){if(r.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return ee(e,new le.classes.URLSearchParams,Object.assign({visitor:function(e,t,n,r){return le.isNode&&z.isBuffer(e)?(this.append(t,e.toString("base64")),!1):r.defaultVisitor.apply(this,arguments)}},t))}(e,this.formSerializer).toString();if((n=z.isFileList(e))||r.indexOf("multipart/form-data")>-1){var a=this.env&&this.env.FormData;return ee(n?{"files[]":e}:e,a&&new a,this.formSerializer)}}return i||o?(t.setContentType("application/json",!1),function(e,t,n){if(z.isString(e))try{return(t||JSON.parse)(e),z.trim(e)}catch(Fn){if("SyntaxError"!==Fn.name)throw Fn}return(n||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){var t=this.transitional||he.transitional,n=t&&t.forcedJSONParsing,r="json"===this.responseType;if(e&&z.isString(e)&&(n&&!this.responseType||r)){var o=!(t&&t.silentJSONParsing)&&r;try{return JSON.parse(e)}catch(Fn){if(o){if("SyntaxError"===Fn.name)throw X.from(Fn,X.ERR_BAD_RESPONSE,this,null,this.response);throw Fn}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:le.classes.FormData,Blob:le.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};z.forEach(["delete","get","head","post","put","patch"],(function(e){he.headers[e]={}}));var de=he,pe=z.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),ve=Symbol("internals");function me(e){return e&&String(e).trim().toLowerCase()}function ge(e){return!1===e||null==e?e:z.isArray(e)?e.map(ge):String(e)}function ye(e,t,n,r,o){return z.isFunction(r)?r.call(this,t,n):(o&&(t=n),z.isString(t)?z.isString(r)?-1!==t.indexOf(r):z.isRegExp(r)?r.test(t):void 0:void 0)}var be=function(e,t){function n(e){(0,V.Z)(this,n),e&&this.set(e)}return(0,H.Z)(n,[{key:"set",value:function(e,t,n){var r=this;function o(e,t,n){var o=me(t);if(!o)throw new Error("header name must be a non-empty string");var i=z.findKey(r,o);(!i||void 0===r[i]||!0===n||void 0===n&&!1!==r[i])&&(r[i||t]=ge(e))}var i=function(e,t){return z.forEach(e,(function(e,n){return o(e,n,t)}))};return z.isPlainObject(e)||e instanceof this.constructor?i(e,t):z.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim())?i(function(e){var t,n,r,o={};return e&&e.split("\n").forEach((function(e){r=e.indexOf(":"),t=e.substring(0,r).trim().toLowerCase(),n=e.substring(r+1).trim(),!t||o[t]&&pe[t]||("set-cookie"===t?o[t]?o[t].push(n):o[t]=[n]:o[t]=o[t]?o[t]+", "+n:n)})),o}(e),t):null!=e&&o(t,e,n),this}},{key:"get",value:function(e,t){if(e=me(e)){var n=z.findKey(this,e);if(n){var r=this[n];if(!t)return r;if(!0===t)return function(e){for(var t,n=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;t=r.exec(e);)n[t[1]]=t[2];return n}(r);if(z.isFunction(t))return t.call(this,r,n);if(z.isRegExp(t))return t.exec(r);throw new TypeError("parser must be boolean|regexp|function")}}}},{key:"has",value:function(e,t){if(e=me(e)){var n=z.findKey(this,e);return!(!n||void 0===this[n]||t&&!ye(0,this[n],n,t))}return!1}},{key:"delete",value:function(e,t){var n=this,r=!1;function o(e){if(e=me(e)){var o=z.findKey(n,e);!o||t&&!ye(0,n[o],o,t)||(delete n[o],r=!0)}}return z.isArray(e)?e.forEach(o):o(e),r}},{key:"clear",value:function(e){for(var t=Object.keys(this),n=t.length,r=!1;n--;){var o=t[n];e&&!ye(0,this[o],o,e,!0)||(delete this[o],r=!0)}return r}},{key:"normalize",value:function(e){var t=this,n={};return z.forEach(this,(function(r,o){var i=z.findKey(n,o);if(i)return t[i]=ge(r),void delete t[o];var a=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(function(e,t,n){return t.toUpperCase()+n}))}(o):String(o).trim();a!==o&&delete t[o],t[a]=ge(r),n[a]=!0})),this}},{key:"concat",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return(e=this.constructor).concat.apply(e,[this].concat(n))}},{key:"toJSON",value:function(e){var t=Object.create(null);return z.forEach(this,(function(n,r){null!=n&&!1!==n&&(t[r]=e&&z.isArray(n)?n.join(", "):n)})),t}},{key:e,value:function(){return Object.entries(this.toJSON())[Symbol.iterator]()}},{key:"toString",value:function(){return Object.entries(this.toJSON()).map((function(e){var t=(0,o.Z)(e,2);return t[0]+": "+t[1]})).join("\n")}},{key:t,get:function(){return"AxiosHeaders"}}],[{key:"from",value:function(e){return e instanceof this?e:new this(e)}},{key:"concat",value:function(e){for(var t=new this(e),n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return r.forEach((function(e){return t.set(e)})),t}},{key:"accessor",value:function(e){var t=(this[ve]=this[ve]={accessors:{}}).accessors,n=this.prototype;function r(e){var r=me(e);t[r]||(!function(e,t){var n=z.toCamelCase(" "+t);["get","set","has"].forEach((function(r){Object.defineProperty(e,r+n,{value:function(e,n,o){return this[r].call(this,t,e,n,o)},configurable:!0})}))}(n,e),t[r]=!0)}return z.isArray(e)?e.forEach(r):r(e),this}}]),n}(Symbol.iterator,Symbol.toStringTag);be.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),z.reduceDescriptors(be.prototype,(function(e,t){var n=e.value,r=t[0].toUpperCase()+t.slice(1);return{get:function(){return n},set:function(e){this[r]=e}}})),z.freezeMethods(be);var we=be;function xe(e,t){var n=this||de,r=t||n,o=we.from(r.headers),i=r.data;return z.forEach(e,(function(e){i=e.call(n,i,o.normalize(),t?t.status:void 0)})),o.normalize(),i}function ke(e){return!(!e||!e.__CANCEL__)}function _e(e,t,n){X.call(this,null==e?"canceled":e,X.ERR_CANCELED,t,n),this.name="CanceledError"}z.inherits(_e,X,{__CANCEL__:!0});var Ee=_e;var Ce=le.isStandardBrowserEnv?{write:function(e,t,n,r,o,i){var a=[];a.push(e+"="+encodeURIComponent(t)),z.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),z.isString(r)&&a.push("path="+r),z.isString(o)&&a.push("domain="+o),!0===i&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}};function Se(e,t){return e&&!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)?function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}var Ie=le.isStandardBrowserEnv?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function r(e){var r=e;return t&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=r(window.location.href),function(t){var n=z.isString(t)?r(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0};var Re=function(e,t){e=e||10;var n,r=new Array(e),o=new Array(e),i=0,a=0;return t=void 0!==t?t:1e3,function(s){var u=Date.now(),c=o[a];n||(n=u),r[i]=s,o[i]=u;for(var l=a,f=0;l!==i;)f+=r[l++],l%=e;if((i=(i+1)%e)===a&&(a=(a+1)%e),!(u-n<t)){var h=c&&u-c;return h?Math.round(1e3*f/h):void 0}}};function Te(e,t){var n=0,r=Re(50,250);return function(o){var i=o.loaded,a=o.lengthComputable?o.total:void 0,s=i-n,u=r(s);n=i;var c={loaded:i,total:a,progress:a?i/a:void 0,bytes:s,rate:u||void 0,estimated:u&&a&&i<=a?(a-i)/u:void 0,event:o};c[t?"download":"upload"]=!0,e(c)}}var Ae={http:null,xhr:"undefined"!==typeof XMLHttpRequest&&function(e){return new Promise((function(t,n){var r,o=e.data,i=we.from(e.headers).normalize(),a=e.responseType;function s(){e.cancelToken&&e.cancelToken.unsubscribe(r),e.signal&&e.signal.removeEventListener("abort",r)}z.isFormData(o)&&(le.isStandardBrowserEnv||le.isStandardBrowserWebWorkerEnv?i.setContentType(!1):i.setContentType("multipart/form-data;",!1));var u=new XMLHttpRequest;if(e.auth){var c=e.auth.username||"",l=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";i.set("Authorization","Basic "+btoa(c+":"+l))}var f=Se(e.baseURL,e.url);function h(){if(u){var r=we.from("getAllResponseHeaders"in u&&u.getAllResponseHeaders());!function(e,t,n){var r=n.config.validateStatus;n.status&&r&&!r(n.status)?t(new X("Request failed with status code "+n.status,[X.ERR_BAD_REQUEST,X.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):e(n)}((function(e){t(e),s()}),(function(e){n(e),s()}),{data:a&&"text"!==a&&"json"!==a?u.response:u.responseText,status:u.status,statusText:u.statusText,headers:r,config:e,request:u}),u=null}}if(u.open(e.method.toUpperCase(),ae(f,e.params,e.paramsSerializer),!0),u.timeout=e.timeout,"onloadend"in u?u.onloadend=h:u.onreadystatechange=function(){u&&4===u.readyState&&(0!==u.status||u.responseURL&&0===u.responseURL.indexOf("file:"))&&setTimeout(h)},u.onabort=function(){u&&(n(new X("Request aborted",X.ECONNABORTED,e,u)),u=null)},u.onerror=function(){n(new X("Network Error",X.ERR_NETWORK,e,u)),u=null},u.ontimeout=function(){var t=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded",r=e.transitional||ce;e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),n(new X(t,r.clarifyTimeoutError?X.ETIMEDOUT:X.ECONNABORTED,e,u)),u=null},le.isStandardBrowserEnv){var d=(e.withCredentials||Ie(f))&&e.xsrfCookieName&&Ce.read(e.xsrfCookieName);d&&i.set(e.xsrfHeaderName,d)}void 0===o&&i.setContentType(null),"setRequestHeader"in u&&z.forEach(i.toJSON(),(function(e,t){u.setRequestHeader(t,e)})),z.isUndefined(e.withCredentials)||(u.withCredentials=!!e.withCredentials),a&&"json"!==a&&(u.responseType=e.responseType),"function"===typeof e.onDownloadProgress&&u.addEventListener("progress",Te(e.onDownloadProgress,!0)),"function"===typeof e.onUploadProgress&&u.upload&&u.upload.addEventListener("progress",Te(e.onUploadProgress)),(e.cancelToken||e.signal)&&(r=function(t){u&&(n(!t||t.type?new Ee(null,e,u):t),u.abort(),u=null)},e.cancelToken&&e.cancelToken.subscribe(r),e.signal&&(e.signal.aborted?r():e.signal.addEventListener("abort",r)));var p=function(e){var t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(f);p&&-1===le.protocols.indexOf(p)?n(new X("Unsupported protocol "+p+":",X.ERR_BAD_REQUEST,e)):u.send(o||null)}))}};z.forEach(Ae,(function(e,t){if(e){try{Object.defineProperty(e,"name",{value:t})}catch(Fn){}Object.defineProperty(e,"adapterName",{value:t})}}));var Ne=function(e){for(var t,n,r=(e=z.isArray(e)?e:[e]).length,o=0;o<r&&(t=e[o],!(n=z.isString(t)?Ae[t.toLowerCase()]:t));o++);if(!n){if(!1===n)throw new X("Adapter ".concat(t," is not supported by the environment"),"ERR_NOT_SUPPORT");throw new Error(z.hasOwnProp(Ae,t)?"Adapter '".concat(t,"' is not available in the build"):"Unknown adapter '".concat(t,"'"))}if(!z.isFunction(n))throw new TypeError("adapter is not a function");return n};function Oe(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Ee(null,e)}function De(e){return Oe(e),e.headers=we.from(e.headers),e.data=xe.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Ne(e.adapter||de.adapter)(e).then((function(t){return Oe(e),t.data=xe.call(e,e.transformResponse,t),t.headers=we.from(t.headers),t}),(function(t){return ke(t)||(Oe(e),t&&t.response&&(t.response.data=xe.call(e,e.transformResponse,t.response),t.response.headers=we.from(t.response.headers))),Promise.reject(t)}))}var Pe=function(e){return e instanceof we?e.toJSON():e};function Me(e,t){t=t||{};var n={};function r(e,t,n){return z.isPlainObject(e)&&z.isPlainObject(t)?z.merge.call({caseless:n},e,t):z.isPlainObject(t)?z.merge({},t):z.isArray(t)?t.slice():t}function o(e,t,n){return z.isUndefined(t)?z.isUndefined(e)?void 0:r(void 0,e,n):r(e,t,n)}function i(e,t){if(!z.isUndefined(t))return r(void 0,t)}function a(e,t){return z.isUndefined(t)?z.isUndefined(e)?void 0:r(void 0,e):r(void 0,t)}function s(n,o,i){return i in t?r(n,o):i in e?r(void 0,n):void 0}var u={url:i,method:i,data:i,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:s,headers:function(e,t){return o(Pe(e),Pe(t),!0)}};return z.forEach(Object.keys(Object.assign({},e,t)),(function(r){var i=u[r]||o,a=i(e[r],t[r],r);z.isUndefined(a)&&i!==s||(n[r]=a)})),n}var Fe="1.5.0",Le={};["object","boolean","number","function","string","symbol"].forEach((function(e,t){Le[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}}));var Be={};Le.transitional=function(e,t,n){function r(e,t){return"[Axios v1.5.0] Transitional option '"+e+"'"+t+(n?". "+n:"")}return function(n,o,i){if(!1===e)throw new X(r(o," has been removed"+(t?" in "+t:"")),X.ERR_DEPRECATED);return t&&!Be[o]&&(Be[o]=!0,console.warn(r(o," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,o,i)}};var Ue={assertOptions:function(e,t,n){if("object"!==typeof e)throw new X("options must be an object",X.ERR_BAD_OPTION_VALUE);for(var r=Object.keys(e),o=r.length;o-- >0;){var i=r[o],a=t[i];if(a){var s=e[i],u=void 0===s||a(s,i,e);if(!0!==u)throw new X("option "+i+" must be "+u,X.ERR_BAD_OPTION_VALUE)}else if(!0!==n)throw new X("Unknown option "+i,X.ERR_BAD_OPTION)}},validators:Le},je=Ue.validators,Ze=function(){function e(t){(0,V.Z)(this,e),this.defaults=t,this.interceptors={request:new ue,response:new ue}}return(0,H.Z)(e,[{key:"request",value:function(e,t){"string"===typeof e?(t=t||{}).url=e:t=e||{};var n=t=Me(this.defaults,t),r=n.transitional,o=n.paramsSerializer,i=n.headers;void 0!==r&&Ue.assertOptions(r,{silentJSONParsing:je.transitional(je.boolean),forcedJSONParsing:je.transitional(je.boolean),clarifyTimeoutError:je.transitional(je.boolean)},!1),null!=o&&(z.isFunction(o)?t.paramsSerializer={serialize:o}:Ue.assertOptions(o,{encode:je.function,serialize:je.function},!0)),t.method=(t.method||this.defaults.method||"get").toLowerCase();var a=i&&z.merge(i.common,i[t.method]);i&&z.forEach(["delete","get","head","post","put","patch","common"],(function(e){delete i[e]})),t.headers=we.concat(a,i);var s=[],u=!0;this.interceptors.request.forEach((function(e){"function"===typeof e.runWhen&&!1===e.runWhen(t)||(u=u&&e.synchronous,s.unshift(e.fulfilled,e.rejected))}));var c,l=[];this.interceptors.response.forEach((function(e){l.push(e.fulfilled,e.rejected)}));var f,h=0;if(!u){var d=[De.bind(this),void 0];for(d.unshift.apply(d,s),d.push.apply(d,l),f=d.length,c=Promise.resolve(t);h<f;)c=c.then(d[h++],d[h++]);return c}f=s.length;var p=t;for(h=0;h<f;){var v=s[h++],m=s[h++];try{p=v(p)}catch(g){m.call(this,g);break}}try{c=De.call(this,p)}catch(g){return Promise.reject(g)}for(h=0,f=l.length;h<f;)c=c.then(l[h++],l[h++]);return c}},{key:"getUri",value:function(e){return ae(Se((e=Me(this.defaults,e)).baseURL,e.url),e.params,e.paramsSerializer)}}]),e}();z.forEach(["delete","get","head","options"],(function(e){Ze.prototype[e]=function(t,n){return this.request(Me(n||{},{method:e,url:t,data:(n||{}).data}))}})),z.forEach(["post","put","patch"],(function(e){function t(t){return function(n,r,o){return this.request(Me(o||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:n,data:r}))}}Ze.prototype[e]=t(),Ze.prototype[e+"Form"]=t(!0)}));var We=Ze,ze=function(){function e(t){if((0,V.Z)(this,e),"function"!==typeof t)throw new TypeError("executor must be a function.");var n;this.promise=new Promise((function(e){n=e}));var r=this;this.promise.then((function(e){if(r._listeners){for(var t=r._listeners.length;t-- >0;)r._listeners[t](e);r._listeners=null}})),this.promise.then=function(e){var t,n=new Promise((function(e){r.subscribe(e),t=e})).then(e);return n.cancel=function(){r.unsubscribe(t)},n},t((function(e,t,o){r.reason||(r.reason=new Ee(e,t,o),n(r.reason))}))}return(0,H.Z)(e,[{key:"throwIfRequested",value:function(){if(this.reason)throw this.reason}},{key:"subscribe",value:function(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}},{key:"unsubscribe",value:function(e){if(this._listeners){var t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}}}],[{key:"source",value:function(){var t,n=new e((function(e){t=e}));return{token:n,cancel:t}}}]),e}(),Ve=ze;var He={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(He).forEach((function(e){var t=(0,o.Z)(e,2),n=t[0],r=t[1];He[r]=n}));var qe=He;var Ge=function e(t){var n=new We(t),r=c(We.prototype.request,n);return z.extend(r,We.prototype,n,{allOwnKeys:!0}),z.extend(r,n,null,{allOwnKeys:!0}),r.create=function(n){return e(Me(t,n))},r}(de);Ge.Axios=We,Ge.CanceledError=Ee,Ge.CancelToken=Ve,Ge.isCancel=ke,Ge.VERSION=Fe,Ge.toFormData=ee,Ge.AxiosError=X,Ge.Cancel=Ge.CanceledError,Ge.all=function(e){return Promise.all(e)},Ge.spread=function(e){return function(t){return e.apply(null,t)}},Ge.isAxiosError=function(e){return z.isObject(e)&&!0===e.isAxiosError},Ge.mergeConfig=Me,Ge.AxiosHeaders=we,Ge.formToJSON=function(e){return fe(z.isHTMLForm(e)?new FormData(e):e)},Ge.getAdapter=Ne,Ge.HttpStatusCode=qe,Ge.default=Ge;var Ke=Ge,Xe=n(3433),$e=n(136),Ye=n(7277),Qe=n(8737),Je=n(3878),et=n(9199),tt=n(181),nt=n(5267);var rt,ot=n(7762);function it(){return it=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},it.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(rt||(rt={}));var at,st="popstate";function ut(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function ct(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(Fn){}}}function lt(e,t){return{usr:e.state,key:e.key,idx:t}}function ft(e,t,n,r){return void 0===n&&(n=null),it({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?dt(t):t,{state:n,key:t&&t.key||r||Math.random().toString(36).substr(2,8)})}function ht(e){var t=e.pathname,n=void 0===t?"/":t,r=e.search,o=void 0===r?"":r,i=e.hash,a=void 0===i?"":i;return o&&"?"!==o&&(n+="?"===o.charAt(0)?o:"?"+o),a&&"#"!==a&&(n+="#"===a.charAt(0)?a:"#"+a),n}function dt(e){var t={};if(e){var n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));var r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function pt(e,t,n,r){void 0===r&&(r={});var o=r,i=o.window,a=void 0===i?document.defaultView:i,s=o.v5Compat,u=void 0!==s&&s,c=a.history,l=rt.Pop,f=null,h=d();function d(){return(c.state||{idx:null}).idx}function p(){l=rt.Pop;var e=d(),t=null==e?null:e-h;h=e,f&&f({action:l,location:m.location,delta:t})}function v(e){var t="null"!==a.location.origin?a.location.origin:a.location.href,n="string"===typeof e?e:ht(e);return ut(t,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,t)}null==h&&(h=0,c.replaceState(it({},c.state,{idx:h}),""));var m={get action(){return l},get location(){return e(a,c)},listen:function(e){if(f)throw new Error("A history only accepts one active listener");return a.addEventListener(st,p),f=e,function(){a.removeEventListener(st,p),f=null}},createHref:function(e){return t(a,e)},createURL:v,encodeLocation:function(e){var t=v(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){l=rt.Push;var r=ft(m.location,e,t);n&&n(r,e);var o=lt(r,h=d()+1),i=m.createHref(r);try{c.pushState(o,"",i)}catch(s){if(s instanceof DOMException&&"DataCloneError"===s.name)throw s;a.location.assign(i)}u&&f&&f({action:l,location:m.location,delta:1})},replace:function(e,t){l=rt.Replace;var r=ft(m.location,e,t);n&&n(r,e);var o=lt(r,h=d()),i=m.createHref(r);c.replaceState(o,"",i),u&&f&&f({action:l,location:m.location,delta:0})},go:function(e){return c.go(e)}};return m}!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(at||(at={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function vt(e,t,n){void 0===n&&(n="/");var r=Tt(("string"===typeof t?dt(t):t).pathname||"/",n);if(null==r)return null;var o=mt(e);!function(e){e.sort((function(e,t){return e.score!==t.score?t.score-e.score:function(e,t){var n=e.length===t.length&&e.slice(0,-1).every((function(e,n){return e===t[n]}));return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((function(e){return e.childrenIndex})),t.routesMeta.map((function(e){return e.childrenIndex})))}))}(o);for(var i=null,a=0;null==i&&a<o.length;++a)i=St(o[a],Rt(r));return i}function mt(e,t,n,r){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===r&&(r="");var o=function(e,o,i){var a={relativePath:void 0===i?e.path||"":i,caseSensitive:!0===e.caseSensitive,childrenIndex:o,route:e};a.relativePath.startsWith("/")&&(ut(a.relativePath.startsWith(r),'Absolute route path "'+a.relativePath+'" nested under path "'+r+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),a.relativePath=a.relativePath.slice(r.length));var s=Dt([r,a.relativePath]),u=n.concat(a);e.children&&e.children.length>0&&(ut(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+s+'".'),mt(e.children,t,u,s)),(null!=e.path||e.index)&&t.push({path:s,score:Ct(s,e.index),routesMeta:u})};return e.forEach((function(e,t){var n;if(""!==e.path&&null!=(n=e.path)&&n.includes("?")){var r,i=(0,ot.Z)(gt(e.path));try{for(i.s();!(r=i.n()).done;){var a=r.value;o(e,t,a)}}catch(s){i.e(s)}finally{i.f()}}else o(e,t)})),t}function gt(e){var t=e.split("/");if(0===t.length)return[];var n,r=(n=t,(0,Je.Z)(n)||(0,et.Z)(n)||(0,tt.Z)(n)||(0,nt.Z)()),o=r[0],i=r.slice(1),a=o.endsWith("?"),s=o.replace(/\?$/,"");if(0===i.length)return a?[s,""]:[s];var u=gt(i.join("/")),c=[];return c.push.apply(c,(0,Xe.Z)(u.map((function(e){return""===e?s:[s,e].join("/")})))),a&&c.push.apply(c,(0,Xe.Z)(u)),c.map((function(t){return e.startsWith("/")&&""===t?"/":t}))}var yt=/^:\w+$/,bt=3,wt=2,xt=1,kt=10,_t=-2,Et=function(e){return"*"===e};function Ct(e,t){var n=e.split("/"),r=n.length;return n.some(Et)&&(r+=_t),t&&(r+=wt),n.filter((function(e){return!Et(e)})).reduce((function(e,t){return e+(yt.test(t)?bt:""===t?xt:kt)}),r)}function St(e,t){for(var n=e.routesMeta,r={},o="/",i=[],a=0;a<n.length;++a){var s=n[a],u=a===n.length-1,c="/"===o?t:t.slice(o.length)||"/",l=It({path:s.relativePath,caseSensitive:s.caseSensitive,end:u},c);if(!l)return null;Object.assign(r,l.params);var f=s.route;i.push({params:r,pathname:Dt([o,l.pathname]),pathnameBase:Pt(Dt([o,l.pathnameBase])),route:f}),"/"!==l.pathnameBase&&(o=Dt([o,l.pathnameBase]))}return i}function It(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});var n=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);ct("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');var r=[],o="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(function(e,t){return r.push(t),"/([^\\/]+)"}));e.endsWith("*")?(r.push("*"),o+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?o+="\\/*$":""!==e&&"/"!==e&&(o+="(?:(?=\\/|$))");var i=new RegExp(o,t?void 0:"i");return[i,r]}(e.path,e.caseSensitive,e.end),r=(0,o.Z)(n,2),i=r[0],a=r[1],s=t.match(i);if(!s)return null;var u=s[0],c=u.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:a.reduce((function(e,t,n){if("*"===t){var r=l[n]||"";c=u.slice(0,u.length-r.length).replace(/(.)\/+$/,"$1")}return e[t]=function(e,t){try{return decodeURIComponent(e)}catch(n){return ct(!1,'The value for the URL param "'+t+'" will not be decoded because the string "'+e+'" is a malformed URL segment. This is probably due to a bad percent encoding ('+n+")."),e}}(l[n]||"",t),e}),{}),pathname:u,pathnameBase:c,pattern:e}}function Rt(e){try{return decodeURI(e)}catch(t){return ct(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function Tt(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;var n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}function At(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function Nt(e){return e.filter((function(e,t){return 0===t||e.route.path&&e.route.path.length>0}))}function Ot(e,t,n,r){var o;void 0===r&&(r=!1),"string"===typeof e?o=dt(e):(ut(!(o=it({},e)).pathname||!o.pathname.includes("?"),At("?","pathname","search",o)),ut(!o.pathname||!o.pathname.includes("#"),At("#","pathname","hash",o)),ut(!o.search||!o.search.includes("#"),At("#","search","hash",o)));var i,a=""===e||""===o.pathname,s=a?"/":o.pathname;if(r||null==s)i=n;else{var u=t.length-1;if(s.startsWith("..")){for(var c=s.split("/");".."===c[0];)c.shift(),u-=1;o.pathname=c.join("/")}i=u>=0?t[u]:"/"}var l=function(e,t){void 0===t&&(t="/");var n="string"===typeof e?dt(e):e,r=n.pathname,o=n.search,i=void 0===o?"":o,a=n.hash,s=void 0===a?"":a,u=r?r.startsWith("/")?r:function(e,t){var n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((function(e){".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)})),n.length>1?n.join("/"):"/"}(r,t):t;return{pathname:u,search:Mt(i),hash:Ft(s)}}(o,i),f=s&&"/"!==s&&s.endsWith("/"),h=(a||"."===s)&&n.endsWith("/");return l.pathname.endsWith("/")||!f&&!h||(l.pathname+="/"),l}var Dt=function(e){return e.join("/").replace(/\/\/+/g,"/")},Pt=function(e){return e.replace(/\/+$/,"").replace(/^\/*/,"/")},Mt=function(e){return e&&"?"!==e?e.startsWith("?")?e:"?"+e:""},Ft=function(e){return e&&"#"!==e?e.startsWith("#")?e:"#"+e:""},Lt=function(e){(0,$e.Z)(n,e);var t=(0,Ye.Z)(n);function n(){return(0,V.Z)(this,n),t.apply(this,arguments)}return(0,H.Z)(n)}((0,Qe.Z)(Error));function Bt(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}var Ut=["post","put","patch","delete"],jt=(new Set(Ut),["get"].concat(Ut));new Set(jt),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function Zt(){return Zt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Zt.apply(this,arguments)}var Wt=e.createContext(null);var zt=e.createContext(null);var Vt=e.createContext(null);var Ht=e.createContext(null);var qt=e.createContext(null);var Gt=e.createContext({outlet:null,matches:[],isDataRoute:!1});var Kt=e.createContext(null);function Xt(){return null!=e.useContext(qt)}function $t(){return Xt()||ut(!1),e.useContext(qt).location}function Yt(t){e.useContext(Ht).static||e.useLayoutEffect(t)}function Qt(){return e.useContext(Gt).isDataRoute?function(){var t=un(an.UseNavigateStable).router,n=ln(sn.UseNavigateStable),r=e.useRef(!1);Yt((function(){r.current=!0}));var o=e.useCallback((function(e,o){void 0===o&&(o={}),r.current&&("number"===typeof e?t.navigate(e):t.navigate(e,Zt({fromRouteId:n},o)))}),[t,n]);return o}():function(){Xt()||ut(!1);var t=e.useContext(Wt),n=e.useContext(Ht),r=n.basename,o=n.navigator,i=e.useContext(Gt).matches,a=$t().pathname,s=JSON.stringify(Nt(i).map((function(e){return e.pathnameBase}))),u=e.useRef(!1);Yt((function(){u.current=!0}));var c=e.useCallback((function(e,n){if(void 0===n&&(n={}),u.current)if("number"!==typeof e){var i=Ot(e,JSON.parse(s),a,"path"===n.relative);null==t&&"/"!==r&&(i.pathname="/"===i.pathname?r:Dt([r,i.pathname])),(n.replace?o.replace:o.push)(i,n.state,n)}else o.go(e)}),[r,o,s,a,t]);return c}()}function Jt(t,n,r){Xt()||ut(!1);var o,i=e.useContext(Ht).navigator,a=e.useContext(Gt).matches,s=a[a.length-1],u=s?s.params:{},c=(s&&s.pathname,s?s.pathnameBase:"/"),l=(s&&s.route,$t());if(n){var f,h="string"===typeof n?dt(n):n;"/"===c||(null==(f=h.pathname)?void 0:f.startsWith(c))||ut(!1),o=h}else o=l;var d=o.pathname||"/",p=vt(t,{pathname:"/"===c?d:d.slice(c.length)||"/"});var v=on(p&&p.map((function(e){return Object.assign({},e,{params:Object.assign({},u,e.params),pathname:Dt([c,i.encodeLocation?i.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?c:Dt([c,i.encodeLocation?i.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})})),a,r);return n&&v?e.createElement(qt.Provider,{value:{location:Zt({pathname:"/",search:"",hash:"",state:null,key:"default"},o),navigationType:rt.Pop}},v):v}function en(){var t=function(){var t,n=e.useContext(Kt),r=cn(sn.UseRouteError),o=ln(sn.UseRouteError);if(n)return n;return null==(t=r.errors)?void 0:t[o]}(),n=Bt(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,o="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:o};return e.createElement(e.Fragment,null,e.createElement("h2",null,"Unexpected Application Error!"),e.createElement("h3",{style:{fontStyle:"italic"}},n),r?e.createElement("pre",{style:i},r):null,null)}var tn=e.createElement(en,null),nn=function(t){(0,$e.Z)(r,t);var n=(0,Ye.Z)(r);function r(e){var t;return(0,V.Z)(this,r),(t=n.call(this,e)).state={location:e.location,revalidation:e.revalidation,error:e.error},t}return(0,H.Z)(r,[{key:"componentDidCatch",value:function(e,t){console.error("React Router caught the following error during render",e,t)}},{key:"render",value:function(){return this.state.error?e.createElement(Gt.Provider,{value:this.props.routeContext},e.createElement(Kt.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{error:e}}},{key:"getDerivedStateFromProps",value:function(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error||t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}}]),r}(e.Component);function rn(t){var n=t.routeContext,r=t.match,o=t.children,i=e.useContext(Wt);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),e.createElement(Gt.Provider,{value:n},o)}function on(t,n,r){var o;if(void 0===n&&(n=[]),void 0===r&&(r=null),null==t){var i;if(null==(i=r)||!i.errors)return null;t=r.matches}var a=t,s=null==(o=r)?void 0:o.errors;if(null!=s){var u=a.findIndex((function(e){return e.route.id&&(null==s?void 0:s[e.route.id])}));u>=0||ut(!1),a=a.slice(0,Math.min(a.length,u+1))}return a.reduceRight((function(t,o,i){var u=o.route.id?null==s?void 0:s[o.route.id]:null,c=null;r&&(c=o.route.errorElement||tn);var l=n.concat(a.slice(0,i+1)),f=function(){var n;return n=u?c:o.route.Component?e.createElement(o.route.Component,null):o.route.element?o.route.element:t,e.createElement(rn,{match:o,routeContext:{outlet:t,matches:l,isDataRoute:null!=r},children:n})};return r&&(o.route.ErrorBoundary||o.route.errorElement||0===i)?e.createElement(nn,{location:r.location,revalidation:r.revalidation,component:c,error:u,children:f(),routeContext:{outlet:null,matches:l,isDataRoute:!0}}):f()}),null)}var an=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(an||{}),sn=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(sn||{});function un(t){var n=e.useContext(Wt);return n||ut(!1),n}function cn(t){var n=e.useContext(zt);return n||ut(!1),n}function ln(t){var n=function(t){var n=e.useContext(Gt);return n||ut(!1),n}(),r=n.matches[n.matches.length-1];return r.route.id||ut(!1),r.route.id}t.startTransition;function fn(e){ut(!1)}function hn(t){var n=t.basename,r=void 0===n?"/":n,o=t.children,i=void 0===o?null:o,a=t.location,s=t.navigationType,u=void 0===s?rt.Pop:s,c=t.navigator,l=t.static,f=void 0!==l&&l;Xt()&&ut(!1);var h=r.replace(/^\/*/,"/"),d=e.useMemo((function(){return{basename:h,navigator:c,static:f}}),[h,c,f]);"string"===typeof a&&(a=dt(a));var p=a,v=p.pathname,m=void 0===v?"/":v,g=p.search,y=void 0===g?"":g,b=p.hash,w=void 0===b?"":b,x=p.state,k=void 0===x?null:x,_=p.key,E=void 0===_?"default":_,C=e.useMemo((function(){var e=Tt(m,h);return null==e?null:{location:{pathname:e,search:y,hash:w,state:k,key:E},navigationType:u}}),[h,m,y,w,k,E,u]);return null==C?null:e.createElement(Ht.Provider,{value:d},e.createElement(qt.Provider,{children:i,value:C}))}function dn(e){var t=e.children,n=e.location;return Jt(mn(t),n)}var pn=function(e){return e[e.pending=0]="pending",e[e.success=1]="success",e[e.error=2]="error",e}(pn||{}),vn=new Promise((function(){}));e.Component;function mn(t,n){void 0===n&&(n=[]);var r=[];return e.Children.forEach(t,(function(t,o){if(e.isValidElement(t)){var i=[].concat((0,Xe.Z)(n),[o]);if(t.type!==e.Fragment){t.type!==fn&&ut(!1),t.props.index&&t.props.children&&ut(!1);var a={id:t.props.id||i.join("-"),caseSensitive:t.props.caseSensitive,element:t.props.element,Component:t.props.Component,index:t.props.index,path:t.props.path,loader:t.props.loader,action:t.props.action,errorElement:t.props.errorElement,ErrorBoundary:t.props.ErrorBoundary,hasErrorBoundary:null!=t.props.ErrorBoundary||null!=t.props.errorElement,shouldRevalidate:t.props.shouldRevalidate,handle:t.props.handle,lazy:t.props.lazy};t.props.children&&(a.children=mn(t.props.children,i)),r.push(a)}else r.push.apply(r,mn(t.props.children,i))}})),r}var gn=n(9702);function yn(e,t){void 0===t&&(t={});var n=function(e){if(e&&"j"===e[0]&&":"===e[1])return e.substr(2);return e}(e);if(function(e,t){return"undefined"===typeof t&&(t=!e||"{"!==e[0]&&"["!==e[0]&&'"'!==e[0]),!t}(n,t.doNotParse))try{return JSON.parse(n)}catch(Fn){}return e}var bn=function(){return bn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},bn.apply(this,arguments)},wn=function(){function e(e,t){var n=this;this.changeListeners=[],this.HAS_DOCUMENT_COOKIE=!1,this.cookies=function(e,t){return"string"===typeof e?gn.Q(e,t):"object"===typeof e&&null!==e?e:{}}(e,t),new Promise((function(){n.HAS_DOCUMENT_COOKIE="object"===typeof document&&"string"===typeof document.cookie})).catch((function(){}))}return e.prototype._updateBrowserValues=function(e){this.HAS_DOCUMENT_COOKIE&&(this.cookies=gn.Q(document.cookie,e))},e.prototype._emitChange=function(e){for(var t=0;t<this.changeListeners.length;++t)this.changeListeners[t](e)},e.prototype.get=function(e,t,n){return void 0===t&&(t={}),this._updateBrowserValues(n),yn(this.cookies[e],t)},e.prototype.getAll=function(e,t){void 0===e&&(e={}),this._updateBrowserValues(t);var n={};for(var r in this.cookies)n[r]=yn(this.cookies[r],e);return n},e.prototype.set=function(e,t,n){var r;"object"===typeof t&&(t=JSON.stringify(t)),this.cookies=bn(bn({},this.cookies),((r={})[e]=t,r)),this.HAS_DOCUMENT_COOKIE&&(document.cookie=gn.q(e,t,n)),this._emitChange({name:e,value:t,options:n})},e.prototype.remove=function(e,t){var n=t=bn(bn({},t),{expires:new Date(1970,1,1,0,0,1),maxAge:0});this.cookies=bn({},this.cookies),delete this.cookies[e],this.HAS_DOCUMENT_COOKIE&&(document.cookie=gn.q(e,"",n)),this._emitChange({name:e,value:void 0,options:t})},e.prototype.addChangeListener=function(e){this.changeListeners.push(e)},e.prototype.removeChangeListener=function(e){var t=this.changeListeners.indexOf(e);t>=0&&this.changeListeners.splice(t,1)},e}(),xn=wn,kn=e.createContext(new xn),_n=(kn.Provider,kn.Consumer,kn);function En(t){var n=(0,e.useContext)(_n);if(!n)throw new Error("Missing <CookiesProvider>");var r=n.getAll(),o=(0,e.useState)(r),i=o[0],a=o[1],s=(0,e.useRef)(i);return"undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement&&(0,e.useLayoutEffect)((function(){function e(){var e=n.getAll();(function(e,t,n){if(!e)return!0;for(var r=0,o=e;r<o.length;r++){var i=o[r];if(t[i]!==n[i])return!0}return!1})(t||null,e,s.current)&&a(e),s.current=e}return n.addChangeListener(e),function(){n.removeChangeListener(e)}}),[n]),[i,(0,e.useMemo)((function(){return n.set.bind(n)}),[n]),(0,e.useMemo)((function(){return n.remove.bind(n)}),[n])]}var Cn=function(t){var n=t.setShowModal,r=t.isSignUp,a=(0,e.useState)(null),c=(0,o.Z)(a,2),l=c[0],f=c[1],h=(0,e.useState)(null),d=(0,o.Z)(h,2),p=d[0],v=d[1],m=(0,e.useState)(null),g=(0,o.Z)(m,2),y=g[0],b=g[1],w=(0,e.useState)(null),x=(0,o.Z)(w,2),k=x[0],_=x[1],E=En(null),C=(0,o.Z)(E,3),S=(C[0],C[1]),I=(C[2],Qt());console.log(l,p,y);var R=function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var n,o;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),e.prev=1,!r||p===y){e.next=5;break}return _("Passwords need to match!"),e.abrupt("return");case 5:return e.next=7,Ke.post("https://tindoor-server.onrender.com/".concat(r?"signup":"login"),{email:l,password:p});case 7:n=e.sent,S("AuthToken",n.data.token),S("UserId",n.data.userId),(o=201===n.status)&&r&&I("/onboarding"),o&&!r&&I("/dashboard"),window.location.reload(),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(1),console.log(e.t0);case 19:case"end":return e.stop()}}),e,null,[[1,16]])})));return function(t){return e.apply(this,arguments)}}();return(0,i.jsxs)("div",{className:"auth-modal",children:[(0,i.jsx)("div",{className:"close-icon",onClick:function(){n(!1)},children:"\u24e7"}),(0,i.jsx)("h2",{children:r?"CREATE ACCOUNT":"LOG IN"}),(0,i.jsx)("p",{children:"By clicking Log In, you agree to our terms. Learn how we process your data in our Privacy Policy and Cookie Policy."}),(0,i.jsxs)("form",{onSubmit:R,children:[(0,i.jsx)("input",{type:"email",id:"email",name:"email",placeholder:"email",required:!0,onChange:function(e){return f(e.target.value)}}),(0,i.jsx)("input",{type:"password",id:"password",name:"password",placeholder:"password",required:!0,onChange:function(e){return v(e.target.value)}}),r&&(0,i.jsx)("input",{type:"password",id:"password-check",name:"password-check",placeholder:"confirm password",required:!0,onChange:function(e){return b(e.target.value)}}),(0,i.jsx)("input",{className:"secondary-button",type:"submit"}),(0,i.jsx)("p",{children:k})]}),(0,i.jsx)("hr",{}),(0,i.jsx)("h2",{children:"GET THE APP"})]})},Sn=function(){var t=(0,e.useState)(!1),n=(0,o.Z)(t,2),r=n[0],s=n[1],u=(0,e.useState)(!0),c=(0,o.Z)(u,2),l=c[0],f=c[1],h=En(["user"]),d=(0,o.Z)(h,3),p=d[0],v=(d[1],d[2]),m=p.AuthToken;return(0,i.jsxs)("div",{className:"overlay",children:[(0,i.jsx)(a,{authToken:m,minimal:!1,setShowModal:s,showModal:r,setIsSignUp:f}),(0,i.jsxs)("div",{className:"home",children:[(0,i.jsx)("h1",{className:"primary-title",children:"Swine Right"}),(0,i.jsx)("h2",{children:"The Tinder for Ugly People "}),(0,i.jsx)("button",{className:"primary-button",onClick:function(){if(m)return v("UserId",p.UserId),v("AuthToken",p.AuthToken),void window.location.reload();s(!0),f(!0)},children:m?"Signout":"Create Account"}),r&&(0,i.jsx)(Cn,{setShowModal:s,isSignUp:l})]}),(0,i.jsxs)("div",{className:"credit",children:["Created by ",(0,i.jsx)("a",{href:"https://www.youtube.com/@odddirector",children:"Odddirector"}),", based on a Tinder Clone by ",(0,i.jsx)("a",{href:"https://www.youtube.com/@AniaKubow",children:"Ania Kubow"})]})]})},In=n(8892),Rn=n.n(In),Tn=function(){var e=function(e){window.location.href=e},t=function(e){1==e?window.alert("It's just an octopus being thrown out of the window."):2==e&&window.alert("It's just a man with a moustache walking away from an explosion")},n=function(e,t){var n=".png";return window.location.pathname==t?e+"_active"+n:e+n};return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("div",{className:"menuButtons",children:(0,i.jsxs)("div",{className:"widthLimitWrapper",children:[(0,i.jsx)("img",{src:n("/icons/menu_button_1","/dashboard"),className:"menuButton",onClick:function(){return e("/dashboard")}}),(0,i.jsx)("img",{src:"/icons/menu_button_2.png",className:"menuButton",onClick:function(){return t(1)}}),(0,i.jsx)("img",{src:"/icons/menu_button_3.png",className:"menuButton",onClick:function(){return t(2)}}),(0,i.jsx)("img",{src:n("/icons/menu_button_4","/chat"),onClick:function(){return e("/chat")},className:"menuButton"}),(0,i.jsx)("img",{src:n("/icons/menu_button_5","/onboarding"),className:"menuButton",onClick:function(){return e("/onboarding")}})]})})})},An=function(){var t=(0,e.useState)(null),n=(0,o.Z)(t,2),r=n[0],a=n[1],c=(0,e.useState)(null),l=(0,o.Z)(c,2),f=l[0],h=l[1],d=(0,e.useState)(),p=(0,o.Z)(d,2),v=(p[0],p[1]),m=En(["user"]),g=(0,o.Z)(m,3),y=g[0],b=(g[1],g[2],(0,e.useState)([])),w=(0,o.Z)(b,2),x=w[0],k=w[1],_=(0,e.useState)([]),E=(0,o.Z)(_,2),C=E[0],S=E[1],I=y.UserId,R=function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ke.get("https://tindoor-server.onrender.com/user",{params:{userId:I}});case 3:t=e.sent,a(t.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),T=function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ke.get("https://tindoor-server.onrender.com/gendered-users",{params:{gender:null===r||void 0===r?void 0:r.gender_interest}});case 3:t=e.sent,h(t.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();(0,e.useEffect)((function(){R()}),[]),(0,e.useEffect)((function(){r&&T()}),[r]);var A=function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ke.put("https://tindoor-server.onrender.com/addmatch",{userId:I,matchedUserId:t});case 3:R(),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.log(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),N=function(e){return(new Date).getFullYear()-e.dob_year},O=function(e){switch(e){case 1:window.alert("No, you don't need to see this again.");break;case 2:window.alert("Jesus, who uses these?! Swipe!");break;case 3:console.log("case 3");var t=Math.floor(Math.random()*window.innerWidth),n=Math.floor(Math.random()*window.innerHeight);k(x.concat((0,i.jsx)("div",{className:"wtfElementThree",style:{left:t+"px",top:n+"px"},children:"\ud83e\udd94"},x.length)));break;case 4:window.alert("God! Just swipe right, will you?")}if(5==e){var r="&#127"+(s=789,u=876,s=Math.ceil(s),u=Math.floor(u),Math.floor(Math.random()*(u-s+1))+s+";");console.log(r);var o=Math.floor(Math.random()*window.innerWidth),a=Math.floor(Math.random()*window.innerHeight);S(C.concat((0,i.jsx)("div",{className:"wtfElementsFour",style:{left:o+"px",top:a+"px"},dangerouslySetInnerHTML:{__html:r}},C.length+"four")))}var s,u},D=null===r||void 0===r?void 0:r.matches.map((function(e){return e.user_id})).concat(I),P=null===f||void 0===f?void 0:f.filter((function(e){return!D.includes(e.user_id)}));return console.log("filteredGenderedUsers ",P),(0,i.jsx)(i.Fragment,{children:r&&(0,i.jsxs)("div",{className:"dashboard",children:[x,C,(0,i.jsx)("div",{className:"logoContainer",children:(0,i.jsx)("img",{src:"/logo.png"})}),(0,i.jsx)("div",{className:"swipe-container",children:(0,i.jsxs)("div",{className:"card-container",children:[null===P||void 0===P?void 0:P.map((function(e){return(0,i.jsx)(Rn(),{className:"swipe",onSwipe:function(t){return n=t,r=e.user_id,"right"===n&&A(r),void v(n);var n,r},onCardLeftScreen:function(){return t=e.first_name,void console.log(t+" left the screen!");var t},children:(0,i.jsxs)("div",{style:{backgroundImage:"url("+e.url+")"},className:"card",children:[(0,i.jsxs)("div",{className:"userInfo",children:[(0,i.jsxs)("h3",{children:[e.first_name,",",(0,i.jsx)("span",{children:N(e)})]}),(0,i.jsxs)("div",{className:"qualities",children:["A ",e.qualities,e.show_gender?e.gender_identity:"person"]}),(0,i.jsxs)("div",{className:"location",children:[(0,i.jsx)("img",{src:"/icons/location_icon.png"}),(0,i.jsx)("span",{children:"God knows where"})]})]}),(0,i.jsxs)("div",{className:"swipeButtons",children:[(0,i.jsx)("img",{src:"/icons/swipe_button_1.png",onClick:function(){return O(1)},className:"pressable swipeButton small"}),(0,i.jsx)("img",{src:"/icons/swipe_button_2.png",onClick:function(){return O(2)},className:"pressable swipeButton big"}),(0,i.jsx)("img",{src:"/icons/swipe_button_3.png",onClick:function(){return O(3)},className:"pressable swipeButton small"}),(0,i.jsx)("img",{src:"/icons/swipe_button_4.png",onClick:function(){return O(4)},className:"pressable swipeButton big"}),(0,i.jsx)("img",{src:"/icons/swipe_button_5.png",onClick:function(){return O(5)},className:"pressable swipeButton small"})]})]})},e.user_id)})),(0,i.jsx)(Tn,{})]})})]})})},Nn=n(9142);function On(e,t,n){return(t=(0,Nn.Z)(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Dn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Pn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Dn(Object(n),!0).forEach((function(t){On(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Dn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Mn=function(e,t){return(Mn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function Fn(e,t){function n(){this.constructor=e}Mn(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function Ln(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?o(e.value):new n((function(t){t(e.value)})).then(a,s)}u((r=r.apply(e,t||[])).next())}))}function Bn(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}var Un=function(){function e(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return e.prototype.setPlatform=function(e,t){null!=this.platform&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+t+"."),this.platformName=e,this.platform=t},e.prototype.registerFlag=function(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},null!=this.urlFlags[e]){var r=this.urlFlags[e];console.warn("Setting feature override from URL "+e+": "+r+"."),this.set(e,r)}},e.prototype.get=function(e){return e in this.flags||(this.flags[e]=this.evaluateFlag(e)),this.flags[e]},e.prototype.getNumber=function(e){return this.get(e)},e.prototype.getBool=function(e){return this.get(e)},e.prototype.getFlags=function(){return this.flags},Object.defineProperty(e.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),e.prototype.set=function(e,t){if(null==this.flagRegistry[e])throw new Error("Cannot set flag "+e+" as it has not been registered.");this.flags[e]=t,null!=this.flagRegistry[e].setHook&&this.flagRegistry[e].setHook(t)},e.prototype.evaluateFlag=function(e){if(null==this.flagRegistry[e])throw new Error("Cannot evaluate flag '"+e+"': no evaluation function found.");return this.flagRegistry[e].evaluationFn()},e.prototype.setFlags=function(e){this.flags=Object.assign({},e)},e.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},e.prototype.populateURLFlags=function(){var e=this;if(void 0!==this.global&&void 0!==this.global.location&&void 0!==this.global.location.search){var t,n,r=(t=this.global.location.search,n={},t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return function(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}(n,t[0],t[1]),t.join("=")})),n);"tfjsflags"in r&&r.tfjsflags.split(",").forEach((function(t){var n=t.split(":"),r=n[0],o=n[1];e.urlFlags[r]=function(e,t){if("true"===(t=t.toLowerCase())||"false"===t)return"true"===t;if(""+ +t===t)return+t;throw new Error("Could not parse value flag value "+t+" for flag "+e+".")}(r,o)}))}},e}();function jn(){return Zn}var Zn=null,Wn=new Map,zn=new Map;function Vn(e,t){var n=Kn(e,t);return Wn.get(n)}function Hn(e){for(var t=Wn.entries(),n=[];;){var r=t.next(),o=r.done,i=r.value;if(o)break;var a=i[0],s=i[1];a.split("_")[0]===e&&n.push(s)}return n}function qn(e){var t=e.kernelName,n=e.backendName,r=Kn(t,n);if(Wn.has(r))throw new Error("The kernel '"+t+"' for backend '"+n+"' is already registered");Wn.set(r,e)}function Gn(e){var t=e.kernelName;zn.has(t)&&console.warn("Overriding the gradient for '"+t+"'"),zn.set(t,e)}function Kn(e,t){return t+"_"+e}function Xn(e){for(var t=e.length,n=0,r=0;t>0;)r=Math.random()*t|0,n=e[--t],e[t]=e[r],e[r]=n}function $n(e,t,n){return Math.max(e,Math.min(t,n))}function Yn(e){return e%2==0?e:e+1}function Qn(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t}function Jn(e,t){if(!e)throw new Error("string"==typeof t?t:t())}function er(e,t,n){void 0===n&&(n=""),Jn(or(e,t),(function(){return n+" Shapes "+e+" and "+t+" must match"}))}function tr(e){Jn(null!=e,(function(){return"The input to the tensor constructor must be a non-null value."}))}function nr(e,t,n){if(void 0===t&&(t=[]),void 0===n&&(n=!1),null==t&&(t=[]),Array.isArray(e)||yr(e)&&!n)for(var r=0;r<e.length;++r)nr(e[r],t,n);else t.push(e);return t}function rr(e){if(0===e.length)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t}function or(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function ir(e){return e%1==0}function ar(e){if(null!=Math.tanh)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;var t=Math.exp(2*e);return(t-1)/(t+1)}function sr(e){var t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function ur(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function cr(e,t,n){return void 0===t&&(t=function(e){return 0}),new Promise((function(r,o){var i=0;!function a(){if(e())r();else{i++;var s=t(i);null!=n&&i>=n?o():setTimeout(a,s)}}()}))}function lr(e,t){for(var n=1,r=-1,o=0;o<e.length;++o)if(e[o]>=0)n*=e[o];else if(-1===e[o]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+o);r=o}else if(e[o]<0)throw Error("Shapes can not be < 0. Found "+e[o]+" at dim "+o);if(-1===r){if(t>0&&t!==n)throw Error("Size("+t+") must match the product of shape "+e);return e}if(0===n)throw Error("Cannot infer the missing size in ["+e+"] when there are 0 elements");if(t%n!=0)throw Error("The implicit shape can't be a fractional number. Got "+t+" / "+n);var i=e.slice();return i[r]=t/n,i}function fr(e,t){var n=t.length;return Jn((e=null==e?t.map((function(e,t){return t})):[].concat(e)).every((function(e){return e>=-n&&e<n})),(function(){return"All values in axis param must be in range [-"+n+", "+n+") but got axis "+e})),Jn(e.every((function(e){return ir(e)})),(function(){return"All values in axis param must be integers but got axis "+e})),e.map((function(e){return e<0?n+e:e}))}function hr(e,t){for(var n=[],r=[],o=null!=t&&Array.isArray(t)&&0===t.length,i=null==t||o?null:fr(t,e).sort(),a=0,s=0;s<e.length;++s){if(null!=i){if(i[a]===s&&1!==e[s])throw new Error("Can't squeeze axis "+s+" since its dim '"+e[s]+"' is not 1");(null==i[a]||i[a]>s)&&1===e[s]&&(n.push(e[s]),r.push(s)),i[a]<=s&&a++}1!==e[s]&&(n.push(e[s]),r.push(s))}return{newShape:n,keptDims:r}}function dr(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else{if("bool"!==e)throw new Error("Unknown data type "+e);n=new Uint8Array(t)}return n}function pr(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else if("bool"===e)n=new Uint8Array(t);else{if("string"!==e)throw new Error("Unknown data type "+e);n=new Array(t)}return n}function vr(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+t+" being uploaded contains "+r+".")}}function mr(e){return"bool"===e||"complex64"===e||"float32"===e||"int32"===e||"string"===e}function gr(e,t){return"complex64"!==t&&("float32"!==t||"complex64"===e)&&("int32"!==t||"float32"===e||"complex64"===e)&&("bool"!==t||"bool"!==e)}function yr(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array}function br(e){if("float32"===e||"int32"===e)return 4;if("complex64"===e)return 8;if("bool"===e)return 1;throw new Error("Unknown dtype "+e)}function wr(e){if(null==e)return 0;var t=0;return e.forEach((function(e){return t+=e.length})),t}function xr(e){return"string"==typeof e||e instanceof String}function kr(e){return"boolean"==typeof e}function _r(e){return"number"==typeof e}function Er(e){return Array.isArray(e)?Er(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array?"int32":_r(e)?"float32":xr(e)?"string":kr(e)?"bool":"float32"}function Cr(e){return!!(e&&e.constructor&&e.call&&e.apply)}function Sr(e,t){for(var n=t;n<e;++n)if(e%n==0)return n;return e}function Ir(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function Rr(e,t,n){if("string"===t)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=nr(e)),n&&vr(e,t),function(e,t){return e instanceof Float32Array&&"float32"===t||e instanceof Int32Array&&"int32"===t||e instanceof Uint8Array&&"bool"===t}(e,t))return e;if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t){for(var r=new Uint8Array(e.length),o=0;o<r.length;++o)0!==Math.round(e[o])&&(r[o]=1);return r}throw new Error("Unknown data type "+t)}function Tr(e,t){if(0===e.length)return t[0];var n=e.reduce((function(e,t){return e*t}));if(0===n)return[];if(n!==t.length)throw new Error("["+e+"] does not match the input size.");return function e(t,n,r){var o=new Array;if(1===n.length)for(var i=n[0],a=0;a<i;a++)o[a]=r[t+a];else{i=n[0];var s=n.slice(1),u=s.reduce((function(e,t){return e*t}));for(a=0;a<i;a++)o[a]=e(t+a*u,s,r)}return o}(0,e,t)}function Ar(e,t){for(var n=Nr(e,t),r=0;r<n.length;r++)n[r]=1;return n}function Nr(e,t){if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t)return new Uint8Array(e);throw new Error("Unknown data type "+t)}function Or(){return jn().platform.now()}function Dr(e){e.forEach((function(t){Jn(Number.isInteger(t)&&t>=0,(function(){return"Tensor must have a shape comprised of positive integers but got shape ["+e+"]."}))}))}function Pr(e,t){return void 0===t&&(t="utf-8"),t=t||"utf-8",jn().platform.encode(e,t)}function Mr(e,t){return void 0===t&&(t="utf-8"),t=t||"utf-8",jn().platform.decode(e,t)}function Fr(e,t,n){if(0===t)return 0;if(1===t)return e[0];for(var r=e[e.length-1],o=0;o<e.length-1;++o)r+=n[o]*e[o];return r}function Lr(e,t,n){if(0===t)return[];if(1===t)return[e];for(var r=new Array(t),o=0;o<r.length-1;++o)r[o]=Math.floor(e/n[o]),e-=r[o]*n[o];return r[r.length-1]=e,r}Object.freeze({shuffle:Xn,clamp:$n,nearestLargerEven:Yn,sum:Qn,randUniform:function(e,t){var n=Math.random();return t*n+(1-n)*e},distSquared:function(e,t){for(var n=0,r=0;r<e.length;r++){var o=Number(e[r])-Number(t[r]);n+=o*o}return n},assert:Jn,assertShapesMatch:er,assertNonNull:tr,flatten:nr,sizeFromShape:rr,isScalarShape:function(e){return 0===e.length},arraysEqual:or,isInt:ir,tanh:ar,sizeToSquarishShape:sr,createShuffledIndices:function(e){for(var t=new Uint32Array(e),n=0;n<e;++n)t[n]=n;return Xn(t),t},rightPad:ur,repeatedTry:cr,inferFromImplicitShape:lr,parseAxisParam:fr,squeezeShape:hr,getTypedArrayFromDType:dr,getArrayFromDType:pr,checkConversionForErrors:vr,isValidDtype:mr,hasEncodingLoss:gr,isTypedArray:yr,bytesPerElement:br,bytesFromStringArray:wr,isString:xr,isBoolean:kr,isNumber:_r,inferDtype:Er,isFunction:Cr,nearestDivisor:Sr,computeStrides:Ir,toTypedArray:Rr,toNestedArray:Tr,makeOnesTypedArray:Ar,makeZerosTypedArray:Nr,now:Or,assertNonNegativeIntegerDimensions:Dr,fetch:function(e,t){return jn().platform.fetch(e,t)},encodeString:Pr,decodeString:Mr,locToIndex:Fr,indexToLoc:Lr});var Br=function(){function e(e,t){this.backendTimer=e,this.logger=t,null==t&&(this.logger=new Ur)}return e.prototype.profileKernel=function(e,t,n){var r,o=this,i=this.backendTimer.time((function(){r=n()}));return r.forEach((function(n){n.data().then((function(r){!function(e,t,n){if("float32"!==t)return!1;for(var r=0;r<e.length;r++){var o=e[r];if(isNaN(o)||!isFinite(o))return console.warn("Found "+o+" in the result of '"+n+"'"),!0}}(r,n.dtype,e),i.then((function(i){var a="";null!=i.getExtraProfileInfo&&(a=i.getExtraProfileInfo()),o.logger.logKernelProfile(e,n,r,i.kernelMs,t,a)}))}))})),r},e}(),Ur=function(){function e(){}return e.prototype.logKernelProfile=function(e,t,n,r,o,i){var a="number"==typeof r?ur(r+"ms",9):r.error,s=ur(e,25),u=t.rank,c=t.size,l=ur(t.shape.toString(),14),f="";for(var h in o){var d=o[h].shape||t.shape,p=d.length;f+=h+": "+p+"D "+(p>0?d:"")+" "}console.log("%c"+s+"\t%c"+a+"\t%c"+u+"D "+l+"\t%c"+c+"\t%c"+f+"\t%c"+i,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},e}(),jr=7;function Zr(e,t,n){return ur(Array.isArray(e)?parseFloat(e[0].toFixed(jr))+" + "+parseFloat(e[1].toFixed(jr))+"j":xr(e)?"'"+e+"'":"bool"===n?Wr(e):parseFloat(e.toFixed(jr)).toString(),t)}function Wr(e){return 0===e?"false":"true"}function zr(e){for(var t=[],n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var Vr=function(){function e(e,t,n){var r=this;if(this.dtype=t,this.shape=e.slice(),this.size=rr(e),null!=n){var o=n.length;Jn(o===this.size,(function(){return"Length of values '"+o+"' does not match the size inferred by the shape '"+r.size+"'."}))}if("complex64"===t)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||pr(t,this.size),this.strides=Ir(e)}return e.prototype.set=function(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];0===n.length&&(n=[0]),Jn(n.length===this.rank,(function(){return"The number of provided coordinates ("+n.length+") must match the rank ("+t.rank+")"}));var o=this.locToIndex(n);this.values[o]=e},e.prototype.get=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];0===e.length&&(e=[0]);for(var n=0,r=0,o=e;r<o.length;r++){var i=o[r];if(i<0||i>=this.shape[n]){var a="Requested out of range element at "+e+".   Buffer shape="+this.shape;throw new Error(a)}n++}for(var s=e[e.length-1],u=0;u<e.length-1;++u)s+=this.strides[u]*e[u];return this.values[s]},e.prototype.locToIndex=function(e){if(0===this.rank)return 0;if(1===this.rank)return e[0];for(var t=e[e.length-1],n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t},e.prototype.indexToLoc=function(e){if(0===this.rank)return[];if(1===this.rank)return[e];for(var t=new Array(this.shape.length),n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.toTensor=function(){return Hr().makeTensor(this.values,this.shape,this.dtype)},e}(),Hr=null,qr=null,Gr=null,Kr=function(){function e(e,t,n,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=rr(e),this.strides=Ir(e),this.dataId=n,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}return e.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},e.prototype.asScalar=function(){return this.throwIfDisposed(),Jn(1===this.size,(function(){return"The array must have only 1 element."})),this.reshape([])},e.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},e.prototype.as2D=function(e,t){return this.throwIfDisposed(),this.reshape([e,t])},e.prototype.as3D=function(e,t,n){return this.throwIfDisposed(),this.reshape([e,t,n])},e.prototype.as4D=function(e,t,n,r){return this.throwIfDisposed(),this.reshape([e,t,n,r])},e.prototype.as5D=function(e,t,n,r,o){return this.throwIfDisposed(),this.reshape([e,t,n,r,o])},e.prototype.asType=function(e){return this.throwIfDisposed(),qr.cast(this,e)},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.buffer=function(){return Ln(this,void 0,void 0,(function(){var e;return Bn(this,(function(t){switch(t.label){case 0:return[4,this.data()];case 1:return e=t.sent(),[2,qr.buffer(this.shape,this.dtype,e)]}}))}))},e.prototype.bufferSync=function(){return qr.buffer(this.shape,this.dtype,this.dataSync())},e.prototype.array=function(){return Ln(this,void 0,void 0,(function(){var e;return Bn(this,(function(t){switch(t.label){case 0:return[4,this.data()];case 1:return e=t.sent(),[2,Tr(this.shape,e)]}}))}))},e.prototype.arraySync=function(){return Tr(this.shape,this.dataSync())},e.prototype.data=function(){return Ln(this,void 0,void 0,(function(){var e,t;return Bn(this,(function(n){switch(n.label){case 0:return this.throwIfDisposed(),e=Hr().read(this.dataId),"string"!==this.dtype?[3,2]:[4,e];case 1:t=n.sent();try{return[2,t.map((function(e){return Mr(e)}))]}catch(e){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}n.label=2;case 2:return[2,e]}}))}))},e.prototype.dataSync=function(){this.throwIfDisposed();var e=Hr().readSync(this.dataId);if("string"===this.dtype)try{return e.map((function(e){return Mr(e)}))}catch(e){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e},e.prototype.bytes=function(){return Ln(this,void 0,void 0,(function(){var e;return Bn(this,(function(t){switch(t.label){case 0:return this.throwIfDisposed(),[4,Hr().read(this.dataId)];case 1:return e=t.sent(),"string"===this.dtype?[2,e]:[2,new Uint8Array(e.buffer)]}}))}))},e.prototype.dispose=function(){this.isDisposed||(Hr().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),e.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},e.prototype.toFloat=function(){return this.asType("float32")},e.prototype.toInt=function(){return this.asType("int32")},e.prototype.toBool=function(){return this.asType("bool")},e.prototype.print=function(e){return void 0===e&&(e=!1),qr.print(this,e)},e.prototype.reshape=function(e){return this.throwIfDisposed(),qr.reshape(this,e)},e.prototype.reshapeAs=function(e){return this.throwIfDisposed(),this.reshape(e.shape)},e.prototype.expandDims=function(e){return void 0===e&&(e=0),qr.expandDims(this,e)},e.prototype.cumsum=function(e,t,n){return void 0===e&&(e=0),void 0===t&&(t=!1),void 0===n&&(n=!1),qr.cumsum(this,e,t,n)},e.prototype.squeeze=function(e){return this.throwIfDisposed(),qr.squeeze(this,e)},e.prototype.clone=function(){return this.throwIfDisposed(),qr.clone(this)},e.prototype.oneHot=function(e,t,n){return this.throwIfDisposed(),qr.oneHot(this,e,t,n)},e.prototype.toString=function(e){return void 0===e&&(e=!1),function(e,t,n,r){var o=Ir(t),i=function(e,t,n,r){var o=rr(t),i=r[r.length-1],a=new Array(i).fill(0),s=t.length,u="complex64"===n?zr(e):e;if(s>1)for(var c=0;c<o/i;c++)for(var l=c*i,f=0;f<i;f++)a[f]=Math.max(a[f],Zr(u[l+f],0,n).length);return a}(e,t,n,o),a=t.length,s=function e(t,n,r,o,i,a){void 0===a&&(a=!0);var s="complex64"===r?2:1,u=n[0],c=n.length;if(0===c)return"complex64"===r?[Zr(zr(t)[0],0,r)]:"bool"===r?[Wr(t[0])]:[t[0].toString()];if(1===c){if(u>20){var l=3*s,f=Array.from(t.slice(0,l)),h=Array.from(t.slice((u-3)*s,u*s));return"complex64"===r&&(f=zr(f),h=zr(h)),["["+f.map((function(e,t){return Zr(e,i[t],r)})).join(", ")+", ..., "+h.map((function(e,t){return Zr(e,i[u-3+t],r)})).join(", ")+"]"]}return["["+("complex64"===r?zr(t):Array.from(t)).map((function(e,t){return Zr(e,i[t],r)})).join(", ")+"]"]}var d=n.slice(1),p=o.slice(1),v=o[0]*s,m=[];if(u>20){for(var g=0;g<3;g++){var y=(b=g*v)+v;m.push.apply(m,e(t.slice(b,y),d,r,p,i,!1))}for(m.push("..."),g=u-3;g<u;g++)y=(b=g*v)+v,m.push.apply(m,e(t.slice(b,y),d,r,p,i,g===u-1))}else for(g=0;g<u;g++){var b;y=(b=g*v)+v,m.push.apply(m,e(t.slice(b,y),d,r,p,i,g===u-1))}var w=2===c?",":"";for(m[0]="["+m[0]+w,g=1;g<m.length-1;g++)m[g]=" "+m[g]+w;var x=",\n";for(g=2;g<c;g++)x+="\n";return m[m.length-1]=" "+m[m.length-1]+"]"+(a?"":x),m}(e,t,n,o,i),u=["Tensor"];return r&&(u.push("  dtype: "+n),u.push("  rank: "+a),u.push("  shape: ["+t+"]"),u.push("  values:")),u.push(s.map((function(e){return"    "+e})).join("\n")),u.join("\n")}(this.dataSync(),this.shape,this.dtype,e)},e.prototype.tile=function(e){return this.throwIfDisposed(),qr.tile(this,e)},e.prototype.gather=function(e,t){return void 0===t&&(t=0),this.throwIfDisposed(),qr.gather(this,e,t)},e.prototype.matMul=function(e,t,n){return void 0===t&&(t=!1),void 0===n&&(n=!1),this.throwIfDisposed(),qr.matMul(this,e,t,n)},e.prototype.dot=function(e){return this.throwIfDisposed(),qr.dot(this,e)},e.prototype.norm=function(e,t,n){return void 0===e&&(e="euclidean"),void 0===t&&(t=null),void 0===n&&(n=!1),this.throwIfDisposed(),qr.norm(this,e,t,n)},e.prototype.slice=function(e,t){return this.throwIfDisposed(),qr.slice(this,e,t)},e.prototype.reverse=function(e){return this.throwIfDisposed(),qr.reverse(this,e)},e.prototype.concat=function(t,n){return void 0===n&&(n=0),this.throwIfDisposed(),t instanceof e&&(t=[t]),qr.concat([this].concat(t),n)},e.prototype.split=function(e,t){return void 0===t&&(t=0),this.throwIfDisposed(),qr.split(this,e,t)},e.prototype.stack=function(e,t){return void 0===t&&(t=0),qr.stack([this,e],t)},e.prototype.unstack=function(e){return void 0===e&&(e=0),qr.unstack(this,e)},e.prototype.pad=function(e,t){return void 0===t&&(t=0),qr.pad(this,e,t)},e.prototype.batchNormalization=function(e,t,n,r,o){return void 0===n&&(n=.001),Gr("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(e,t,o,r,n)},e.prototype.batchNorm=function(e,t,n,r,o){return void 0===o&&(o=.001),this.throwIfDisposed(),qr.batchNorm(this,e,t,n,r,o)},e.prototype.all=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),qr.all(this,e,t)},e.prototype.any=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),qr.any(this,e,t)},e.prototype.logSumExp=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),qr.logSumExp(this,e,t)},e.prototype.sum=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),qr.sum(this,e,t)},e.prototype.prod=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),qr.prod(this,e,t)},e.prototype.mean=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),qr.mean(this,e,t)},e.prototype.min=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),qr.min(this,e,t)},e.prototype.max=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),qr.max(this,e,t)},e.prototype.argMin=function(e){return void 0===e&&(e=null),this.throwIfDisposed(),qr.argMin(this,e)},e.prototype.argMax=function(e){return void 0===e&&(e=null),this.throwIfDisposed(),qr.argMax(this,e)},e.prototype.cast=function(e){return this.throwIfDisposed(),qr.cast(this,e)},e.prototype.add=function(e){return this.throwIfDisposed(),qr.add(this,e)},e.prototype.addStrict=function(e){return this.throwIfDisposed(),qr.addStrict(this,e)},e.prototype.atan2=function(e){return this.throwIfDisposed(),qr.atan2(this,e)},e.prototype.sub=function(e){return this.throwIfDisposed(),qr.sub(this,e)},e.prototype.subStrict=function(e){return this.throwIfDisposed(),qr.subStrict(this,e)},e.prototype.pow=function(e){return this.throwIfDisposed(),qr.pow(this,e)},e.prototype.powStrict=function(e){return this.throwIfDisposed(),qr.powStrict(this,e)},e.prototype.mul=function(e){return this.throwIfDisposed(),qr.mul(this,e)},e.prototype.mulStrict=function(e){return this.throwIfDisposed(),qr.mulStrict(this,e)},e.prototype.div=function(e){return this.throwIfDisposed(),qr.div(this,e)},e.prototype.divNoNan=function(e){return this.throwIfDisposed(),qr.divNoNan(this,e)},e.prototype.floorDiv=function(e){return this.throwIfDisposed(),qr.floorDiv(this,e)},e.prototype.divStrict=function(e){return this.throwIfDisposed(),qr.divStrict(this,e)},e.prototype.minimum=function(e){return this.throwIfDisposed(),qr.minimum(this,e)},e.prototype.minimumStrict=function(e){return this.throwIfDisposed(),qr.minimumStrict(this,e)},e.prototype.maximum=function(e){return this.throwIfDisposed(),qr.maximum(this,e)},e.prototype.maximumStrict=function(e){return this.throwIfDisposed(),qr.maximumStrict(this,e)},e.prototype.mod=function(e){return this.throwIfDisposed(),qr.mod(this,e)},e.prototype.modStrict=function(e){return this.throwIfDisposed(),qr.modStrict(this,e)},e.prototype.squaredDifferenceStrict=function(e){return this.throwIfDisposed(),qr.squaredDifferenceStrict(this,e)},e.prototype.transpose=function(e){return this.throwIfDisposed(),qr.transpose(this,e)},e.prototype.notEqual=function(e){return this.throwIfDisposed(),qr.notEqual(this,e)},e.prototype.notEqualStrict=function(e){return this.throwIfDisposed(),qr.notEqualStrict(this,e)},e.prototype.less=function(e){return this.throwIfDisposed(),qr.less(this,e)},e.prototype.lessStrict=function(e){return this.throwIfDisposed(),qr.lessStrict(this,e)},e.prototype.equal=function(e){return this.throwIfDisposed(),qr.equal(this,e)},e.prototype.equalStrict=function(e){return this.throwIfDisposed(),qr.equalStrict(this,e)},e.prototype.lessEqual=function(e){return this.throwIfDisposed(),qr.lessEqual(this,e)},e.prototype.lessEqualStrict=function(e){return this.throwIfDisposed(),qr.lessEqualStrict(this,e)},e.prototype.greater=function(e){return this.throwIfDisposed(),qr.greater(this,e)},e.prototype.greaterStrict=function(e){return this.throwIfDisposed(),qr.greaterStrict(this,e)},e.prototype.greaterEqual=function(e){return this.throwIfDisposed(),qr.greaterEqual(this,e)},e.prototype.greaterEqualStrict=function(e){return this.throwIfDisposed(),qr.greaterEqualStrict(this,e)},e.prototype.logicalAnd=function(e){return this.throwIfDisposed(),qr.logicalAnd(this,e)},e.prototype.logicalOr=function(e){return this.throwIfDisposed(),qr.logicalOr(this,e)},e.prototype.logicalNot=function(){return this.throwIfDisposed(),qr.logicalNot(this)},e.prototype.logicalXor=function(e){return this.throwIfDisposed(),qr.logicalXor(this,e)},e.prototype.where=function(e,t){return this.throwIfDisposed(),qr.where(e,this,t)},e.prototype.neg=function(){return this.throwIfDisposed(),qr.neg(this)},e.prototype.ceil=function(){return this.throwIfDisposed(),qr.ceil(this)},e.prototype.floor=function(){return this.throwIfDisposed(),qr.floor(this)},e.prototype.sign=function(){return this.throwIfDisposed(),qr.sign(this)},e.prototype.isNaN=function(){return this.throwIfDisposed(),qr.isNaN(this)},e.prototype.isInf=function(){return this.throwIfDisposed(),qr.isInf(this)},e.prototype.isFinite=function(){return this.throwIfDisposed(),qr.isFinite(this)},e.prototype.exp=function(){return this.throwIfDisposed(),qr.exp(this)},e.prototype.expm1=function(){return this.throwIfDisposed(),qr.expm1(this)},e.prototype.log=function(){return this.throwIfDisposed(),qr.log(this)},e.prototype.log1p=function(){return this.throwIfDisposed(),qr.log1p(this)},e.prototype.sqrt=function(){return this.throwIfDisposed(),qr.sqrt(this)},e.prototype.rsqrt=function(){return this.throwIfDisposed(),qr.rsqrt(this)},e.prototype.square=function(){return this.throwIfDisposed(),qr.square(this)},e.prototype.reciprocal=function(){return this.throwIfDisposed(),qr.reciprocal(this)},e.prototype.abs=function(){return this.throwIfDisposed(),qr.abs(this)},e.prototype.clipByValue=function(e,t){return this.throwIfDisposed(),qr.clipByValue(this,e,t)},e.prototype.relu=function(){return this.throwIfDisposed(),qr.relu(this)},e.prototype.relu6=function(){return this.throwIfDisposed(),qr.relu6(this)},e.prototype.elu=function(){return this.throwIfDisposed(),qr.elu(this)},e.prototype.selu=function(){return this.throwIfDisposed(),qr.selu(this)},e.prototype.leakyRelu=function(e){return void 0===e&&(e=.2),this.throwIfDisposed(),qr.leakyRelu(this,e)},e.prototype.prelu=function(e){return this.throwIfDisposed(),qr.prelu(this,e)},e.prototype.sigmoid=function(){return this.throwIfDisposed(),qr.sigmoid(this)},e.prototype.logSigmoid=function(){return this.throwIfDisposed(),qr.logSigmoid(this)},e.prototype.softplus=function(){return this.throwIfDisposed(),qr.softplus(this)},e.prototype.zerosLike=function(){return this.throwIfDisposed(),qr.zerosLike(this)},e.prototype.onesLike=function(){return this.throwIfDisposed(),qr.onesLike(this)},e.prototype.sin=function(){return this.throwIfDisposed(),qr.sin(this)},e.prototype.cos=function(){return this.throwIfDisposed(),qr.cos(this)},e.prototype.tan=function(){return this.throwIfDisposed(),qr.tan(this)},e.prototype.asin=function(){return this.throwIfDisposed(),qr.asin(this)},e.prototype.acos=function(){return this.throwIfDisposed(),qr.acos(this)},e.prototype.atan=function(){return this.throwIfDisposed(),qr.atan(this)},e.prototype.sinh=function(){return this.throwIfDisposed(),qr.sinh(this)},e.prototype.cosh=function(){return this.throwIfDisposed(),qr.cosh(this)},e.prototype.tanh=function(){return this.throwIfDisposed(),qr.tanh(this)},e.prototype.asinh=function(){return this.throwIfDisposed(),qr.asinh(this)},e.prototype.acosh=function(){return this.throwIfDisposed(),qr.acosh(this)},e.prototype.atanh=function(){return this.throwIfDisposed(),qr.atanh(this)},e.prototype.erf=function(){return this.throwIfDisposed(),qr.erf(this)},e.prototype.round=function(){return this.throwIfDisposed(),qr.round(this)},e.prototype.step=function(e){return void 0===e&&(e=0),this.throwIfDisposed(),qr.step(this,e)},e.prototype.softmax=function(e){return void 0===e&&(e=-1),this.throwIfDisposed(),qr.softmax(this,e)},e.prototype.logSoftmax=function(e){return void 0===e&&(e=-1),this.throwIfDisposed(),qr.logSoftmax(this,e)},e.prototype.resizeBilinear=function(e,t){return void 0===t&&(t=!1),this.throwIfDisposed(),qr.image.resizeBilinear(this,e,t)},e.prototype.resizeNearestNeighbor=function(e,t){return void 0===t&&(t=!1),this.throwIfDisposed(),qr.image.resizeNearestNeighbor(this,e,t)},e.prototype.conv1d=function(e,t,n,r,o,i){return void 0===r&&(r="NWC"),void 0===o&&(o=1),this.throwIfDisposed(),qr.conv1d(this,e,t,n,r,o,i)},e.prototype.conv2d=function(e,t,n,r,o,i){return void 0===r&&(r="NHWC"),void 0===o&&(o=[1,1]),this.throwIfDisposed(),qr.conv2d(this,e,t,n,r,o,i)},e.prototype.conv2dTranspose=function(e,t,n,r,o){return this.throwIfDisposed(),qr.conv2dTranspose(this,e,t,n,r,o)},e.prototype.depthwiseConv2D=function(e,t,n,r,o,i){return void 0===r&&(r="NHWC"),void 0===o&&(o=[1,1]),this.throwIfDisposed(),qr.depthwiseConv2d(this,e,t,n,r,o,i)},e.prototype.separableConv2d=function(e,t,n,r,o,i){return void 0===o&&(o=[1,1]),void 0===i&&(i="NHWC"),this.throwIfDisposed(),qr.separableConv2d(this,e,t,n,r,o,i)},e.prototype.avgPool=function(e,t,n,r){return this.throwIfDisposed(),qr.avgPool(this,e,t,n,r)},e.prototype.maxPool=function(e,t,n,r){return this.throwIfDisposed(),qr.maxPool(this,e,t,n,r)},e.prototype.localResponseNormalization=function(e,t,n,r){return void 0===e&&(e=5),void 0===t&&(t=1),void 0===n&&(n=1),void 0===r&&(r=.5),qr.localResponseNormalization(this,e,t,n,r)},e.prototype.pool=function(e,t,n,r,o){return this.throwIfDisposed(),qr.pool(this,e,t,n,r,o)},e.prototype.variable=function(e,t,n){return void 0===e&&(e=!0),this.throwIfDisposed(),Hr().makeVariable(this,e,t,n)},e.prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),qr.unsortedSegmentSum(this,e,t)},e.prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),qr.batchToSpaceND(this,e,t)},e.prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),qr.spaceToBatchND(this,e,t)},e.prototype.topk=function(e,t){return void 0===e&&(e=1),void 0===t&&(t=!0),this.throwIfDisposed(),qr.topk(this,e,t)},e.prototype.stridedSlice=function(e,t,n,r,o,i,a,s){return void 0===r&&(r=0),void 0===o&&(o=0),void 0===i&&(i=0),void 0===a&&(a=0),void 0===s&&(s=0),this.throwIfDisposed(),qr.stridedSlice(this,e,t,n,r,o,i,a,s)},e.prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),qr.depthToSpace(this,e,t)},e.prototype.fft=function(){return this.throwIfDisposed(),qr.spectral.fft(this)},e.prototype.ifft=function(){return this.throwIfDisposed(),qr.spectral.ifft(this)},e.prototype.rfft=function(){return this.throwIfDisposed(),qr.spectral.rfft(this)},e.prototype.irfft=function(){return this.throwIfDisposed(),qr.spectral.irfft(this)},e}();Object.defineProperty(Kr,Symbol.hasInstance,{value:function(e){return!!e&&null!=e.dataId&&null!=e.shape&&null!=e.dtype}});var Xr,$r,Yr,Qr,Jr,eo,to=function(e){function t(t,n,r,o){var i=e.call(this,t.shape,t.dtype,t.dataId,o)||this;return i.trainable=n,i.name=r,i}return Fn(t,e),t.prototype.assign=function(e){if(e.dtype!==this.dtype)throw new Error("dtype of the new value ("+e.dtype+") and previous value ("+this.dtype+") must match");if(!or(e.shape,this.shape))throw new Error("shape of the new value ("+e.shape+") and previous value ("+this.shape+") must match");Hr().disposeTensor(this),this.dataId=e.dataId,Hr().incRef(this,null)},t.prototype.dispose=function(){Hr().disposeVariable(this),this.isDisposedInternal=!0},t}(Kr);Object.defineProperty(to,Symbol.hasInstance,{value:function(e){return e instanceof Kr&&null!=e.assign&&e.assign instanceof Function}}),(eo=Xr||(Xr={})).R0="R0",eo.R1="R1",eo.R2="R2",eo.R3="R3",eo.R4="R4",eo.R5="R5",eo.R6="R6",function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}($r||($r={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(Yr||(Yr={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(Qr||(Qr={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(Jr||(Jr={}));var no={float32:Qr,int32:$r,bool:Yr,complex64:Jr};function ro(e,t){if("string"===e||"string"===t){if("string"===e&&"string"===t)return"string";throw new Error("Can not upcast "+e+" with "+t)}return no[e][t]}function oo(e){return ro(e,"int32")}function io(e,t){if(e.dtype===t.dtype)return[e,t];var n=ro(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function ao(e,t){Jn(e.dtype===t.dtype,(function(){return"The dtypes of the first("+e.dtype+") and second("+t.dtype+") input must match"}))}function so(e){var t=[];return function e(t,n,r){if(null!=t)if(t instanceof Kr)n.push(t);else if(o=t,Array.isArray(o)||"object"==typeof o){var o,i=t;for(var a in i){var s=i[a];r.has(s)||(r.add(s),e(s,n,r))}}}(e,t,new Set),t}Object.freeze({makeTypesMatch:io,assertTypesMatch:ao,isTensorInList:function(e,t){return t.some((function(t){return t.id===e.id}))},getTensorsInContainer:so});var uo,co=function(){function e(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return e.prototype.dispose=function(){for(var e in this.registeredVariables)this.registeredVariables[e].dispose()},e}(),lo=function(){function e(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new co}return e.prototype.ready=function(){return Ln(this,void 0,void 0,(function(){var e,t,n;return Bn(this,(function(r){switch(r.label){case 0:if(null!=this.pendingBackendInit)return[2,this.pendingBackendInit.then((function(){}))];if(null!=this.backendInstance)return[2];e=this.getSortedBackends(),t=0,r.label=1;case 1:return t<e.length?(n=e[t],[4,this.initializeBackend(n).success]):[3,5];case 2:return r.sent()?[4,this.setBackend(n)]:[3,4];case 3:return r.sent(),[2];case 4:return t++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}}))}))},Object.defineProperty(e.prototype,"backend",{get:function(){if(null!=this.pendingBackendInit)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(null==this.backendInstance){var e=this.initializeBackendsAndReturnBest(),t=e.name;if(e.asyncInit)throw new Error("The highest priority backend '"+t+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(t)}return this.backendInstance},enumerable:!0,configurable:!0}),e.prototype.backendNames=function(){return Object.keys(this.registryFactory)},e.prototype.findBackend=function(e){if(!(e in this.registry)){if(!(e in this.registryFactory))return null;if(this.initializeBackend(e).asyncInit)return null}return this.registry[e]},e.prototype.findBackendFactory=function(e){return e in this.registryFactory?this.registryFactory[e].factory:null},e.prototype.registerBackend=function(e,t,n){return void 0===n&&(n=1),e in this.registryFactory?(console.warn(e+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[e]={factory:t,priority:n},!0)},e.prototype.setBackend=function(e){return Ln(this,void 0,void 0,(function(){var t,n,r;return Bn(this,(function(o){switch(o.label){case 0:if(null==this.registryFactory[e])throw new Error("Backend name '"+e+"' not found in registry");return this.backendName=e,null!=this.registry[e]?[3,4]:(this.backendInstance=null,t=this.initializeBackend(e),n=t.success,t.asyncInit?[4,n]:[3,2]);case 1:return r=o.sent(),[3,3];case 2:r=n,o.label=3;case 3:if(!r)return[2,!1];o.label=4;case 4:return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new Br(this.backendInstance),[2,!0]}}))}))},e.prototype.setupRegisteredKernels=function(){var e=this;Hn(this.backendName).forEach((function(t){null!=t.setupFunc&&t.setupFunc(e.backendInstance)}))},e.prototype.disposeRegisteredKernels=function(e){var t=this;Hn(e).forEach((function(n){null!=n.disposeFunc&&n.disposeFunc(t.registry[e])}))},e.prototype.initializeBackend=function(e){var t=this,n=this.registryFactory[e];if(null==n)throw new Error("Cannot initialize backend "+e+", no registration found.");try{var r=n.factory();if(Promise.resolve(r)===r){var o=++this.pendingBackendInitId,i=r.then((function(n){return!(o<t.pendingBackendInitId)&&(t.registry[e]=n,t.pendingBackendInit=null,!0)})).catch((function(n){return!(o<t.pendingBackendInitId)&&(t.pendingBackendInit=null,console.warn("Initialization of backend "+e+" failed"),console.warn(n.stack||n.message),!1)}));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}return this.registry[e]=r,{success:!0,asyncInit:!1}}catch(t){return console.warn("Initialization of backend "+e+" failed"),console.warn(t.stack||t.message),{success:!1,asyncInit:!1}}},e.prototype.removeBackend=function(e){if(!(e in this.registryFactory))throw new Error(e+" backend not found in registry");this.backendName===e&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},e.prototype.getSortedBackends=function(){var e=this;if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((function(t,n){return e.registryFactory[n].priority-e.registryFactory[t].priority}))},e.prototype.initializeBackendsAndReturnBest=function(){for(var e=this.getSortedBackends(),t=0;t<e.length;t++){var n=e[t],r=this.initializeBackend(n),o=r.success,i=r.asyncInit;if(i||o)return{name:n,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")},e.prototype.moveData=function(e,t){var n=this.state.tensorInfo.get(t),r=n.backend,o=this.readSync(t);r.disposeData(t),n.backend=e,e.move(t,o,n.shape,n.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},e.prototype.tidy=function(e,t){var n,r=this,o=null;if(null==t){if("function"!=typeof e)throw new Error("Please provide a function to tidy()");t=e}else{if("string"!=typeof e&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof t)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");o=e}return this.scopedRun((function(){return r.startScope(o)}),(function(){return r.endScope(n)}),(function(){return(n=t())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n}))},e.prototype.scopedRun=function(e,t,n){e();try{var r=n();return t(),r}catch(e){throw t(),e}},e.prototype.nextTensorId=function(){return e.nextTensorId++},e.prototype.nextVariableId=function(){return e.nextVariableId++},e.prototype.clone=function(e){var t=this.makeTensorFromDataId(e.dataId,e.shape,e.dtype),n={x:e};return this.addTapeNode(this.state.activeScope.name,n,[t],(function(e){return{x:function(){return e.toFloat()}}}),[]),t},e.prototype.runKernel=function(e,t,n,r,o){return this.runKernelFunc(null,t,null,e,n,r,o)},e.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},e.prototype.checkKernelForMemLeak=function(e,t,n){var r=this.backend.numDataIds(),o=0;n.forEach((function(e){o+="complex64"===e.dtype?3:1}));var i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],a=r-t-o-i;if(a>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+a+" data ids) after running '"+e+"'")},e.prototype.runKernelFunc=function(e,t,n,r,o,i,a){var s,u=this;void 0===i&&(i=[]),void 0===a&&(a=[]);var c=[],l=this.isTapeOn();null==r&&(r=null!=this.state.activeScope?this.state.activeScope.name:"");var f,h=function(e){l&&(c=e.map((function(e){return u.keep(u.clone(e))})))},d=this.state.numBytes,p=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var v,m=Vn(r,this.backendName);return f=null!=m?function(){var e=u.backend.numDataIds();v=m.kernelFunc({inputs:t,attrs:o,backend:u.backend});var n=Array.isArray(v)?v:[v];u.shouldCheckForMemLeaks()&&u.checkKernelForMemLeak(r,e,n);var s=n.map((function(e){var t=e.dataId,n=e.shape,r=e.dtype;return u.makeTensorFromDataId(t,n,r)})),c=s.filter((function(e,t){return a[t]}));return h((i||[]).slice().concat(c)),s}:function(){var t=u.backend.numDataIds();v=u.tidy((function(){return e(u.backend,h)}));var n=Array.isArray(v)?v:[v];return u.shouldCheckForMemLeaks()&&u.checkKernelForMemLeak(r,t,n),n},this.scopedRun((function(){return u.state.kernelDepth++}),(function(){return u.state.kernelDepth--}),(function(){s=u.ENV.getBool("DEBUG")?u.profiler.profileKernel(r,t,(function(){return f()})):f()})),l&&this.addTapeNode(r,t,s,n,c),this.state.profiling&&this.state.activeProfile.kernels.push({name:r,bytesAdded:this.state.numBytes-d,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-p,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(t).map((function(e){return t[e].shape})),outputShapes:s.map((function(e){return e.shape}))}),Array.isArray(v)?s:s[0]},e.prototype.makeTensor=function(e,t,n,r){if(null==e)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;var o=e;"string"===n&&xr(e[0])&&(o=e.map((function(e){return Pr(e)})));var i=r.write(o,t,n),a=new Kr(t,n,i,this.nextTensorId());if(this.incRef(a,r),"string"===n){var s=this.state.tensorInfo.get(i),u=wr(o);this.state.numBytes+=u-s.bytes,s.bytes=u}return a},e.prototype.makeTensorFromDataId=function(e,t,n,r){var o=new Kr(t,n=n||"float32",e,this.nextTensorId());return this.incRef(o,r),o},e.prototype.makeVariable=function(e,t,n,r){void 0===t&&(t=!0),n=n||this.nextVariableId().toString(),null!=r&&r!==e.dtype&&(e=e.asType(r));var o=new to(e,t,n,this.nextTensorId());if(null!=this.state.registeredVariables[o.name])throw new Error("Variable with name "+o.name+" was already registered");return this.state.registeredVariables[o.name]=o,this.incRef(o,this.backend),o},e.prototype.incRef=function(e,t){var n=this.state.tensorInfo.has(e.dataId)?this.state.tensorInfo.get(e.dataId).refCount:0;if(this.state.numTensors++,"string"===e.dtype&&this.state.numStringTensors++,0===n){this.state.numDataBuffers++;var r=0;"complex64"!==e.dtype&&"string"!==e.dtype&&(r=e.size*br(e.dtype)),this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:r,refCount:0}),this.state.numBytes+=r}this.state.tensorInfo.get(e.dataId).refCount++,e instanceof to||this.track(e)},e.prototype.disposeTensor=function(e){if(this.state.tensorInfo.has(e.dataId)){this.state.numTensors--,"string"===e.dtype&&this.state.numStringTensors--;var t=this.state.tensorInfo.get(e.dataId);t.refCount<=1?("complex64"!==e.dtype&&(this.state.numBytes-=t.bytes),this.state.numDataBuffers--,t.backend.disposeData(e.dataId),this.state.tensorInfo.delete(e.dataId)):this.state.tensorInfo.get(e.dataId).refCount--}},e.prototype.disposeVariables=function(){for(var e in this.state.registeredVariables){var t=this.state.registeredVariables[e];this.disposeVariable(t)}},e.prototype.disposeVariable=function(e){this.disposeTensor(e),null!=this.state.registeredVariables[e.name]&&delete this.state.registeredVariables[e.name]},e.prototype.memory=function(){var e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,null==e.reasons&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e},e.prototype.profile=function(e){return Ln(this,void 0,void 0,(function(){var t,n;return Bn(this,(function(r){return this.state.profiling=!0,t=this.state.numBytes,n=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map((function(e){return e.totalBytesSnapshot}))),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-n,[2,this.state.activeProfile]}))}))},e.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&0===this.state.kernelDepth},e.prototype.addTapeNode=function(e,t,n,r,o){var i=this,a={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:n,saved:o},s=function(e){return zn.get(e)}(e);null!=s&&(r=s.gradFunc),null!=r&&(a.gradient=function(e){return e=e.map((function(e,t){if(null==e){var r=n[t],o=Nr(r.size,r.dtype);return i.makeTensor(o,r.shape,r.dtype)}return e})),r(e.length>1?e:e[0],o)}),this.state.activeTape.push(a)},e.prototype.keep=function(e){return e.kept=!0,e},e.prototype.startTape=function(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++},e.prototype.endTape=function(){this.state.gradientDepth--},e.prototype.startScope=function(e){var t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t},e.prototype.endScope=function(e){for(var t=this,n=so(e),r=new Set(n.map((function(e){return e.id}))),o=0;o<this.state.activeScope.track.length;o++){var i=this.state.activeScope.track[o];i.kept||r.has(i.id)||i.dispose()}var a=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach((function(e){e.kept||e.scopeId!==a.id||t.track(e)}))},e.prototype.gradients=function(e,t,n,r){var o=this;if(void 0===r&&(r=!1),Jn(t.length>0,(function(){return"gradients() received an empty list of xs."})),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '"+n.dtype+"'");var i=this.scopedRun((function(){return o.startTape()}),(function(){return o.endTape()}),(function(){return o.tidy("forward",e)}));Jn(i instanceof Kr,(function(){return"The result y returned by f() must be a tensor."}));var a=function(e,t,n){for(var r={},o={},i=0;i<t.length;i++)r[t[i].id]=!0;for(i=0;i<e.length;i++){var a=(p=e[i]).inputs;for(var s in a){for(var u=a[s],c=!1,l=0;l<t.length;l++)if(r[u.id]){p.outputs.forEach((function(e){return r[e.id]=!0})),c=!0,o[p.id]=!0;break}if(c)break}}var f={};f[n.id]=!0;var h={};for(i=e.length-1;i>=0;i--)for(a=(p=e[i]).inputs,l=0;l<p.outputs.length;l++)if(f[p.outputs[l].id]){for(var s in a)f[a[s].id]=!0,h[p.id]=!0;break}var d=[];for(i=0;i<e.length;i++){var p;if(o[(p=e[i]).id]&&h[p.id]){var v={};for(var s in p.inputs){var m=p.inputs[s];r[m.id]&&(v[s]=m)}var g=Object.assign({},p);g.inputs=v,g.outputs=p.outputs,d.push(g)}}return d}(this.state.activeTape,t,i);if(!r&&0===a.length&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(function(){var e,r,s={};s[i.id]=null==n?(r=Ar(rr(e=i.shape),"float32"),fo.makeTensor(r,e,"float32")):n,function(e,t,n){for(var r=function(r){var o=t[r],i=[];if(o.outputs.forEach((function(t){var n=e[t.id];null!=n?i.push(n):i.push(null)})),null==o.gradient)throw new Error("Cannot compute gradient: gradient function not found for "+o.kernelName+".");var a=o.gradient(i),s=function(t){if(!(t in a))throw new Error("Cannot backprop through input "+t+". Available gradients found: "+Object.keys(a)+".");var r=n((function(){return a[t]()}));if("float32"!==r.dtype)throw new Error("Error in gradient for op "+o.kernelName+". The gradient of input "+t+" must have 'float32' dtype, but has '"+r.dtype+"'");var i=o.inputs[t];if(!or(r.shape,i.shape))throw new Error("Error in gradient for op "+o.kernelName+". The gradient of input '"+t+"' has shape '"+r.shape+"', which does not match the shape of the input '"+i.shape+"'");if(null==e[i.id])e[i.id]=r;else{var s=e[i.id];e[i.id]=s.add(r),s.dispose()}};for(var u in o.inputs)s(u)},o=t.length-1;o>=0;o--)r(o)}(s,a,(function(e){return o.tidy(e)}));var u=t.map((function(e){return s[e.id]}));return 0===o.state.gradientDepth&&(o.state.activeTape.forEach((function(e){for(var t=0,n=e.saved;t<n.length;t++)n[t].dispose()})),o.state.activeTape=null),{value:i,grads:u}}))},e.prototype.customGrad=function(e){var t=this;return Jn(Cr(e),(function(){return"The f passed in customGrad(f) must be a function."})),function(){for(var n,r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];Jn(r.every((function(e){return e instanceof Kr})),(function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"}));var i={};return r.forEach((function(e,t){i[t]=e})),t.runKernelFunc((function(t,o){return Jn((n=e.apply(void 0,r.concat([o]))).value instanceof Kr,(function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"})),Jn(Cr(n.gradFunc),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."})),n.value}),i,(function(e,t){var o=n.gradFunc(e,t),i=Array.isArray(o)?o:[o];Jn(i.length===r.length,(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."})),Jn(i.every((function(e){return e instanceof Kr})),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."}));var a={};return i.forEach((function(e,t){a[t]=function(){return e}})),a}))}},e.prototype.readSync=function(e){return this.state.tensorInfo.get(e).backend.readSync(e)},e.prototype.read=function(e){return this.state.tensorInfo.get(e).backend.read(e)},e.prototype.time=function(e){return Ln(this,void 0,void 0,(function(){var t,n;return Bn(this,(function(r){switch(r.label){case 0:return t=Or(),[4,this.backend.time(e)];case 1:return(n=r.sent()).wallMs=Or()-t,[2,n]}}))}))},e.prototype.track=function(e){return null!=this.state.activeScope&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e},Object.defineProperty(e.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),e.prototype.reset=function(){for(var e in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new co,this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},e.nextTensorId=0,e.nextVariableId=0,e}(),fo=function(){var e=function(){if(null==uo){var e=void 0;if("undefined"!=typeof window)e=window;else if("undefined"!=typeof n.g)e=n.g;else if("undefined"!=typeof process)e=process;else{if("undefined"==typeof self)throw new Error("Could not find a global object");e=self}uo=e}return uo}();if(null==e._tfengine){var t=new Un(e);e._tfengine=new lo(t)}return function(e){Zn=e}(e._tfengine.ENV),Hr=function(){return e._tfengine},e._tfengine}();function ho(){return"undefined"!=typeof window&&null!=window.document||"undefined"!=typeof WorkerGlobalScope}var po=jn();po.registerFlag("DEBUG",(function(){return!1}),(function(e){e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),po.registerFlag("IS_BROWSER",(function(){return ho()})),po.registerFlag("IS_NODE",(function(){return"undefined"!=typeof process&&void 0!==process.versions&&void 0!==process.versions.node})),po.registerFlag("IS_CHROME",(function(){return"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)})),po.registerFlag("PROD",(function(){return!1})),po.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(function(){return po.getBool("DEBUG")})),po.registerFlag("DEPRECATION_WARNINGS_ENABLED",(function(){return!0})),po.registerFlag("IS_TEST",(function(){return!1}));var vo,mo,go,yo={},bo={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function wo(e,t){yo[e]=t}function xo(e){e in yo||(yo[e]=function(e){if(1!==e&&2!==e)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var t=function(e){if("undefined"!=typeof OffscreenCanvas&&2===e)return new OffscreenCanvas(300,150);if("undefined"!=typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(e);return t.addEventListener("webglcontextlost",(function(t){t.preventDefault(),delete yo[e]}),!1),1===e?t.getContext("webgl",bo)||t.getContext("experimental-webgl",bo):t.getContext("webgl2",bo)}(e));var t=yo[e];return t.isContextLost()?(delete yo[e],xo(e)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),yo[e])}function ko(e,t){return[t,e]}function _o(e){var t=rr(e);return sr(Math.ceil(t/4))}function Eo(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function Co(e,t){var n,r,o,i,a,s,u,c,l,f=e;return 2===jn().getNumber("WEBGL_VERSION")?(n=f.R32F,r=f.R16F,o=f.RGBA16F,i=f.RGBA32F,a=f.RED,s=4,u=1,c=f.HALF_FLOAT,l=f.FLOAT):(n=e.RGBA,r=e.RGBA,o=e.RGBA,i=f.RGBA,a=e.RGBA,s=4,u=4,c=null!=t?t.HALF_FLOAT_OES:null,l=e.FLOAT),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:o,internalFormatPackedFloat:i,textureFormatFloat:a,downloadTextureFormat:e.RGBA,downloadUnpackNumChannels:s,defaultNumChannels:u,textureTypeHalfFloat:c,textureTypeFloat:l}}function So(e,t,n){var r=n();return t&&function(e){var t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+Ro(e,t))}(e),r}!function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"}(vo||(vo={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(mo||(mo={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(go||(go={}));function Io(e){return!!(jn().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===e||5.96e-8<Math.abs(e)&&Math.abs(e)<65504)}function Ro(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+t}}function To(e,t,n){return Qo(e,t,(function(){return e.getExtension(n)}),'Extension "'+n+'" not supported on this browser.')}function Ao(e,t,n){var r=Qo(e,t,(function(){return e.createShader(e.VERTEX_SHADER)}),"Unable to create vertex WebGLShader.");if(So(e,t,(function(){return e.shaderSource(r,n)})),So(e,t,(function(){return e.compileShader(r)})),!1===e.getShaderParameter(r,e.COMPILE_STATUS))throw console.log(e.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function No(e,t,n){var r=Qo(e,t,(function(){return e.createShader(e.FRAGMENT_SHADER)}),"Unable to create fragment WebGLShader.");if(So(e,t,(function(){return e.shaderSource(r,n)})),So(e,t,(function(){return e.compileShader(r)})),!1===e.getShaderParameter(r,e.COMPILE_STATUS))throw function(e,t){var n=Po.exec(t);if(null==n)return console.log("Couldn't parse line number in error: "+t),void console.log(e);for(var r=+n[1],o=e.split("\n"),i=o.length.toString().length+2,a=o.map((function(e,t){return ur((t+1).toString(),i)+e})),s=0,u=0;u<a.length;u++)s=Math.max(a[u].length,s);var c=a.slice(0,r-1),l=a.slice(r-1,r),f=a.slice(r);console.log(c.join("\n")),console.log(t.split("\n")[0]),console.log("%c "+ur(l[0],s),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(f.join("\n"))}(n,e.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}var Oo,Do,Po=/ERROR: [0-9]+:([0-9]+):/g;function Mo(e,t){return Qo(e,t,(function(){return e.createProgram()}),"Unable to create WebGLProgram.")}function Fo(e,t,n){if(So(e,t,(function(){return e.linkProgram(n)})),!1===e.getProgramParameter(n,e.LINK_STATUS))throw console.log(e.getProgramInfoLog(n)),new Error("Failed to link vertex and fragment shaders.")}function Lo(e,t,n){if(So(e,t,(function(){return e.validateProgram(n)})),!1===e.getProgramParameter(n,e.VALIDATE_STATUS))throw console.log(e.getProgramInfoLog(n)),new Error("Shader program validation failed.")}function Bo(e,t,n){var r=Qo(e,t,(function(){return e.createBuffer()}),"Unable to create WebGLBuffer");return So(e,t,(function(){return e.bindBuffer(e.ARRAY_BUFFER,r)})),So(e,t,(function(){return e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW)})),r}function Uo(e,t,n){var r=Qo(e,t,(function(){return e.createBuffer()}),"Unable to create WebGLBuffer");return So(e,t,(function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r)})),So(e,t,(function(){return e.bufferData(e.ELEMENT_ARRAY_BUFFER,n,e.STATIC_DRAW)})),r}function jo(e,t){return Qo(e,t,(function(){return e.createTexture()}),"Unable to create WebGLTexture.")}function Zo(e,t){var n=jn().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){var r="["+e+"x"+t+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(e>n||t>n)throw r="["+e+"x"+t+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU ["+n+"x"+n+"].")}function Wo(e,t){return Qo(e,t,(function(){return e.createFramebuffer()}),"Unable to create WebGLFramebuffer.")}function zo(e,t,n,r,o,i,a,s){var u=e.getAttribLocation(n,r);return-1!==u&&(So(e,t,(function(){return e.bindBuffer(e.ARRAY_BUFFER,o)})),So(e,t,(function(){return e.vertexAttribPointer(u,i,e.FLOAT,!1,a,s)})),So(e,t,(function(){return e.enableVertexAttribArray(u)})),!0)}function Vo(e,t,n,r){Jo(e,r),So(e,t,(function(){return e.activeTexture(e.TEXTURE0+r)})),So(e,t,(function(){return e.bindTexture(e.TEXTURE_2D,n)}))}function Ho(e,t,n,r){return Qo(e,t,(function(){return e.getUniformLocation(n,r)}),'uniform "'+r+'" not present in program.')}function qo(e,t,n){return e.getUniformLocation(t,n)}function Go(e,t,n,r,o,i){So(e,t,(function(){return Vo(e,t,r,i)})),So(e,t,(function(){return e.uniform1i(o,i)}))}function Ko(e,t,n,r){So(e,t,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,r)})),So(e,t,(function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0)}))}function Xo(e,t,n){So(e,t,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,n)})),So(e,t,(function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)}))}function $o(e){var t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+Yo(e,t))}function Yo(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+t}}function Qo(e,t,n,r){var o=So(e,t,(function(){return n()}));if(null==o)throw new Error(r);return o}function Jo(e,t){var n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n)throw new Error("textureUnit must be in [gl.TEXTURE0, gl.TEXTURE"+n+"].")}function ei(e,t){return void 0===t&&(t=2),rr(e.slice(0,e.length-t))}function ti(e){if(0===e.length)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function ni(e){var t=[1,1,1];return 0===e.length||1===e.length&&1===e[0]||(t=[ei(e)].concat(ti(e))),t}function ri(e,t){var n;void 0===t&&(t=!1);var r=jn().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t&&(r*=2,1===(e=e.map((function(t,n){return n>=e.length-2?Yn(e[n]):e[n]}))).length&&(e=[2,e[0]])),2!==e.length){var o=hr(e);e=o.newShape}var i=rr(e);if(e.length<=1&&i<=r)return[1,i];if(2===e.length&&e[0]<=r&&e[1]<=r)return e;if(3===e.length&&e[0]*e[1]<=r&&e[2]<=r)return[e[0]*e[1],e[2]];if(3===e.length&&e[0]<=r&&e[1]*e[2]<=r)return[e[0],e[1]*e[2]];if(4===e.length&&e[0]*e[1]*e[2]<=r&&e[3]<=r)return[e[0]*e[1]*e[2],e[3]];if(4===e.length&&e[0]<=r&&e[1]*e[2]*e[3]<=r)return[e[0],e[1]*e[2]*e[3]];if(t){var a=ei(e),s=2,u=2;return e.length&&(s=(n=ti(e))[0],u=n[1]),sr(i=a*(s/2)*(u/2)).map((function(e){return 2*e}))}return sr(i)}function oi(e){return e%2==0}function ii(e,t){if(or(e=e.slice(-2),t=t.slice(-2)))return!0;if(!e.length||!t.length)return!0;if(0===e[0]||0===e[1]||0===t[0]||0===t[1])return!0;if(e.length!==t.length){var n=e.slice(-1)[0],r=t.slice(-1)[0];if(n===r)return!0;if(oi(n)&&oi(r)&&(1===e[0]||1===t[0]))return!0}return e[1]===t[1]&&oi(e[0])&&oi(t[0])}function ai(e){if(null==Oo){var t=xo(e);Oo=t.getParameter(t.MAX_TEXTURE_SIZE)}return Oo}function si(e){if(null==Do){var t=xo(e);Do=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Do)}function ui(e){if(0===e)return 0;var t=xo(e);return ci(t,"EXT_disjoint_timer_query_webgl2")&&2===e?2:ci(t,"EXT_disjoint_timer_query")?1:0}function ci(e,t){return null!=e.getExtension(t)}function li(e){try{if(null!=xo(e))return!0}catch(e){return!1}return!1}function fi(e){if(0===e)return!1;var t=xo(e);if(1===e){if(!ci(t,"OES_texture_float"))return!1}else if(!ci(t,"EXT_color_buffer_float"))return!1;return di(t)}function hi(e){if(0===e)return!1;var t=xo(e);if(1!==e){if(ci(t,"EXT_color_buffer_float"))return di(t);if(ci(t,"EXT_color_buffer_half_float")){var n=t.getExtension("EXT_color_buffer_half_float");return function(e,t){var n=Co(e,t),r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r),e.texImage2D(e.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);var o=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,o),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);var i=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(r),e.deleteFramebuffer(o),i}(t,n)}return!1}return!!ci(t,"OES_texture_float")&&!!ci(t,"WEBGL_color_buffer_float")&&di(t)}function di(e){var t=Co(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);var o=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),o}function pi(e){return 2===e&&null!=xo(e).fenceSync}var vi=Object.freeze({callAndCheck:So,canBeRepresented:Io,getWebGLErrorMessage:Ro,getExtensionOrThrow:To,createVertexShader:Ao,createFragmentShader:No,createProgram:Mo,linkProgram:Fo,validateProgram:Lo,createStaticVertexBuffer:Bo,createStaticIndexBuffer:Uo,getNumChannels:function(){return 2===jn().getNumber("WEBGL_VERSION")?1:4},createTexture:jo,validateTextureSize:Zo,createFramebuffer:Wo,bindVertexBufferToProgramAttribute:zo,bindTextureUnit:Vo,unbindTextureUnit:function(e,t,n){Jo(e,n),So(e,t,(function(){return e.activeTexture(e.TEXTURE0+n)})),So(e,t,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))},getProgramUniformLocationOrThrow:Ho,getProgramUniformLocation:qo,bindTextureToProgramUniformSampler:Go,bindCanvasToFramebuffer:function(e,t){So(e,t,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,null)})),So(e,t,(function(){return e.viewport(0,0,e.canvas.width,e.canvas.height)})),So(e,t,(function(){return e.scissor(0,0,e.canvas.width,e.canvas.height)}))},bindColorTextureToFramebuffer:Ko,unbindColorTextureFromFramebuffer:Xo,validateFramebuffer:$o,getFramebufferErrorMessage:Yo,getBatchDim:ei,getRowsCols:ti,getShapeAs3D:ni,getTextureShapeFromLogicalShape:ri,isReshapeFree:ii,getWebGLMaxTextureSize:ai,resetMaxTextureSize:function(){Oo=null},resetMaxTexturesInShader:function(){Do=null},getMaxTexturesInShader:si,getWebGLDisjointQueryTimerVersion:ui,hasExtension:ci,isWebGLVersionEnabled:li,isCapableOfRenderingToFloatTexture:fi,isDownloadFloatTextureEnabled:hi,isWebGLFenceEnabled:pi}),mi=jn();function gi(e){jn().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function yi(e,t){return fo.tidy(e,t)}function bi(e){so(e).forEach((function(e){return e.dispose()}))}function wi(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];jn().getBool("IS_TEST")||console.warn.apply(console,e)}function xi(e,t){var n=e;if(yr(e))return"string"===t?[]:[e.length];if(!Array.isArray(e))return[];for(var r=[];Array.isArray(n)||yr(n)&&"string"!==t;)r.push(n.length),n=n[0];return Array.isArray(e)&&jn().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function e(t,n,r){if(r=r||[],Array.isArray(t)||yr(t)){Jn(n.length>0,(function(){return"Element arr["+r.join("][")+"] should be a primitive, but is an array of "+t.length+" elements"})),Jn(t.length===n[0],(function(){return"Element arr["+r.join("][")+"] should have "+n[0]+" elements, but has "+t.length+" elements"}));for(var o=n.slice(1),i=0;i<t.length;++i)e(t[i],o,r.concat(i))}else Jn(0===n.length,(function(){return"Element arr["+r.join("][")+"] is a primitive, but should be an array/TypedArray of "+n[0]+" elements"}))}(e,r,[]),r}function ki(e,t,n,r){if(null!=e&&("numeric"!==e&&e!==t||"numeric"===e&&"string"===t))throw new Error("Argument '"+n+"' passed to '"+r+"' must be "+e+" tensor, but got "+t+" tensor")}function _i(e,t,n,r){if(void 0===r&&(r="numeric"),e instanceof Kr)return ki(r,e.dtype,t,n),e;var o=Er(e);if("string"!==o&&["bool","int32","float32"].indexOf(r)>=0&&(o=r),ki(r,o,t,n),null==e||!yr(e)&&!Array.isArray(e)&&"number"!=typeof e&&"boolean"!=typeof e&&"string"!=typeof e){var i=null==e?"null":e.constructor.name;throw new Error("Argument '"+t+"' passed to '"+n+"' must be a Tensor or TensorLike, but got '"+i+"'")}var a=xi(e,o);yr(e)||Array.isArray(e)||(e=[e]);var s="string"!==o?Rr(e,o,jn().getBool("DEBUG")):nr(e,[],!0);return fo.makeTensor(s,a,o)}function Ei(e,t,n,r){if(void 0===r&&(r="numeric"),!Array.isArray(e))throw new Error("Argument "+t+" passed to "+n+" must be a `Tensor[]` or `TensorLike[]`");return e.map((function(e,r){return _i(e,t+"["+r+"]",n)}),r)}function Ci(e,t){for(var n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function Si(e,t,n){for(var r=e.length+t.length,o=[],i=0,a=0,s=0;s<r;s++)-1===n.indexOf(s)?o.push(e[i++]):o.push(t[a++]);return o}function Ii(e,t){for(var n=[],r=e.length,o=0;o<r;o++)-1===t.indexOf(o)&&n.push(e[o]);return[n,t.map((function(t){return e[t]}))]}function Ri(e,t){return Si(e,t.map((function(e){return 1})),t)}function Ti(e,t,n){Jn(Ci(t,n),(function(){return e+" supports only inner-most axes for now. Got axes "+t+" and rank-"+n+" input."}))}function Ai(e,t){if(Ci(e,t))return null;for(var n=[],r=0;r<t;++r)-1===e.indexOf(r)&&n.push(r);return e.forEach((function(e){return n.push(e)})),n}function Ni(e){return e.map((function(e,t){return[t,e]})).sort((function(e,t){return e[1]-t[1]})).map((function(e){return e[0]}))}function Oi(e,t){for(var n=[],r=t-e;r<t;++r)n.push(r);return n}function Di(e,t){var n=e[0].length;e.forEach((function(e,t){Jn(e.length===n,(function(){return"Error in concat"+n+"D: rank of tensors["+t+"] must be the same as the rank of the rest ("+n+")"}))})),Jn(t>=0&&t<n,(function(){return"Error in concat"+n+"D: axis must be between 0 and "+(n-1)+"."}));var r=e[0];e.forEach((function(e,o){for(var i=0;i<n;i++)Jn(i===t||e[i]===r[i],(function(){return"Error in concat"+n+"D: Shape of tensors["+o+"] ("+e+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+o+"."}))}))}function Pi(e,t){for(var n=e[0].slice(),r=1;r<e.length;r++)n[t]+=e[r][t];return n}function Mi(e){var t=Object.keys(e);if(1!==t.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+t.length+" keys.");var n=t[0],r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));var o=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];fo.startScope(n);try{var o=r.apply(void 0,e);return o instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),fo.endScope(o),o}catch(e){throw fo.endScope(null),e}};return Object.defineProperty(o,"name",{value:n,configurable:!0}),o}mi.registerFlag("HAS_WEBGL",(function(){return mi.getNumber("WEBGL_VERSION")>0})),mi.registerFlag("WEBGL_VERSION",(function(){return li(2)?2:li(1)?1:0})),mi.registerFlag("WEBGL_BUFFER_SUPPORTED",(function(){return 2===mi.get("WEBGL_VERSION")})),mi.registerFlag("WEBGL_CPU_FORWARD",(function(){return!0})),mi.registerFlag("WEBGL_FORCE_F16_TEXTURES",(function(){return!1})),mi.registerFlag("WEBGL_PACK",(function(){return mi.getBool("HAS_WEBGL")})),mi.registerFlag("WEBGL_PACK_NORMALIZATION",(function(){return mi.getBool("WEBGL_PACK")})),mi.registerFlag("WEBGL_PACK_CLIP",(function(){return mi.getBool("WEBGL_PACK")})),mi.registerFlag("WEBGL_PACK_DEPTHWISECONV",(function(){return!1})),mi.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(function(){return mi.getBool("WEBGL_PACK")})),mi.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(function(){return mi.getBool("WEBGL_PACK")})),mi.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(function(){return mi.getBool("WEBGL_PACK")})),mi.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(function(){return mi.getBool("WEBGL_PACK")})),mi.registerFlag("WEBGL_PACK_REDUCE",(function(){return mi.getBool("WEBGL_PACK")})),mi.registerFlag("WEBGL_LAZILY_UNPACK",(function(){return mi.getBool("WEBGL_PACK")})),mi.registerFlag("WEBGL_CONV_IM2COL",(function(){return mi.getBool("WEBGL_PACK")})),mi.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(function(){return ai(mi.getNumber("WEBGL_VERSION"))})),mi.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(function(){return si(mi.getNumber("WEBGL_VERSION"))})),mi.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(function(){var e=mi.getNumber("WEBGL_VERSION");return 0===e?0:ui(e)})),mi.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(function(){return mi.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(e=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))));var e})),mi.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(function(){return fi(mi.getNumber("WEBGL_VERSION"))})),mi.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(function(){return!mi.getBool("WEBGL_FORCE_F16_TEXTURES")&&mi.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")})),mi.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(function(){return hi(mi.getNumber("WEBGL_VERSION"))})),mi.registerFlag("WEBGL_FENCE_API_ENABLED",(function(){return pi(mi.getNumber("WEBGL_VERSION"))})),mi.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(function(){return mi.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0})),Gr=gi;var Fi=Mi({complex_:function(e,t){var n=_i(e,"real","complex"),r=_i(t,"imag","complex");return er(n.shape,r.shape,"real and imag shapes, "+n.shape+" and "+r.shape+", must match in call to tf.complex()."),fo.runKernelFunc((function(e){return e.complex(n,r)}),{$real:n,$imag:r})}}),Li=Mi({real_:function(e){var t=_i(e,"input","real");return fo.runKernelFunc((function(e){return e.real(t)}),{$input:t})}}),Bi=Mi({imag_:function(e){var t=_i(e,"input","imag");return fo.runKernelFunc((function(e){return e.imag(t)}),{$input:t})}});function Ui(e,t,n){return ji(e,t,xi(e,n),n)}function ji(e,t,n,r){if(null==r&&(r=Er(e)),"complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!yr(e)&&!Array.isArray(e)&&"number"!=typeof e&&"boolean"!=typeof e&&"string"!=typeof e)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=t){Dr(t);var o=rr(t),i=rr(n);Jn(o===i,(function(){return"Based on the provided shape, ["+t+"], the tensor should have "+o+" values but has "+i}));for(var a=0;a<n.length;++a){var s=n[a],u=a!==n.length-1||s!==rr(t.slice(a));Jn(n[a]===t[a]||!u,(function(){return"Error creating a new Tensor. Inferred shape ("+n+") does not match the provided shape ("+t+"). "}))}}return yr(e)||Array.isArray(e)||(e=[e]),t=t||n,e="string"!==r?Rr(e,r,jn().getBool("DEBUG")):nr(e,[],!0),fo.makeTensor(e,t,r)}function Zi(e,t){if((yr(e)&&"string"!==t||Array.isArray(e))&&"complex64"!==t)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===t&&yr(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return ji(e,[],[],t)}function Wi(e,t){tr(e);var n=xi(e,t);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return ji(e,null,n,t)}function zi(e,t,n){if(tr(e),null!=t&&2!==t.length)throw new Error("tensor2d() requires shape to have two numbers");var r=xi(e,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return ji(e,t,r,n)}function Vi(e,t,n){if(tr(e),null!=t&&3!==t.length)throw new Error("tensor3d() requires shape to have three numbers");var r=xi(e,n);if(3!==r.length&&1!==r.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return ji(e,t,r,n)}function Hi(e,t,n){if(tr(e),null!=t&&4!==t.length)throw new Error("tensor4d() requires shape to have four numbers");var r=xi(e,n);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return ji(e,t,r,n)}function qi(e,t){if(void 0===t&&(t="float32"),"complex64"===t){var n=qi(e,"float32"),r=Gi(e,"float32");return Fi(n,r)}var o=Ar(rr(e),t);return fo.makeTensor(o,e,t)}function Gi(e,t){if(void 0===t&&(t="float32"),"complex64"===t){var n=Gi(e,"float32"),r=Gi(e,"float32");return Fi(n,r)}var o=Nr(rr(e),t);return fo.makeTensor(o,e,t)}function Ki(e,t,n){return fo.runKernelFunc((function(r){return r.fill(e,t,n)}),{})}function Xi(e,t,n,r){if(void 0===n&&(n=1),void 0===r&&(r="float32"),0===n)throw new Error("Cannot have a step of zero");if(e===t||e<t&&n<0||t<e&&n>1)return Gi([0],r);var o=Nr(Math.abs(Math.ceil((t-e)/n)),r);t<e&&1===n&&(n=-1),o[0]=e;for(var i=1;i<o.length;i++)o[i]=o[i-1]+n;return Wi(o,r)}var $i=Mi({onesLike_:function(e){var t=_i(e,"x","onesLike");if("complex64"===t.dtype){var n=$i(Li(t)),r=Yi(Bi(t));return Fi(n,r)}return fo.runKernelFunc((function(e){return e.onesLike(t)}),{$x:t},(function(e,t){return{$x:function(){return Yi(e)}}}))}}),Yi=Mi({zerosLike_:function(e){var t=_i(e,"x","zerosLike");return fo.runKernelFunc((function(e){return e.zerosLike(t)}),{$x:t},(function(e,t){return{$x:function(){return Yi(e)}}}))}}),Qi=Mi({concat_:function(e,t){void 0===t&&(t=0),Jn(e.length>=1,(function(){return"Pass at least one tensor to concat"}));var n=Ei(e,"tensors","concat");"complex64"===n[0].dtype&&n.forEach((function(e){if("complex64"!==e.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype "+e.dtype+". ")})),t=fr(t,n[0].shape)[0];var r=Pi(n.map((function(e){return e.shape})),t);if(0===rr(r))return Ui([],r);if(1===(n=n.filter((function(e){return e.size>0}))).length)return n[0];var o=n.map((function(e){return e.shape}));Di(o,t);var i=n,a={axis:t};return fo.runKernelFunc((function(e){return e.concat(n,t)}),i,(function(e){var n=o.map((function(e){return e[t]}));return ra(e,n,t).map((function(e){return function(){return e}}))}),"Concat",a)}}),Ji=Mi({concat1d_:function(e){return Qi(e,0)}}),ea=Mi({concat2d_:function(e,t){return Qi(e,t)}}),ta=Mi({concat3d_:function(e,t){return Qi(e,t)}}),na=Mi({concat4d_:function(e,t){return Qi(e,t)}}),ra=Mi({split_:function(e,t,n){void 0===n&&(n=0);var r,o=_i(e,"x","split");return n=fr(n,o.shape)[0],"number"==typeof t?(Jn(o.shape[n]%t==0,(function(){return"Number of splits must evenly divide the axis."})),r=new Array(t).fill(o.shape[n]/t)):(Jn(o.shape[n]===t.reduce((function(e,t){return e+t})),(function(){return"The sum of sizes must match the size of the axis dimension."})),r=t),fo.runKernelFunc((function(e){return e.split(o,r,n)}),{$x:o},(function(e){return{$x:function(){return Qi(e,n)}}}))}});function oa(e,t){return e(t={exports:{}},t.exports),t.exports}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof n.g?n.g:"undefined"!=typeof self&&self;var ia=oa((function(e){!function(e,t,n){function r(e){var t,n=this,r=(t=4022871197,function(e){e=e.toString();for(var n=0;n<e.length;n++){var r=.02519603282416938*(t+=e.charCodeAt(n));r-=t=r>>>0,t=(r*=t)>>>0,t+=4294967296*(r-=t)}return 2.3283064365386963e-10*(t>>>0)});n.next=function(){var e=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=e-(n.c=0|e)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(e),n.s0<0&&(n.s0+=1),n.s1-=r(e),n.s1<0&&(n.s1+=1),n.s2-=r(e),n.s2<0&&(n.s2+=1),r=null}function o(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function i(e,t){var n=new r(e),i=t&&t.state,a=n.next;return a.int32=function(){return 4294967296*n.next()|0},a.double=function(){return a()+11102230246251565e-32*(2097152*a()|0)},a.quick=a,i&&("object"==typeof i&&o(i,n),a.state=function(){return o(n,{})}),a}t&&t.exports?t.exports=i:this.alea=i}(0,e)})),aa=oa((function(e){!function(e,t,n){function r(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}function o(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function i(e,t){var n=new r(e),i=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,i&&("object"==typeof i&&o(i,n),a.state=function(){return o(n,{})}),a}t&&t.exports?t.exports=i:this.xor128=i}(0,e)})),sa=oa((function(e){!function(e,t,n){function r(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function o(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function i(e,t){var n=new r(e),i=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,i&&("object"==typeof i&&o(i,n),a.state=function(){return o(n,{})}),a}t&&t.exports?t.exports=i:this.xorwow=i}(0,e)})),ua=oa((function(e){!function(e,t,n){function r(e){var t=this;t.next=function(){var e,n,r=t.x,o=t.i;return e=r[o],n=(e^=e>>>7)^e<<24,n^=(e=r[o+1&7])^e>>>10,n^=(e=r[o+3&7])^e>>>3,n^=(e=r[o+4&7])^e<<7,e=r[o+7&7],n^=(e^=e<<13)^e<<9,r[o]=n,t.i=o+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,n=0;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function o(e,t){return t.x=e.x.slice(),t.i=e.i,t}function i(e,t){null==e&&(e=+new Date);var n=new r(e),i=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,i&&(i.x&&o(i,n),a.state=function(){return o(n,{})}),a}t&&t.exports?t.exports=i:this.xorshift7=i}(0,e)})),ca=oa((function(e){!function(e,t,n){function r(e){var t=this;t.next=function(){var e,n,r=t.w,o=t.X,i=t.i;return t.w=r=r+1640531527|0,n=o[i+34&127],e=o[i=i+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=o[i]=n^e,t.i=i,n+(r^r>>>16)|0},function(e,t){var n,r,o,i,a,s=[],u=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,u=Math.max(u,t.length)),o=0,i=-32;i<u;++i)t&&(r^=t.charCodeAt((i+32)%t.length)),0===i&&(a=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,i>=0&&(a=a+1640531527|0,o=0==(n=s[127&i]^=r+a)?o+1:0);for(o>=128&&(s[127&(t&&t.length||0)]=-1),o=127,i=512;i>0;--i)r=s[o+34&127],n=s[o=o+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[o]=r^n;e.w=a,e.X=s,e.i=o}(t,e)}function o(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function i(e,t){null==e&&(e=+new Date);var n=new r(e),i=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,i&&(i.X&&o(i,n),a.state=function(){return o(n,{})}),a}t&&t.exports?t.exports=i:this.xor4096=i}(0,e)})),la=oa((function(e){!function(e,t,n){function r(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,o=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^o,o=o-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^o,t.a=o-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}function o(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function i(e,t){var n=new r(e),i=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,i&&("object"==typeof i&&o(i,n),a.state=function(){return o(n,{})}),a}t&&t.exports?t.exports=i:this.tychei=i}(0,e)})),fa=oa((function(e){!function(t,r){var o,i=this,a=256,s="random",u=r.pow(a,6),c=r.pow(2,52),l=2*c,f=a-1;function h(e,n,f){var h=[],g=v(function e(t,n){var r,o=[],i=typeof t;if(n&&"object"==i)for(r in t)try{o.push(e(t[r],n-1))}catch(e){}return o.length?o:"string"==i?t:t+"\0"}((n=1==n?{entropy:!0}:n||{}).entropy?[e,m(t)]:null==e?function(){try{var e;return o&&(e=o.randomBytes)?e=e(a):(e=new Uint8Array(a),(i.crypto||i.msCrypto).getRandomValues(e)),m(e)}catch(e){var n=i.navigator,r=n&&n.plugins;return[+new Date,i,r,i.screen,m(t)]}}():e,3),h),y=new d(h),b=function(){for(var e=y.g(6),t=u,n=0;e<c;)e=(e+n)*a,t*=a,n=y.g(1);for(;e>=l;)e/=2,t/=2,n>>>=1;return(e+n)/t};return b.int32=function(){return 0|y.g(4)},b.quick=function(){return y.g(4)/4294967296},b.double=b,v(m(y.S),t),(n.pass||f||function(e,t,n,o){return o&&(o.S&&p(o,y),e.state=function(){return p(y,{})}),n?(r[s]=e,t):e})(b,g,"global"in n?n.global:this==r,n.state)}function d(e){var t,n=e.length,r=this,o=0,i=r.i=r.j=0,s=r.S=[];for(n||(e=[n++]);o<a;)s[o]=o++;for(o=0;o<a;o++)s[o]=s[i=f&i+e[o%n]+(t=s[o])],s[i]=t;(r.g=function(e){for(var t,n=0,o=r.i,i=r.j,s=r.S;e--;)t=s[o=f&o+1],n=n*a+s[f&(s[o]=s[i=f&i+t])+(s[i]=t)];return r.i=o,r.j=i,n})(a)}function p(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function v(e,t){for(var n,r=e+"",o=0;o<r.length;)t[f&o]=f&(n^=19*t[f&o])+r.charCodeAt(o++);return m(t)}function m(e){return String.fromCharCode.apply(0,e)}if(r["seed"+s]=h,v(r.random(),t),e.exports){e.exports=h;try{o=n(4902)}catch(e){}}}([],Math)}));fa.alea=ia,fa.xor128=aa,fa.xorwow=sa,fa.xorshift7=ua,fa.xor4096=ca,fa.tychei=la;var ha=fa.alea,da=function(){function e(e,t,n,r,o){this.mean=e,this.stdDev=t,this.dtype=n,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var i=o||Math.random();this.random=ha(i.toString())}return e.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var e=this.nextVal;return this.nextVal=NaN,e}for(var t,n,r=!1;!r;){var o=void 0,i=void 0,a=void 0;do{a=(o=2*this.random()-1)*o+(i=2*this.random()-1)*i}while(a>=1||0===a);var s=Math.sqrt(-2*Math.log(a)/a);t=this.mean+this.stdDev*o*s,n=this.mean+this.stdDev*i*s,this.truncated&&!this.isValidTruncated(t)||(r=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(t)},e.prototype.convertValue=function(e){return null==this.dtype||"float32"===this.dtype?e:Math.round(e)},e.prototype.isValidTruncated=function(e){return e<=this.upper&&e>=this.lower},e}(),pa=function(){function e(e,t,n,r){this.alpha=e,this.beta=1/t,this.dtype=n;var o=r||Math.random();this.randu=ha(o.toString()),this.randn=new da(0,1,n,!1,this.randu()),this.d=e<1?e+2/3:e-1/3,this.c=1/Math.sqrt(9*this.d)}return e.prototype.nextValue=function(){for(var e,t,n,r,o,i;;){do{r=this.randn.nextValue(),i=1+this.c*r}while(i<=0);if(i*=i*i,t=1-.331*(e=r*r)*e,n=.5*e+this.d*(1-i+Math.log(i)),(o=this.randu())<t||Math.log(o)<n)break}return i=1/this.beta*this.d*i,this.alpha<1&&(i*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(i)},e.prototype.convertValue=function(e){return"float32"===this.dtype?e:Math.round(e)},e}(),va=function(){function e(e,t,n,r){var o=this;if(void 0===e&&(e=0),void 0===t&&(t=1),this.canReturnFloat=function(){return null==o.dtype||"float32"===o.dtype},this.min=e,this.range=t-e,this.dtype=n,null==r&&(r=Math.random()),"number"==typeof r&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+e+" - "+t+" <= 1 and dtype is not float");this.random=ha(r)}return e.prototype.convertValue=function(e){return this.canReturnFloat()?e:Math.round(e)},e.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},e}();function ma(e,t,n){return void 0===t&&(t="float32"),t=t||"float32",Dr(e),new Vr(e,t,n)}var ga=Mi({batchToSpaceND_:function(e,t,n){var r=_i(e,"x","batchToSpaceND"),o=t.reduce((function(e,t){return e*t}));return Jn(r.rank>=1+t.length,(function(){return"input rank is "+r.rank+" but should be > than blockShape.length "+t.length})),Jn(n.length===t.length,(function(){return"crops.length is "+n.length+" but should be equal to blockShape.length  "+t.length})),Jn(r.shape[0]%o==0,(function(){return"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+t.join(" * ")+" === "+o})),fo.runKernelFunc((function(e){return e.batchToSpaceND(r,t,n)}),{$x:r},(function(e){return{$x:function(){return e.spaceToBatchND(t,n)}}}))}}),ya=Mi({broadcastTo_:function(e,t){var n=_i(e,"broadcastTo","x"),r=n.shape;if(t.some((function(e){return!(e>0)||e%1!=0})))throw new Error("broadcastTo(): Invalid broadcast shape ["+t+"].");if(t.length<n.rank)throw new Error("broadcastTo(): shape.length="+t.length+" < input.rank="+n.rank+".");if(t.length>n.rank){for(var o=n.shape.slice();o.length<t.length;)o.unshift(1);n=n.reshape(o)}for(var i=Array.from(t),a=t.length-1;a>=0;a--)if(n.shape[a]===t[a])i[a]=1;else if(1!==n.shape[a])throw new Error("broadcastTo(): ["+r+"] cannot be broadcast to ["+t+"].");var s=i.map((function(e,t){return e>1?t:-1})).filter((function(e){return e>=0}));return 0===s.length?n.clone():fo.runKernelFunc((function(e){return e.tile(n,i)}),{input:n},(function(e){return{input:function(){return e.sum(s,!0)}}}))}}),ba=Mi({cast_:function(e,t){var n=_i(e,"x","cast");if(!mr(t))throw new Error("Failed to cast to unknown dtype "+t);if("string"===t&&"string"!==n.dtype||"string"!==t&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");var r={dtype:t};return fo.runKernelFunc((function(e){return e.cast(n,t)}),{x:n},(function(e){return{x:function(){return e.clone()}}}),"Cast",r)}}),wa=Mi({clone_:function(e){var t=_i(e,"x","clone",null);return fo.runKernelFunc((function(){return fo.makeTensorFromDataId(t.dataId,t.shape,t.dtype)}),{$x:t},(function(e){return{$x:function(){return e.toFloat()}}}))}}),xa=Mi({cumsum_:function(e,t,n,r){void 0===t&&(t=0),void 0===n&&(n=!1),void 0===r&&(r=!1);var o=_i(e,"x","cumsum"),i=Ai([t|=0],o.rank),a=o;null!=i&&(a=o.transpose(i));var s=Oi(1,o.rank)[0],u=fo.runKernelFunc((function(e){return e.cumsum(a,s,n,r)}),{permutedX:a},(function(e){return{permutedX:function(){return e.cumsum(t,n,!r)}}}));return null!=i&&(u=u.transpose(i)),u}}),ka=Mi({depthToSpace_:function(e,t,n){void 0===n&&(n="NHWC");var r=_i(e,"x","depthToSpace"),o="NHWC"===n?r.shape[1]:r.shape[2],i="NHWC"===n?r.shape[2]:r.shape[3],a="NHWC"===n?r.shape[3]:r.shape[1];return Jn(o*t>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n      "+o+" and "+t+"  for depthToSpace with input shape\n      "+r.shape})),Jn(i*t>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n      "+i+" and "+t+" for depthToSpace with input shape\n          "+r.shape})),Jn(a%(t*t)==0,(function(){return"Dimension size must be evenly divisible by "+t*t+" but is "+a+" for depthToSpace with input shape "+r.shape})),fo.runKernelFunc((function(e){return e.depthToSpace(r,t,n)}),{$x:r})}}),_a=Mi({expandDims_:function(e,t){void 0===t&&(t=0);var n=_i(e,"x","expandDims",null);Jn(t<=n.rank,(function(){return"Axis must be <= rank of the tensor"}));var r=n.shape.slice();return t<0&&(Jn(-(n.rank+1)<=t,(function(){return"Axis must be in the interval ["+-(n.rank+1)+", "+n.rank+"]"})),t=n.rank+t+1),r.splice(t,0,1),Fa(n,r)}}),Ea=Mi({eye_:function(e,t,n,r){void 0===r&&(r="float32"),null==t&&(t=e);for(var o=ma([e,t],r),i=e<=t?e:t,a=0;a<i;++a)o.set(1,a,a);var s=o.toTensor().as2D(e,t);if(null==n)return s;if(1===n.length)return ja(_a(s,0),[n[0],1,1]);if(2===n.length)return ja(_a(_a(s,0),0),[n[0],n[1],1,1]);if(3===n.length)return ja(_a(_a(_a(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+n.length+"D.")}}),Ca=Mi({multinomial_:function(e,t,n,r){void 0===r&&(r=!1);var o=_i(e,"logits","multinomial"),i=o.size,a=o.rank;if(i<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+i+".");if(a>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+a);n=n||Math.random();var s=1===a?o.as2D(1,-1):o,u=fo.runKernelFunc((function(e){return e.multinomial(s,r,t,n)}),{logits2D:s});return 1===a?u.as1D():u}}),Sa=Mi({oneHot_:function(e,t,n,r){if(void 0===n&&(n=1),void 0===r&&(r=0),t<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+t);var o=_i(e,"indices","oneHot","int32"),i=o.shape.concat([t]);return o=o.flatten(),fo.runKernelFunc((function(e){return e.oneHot(o,t,n,r)}),{$indices:o},(function(e){return{$indices:function(){return Gi(o.shape,"float32")}}})).reshape(i)}}),Ia=Mi({pad_:function(e,t,n){void 0===n&&(n=0);var r=_i(e,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var o={paddings:t,constantValue:n};return fo.runKernelFunc((function(e){return e.pad(r,t,n)}),{x:r},(function(e){var n=t.map((function(e){return e[0]}));return{x:function(){return e.slice(n,r.shape)}}}),"PadV2",o)}}),Ra=Mi({pad1d_:function(e,t,n){return void 0===n&&(n=0),Jn(2===t.length,(function(){return"Invalid number of paddings. Must be length of 2."})),Ia(e,[t],n)}}),Ta=Mi({pad2d_:function(e,t,n){return void 0===n&&(n=0),Jn(2===t.length&&2===t[0].length&&2===t[1].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),Ia(e,t,n)}}),Aa=Mi({pad3d_:function(e,t,n){return void 0===n&&(n=0),Jn(3===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),Ia(e,t,n)}}),Na=Mi({pad4d_:function(e,t,n){return void 0===n&&(n=0),Jn(4===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length&&2===t[3].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),Ia(e,t,n)}}),Oa=Mi({rand_:function(e,t,n){var r=rr(e),o=null;if(null==n||"float32"===n)o=new Float32Array(r);else if("int32"===n)o=new Int32Array(r);else{if("bool"!==n)throw new Error("Unknown data type "+n);o=new Uint8Array(r)}for(var i=0;i<r;i++)o[i]=t();return fo.makeTensor(o,e,n)}}),Da=Mi({randomNormal_:function(e,t,n,r,o){if(void 0===t&&(t=0),void 0===n&&(n=1),null!=r&&"bool"===r)throw new Error("Unsupported data type "+r);for(var i=new da(t,n,r,!1,o),a=ma(e,r),s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}}),Pa=Mi({randomGamma_:function(e,t,n,r,o){if(void 0===n&&(n=1),void 0===r&&(r="float32"),null==n&&(n=1),null==r&&(r="float32"),"float32"!==r&&"int32"!==r)throw new Error("Unsupported data type "+r);for(var i=new pa(t,n,r,o),a=ma(e,r),s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}}),Ma=Mi({randomUniform_:function(e,t,n,r,o){void 0===t&&(t=0),void 0===n&&(n=1),void 0===r&&(r="float32");for(var i=ma(e,r),a=new va(t,n,null,o),s=0;s<i.values.length;s++)i.values[s]=a.nextValue();return i.toTensor()}}),Fa=Mi({reshape_:function(e,t){var n=_i(e,"x","reshape",null);t=lr(t,n.size),Jn(n.size===rr(t),(function(){return"new shape and old shape must have the same number of elements."}));var r={shape:t};return fo.runKernelFunc((function(e){return e.reshape(n,t)}),{x:n},(function(e){return{x:function(){return e.reshape(n.shape)}}}),"Reshape",r)}}),La=Mi({spaceToBatchND_:function(e,t,n){var r=_i(e,"x","spaceToBatchND");return Jn(r.rank>=1+t.length,(function(){return"input rank "+r.rank+" should be > than [blockShape] "+t.length})),Jn(n.length===t.length,(function(){return"paddings.shape[0] "+n.length+" must be equal to [blockShape] "+t.length})),Jn(r.shape.reduce((function(e,r,o){return o>0&&o<=t.length?e&&(r+n[o-1][0]+n[o-1][1])%t[o-1]==0:e}),!0),(function(){return"input spatial dimensions "+r.shape.slice(1)+" with paddings "+n.toString()+" must be divisible by blockShapes "+t.toString()})),fo.runKernelFunc((function(e){return e.spaceToBatchND(r,t,n)}),{$x:r},(function(e){return{$x:function(){return e.batchToSpaceND(t,n)}}}))}}),Ba=Mi({squeeze_:function(e,t){var n=_i(e,"x","squeeze");return Fa(n,hr(n.shape,t).newShape)}}),Ua=Mi({stack_:function(e,t){void 0===t&&(t=0);var n=Ei(e,"tensors","stack");if(Jn(n.length>=1,(function(){return"Pass at least one tensor to tf.stack"})),1===n.length)return n[0].expandDims(t);var r=n[0].rank,o=n[0].shape,i=n[0].dtype;Jn(t<=r,(function(){return"Axis must be <= rank of the tensor"})),n.forEach((function(e){er(o,e.shape,"All tensors passed to stack must have matching shapes")})),n.forEach((function(e){Jn(i===e.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var a=n.map((function(e){return e.expandDims(t)}));return Qi(a,t)}}),ja=Mi({tile_:function(e,t){var n=_i(e,"x","tile",null);Jn(n.rank===t.length,(function(){return"Error in transpose: rank of input "+n.rank+" must match length of reps "+t+"."}));var r=[n],o={reps:t};return fo.runKernelFunc((function(e,r){var o=e.tile(n,t);return r([n]),o}),{x:n},(function(e,n){var r=n[0];return{x:function(){var n=Yi(r);if(1===r.rank)for(var o=0;o<t[0];++o)n=n.add(e.slice([o*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(o=0;o<t[0];++o)for(var i=0;i<t[1];++i)n=n.add(e.slice([o*r.shape[0],i*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(o=0;o<t[0];++o)for(i=0;i<t[1];++i)for(var a=0;a<t[2];++a)n=n.add(e.slice([o*r.shape[0],i*r.shape[1],a*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+r.rank+" tensors yet.");for(o=0;o<t[0];++o)for(i=0;i<t[1];++i)for(a=0;a<t[2];++a)for(var s=0;s<t[3];++s)n=n.add(e.slice([o*r.shape[0],i*r.shape[1],a*r.shape[2],s*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return n}}}),"Tile",o,r)}}),Za=Mi({truncatedNormal_:function(e,t,n,r,o){if(void 0===t&&(t=0),void 0===n&&(n=1),null!=r&&"bool"===r)throw new Error("Unsupported data type "+r);for(var i=new da(t,n,r,!0,o),a=ma(e,r),s=0;s<a.values.length;s++)a.values[s]=i.nextValue();return a.toTensor()}}),Wa=Mi({unstack_:function(e,t){void 0===t&&(t=0),t=t||0;var n=_i(e,"x","unstack");Jn(t>=-n.shape.length&&t<n.shape.length,(function(){return"Axis = "+t+" is not in [-"+n.shape.length+", "+n.shape.length+")"})),t<0&&(t+=n.shape.length);var r={axis:t};return fo.runKernelFunc((function(e){return e.unstack(n,t)}),{x:n},(function(e){return{x:function(){return Ua(e,t)}}}),"Unpack",r)}});function za(e,t,n,r){void 0===r&&(r=!0);var o=[];if(r)(o=o.concat(t.slice(0))).push(e[0]/n),o=o.concat(e.slice(1));else{o=o.concat(e[0]);for(var i=t.length,a=0;a<i;++a)o=o.concat([e[a+1]/t[a],t[a]]);o=o.concat(e.slice(i+1))}return o}function Va(e,t,n){void 0===n&&(n=!0);var r=[];if(n){r.push(t);for(var o=t+1;o<e;++o)o<=2*t?(r.push(o),r.push(o-(t+1))):r.push(o)}else{var i=[],a=[];for(o=1;o<e;++o)o>=2*t+1||o%2==1?a.push(o):i.push(o);r.push.apply(r,i),r.push(0),r.push.apply(r,a)}return r}function Ha(e,t,n,r){void 0===r&&(r=!0);var o=[];r?o.push(e[0]/n):o.push(e[0]*n);for(var i=1;i<e.length;++i)i<=t.length?r?o.push(t[i-1]*e[i]):o.push(e[i]/t[i-1]):o.push(e[i]);return o}function qa(e,t){for(var n=[0],r=0;r<t;++r)n.push(e[r][0]);return n}function Ga(e,t,n){for(var r=e.slice(0,1),o=0;o<n;++o)r.push(e[o+1]-t[o][0]-t[o][1]);return r}function Ka(e,t){if(e.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+e.rank+".");if(t.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if("int32"!==t.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+t.dtype+".");if(t.shape[t.rank-1]>e.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+t.shape[t.rank-1]+" vs. "+e.rank);if(0===e.size)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+e.shape+".");for(var n=t.shape,r=n[n.length-1],o=1,i=0;i<n.length-1;++i)o*=n[i];var a=e.shape,s=n.slice();s.pop();var u=1;for(i=r;i<e.rank;++i)u*=a[i],s.push(a[i]);var c=Ir(e.shape).map((function(e){return e/u})).concat([1]).slice(0,r);return[s,o,u,c]}Object.freeze({prepareAndValidate:Ka});function Xa(e){return e<=30?e:Sr(e,Math.floor(Math.sqrt(e)))}function $a(e,t,n){var r=t.rank>1?t.shape[t.rank-1]:1,o=t.rank>1?t.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+n.shape+", indices.shape: "+t.shape+", shape: "+e+", sliceDim: "+r+", and batchDim: "+o+".";if(n.rank<o)throw new Error(i+" update.rank < "+o+". ");if(e.length<r+(n.rank-o))throw new Error(i+" Output shape length < "+(r+(n.rank-o)));if(n.rank!==o+e.length-r)throw new Error(i+" update.rank != "+(o+e.length-r));for(var a=0;a<o;++a)if(n.shape[a]!==t.shape[a])throw new Error(i+" updates.shape["+a+"] ("+n.shape[a]+") != indices.shape["+a+"] ("+t.shape[a]+").");for(a=0;a<n.rank-o;++a)if(n.shape[a+o]!==e[a+r])throw new Error(i+" updates.shape["+(a+o)+"] ("+n.shape[a+o]+") != shape["+(a+o)+"] ("+e[a+o]+")")}function Ya(e,t,n){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(e.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+e.rank+".");if("int32"!==t.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: "+t.dtype);if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+n);if(0===n.length){if(0===t.size)throw new Error("Indices specified for empty output. indices shape: "+t.shape);if(0===e.size)throw new Error("Updates specified for empty output. updates shape: "+e.shape)}$a(n,t,e)}function Qa(e,t,n){for(var r=t.shape.length,o=r>1?t.shape[r-1]:1,i=n.length,a=1,s=o;s<i;++s)a*=n[s];var u=o<1?1:o;return{sliceRank:o,numUpdates:rr(t.shape)/u,sliceSize:a,strides:Ir(n.slice(0,o)).concat([1]),outputSize:rr(n)}}Object.freeze({validateUpdateShape:$a,validateInput:Ya,calculateShapes:Qa});function Ja(e,t,n){Jn(e.rank===t.length,(function(){return"Error in slice"+e.rank+"D: Length of begin "+t+" must match the rank of the array ("+e.rank+")."})),Jn(e.rank===n.length,(function(){return"Error in slice"+e.rank+"D: Length of size "+n+" must match the rank of the array ("+e.rank+")."}));for(var r=function(r){Jn(t[r]+n[r]<=e.shape[r],(function(){return"Error in slice"+e.rank+"D: begin["+r+"] + size["+r+"] ("+(t[r]+n[r])+") would overflow input.shape["+r+"] ("+e.shape[r]+")"}))},o=0;o<e.rank;++o)r(o)}function es(e){for(var t=[],n=0;e>0;)1&e&&t.push(n),e/=2,n++;return t}function ts(e,t,n){for(var r=[],o=0;o<e.length;o++)r[o]=Math.ceil((t[o]-e[o])/n[o]);return r}function ns(e,t,n,r,o){var i=t[o],a=n[o]||1;(e&1<<o||null==i)&&(i=a>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var s=r[o];return i<0&&(i+=s),$n(0,i,s-1)}function rs(e,t,n,r,o){var i=t[o],a=n[o]||1;(e&1<<o||null==i)&&(i=a>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var s=r[o];return i<0&&(i+=s),a>0?$n(0,i,s):$n(-1,i,s-1)}function os(e,t,n){for(var r=n.length,o=0;o<n.length;o++)if(n[o]>1){r=o;break}for(o=r+1;o<n.length;o++)if(t[o]>0||n[o]!==e[o])return!1;return!0}function is(e,t){for(var n=e.length>0?e[e.length-1]:1,r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}Object.freeze({assertParamsValid:Ja,maskToAxes:es,computeOutShape:ts,startForAxis:ns,stopForAxis:rs,isSliceContinous:os,computeFlatOffset:is});function as(e){return fo.customGrad(e)}var ss=Mi({softmax_:function(e,t){void 0===t&&(t=-1);var n=_i(e,"logits","softmax","float32");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and dim was "+t);return fo.runKernelFunc((function(e,r){var o=e.softmax(n,t);return r([o]),o}),{logits:n},(function(e,n){var r=n[0],o=e.mul(r);return{logits:function(){return o.sub(o.sum([t],!0).mul(r))}}}),"Softmax",{dim:t},[],[!0])}}),us=Mi({logSoftmax_:function(e,t){void 0===t&&(t=-1);var n=_i(e,"logits","logSoftmax");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and axis was "+t);return as((function(e,n){var r=e.max(t,!0),o=e.sub(r),i=o.toFloat().sub(o.exp().sum(t,!0).log());return n([i]),{value:i,gradFunc:function(e,n){var r=n[0].exp();return e.sub(e.sum(t,!0).mul(r))}}}))(n)}}),cs=function(){function e(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}return e.prototype.get=function(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)},e.prototype.set=function(e,t){this.dataIdsCount++,this.data.set(e,t)},e.prototype.has=function(e){return this.data.has(e)},e.prototype.delete=function(e){return this.dataIdsCount--,this.data.delete(e)},e.prototype.numDataIds=function(){return this.dataIdsCount},e}(),ls=function(){function e(){}return e.prototype.time=function(e){return fs("time")},e.prototype.read=function(e){return fs("read")},e.prototype.readSync=function(e){return fs("readSync")},e.prototype.numDataIds=function(){return fs("numDataIds")},e.prototype.disposeData=function(e){return fs("disposeData")},e.prototype.write=function(e,t,n){return fs("write")},e.prototype.move=function(e,t,n,r){return fs("move")},e.prototype.memory=function(){return fs("memory")},e.prototype.floatPrecision=function(){return fs("floatPrecision")},e.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},e.prototype.batchMatMul=function(e,t,n,r){return fs("batchMatMul")},e.prototype.fusedBatchMatMul=function(e){return e.a,e.b,e.transposeA,e.transposeB,e.bias,e.activation,e.preluActivationWeights,fs("fusedBatchMatMul")},e.prototype.slice=function(e,t,n){return fs("slice")},e.prototype.stridedSlice=function(e,t,n,r){return fs("stridedSlice")},e.prototype.unstack=function(e,t){return fs("unstack")},e.prototype.reverse=function(e,t){return fs("reverse")},e.prototype.concat=function(e,t){return fs("concat")},e.prototype.neg=function(e){return fs("neg")},e.prototype.add=function(e,t){return fs("add")},e.prototype.addN=function(e){return fs("addN")},e.prototype.subtract=function(e,t){return fs("subtract")},e.prototype.multiply=function(e,t){return fs("multiply")},e.prototype.realDivide=function(e,t){return fs("realDivide")},e.prototype.floorDiv=function(e,t){return fs("floorDiv")},e.prototype.sum=function(e,t){return fs("sum")},e.prototype.prod=function(e,t){return fs("prod")},e.prototype.unsortedSegmentSum=function(e,t,n){return fs("unsortedSegmentSum")},e.prototype.argMin=function(e,t){return fs("argMin")},e.prototype.argMax=function(e,t){return fs("argMax")},e.prototype.equal=function(e,t){return fs("equal")},e.prototype.notEqual=function(e,t){return fs("notEqual")},e.prototype.less=function(e,t){return fs("less")},e.prototype.lessEqual=function(e,t){return fs("lessEqual")},e.prototype.greater=function(e,t){return fs("greater")},e.prototype.greaterEqual=function(e,t){return fs("greaterEqual")},e.prototype.logicalNot=function(e){return fs("logicalNot")},e.prototype.logicalAnd=function(e,t){return fs("logicalAnd")},e.prototype.logicalOr=function(e,t){return fs("logicalOr")},e.prototype.where=function(e){return fs("where")},e.prototype.select=function(e,t,n){return fs("select")},e.prototype.topk=function(e,t,n){return fs("topk")},e.prototype.min=function(e,t){return fs("min")},e.prototype.minimum=function(e,t){return fs("minimum")},e.prototype.mod=function(e,t){return fs("mod")},e.prototype.max=function(e,t){return fs("max")},e.prototype.maximum=function(e,t){return fs("maximum")},e.prototype.all=function(e,t){return fs("all")},e.prototype.any=function(e,t){return fs("any")},e.prototype.squaredDifference=function(e,t){return fs("squaredDifference")},e.prototype.ceil=function(e){return fs("ceil")},e.prototype.floor=function(e){return fs("floor")},e.prototype.round=function(e){return fs("round")},e.prototype.sign=function(e){return fs("sign")},e.prototype.isNaN=function(e){return fs("isNaN")},e.prototype.isInf=function(e){return fs("isInf")},e.prototype.isFinite=function(e){return fs("isFinite")},e.prototype.pow=function(e,t){return fs("pow")},e.prototype.exp=function(e){return fs("exp")},e.prototype.expm1=function(e){return fs("expm1")},e.prototype.softmax=function(e,t){return fs("softmax")},e.prototype.log=function(e){return fs("log")},e.prototype.log1p=function(e){return fs("log1p")},e.prototype.sqrt=function(e){return fs("sqrt")},e.prototype.rsqrt=function(e){return fs("rsqrt")},e.prototype.square=function(e){return fs("square")},e.prototype.reciprocal=function(e){return fs("reciprocal")},e.prototype.relu=function(e){return fs("relu")},e.prototype.relu6=function(e){return fs("relu6")},e.prototype.prelu=function(e,t){return fs("prelu")},e.prototype.elu=function(e){return fs("elu")},e.prototype.eluDer=function(e,t){return fs("eluDer")},e.prototype.selu=function(e){return fs("selu")},e.prototype.int=function(e){return fs("int")},e.prototype.clip=function(e,t,n){return fs("clip")},e.prototype.abs=function(e){return fs("abs")},e.prototype.complexAbs=function(e){return fs("complexAbs")},e.prototype.sigmoid=function(e){return fs("sigmoid")},e.prototype.softplus=function(e){return fs("softplus")},e.prototype.sin=function(e){return fs("sin")},e.prototype.cos=function(e){return fs("cos")},e.prototype.tan=function(e){return fs("tan")},e.prototype.asin=function(e){return fs("asin")},e.prototype.acos=function(e){return fs("acos")},e.prototype.atan=function(e){return fs("atan")},e.prototype.atan2=function(e,t){return fs("atan2")},e.prototype.sinh=function(e){return fs("sinh")},e.prototype.cosh=function(e){return fs("cosh")},e.prototype.tanh=function(e){return fs("tanh")},e.prototype.asinh=function(e){return fs("asinh")},e.prototype.acosh=function(e){return fs("acosh")},e.prototype.atanh=function(e){return fs("atanh")},e.prototype.erf=function(e){return fs("erf")},e.prototype.step=function(e,t){return fs("step")},e.prototype.fusedConv2d=function(e){return e.input,e.filter,e.convInfo,e.bias,e.activation,e.preluActivationWeights,fs("fusedConv2d")},e.prototype.conv2d=function(e,t,n){return fs("conv2d")},e.prototype.conv2dDerInput=function(e,t,n){return fs("conv2dDerInput")},e.prototype.conv2dDerFilter=function(e,t,n){return fs("conv2dDerFilter")},e.prototype.fusedDepthwiseConv2D=function(e){return e.input,e.filter,e.convInfo,e.bias,e.activation,e.preluActivationWeights,fs("fusedDepthwiseConv2D")},e.prototype.depthwiseConv2D=function(e,t,n){return fs("depthwiseConv2D")},e.prototype.depthwiseConv2DDerInput=function(e,t,n){return fs("depthwiseConv2DDerInput")},e.prototype.depthwiseConv2DDerFilter=function(e,t,n){return fs("depthwiseConv2DDerFilter")},e.prototype.conv3d=function(e,t,n){return fs("conv3d")},e.prototype.conv3dDerInput=function(e,t,n){return fs("conv3dDerInput")},e.prototype.conv3dDerFilter=function(e,t,n){return fs("conv3dDerFilter")},e.prototype.maxPool=function(e,t){return fs("maxPool")},e.prototype.maxPoolBackprop=function(e,t,n,r){return fs("maxPoolBackprop")},e.prototype.avgPool=function(e,t){return fs("avgPool")},e.prototype.avgPoolBackprop=function(e,t,n){return fs("avgPoolBackprop")},e.prototype.avgPool3d=function(e,t){return fs("avgPool3d")},e.prototype.avgPool3dBackprop=function(e,t,n){return fs("avgPool3dBackprop")},e.prototype.maxPool3d=function(e,t){return fs("maxPool3d")},e.prototype.maxPool3dBackprop=function(e,t,n,r){return fs("maxPool3dBackprop")},e.prototype.reshape=function(e,t){return fs("reshape")},e.prototype.cast=function(e,t){return fs("cast")},e.prototype.tile=function(e,t){return fs("tile")},e.prototype.pad=function(e,t,n){return fs("pad")},e.prototype.transpose=function(e,t){return fs("transpose")},e.prototype.gather=function(e,t,n){return fs("gather")},e.prototype.gatherND=function(e,t){return fs("gatherND")},e.prototype.scatterND=function(e,t,n){return fs("scatterND")},e.prototype.batchToSpaceND=function(e,t,n){return fs("batchToSpaceND")},e.prototype.spaceToBatchND=function(e,t,n){return fs("spaceToBatchND")},e.prototype.resizeBilinear=function(e,t,n,r){return fs("resizeBilinear")},e.prototype.resizeBilinearBackprop=function(e,t,n){return fs("resizeBilinearBackprop")},e.prototype.resizeNearestNeighbor=function(e,t,n,r){return fs("resizeNearestNeighbor")},e.prototype.resizeNearestNeighborBackprop=function(e,t,n){return fs("resizeNearestNeighborBackprop")},e.prototype.batchNormalization=function(e,t,n,r,o,i){return fs("batchNormalization")},e.prototype.localResponseNormalization4D=function(e,t,n,r,o){return fs("localResponseNormalization4D")},e.prototype.LRNGrad=function(e,t,n,r,o,i,a){return fs("LRNGrad")},e.prototype.multinomial=function(e,t,n,r){return fs("multinomial")},e.prototype.oneHot=function(e,t,n,r){return fs("oneHot")},e.prototype.cumsum=function(e,t,n,r){return fs("cumsum")},e.prototype.nonMaxSuppression=function(e,t,n,r,o){return fs("nonMaxSuppression")},e.prototype.fft=function(e){return fs("fft")},e.prototype.ifft=function(e){return fs("ifft")},e.prototype.complex=function(e,t){return fs("complex")},e.prototype.real=function(e){return fs("real")},e.prototype.imag=function(e){return fs("imag")},e.prototype.cropAndResize=function(e,t,n,r,o,i){return fs("cropAndResize")},e.prototype.depthToSpace=function(e,t,n){return fs("depthToSpace")},e.prototype.split=function(e,t,n){return fs("split")},e.prototype.sparseToDense=function(e,t,n,r){return fs("sparseToDense")},e.prototype.diag=function(e){return fs("diag")},e.prototype.fill=function(e,t,n){return fs("fill")},e.prototype.onesLike=function(e){return fs("onesLike")},e.prototype.zerosLike=function(e){return fs("zerosLike")},e.prototype.linspace=function(e,t,n){return fs("linspace")},e.prototype.dispose=function(){return fs("dispose")},e}();function fs(e){throw new Error("'"+e+"' not yet implemented or not found in the registry. Did you forget to import the kernel?")}function hs(e,t){for(var n=e.length,r=[],o=0;o<n;o++){var i=n-1-o,a=e[i]||1;(t[t.length-1-o]||1)>1&&1===a&&r.unshift(i)}return r}function ds(e,t){for(var n=[],r=0;r<t.length;r++){var o=e[e.length-r-1],i=t.length-r-1,a=t[i];(null==o||1===o&&a>1)&&n.unshift(i)}return n}function ps(e,t){for(var n=[],r=Math.max(e.length,t.length),o=0;o<r;o++){var i=e[e.length-o-1];null==i&&(i=1);var a=t[t.length-o-1];if(null==a&&(a=1),1===i)n.unshift(a);else if(1===a)n.unshift(i);else{if(i!==a)throw Error("Operands could not be broadcast together with shapes "+e+" and "+t+".");n.unshift(i)}}return n}function vs(e,t,n,r,o,i,a){void 0===a&&(a="channelsLast");var s,u=ws(t),c=u[0],l=u[1];if("channelsLast"===a)s=[c,l,e[3],e[3]];else{if("channelsFirst"!==a)throw new Error("Unknown dataFormat "+a);s=[c,l,e[1],e[1]]}return gs(e,s,n,r,o,i,!1,a)}function ms(e,t,n,r,o,i,a){void 0===a&&(a="NDHWC");var s,u,c=xs(t),l=c[0],f=c[1],h=c[2];if("NDHWC"===a)u="channelsLast",s=[l,f,h,e[4],e[4]];else{if("NCDHW"!==a)throw new Error("Unknown dataFormat "+a);u="channelsFirst",s=[l,f,h,e[1],e[1]]}return ys(e,s,n,r,o,!1,u,i)}function gs(e,t,n,r,o,i,a,s){void 0===a&&(a=!1),void 0===s&&(s="channelsLast");var u=[-1,-1,-1,-1],c=u[0],l=u[1],f=u[2],h=u[3];if("channelsLast"===s)c=e[0],l=e[1],f=e[2],h=e[3];else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat "+s);c=e[0],h=e[1],l=e[2],f=e[3]}var d,p=t[0],v=t[1],m=t[3],g=ws(n),y=g[0],b=g[1],w=ws(r),x=w[0],k=w[1],_=ks(p,x),E=ks(v,k),C=function(e,t,n,r,o,i,a,s){var u,c,l;if("number"==typeof e){u={top:e,bottom:e,left:e,right:e,type:0===e?"VALID":"NUMBER"};var f=function(e,t,n,r,o){null==r&&(r=bs(e,t,n));var i=e[1],a=_s((e[0]-t+2*r)/n+1,o);Jn(ir(a),(function(){return"The output # of rows ("+a+") must be an integer. Change the stride and/or zero pad parameters"}));var s=_s((i-t+2*r)/n+1,o);return Jn(ir(s),(function(){return"The output # of columns ("+s+") must be an integer. Change the stride and/or zero pad parameters"})),[a,s]}([t,n],i,r,e,s);c=f[0],l=f[1]}else if("same"===e){c=Math.ceil(t/r),l=Math.ceil(n/o);var h=Math.max(0,(c-1)*r+i-t),d=Math.max(0,(l-1)*o+a-n),p=Math.floor(h/2),v=h-p,m=Math.floor(d/2);u={top:p,bottom:v,left:m,right:d-m,type:"SAME"}}else{if("valid"!==e)throw Error("Unknown padding parameter: "+e);u={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((t-i+1)/r),l=Math.ceil((n-a+1)/o)}return{padInfo:u,outHeight:c,outWidth:l}}(o,l,f,y,b,_,E,i),S=C.padInfo,I=C.outHeight,R=C.outWidth,T=a?m*h:m;return"channelsFirst"===s?d=[c,T,I,R]:"channelsLast"===s&&(d=[c,I,R,T]),{batchSize:c,dataFormat:s,inHeight:l,inWidth:f,inChannels:h,outHeight:I,outWidth:R,outChannels:T,padInfo:S,strideHeight:y,strideWidth:b,filterHeight:p,filterWidth:v,effectiveFilterHeight:_,effectiveFilterWidth:E,dilationHeight:x,dilationWidth:k,inShape:e,outShape:d,filterShape:t}}function ys(e,t,n,r,o,i,a,s){void 0===i&&(i=!1),void 0===a&&(a="channelsLast");var u=[-1,-1,-1,-1,-1],c=u[0],l=u[1],f=u[2],h=u[3],d=u[4];if("channelsLast"===a)c=e[0],l=e[1],f=e[2],h=e[3],d=e[4];else{if("channelsFirst"!==a)throw new Error("Unknown dataFormat "+a);c=e[0],d=e[1],l=e[2],f=e[3],h=e[4]}var p,v=t[0],m=t[1],g=t[2],y=t[4],b=xs(n),w=b[0],x=b[1],k=b[2],_=xs(r),E=_[0],C=_[1],S=_[2],I=ks(v,E),R=ks(m,C),T=ks(g,S),A=function(e,t,n,r,o,i,a,s,u,c,l){var f,h,d,p;if("number"==typeof e){f={top:e,bottom:e,left:e,right:e,front:e,back:e,type:0===e?"VALID":"NUMBER"};var v=function(e,t,n,r,o,i){null==o&&(o=bs(e,t,r));var a=e[1],s=e[2],u=_s((e[0]-t+2*o)/r+1,i);Jn(ir(u),(function(){return"The output # of depths ("+u+") must be an integer. Change the stride and/or zero pad parameters"}));var c=_s((a-t+2*o)/r+1,i);Jn(ir(c),(function(){return"The output # of rows ("+c+") must be an integer. Change the stride and/or zero pad parameters"}));var l=_s((s-t+2*o)/r+1,i);return Jn(ir(l),(function(){return"The output # of columns ("+l+") must be an integer. Change the stride and/or zero pad parameters"})),[u,c,l,1]}([t,n,r,1],s,0,o,e,l);h=v[0],d=v[1],p=v[2]}else if("same"===e){var m=((h=Math.ceil(t/o))-1)*o+s-t,g=((d=Math.ceil(n/i))-1)*i+u-n,y=((p=Math.ceil(r/a))-1)*a+c-r,b=Math.floor(m/2),w=m-b,x=Math.floor(g/2),k=g-x,_=Math.floor(y/2);f={top:x,bottom:k,left:_,right:y-_,front:b,back:w,type:"SAME"}}else{if("valid"!==e)throw Error("Unknown padding parameter: "+e);f={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},h=Math.ceil((t-s+1)/o),d=Math.ceil((n-u+1)/i),p=Math.ceil((r-c+1)/a)}return{padInfo:f,outDepth:h,outHeight:d,outWidth:p}}(o,l,f,h,w,x,k,I,R,T,s),N=A.padInfo,O=A.outDepth,D=A.outHeight,P=A.outWidth,M=i?y*d:y;return"channelsFirst"===a?p=[c,M,O,D,P]:"channelsLast"===a&&(p=[c,O,D,P,M]),{batchSize:c,dataFormat:a,inDepth:l,inHeight:f,inWidth:h,inChannels:d,outDepth:O,outHeight:D,outWidth:P,outChannels:M,padInfo:N,strideDepth:w,strideHeight:x,strideWidth:k,filterDepth:v,filterHeight:m,filterWidth:g,effectiveFilterDepth:I,effectiveFilterHeight:R,effectiveFilterWidth:T,dilationDepth:E,dilationHeight:C,dilationWidth:S,inShape:e,outShape:p,filterShape:t}}function bs(e,t,n,r){void 0===r&&(r=1);var o=ks(t,r);return Math.floor((e[0]*(n-1)-n+o)/2)}function ws(e){return"number"==typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}function xs(e){return"number"==typeof e?[e,e,e]:e}function ks(e,t){return t<=1?e:e+(e-1)*(t-1)}function _s(e,t){if(!t)return e;switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode "+t)}}function Es(e){var t=ws(e),n=t[0],r=t[1],o=t[2];return 1===n&&1===r&&1===o}function Cs(e,t){return Es(e)||Es(t)}function Ss(e){if("NHWC"===e)return"channelsLast";if("NCHW"===e)return"channelsFirst";throw new Error("Unknown dataFormat "+e)}function Is(e,t,n){if("complex64"===t){if("complex64"===e.dtype)return e.clone();var r=Gi(e.shape),o=e.toFloat(),i=n.complex(o,r);return r.dispose(),o.dispose(),i}if(!gr(e.dtype,t))return fo.makeTensorFromDataId(e.dataId,e.shape,t);if("complex64"===e.dtype){var a=n.real(e);return i=a.cast(t),a.dispose(),i}if("int32"===t)return n.int(e);if("bool"===t){var s=Zi(0,e.dtype);return i=n.notEqual(e,s),s.dispose(),i}throw new Error("Error in Cast: failed to cast "+e.dtype+" to "+t)}function Rs(e,t){return fo.makeTensorFromDataId(e.dataId,t,e.dtype)}function Ts(e,t,n){var r=(t-e)/(n-1),o=Nr(n,"float32");o[0]=e;for(var i=1;i<o.length;i++)o[i]=o[i-1]+r;return Wi(o,"float32")}Object.freeze({castTensor:Is,reshapeTensor:Rs,linspaceImpl:Ts,upcastType:ro,axesAreInnerMostDims:Ci,combineLocations:Si,computeOutAndReduceShapes:Ii,expandShapeToKeepDim:Ri,assertAxesAreInnerMostDims:Ti,getAxesPermutation:Ai,getUndoAxesPermutation:Ni,getInnerMostAxes:Oi,getBroadcastDims:hs,getReductionAxes:ds,assertAndGetBroadcastShape:ps,assertParamsConsistent:Di,computeOutShape:Pi,computePool2DInfo:vs,computePool3DInfo:ms,computeConv2DInfo:gs,computeConv3DInfo:ys,computeDefaultPad:bs,tupleValuesAreOne:Es,eitherStridesOrDilationsAreOne:Cs,convertConv2DDataFormat:Ss,PARALLELIZE_THRESHOLD:30,computeOptimalWindowSize:Xa});function As(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+e.length+", imag: "+t.length+".");for(var n=new Float32Array(2*e.length),r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function Ns(e,t){return{real:e[2*t],imag:e[2*t+1]}}function Os(e,t,n,r){e[2*r]=t,e[2*r+1]=n}function Ds(e,t,n){var r=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(r),imag:Math.sin(r)}}function Ps(e,t,n){var r=function(e,t,n){return function(e,t,n){for(var r=0,o=e.length,i=0,a=!1;r<o;){var s=n(t,e[i=r+(o-r>>>1)]);s>0?r=i+1:(o=i,a=!s)}return a?r:-r-1}(e,t,n||Ms)}(e,t,n),o=r<0?-(r+1):r;e.splice(o,0,t)}function Ms(e,t){return e>t?1:e<t?-1:0}function Fs(e,t,n,r,o){return Bs(e,t,n,r,o,0).selectedIndices}function Ls(e,t,n,r,o,i){var a=Bs(e,t,n,r,o,i,!0);return a.numValidOutputs.dispose(),{selectedIndices:a.selectedIndices,selectedScores:a.selectedScores}}function Bs(e,t,n,r,o,i,a,s){void 0===a&&(a=!1),void 0===s&&(s=!1);for(var u=Array.from(t).map((function(e,t){return{score:e,boxIndex:t,suppressBeginIndex:0}})).filter((function(e){return e.score>o})).sort(Zs),c=i>0?-.5/i:0,l=[],f=[];l.length<n&&u.length>0;){var h=u.pop(),d=h.score,p=h.boxIndex,v=h.suppressBeginIndex;if(d<o)break;for(var m=!1,g=l.length-1;g>=v;--g){var y=Us(e,p,l[g]);if(y>=r){m=!0;break}if(h.score=h.score*js(r,c,y),h.score<=o)break}h.suppressBeginIndex=l.length,m||(h.score===d?(l.push(p),f.push(h.score)):h.score>o&&Ps(u,h,Zs))}var b=l.length;return s&&(l.fill(0,b),f.fill(0,b)),{selectedIndices:Wi(l,"int32"),selectedScores:Wi(f,"float32"),numValidOutputs:Zi(b,"int32")}}function Us(e,t,n){var r=e.subarray(4*t,4*t+4),o=e.subarray(4*n,4*n+4),i=Math.min(r[0],r[2]),a=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),c=Math.min(o[0],o[2]),l=Math.min(o[1],o[3]),f=Math.max(o[0],o[2]),h=Math.max(o[1],o[3]),d=(s-i)*(u-a),p=(f-c)*(h-l);if(d<=0||p<=0)return 0;var v=Math.max(i,c),m=Math.max(a,l),g=Math.min(s,f),y=Math.min(u,h),b=Math.max(g-v,0)*Math.max(y-m,0);return b/(d+p-b)}function js(e,t,n){var r=Math.exp(t*n*n);return n<=e?r:0}function Zs(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}function Ws(e,t,n){var r=new Array(e.rank).fill(0),o=e.shape.slice();return t.map((function(t){o[n]=t;var i=e.slice(r,o);return r[n]+=t,i}))}function zs(e,t){for(var n=new Array(e.rank),r=0;r<n.length;r++)n[r]=e.shape[r]*t[r];var o=ma(n,e.dtype);for(r=0;r<o.values.length;++r){for(var i=o.indexToLoc(r),a=new Array(e.rank),s=0;s<a.length;s++)a[s]=i[s]%e.shape[s];var u=e.locToIndex(a);o.values[r]=e.values[u]}return o.toTensor()}function Vs(e,t,n,r,o){for(var i=t[t.length-1],a=[e.length/i,i],s=a[0],u=a[1],c=dr(n,s*r),l=dr("int32",s*r),f=0;f<s;f++){for(var h=f*u,d=e.subarray(h,h+u),p=[],v=0;v<d.length;v++)p.push({value:d[v],index:v});p.sort((function(e,t){return t.value-e.value}));var m=f*r,g=c.subarray(m,m+r),y=l.subarray(m,m+r);for(v=0;v<r;v++)g[v]=p[v].value,y[v]=p[v].index}var b=t.slice();return b[b.length-1]=r,[Ui(c,b,n),Ui(l,b,"int32")]}function Hs(e,t){for(var n=[],r=0;r<t.length;r++)t[r]&&n.push(r);var o=ma(e,"int32"),i=ma([n.length,e.length],"int32");for(r=0;r<n.length;r++){var a=o.indexToLoc(n[r]),s=r*e.length;i.values.set(a,s)}return i.toTensor()}var qs=function(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map((function(e,t){return"T"+t}));var n=[];this.variableNames.forEach((function(e){n.push("float v"+e+" = get"+e+"AtOutCoords();")}));var r=this.variableNames.map((function(e){return"v"+e})).join(" + ");this.userCode="\n      void main() {\n        "+n.join("\n        ")+"\n\n        float result = "+r+";\n        setOutput(result);\n      }\n    "},Gs=function(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map((function(e,t){return"T"+t}));var n=[];this.variableNames.forEach((function(e){n.push("vec4 v"+e+" = get"+e+"AtOutCoords();")}));var r=this.variableNames.map((function(e){return"v"+e})).join(" + ");this.userCode="\n      void main() {\n        "+n.join("\n        ")+"\n\n        vec4 result = "+r+";\n        setOutput(result);\n      }\n    "},Ks=function(e,t,n){this.variableNames=["A"];var r=e.windowSize,o=e.batchSize,i=e.inSize,a=Math.ceil(i/r);n||this.variableNames.push("bestIndicesA"),this.outputShape=[o,a];var s="max"===t?">":"<",u=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+r+";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < "+r+"; i++) {\n          int inIdx = "+u+";\n          float candidate = getA(batch, inIdx);\n          if (candidate "+s+" bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    "};function Xs(e,t){return["x","y","z","w","u","v"].slice(0,t).map((function(t){return e+"."+t}))}function $s(e,t){return 1===t?[e]:Xs(e,t)}function Ys(){var e,t,n,r,o,i,a,s,u,c;return 2===jn().getNumber("WEBGL_VERSION")?(e="#version 300 es",t="in",n="out",r="in",o="texture",i="outputColor",a="out vec4 outputColor;",s="\n      bool isnan_custom(float val) {\n        return (val > 0.0 || val < 0.0) ? false : val != 0.0;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ",u="",c="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(e="",t="attribute",n="varying",r="varying",o="texture2D",i="gl_FragColor",a="",s="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",u="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",c="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:o,output:i,defineOutput:a,defineSpecialNaN:s,defineSpecialInf:u,defineRound:c}}function Qs(e,t,n){void 0===n&&(n="index");var r=Ir(t);return r.map((function(t,o){return"int "+e[o]+" = "+n+" / "+t+"; "+(o===r.length-1?"int "+e[o+1]+" = "+n+" - "+e[o]+" * "+t:"index -= "+e[o]+" * "+t)+";"})).join("")}function Js(e){var t=Ir(e).map((function(e){return e.toString()}));return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * "+t[0]+" + coords.y * "+t[1]+" + coords.z;\n  }\n"}var eu="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n";function tu(e,t,n,r){var o=[];e.forEach((function(e){var t=rr(e.shapeInfo.logicalShape);e.shapeInfo.isUniform?o.push("uniform float "+e.name+(t>1?"["+t+"]":"")+";"):(o.push("uniform sampler2D "+e.name+";"),o.push("uniform int offset"+e.name+";"))}));var i,a,s=o.join("\n"),u=e.map((function(e){return function(e,t,n){void 0===n&&(n=!1);var r="";r+=n?ru(e):nu(e);var o=e.shapeInfo.logicalShape,i=t.logicalShape;return o.length<=i.length&&(r+=n?function(e,t){var n,r=e.name,o=r.charAt(0).toUpperCase()+r.slice(1),i="get"+o+"AtOutCoords",a=e.shapeInfo.logicalShape.length,s=t.logicalShape.length,u=hs(e.shapeInfo.logicalShape,t.logicalShape),c=lu(s),l=s-a,f=["x","y","z","w","u","v"];n=0===a?"":s<2&&u.length>=1?"coords = 0;":u.map((function(e){return"coords."+f[e+l]+" = 0;"})).join("\n");var h;h=s<2&&a>0?"coords":e.shapeInfo.logicalShape.map((function(e,t){return"coords."+f[t+l]})).join(", ");var d="return outputValue;",p=1===rr(e.shapeInfo.logicalShape),v=1===rr(t.logicalShape);if(1!==a||p||v){if(p&&!v)d=1===s?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(u.length){var m=a-2,g=a-1;u.indexOf(m)>-1&&u.indexOf(g)>-1?d="return vec4(outputValue.x);":u.indexOf(m)>-1?d="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":u.indexOf(g)>-1&&(d="return vec4(outputValue.xx, outputValue.zz);")}}else d="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 "+i+"() {\n      "+c+" coords = getOutputCoords();\n      "+n+"\n      vec4 outputValue = get"+o+"("+h+");\n      "+d+"\n    }\n  "}(e,t):function(e,t){var n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),o="get"+r+"AtOutCoords",i=t.texShape,a=e.shapeInfo.texShape,s=e.shapeInfo.logicalShape.length,u=t.logicalShape.length;if(!e.shapeInfo.isUniform&&s===u&&null==e.shapeInfo.flatOffset&&or(a,i))return"\n      float "+o+"() {\n        return sampleTexture("+n+", resultUV);\n      }\n    ";var c,l=lu(u),f=hs(e.shapeInfo.logicalShape,t.logicalShape),h=u-s,d=["x","y","z","w","u","v"];c=0===s?"":u<2&&f.length>=1?"coords = 0;":f.map((function(e){return"coords."+d[e+h]+" = 0;"})).join("\n");var p;return p=u<2&&s>0?"coords":e.shapeInfo.logicalShape.map((function(e,t){return"coords."+d[t+h]})).join(", "),"\n    float "+o+"() {\n      "+l+" coords = getOutputCoords();\n      "+c+"\n      return get"+r+"("+p+");\n    }\n  "}(e,t)),r}(e,t,r)})).join("\n"),c=t.texShape,l=Ys(),f=function(e){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return "+e.texture2D+"(textureSampler, uv).r;\n    }\n  "}(l),h=function(e){return e.version+"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    "+e.varyingFs+" vec2 resultUV;\n    "+e.defineOutput+"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    "+e.defineSpecialNaN+"\n    "+e.defineSpecialInf+"\n    "+e.defineRound+"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    "+ou+"\n    "+iu+"\n    "+au+"\n  "}(l);return t.isPacked?(i=function(e,t){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t){var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];return 1===n[0]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * "+n[1]+".0);\n      }\n    ":1===n[1]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * "+n[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      return 2 * (resTexRC.x * "+n[1]+" + resTexRC.y);\n    }\n  "}(0,t);case 2:return function(e,t){var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(or(e,t))return"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2("+n[0]+", "+n[1]+"));\n      }\n    ";var r=Math.ceil(e[1]/2);return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n      int r = 2 * (index / "+r+");\n      int c = imod(index, "+r+") * 2;\n\n      return ivec2(r, c);\n    }\n  "}(e,t);case 3:return n=e,r=t,o=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],a=(i=Math.ceil(n[2]/2))*Math.ceil(n[1]/2),"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+o[0]+", "+o[1]+"));\n      int index = resTexRC.x * "+o[1]+" + resTexRC.y;\n\n      int b = index / "+a+";\n      index -= b * "+a+";\n\n      int r = 2 * (index / "+i+");\n      int c = imod(index, "+i+") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";default:return function(e,t){for(var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],r=Math.ceil(e[e.length-1]/2),o=r*Math.ceil(e[e.length-2]/2),i=o,a="",s="b, r, c",u=2;u<e.length-1;u++)a="\n      int b"+u+" = index / "+(i*=e[e.length-u-1])+";\n      index -= b"+u+" * "+i+";\n    "+a,s="b"+u+", "+s;return"\n    ivec"+e.length+" getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n\n      "+a+"\n\n      int b = index / "+o+";\n      index -= b * "+o+";\n\n      int r = 2 * (index / "+r+");\n      int c = imod(index, "+r+") * 2;\n\n      return ivec"+e.length+"("+s+");\n    }\n  "}(e,t)}var n,r,o,i,a}(t.logicalShape,c),a=function(e){return"\n    void setOutput(vec4 val) {\n      "+e.output+" = val;\n    }\n  "}(l)):(i=function(e,t){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t){return 1===t[0]?"\n      int getOutputCoords() {\n        return int(resultUV.x * "+t[1]+".0);\n      }\n    ":1===t[1]?"\n      int getOutputCoords() {\n        return int(resultUV.y * "+t[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+t[0]+", "+t[1]+"));\n      return resTexRC.x * "+t[1]+" + resTexRC.y;\n    }\n  "}(0,t);case 2:return function(e,t){return or(e,t)?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2("+t[0]+", "+t[1]+"));\n      }\n    ":1===e[1]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+t[0]+", "+t[1]+"));\n        int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":1===e[0]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+t[0]+", "+t[1]+"));\n        int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+t[0]+", "+t[1]+"));\n      int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n      int r = index / "+e[1]+";\n      int c = index - r * "+e[1]+";\n      return ivec2(r, c);\n    }\n  "}(e,t);case 3:return n=t,r=Qs(["r","c","d"],e),"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n      "+r+"\n      return ivec3(r, c, d);\n    }\n  ";case 4:return function(e,t){var n=Qs(["r","c","d","d2"],e);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+t[0]+", "+t[1]+"));\n      int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n      "+n+"\n      return ivec4(r, c, d, d2);\n    }\n  "}(e,t);case 5:return function(e,t){var n=Qs(["r","c","d","d2","d3"],e);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2("+t[0]+",\n                             "+t[1]+"));\n\n      int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n\n      "+n+"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  "}(e,t);case 6:return function(e,t){var n=Qs(["r","c","d","d2","d3","d4"],e);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+t[0]+", "+t[1]+"));\n      int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n\n      "+n+"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  "}(e,t);default:throw new Error(e.length+"-D output sampling is not yet supported")}var n,r}(t.logicalShape,c),a=function(e){return"\n    void setOutput(float val) {\n      "+e.output+" = vec4(val, 0, 0, 0);\n    }\n  "}(l)),r&&(h+=su),[h,f,a,s,i,u,n].join("\n")}function nu(e){var t=e.shapeInfo.logicalShape;switch(t.length){case 0:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1);if(e.shapeInfo.isUniform)return"float "+n+"() {return "+t+";}";var r=e.shapeInfo.texShape,o=r[0],i=r[1];if(1===o&&1===i)return"\n      float "+n+"() {\n        return sampleTexture("+t+", halfCR);\n      }\n    ";var a=e.shapeInfo.texShape;return"\n    float "+n+"() {\n      vec2 uv = uvFromFlat("+a[0]+", "+a[1]+", "+uu(t)+");\n      return sampleTexture("+t+", uv);\n    }\n  "}(e);case 1:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1);if(e.shapeInfo.isUniform)return"\n      float "+n+"(int index) {\n        "+cu(e)+"\n      }\n    ";var r=e.shapeInfo.texShape,o=r[0],i=r[1];if(1===i&&1===o)return"\n      float "+n+"(int index) {\n        return sampleTexture("+t+", halfCR);\n      }\n    ";var a=uu(t);return 1===i?"\n      float "+n+"(int index) {\n        vec2 uv = vec2(0.5, (float(index + "+a+") + 0.5) / "+o+".0);\n        return sampleTexture("+t+", uv);\n      }\n    ":1===o?"\n      float "+n+"(int index) {\n        vec2 uv = vec2((float(index + "+a+") + 0.5) / "+i+".0, 0.5);\n        return sampleTexture("+t+", uv);\n      }\n    ":"\n    float "+n+"(int index) {\n      vec2 uv = uvFromFlat("+o+", "+i+", index + "+a+");\n      return sampleTexture("+t+", uv);\n    }\n  "}(e);case 2:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),o=e.shapeInfo.texShape;if(null!=o&&or(t,o)){var i=o[0];return"\n    float "+r+"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2("+o[1]+".0, "+i+".0);\n      return sampleTexture("+n+", uv);\n    }\n  "}var a=hr(t),s=a.newShape,u=a.keptDims,c=s;if(c.length<t.length)return"\n      "+nu(fu(e,c))+"\n      float "+r+"(int row, int col) {\n        return "+r+"("+hu(["row","col"],u)+");\n      }\n    ";if(e.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2("+t[1]+", 1)));\n        "+cu(e)+"\n      }\n    ";var l=o[0],f=o[1],h=uu(n);return 1===f?"\n    float "+r+"(int row, int col) {\n      float index = dot(vec3(row, col, "+h+"), vec3("+t[1]+", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / "+l+".0);\n      return sampleTexture("+n+", uv);\n    }\n  ":1===l?"\n    float "+r+"(int row, int col) {\n      float index = dot(vec3(row, col, "+h+"), vec3("+t[1]+", 1, 1));\n      vec2 uv = vec2((index + 0.5) / "+f+".0, 0.5);\n      return sampleTexture("+n+", uv);\n    }\n  ":"\n  float "+r+"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * "+t[1]+" + col + "+h+";\n    vec2 uv = uvFromFlat("+l+", "+f+", index);\n    return sampleTexture("+n+", uv);\n  }\n"}(e);case 3:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),o=t[1]*t[2],i=t[2],a=hr(t),s=a.newShape,u=a.keptDims,c=s;if(c.length<t.length)return"\n        "+nu(fu(e,c))+"\n        float "+r+"(int row, int col, int depth) {\n          return "+r+"("+hu(["row","col","depth"],u)+");\n        }\n      ";if(e.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3("+o+", "+i+", 1)));\n        "+cu(e)+"\n      }\n    ";var l=e.shapeInfo.texShape,f=l[0],h=l[1],d=e.shapeInfo.flatOffset;return h===o&&null==d?"\n        float "+r+"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2("+i+", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2("+h+".0, "+f+".0);\n          return sampleTexture("+n+", uv);\n        }\n      ":h===i&&null==d?"\n    float "+r+"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2("+t[1]+", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+h+".0, "+f+".0);\n      return sampleTexture("+n+", uv);\n    }\n  ":"\n      float "+r+"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * "+o+" + col * "+i+" + depth + "+uu(n)+";\n        vec2 uv = uvFromFlat("+f+", "+h+", index);\n        return sampleTexture("+n+", uv);\n      }\n  "}(e);case 4:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),o=t[3],i=t[2]*o,a=t[1]*i,s=hr(t),u=s.newShape,c=s.keptDims;if(u.length<t.length)return"\n      "+nu(fu(e,u))+"\n      float "+r+"(int row, int col, int depth, int depth2) {\n        return "+r+"("+hu(["row","col","depth","depth2"],c)+");\n      }\n    ";if(e.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4("+a+", "+i+", "+o+", 1)));\n        "+cu(e)+"\n      }\n    ";var l=e.shapeInfo.flatOffset,f=e.shapeInfo.texShape,h=f[0],d=f[1];return d===a&&null==l?"\n      float "+r+"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3("+i+", "+o+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+d+".0, "+h+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ":d===o&&null==l?"\n      float "+r+"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3("+t[1]*t[2]+", "+t[2]+", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+d+".0, "+h+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ":"\n    float "+r+"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+a+" + col * "+i+" +\n          depth * "+o+" + depth2;\n      vec2 uv = uvFromFlat("+h+", "+d+", index + "+uu(n)+");\n      return sampleTexture("+n+", uv);\n    }\n  "}(e);case 5:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),o=t[4],i=t[3]*o,a=t[2]*i,s=t[1]*a,u=hr(t),c=u.newShape,l=u.keptDims;if(c.length<t.length)return"\n      "+nu(fu(e,c))+"\n      float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n        return "+r+"("+hu(["row","col","depth","depth2","depth3"],l)+");\n      }\n    ";if(e.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+s+", "+a+", "+i+", "+o+")) +\n          depth3;\n        "+cu(e)+"\n      }\n    ";var f=e.shapeInfo.flatOffset,h=e.shapeInfo.texShape,d=h[0],p=h[1];return p===s&&null==f?"\n      float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4("+a+", "+i+", "+o+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+p+".0, "+d+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ":p===o&&null==f?"\n      float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+t[1]*t[2]*t[3]+",\n               "+t[2]*t[3]+", "+t[3]+", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+p+".0, "+d+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ":"\n    float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+s+" + col * "+a+" + depth * "+i+" +\n          depth2 * "+o+" + depth3 + "+uu(n)+";\n      vec2 uv = uvFromFlat("+d+", "+p+", index);\n      return sampleTexture("+n+", uv);\n    }\n  "}(e);case 6:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),o=hr(t),i=o.newShape,a=o.keptDims;if(i.length<t.length)return"\n      "+nu(fu(e,i))+"\n      float "+r+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return "+r+"("+hu(["row","col","depth","depth2","depth3","depth4"],a)+");\n      }\n    ";var s=t[5],u=t[4]*s,c=t[3]*u,l=t[2]*c,f=t[1]*l;if(e.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4("+f+", "+l+", "+c+", "+u+")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2("+s+", 1)));\n        "+cu(e)+"\n      }\n    ";var h=e.shapeInfo.flatOffset,d=e.shapeInfo.texShape,p=d[0],v=d[1];return v===f&&null==h?"\n      float "+r+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4("+l+", "+c+", "+u+", "+s+")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+v+".0, "+p+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ":v===s&&null==h?"\n      float "+r+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4("+t[1]*t[2]*t[3]*t[4]+",\n               "+t[2]*t[3]*t[4]+",\n               "+t[3]*t[4]+",\n               "+t[4]+")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+v+".0, "+p+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ":"\n    float "+r+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+f+" + col * "+l+" + depth * "+c+" +\n          depth2 * "+u+" + depth3 * "+s+" + depth4 + "+uu(n)+";\n      vec2 uv = uvFromFlat("+p+", "+v+", index);\n      return sampleTexture("+n+", uv);\n    }\n  "}(e);default:throw new Error(t.length+"-D input sampling is not yet supported")}}function ru(e){var t;switch(e.shapeInfo.logicalShape.length){case 0:return"\n    vec4 "+("get"+(t=e.name).charAt(0).toUpperCase()+t.slice(1))+"() {\n      return "+Ys().texture2D+"("+t+", halfCR);\n    }\n  ";case 1:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=e.shapeInfo.texShape,o=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],i=Ys();return"\n    vec4 "+n+"(int index) {\n      vec2 uv = packedUVfrom1D(\n        "+o[0]+", "+o[1]+", index);\n      return "+i.texture2D+"("+t+", uv);\n    }\n  "}(e);case 2:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),o=e.shapeInfo.texShape,i=o[0],a=o[1],s=Ys();if(null!=o&&or(t,o))return"\n      vec4 "+r+"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2("+a+".0, "+i+".0);\n\n        return "+s.texture2D+"("+n+", uv);\n      }\n    ";var u=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];return"\n    vec4 "+r+"(int row, int col) {\n      vec2 uv = packedUVfrom2D("+Math.ceil(t[1]/2)+", "+u[0]+", "+u[1]+", row, col);\n      return "+s.texture2D+"("+n+", uv);\n    }\n  "}(e);case 3:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),o=e.shapeInfo.texShape,i=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];if(1===t[0])return"\n        "+ru(fu(e,t.slice(1)))+"\n        vec4 "+r+"(int b, int row, int col) {\n          return "+r+"("+hu(["b","row","col"],[1,2])+");\n        }\n      ";var a=i[0],s=i[1],u=Math.ceil(t[2]/2);return"\n    vec4 "+r+"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        "+a+", "+s+", "+u*Math.ceil(t[1]/2)+", "+u+", b, row, col);\n      return "+Ys().texture2D+"("+n+", uv);\n    }\n  "}(e);default:return function(e){for(var t=e.shapeInfo.logicalShape,n=t.length,r=e.name,o="get"+r.charAt(0).toUpperCase()+r.slice(1),i=e.shapeInfo.texShape,a=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],s=a[0],u=a[1],c=Math.ceil(t[n-1]/2),l=c*Math.ceil(t[n-2]/2),f="int b, int row, int col",h="b * "+l+" + (row / 2) * "+c+" + (col / 2)",d=2;d<n-1;d++)f="int b"+d+", "+f,h="b"+d+" * "+(l*=t[n-d-1])+" + "+h;return"\n    vec4 "+o+"("+f+") {\n      int index = "+h+";\n      int texR = index / "+u+";\n      int texC = index - texR * "+u+";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+u+", "+s+");\n      return "+Ys().texture2D+"("+r+", uv);\n    }\n  "}(e)}}var ou="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",iu="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",au="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",su="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function uu(e){return"offset"+e}function cu(e){var t=e.name,n=rr(e.shapeInfo.logicalShape);return n<2?"return "+t+";":"\n    for (int i = 0; i < "+n+"; i++) {\n      if (i == index) {\n        return "+t+"[i];\n      }\n    }\n  "}function lu(e){if(e<=1)return"int";if(2===e)return"ivec2";if(3===e)return"ivec3";if(4===e)return"ivec4";if(5===e)return"ivec5";if(6===e)return"ivec6";throw Error("GPU for rank "+e+" is not yet supported")}function fu(e,t){var n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function hu(e,t){return t.map((function(t){return e[t]})).join(", ")}var du=function(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,Jn(e.length>2,(function(){return"Packed arg"+(n.charAt(0).toUpperCase()+n.slice(1))+" supports only inputs with rank above 2."}));var o=e[e.length-1],i=Math.ceil(o/t);this.outputShape=e.slice(0,-1),i>1&&this.outputShape.push(i),r||this.variableNames.push("bestIndicesA");var a,s,u=this.outputShape,c=u.length,l=lu(c),f=$s("coords",c);if(1===i){var h=lu(s=c+1);a="\n        "+h+" sourceLocR = "+h+"("+f.join()+", 0);\n        ++"+f[c-1]+";\n        "+h+" sourceLocG = "+h+"("+f.join()+", 0);\n        ++"+f[c-2]+";\n        "+h+" sourceLocA = "+h+"("+f.join()+", 0);\n        --"+f[c-1]+";\n        "+h+" sourceLocB = "+h+"("+f.join()+", 0);\n        --"+f[c-2]+";"}else s=c,a="\n        "+l+" sourceLocR = coords;\n        ++"+f[c-1]+";\n        "+l+" sourceLocG = coords;\n        ++"+f[c-2]+";\n        "+l+" sourceLocA = coords;\n        --"+f[c-1]+";\n        "+l+" sourceLocB = coords;\n        --"+f[c-2]+";";var d=["x","y","z","w","u","v"].slice(0,s),p="."+d[s-1],v=d.map((function(e){return"int "+e})),m=$s("sourceLocR",s-1).concat("inIdx.r"),g=$s("sourceLocG",s-1).concat("inIdx.g"),y=$s("sourceLocB",s-1).concat("inIdx.b"),b=$s("sourceLocA",s-1).concat("inIdx.a"),w="max"===n?"greaterThan":"lessThan",x=r?"":"\n          inIdx = round(vec4(getBestIndicesAChannel("+m.join()+"),\n                             getBestIndicesAChannel("+g.join()+"),\n                             getBestIndicesAChannel("+y.join()+"),\n                             getBestIndicesAChannel("+b.join()+")));",k="vec4(\n            getAChannel("+m.join()+"),\n            hasNextCol ? getAChannel("+g.join()+") : 0.,\n            hasNextRow ? getAChannel("+y.join()+") : 0.,\n            hasNextRow && hasNextCol ? getAChannel("+b.join()+") : 0.)",_=r?"":"\n      float getBestIndicesAChannel("+v.join()+") {\n        return getChannel(getBestIndicesA("+d.join()+"),\n                                          vec2("+d.slice(-2).join()+"));\n      }";this.userCode="\n      float getAChannel("+v.join()+") {\n        return getChannel(getA("+d.join()+"),\n                               vec2("+d.slice(-2).join()+"));\n      }\n      "+_+"\n      void main() {\n        "+l+" coords = getOutputCoords();\n        bool hasNextCol = "+f[c-1]+" < "+(u[c-1]-1)+";\n        bool hasNextRow = "+f[c-2]+" < "+(u[c-2]-1)+";\n        "+a+"\n        ivec4 srcIdx = ivec4(sourceLocR"+p+", sourceLocG"+p+",\n          sourceLocB"+p+", sourceLocA"+p+") * "+t+";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = "+k+";\n\n        for (int i = 0; i < "+t+"; i++) {\n          inIdx = srcIdx;\n          "+x+"\n          vec4 candidate = "+k+";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4("+w+"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    "},pu=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,o=e.strideWidth,i=e.dilationHeight,a=e.dilationWidth,s=e.effectiveFilterHeight,u=e.effectiveFilterWidth,c=s-1-e.padInfo.top,l=u-1-e.padInfo.left,f=1/(t*n);this.userCode="\n      const ivec2 pads = ivec2("+c+", "+l+");\n      const float avgMultiplier = float("+f+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+s+";\n            wR += "+i+") {\n          float dyR = float(dyRCorner + wR) / "+r+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+u+";\n            wC+= "+a+") {\n            float dyC = float(dyCCorner + wC) / "+o+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},vu=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,l=e.effectiveFilterDepth,f=e.effectiveFilterHeight,h=e.effectiveFilterWidth,d=l-1-e.padInfo.front,p=f-1-e.padInfo.top,v=h-1-e.padInfo.left,m=1/(t*n*r);this.userCode="\n      const ivec3 pads = ivec3("+d+", "+p+", "+v+");\n      const float avgMultiplier = float("+m+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < "+l+";\n            wD += "+s+") {\n          float dyD = float(dyDCorner + wD) / "+o+".0;\n\n          if (dyD < 0.0 || dyD >= "+e.outDepth+".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < "+f+";\n              wR += "+u+") {\n            float dyR = float(dyRCorner + wR) / "+i+".0;\n\n            if (dyR < 0.0 || dyR >= "+e.outHeight+".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < "+h+";\n                wC += "+c+") {\n              float dyC = float(dyCCorner + wC) / "+a+".0;\n\n              if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},mu=function(e,t,n,r,o,i){this.outputShape=[],this.variableNames=["x","mean","variance"],ps(e,t),ps(e,n);var a="0.0";null!=r&&(ps(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");var s="1.0";null!=o&&(ps(e,o),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = "+a+";\n        float scale = "+s+";\n        float inv = scale * inversesqrt(variance + float("+i+"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    "},gu=function(e,t,n,r,o,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],ps(e,t),ps(e,n);var a="vec4(0.0)";null!=r&&(ps(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");var s="vec4(1.0)";null!=o&&(ps(e,o),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode="\n      void main() {\n        vec4 offset = "+a+";\n        vec4 scale = "+s+";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4("+i+"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    "},yu=function(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=ps(t,n),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        "+e+"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    "},bu="return a + b;",wu="return a - b;",xu="return a * b;",ku="return (a < 0.) ? b * a : a;",_u=function(e,t,n){this.variableNames=["A","B"],this.outputShape=ps(t,n),this.userCode="\n      float binaryOperation(float a, float b) {\n        "+e+"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    "},Eu="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n",Cu=function(e,t,n,r){void 0===r&&(r=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=ps(t,n);var o=this.outputShape.length,i="";if(r)if(0===o||1===rr(this.outputShape))i="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else if(i="\n          "+lu(o)+" coords = getOutputCoords();\n        ",1===o)i+="\n            result.y = (coords + 1) >= "+this.outputShape[0]+" ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ";else{var a=$s("coords",o);i+="\n            bool nextRowOutOfBounds =\n              ("+a[o-2]+" + 1) >= "+this.outputShape[o-2]+";\n            bool nextColOutOfBounds =\n              ("+a[o-1]+" + 1) >= "+this.outputShape[o-1]+";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          "}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        "+e+"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        "+i+"\n\n        setOutput(result);\n      }\n    "},Su=function(){function e(e){this.variableNames=["A"],this.outputShape=e,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e,t){var n=this;return function(r,o){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(o,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(o,"maxVal")),r.gl.uniform1f(n.minLoc,e),r.gl.uniform1f(n.maxLoc,t)}},e}(),Iu=function(){function e(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e,t){var n=this;return function(r,o){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(o,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(o,"maxVal")),r.gl.uniform1f(n.minLoc,e),r.gl.uniform1f(n.maxLoc,t)}},e}(),Ru=function(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "},Tu=function(e){this.outputShape=[],this.outputShape=Pi(e,1),this.variableNames=e.map((function(e,t){return"T"+t}));var t=new Array(e.length-1);t[0]=e[0][1];for(var n=1;n<t.length;n++)t[n]=t[n-1]+e[n][1];var r=["if (yC < "+t[0]+") setOutput(getT0(yR, yC));"];for(n=1;n<t.length;n++){var o=t[n-1];r.push("else if (yC < "+t[n]+") setOutput(getT"+n+"(yR, yC-"+o+"));")}var i=t.length,a=t[t.length-1];r.push("else setOutput(getT"+i+"(yR, yC-"+a+"));"),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        "+r.join("\n        ")+"\n      }\n    "},Au=function(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Pi(e,t);var n=this.outputShape,r=n.length,o=lu(r),i=$s("coords",r),a=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map((function(e,t){return"T"+t}));var s=new Array(e.length-1);s[0]=e[0][t];for(var u=1;u<s.length;u++)s[u]=s[u-1]+e[u][t];var c=a[t],l=a.slice(-2),f=a.join(),h="if ("+c+" < "+s[0]+") {\n        return getChannel(\n            getT0("+f+"), vec2("+l.join()+"));\n        }";for(u=1;u<s.length;u++){var d=s[u-1];h+="\n        if ("+c+" < "+s[u]+"  && "+c+" >= "+s[u-1]+") {\n          return getChannel(\n            getT"+u+"("+Nu(a,c,d)+"),\n            vec2("+Nu(l,c,d)+"));\n        }"}var p=s.length,v=s[s.length-1];h+="\n        return getChannel(\n          getT"+p+"("+Nu(a,c,v)+"),\n          vec2("+Nu(l,c,v)+"));",this.userCode="\n      float getValue("+a.map((function(e){return"int "+e}))+") {\n        "+h+"\n      }\n\n      void main() {\n        "+o+" coords = getOutputCoords();\n        vec4 result = vec4(getValue("+i+"), 0., 0., 0.);\n\n        "+i[r-1]+" = "+i[r-1]+" + 1;\n        if ("+i[r-1]+" < "+n[r-1]+") {\n          result.g = getValue("+i+");\n        }\n\n        "+i[r-2]+" = "+i[r-2]+" + 1;\n        if ("+i[r-2]+" < "+n[r-2]+") {\n          result.a = getValue("+i+");\n        }\n\n        "+i[r-1]+" = "+i[r-1]+" - 1;\n        if ("+i[r-2]+" < "+n[r-2]+" &&\n            "+i[r-1]+" < "+n[r-1]+") {\n          result.b = getValue("+i+");\n        }\n        setOutput(result);\n      }\n    "};function Nu(e,t,n){var r=e.indexOf(t);return e.map((function(e,t){return t===r?e+" - "+n:e})).join()}var Ou=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,o=e.padInfo.left,i="channelsLast"===e.dataFormat;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+e.batchSize+"; b++) {\n          for (int yR = 0; yR < "+e.outHeight+"; yR++) {\n            int xR = wR + yR * "+t+" - "+r+";\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+e.outWidth+"; yC++) {\n              int xC = wC + yC * "+n+" - "+o+";\n\n              if (xC < 0 || xC >= "+e.inWidth+") {\n                continue;\n              }\n\n              if ("+i+") {\n                float dyValue = getDy(b, yR, yC, d2);\n                float xValue = getX(b, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              } else {\n                float dyValue = getDy(b, d2, yR, yC);\n                float xValue = getX(b, d1, xR, xC);\n                dotProd += (xValue * dyValue);\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Du=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,o=e.strideWidth,i="channelsLast"===e.dataFormat,a=t-1-e.padInfo.top,s=n-1-e.padInfo.left,u=i?1:2,c=i?2:3,l=i?3:1;this.userCode="\n      const ivec2 pads = ivec2("+a+", "+s+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords["+l+"];\n\n        ivec2 dyCorner = ivec2(coords["+u+"], coords["+c+"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+t+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+r+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+t+" - 1 - wR;\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+o+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+n+" - 1 - wC;\n\n            for (int d2 = 0; d2 < "+e.outChannels+"; d2++) {\n\n              if ("+i+") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Pu=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,o=e.padInfo.front,i=e.padInfo.top,a=e.padInfo.left;this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+e.batchSize+"; b++) {\n          for (int yF = 0; yF < "+e.outDepth+"; yF++) {\n            int xF = wF + yF * "+t+" - "+o+";\n\n            if (xF < 0 || xF >= "+e.inDepth+") {\n              continue;\n            }\n\n            for (int yR = 0; yR < "+e.outHeight+"; yR++) {\n              int xR = wR + yR * "+n+" - "+i+";\n\n              if (xR < 0 || xR >= "+e.inHeight+") {\n                continue;\n              }\n\n              for (int yC = 0; yC < "+e.outWidth+"; yC++) {\n                int xC = wC + yC * "+r+" - "+a+";\n\n                if (xC < 0 || xC >= "+e.inWidth+") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Mu=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,s=t-1-e.padInfo.front,u=n-1-e.padInfo.top,c=r-1-e.padInfo.left;this.userCode="\n      const ivec3 pads = ivec3("+s+", "+u+", "+c+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < "+t+"; wF++) {\n          float dyF = float(dyFCorner + wF) / "+o+".0;\n\n          if (dyF < 0.0 || dyF >= "+e.outDepth+".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = "+t+" - 1 - wF;\n\n          for (int wR = 0; wR < "+n+"; wR++) {\n            float dyR = float(dyRCorner + wR) / "+i+".0;\n\n            if (dyR < 0.0 || dyR >= "+e.outHeight+".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = "+n+" - 1 - wR;\n\n            for (int wC = 0; wC < "+r+"; wC++) {\n              float dyC = float(dyCCorner + wC) / "+a+".0;\n\n              if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = "+r+" - 1 - wC;\n\n              for (int d2 = 0; d2 < "+e.outChannels+"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Fu=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,o=e.padInfo.left,i=e.outChannels/e.inChannels;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * "+i+" + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < "+e.batchSize+"; b++) {\n          for (int yR = 0; yR < "+e.outHeight+"; yR++) {\n            int xR = wR + yR * "+t+" - "+r+";\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+e.outWidth+"; yC++) {\n              int xC = wC + yC * "+n+" - "+o+";\n\n              if (xC < 0 || xC >= "+e.inWidth+") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Lu=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,o=e.strideWidth,i=t-1-e.padInfo.top,a=n-1-e.padInfo.left,s=e.outChannels/e.inChannels;this.userCode="\n      const ivec2 pads = ivec2("+i+", "+a+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < "+t+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+r+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+t+" - 1 - wR;\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+o+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+n+" - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < "+s+"; dm++) {\n              int d2 = d1 * "+s+" + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Bu=function(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var o=e.padInfo.top,i=e.padInfo.left,a=e.strideHeight,s=e.strideWidth,u=e.dilationHeight,c=e.dilationWidth,l=e.filterHeight,f=e.filterWidth,h=4*Math.floor(e.inChannels/4),d=e.inChannels%4,p="channelsLast"===e.dataFormat,v=p?1:2,m=p?2:3,g=p?3:1,y="",b="";n&&(y=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          "+n+"\n        }":"\n          float activation(float x) {\n            "+n+"\n          }\n        ",b="result = activation(result);");var w=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+y+"\n\n      const ivec2 strides = ivec2("+a+", "+s+");\n      const ivec2 pads = ivec2("+o+", "+i+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords["+g+"];\n\n        ivec2 xRCCorner =\n            ivec2(coords["+v+"], coords["+m+"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+l+"; wR++) {\n          int xR = xRCorner + wR * "+u+";\n\n          if (xR < 0 || xR >= "+e.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+f+"; wC++) {\n            int xC = xCCorner + wC * "+c+";\n\n            if (xC < 0 || xC >= "+e.inWidth+") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < "+h+"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if ("+p+") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if ("+(1===d)+") {\n\n              if ("+p+") {\n                dotProd +=\n                    getX(batch, xR, xC, "+h+") *\n                    getW(wR, wC, "+h+", d2);\n              } else {\n                dotProd +=\n                    getX(batch, "+h+", xR, xC) *\n                    getW(wR, wC, "+h+", d2);\n              }\n\n            } else if ("+(2===d)+") {\n              vec2 wValues = vec2(\n                getW(wR, wC, "+h+", d2),\n                getW(wR, wC, "+h+" + 1, d2)\n              );\n\n              if ("+p+") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, "+h+"),\n                  getX(batch, xR, xC, "+h+" + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, "+h+", xR, xC),\n                  getX(batch, "+h+" + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if ("+(3===d)+") {\n              vec3 wValues = vec3(\n                getW(wR, wC, "+h+", d2),\n                getW(wR, wC, "+h+" + 1, d2),\n                getW(wR, wC, "+h+" + 2, d2)\n              );\n\n              if ("+p+") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, "+h+"),\n                  getX(batch, xR, xC, "+h+" + 1),\n                  getX(batch, xR, xC, "+h+" + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, "+h+", xR, xC),\n                  getX(batch, "+h+" + 1, xR, xC),\n                  getX(batch, "+h+" + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        "+w+"\n        "+b+"\n        setOutput(result);\n      }\n    "},Uu=function(e){this.variableNames=["x","W"],this.outputShape=e.outShape;var t=e.padInfo.front,n=e.padInfo.top,r=e.padInfo.left,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,l=e.filterDepth,f=e.filterHeight,h=e.filterWidth,d=4*Math.floor(e.inChannels/4),p=e.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3("+o+", "+i+", "+a+");\n      const ivec3 pads = ivec3("+t+", "+n+", "+r+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < "+l+"; wF++) {\n          int xF = xFCorner + wF * "+s+";\n\n          if (xF < 0 || xF >= "+e.inDepth+") {\n            continue;\n          }\n\n          for (int wR = 0; wR < "+f+"; wR++) {\n            int xR = xRCorner + wR * "+u+";\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+h+"; wC++) {\n              int xC = xCCorner + wC * "+c+";\n\n              if (xC < 0 || xC >= "+e.inWidth+") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < "+d+"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if ("+(1===p)+") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, "+d+") *\n                  getW(wF, wR, wC, "+d+", d2);\n              } else if ("+(2===p)+") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, "+d+"),\n                  getX(batch, xF, xR, xC, "+d+" + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, "+d+", d2),\n                  getW(wF, wR, wC, "+d+" + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if ("+(3===p)+") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, "+d+"),\n                  getX(batch, xF, xR, xC, "+d+" + 1),\n                  getX(batch, xF, xR, xC, "+d+" + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, "+d+", d2),\n                  getW(wF, wR, wC, "+d+" + 1, d2),\n                  getW(wF, wR, wC, "+d+" + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},ju=function(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var o=e.inHeight,i=e.inWidth,a=e.padInfo.top,s=e.padInfo.left,u=e.strideHeight,c=e.strideWidth,l=e.dilationHeight,f=e.dilationWidth,h=e.filterHeight,d=e.filterWidth,p=e.outChannels/e.inChannels,v="",m="";n&&(v=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          "+n+"\n        }":"\n          float activation(float x) {\n            "+n+"\n          }\n        ",m="result = activation(result);");var g=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+v+"\n\n      const ivec2 strides = ivec2("+u+", "+c+");\n      const ivec2 pads = ivec2("+a+", "+s+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / "+p+";\n        int q = d2 - d1 * "+p+";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < "+h+"; wR++) {\n          int xR = xRCorner + wR * "+l+";\n\n          if (xR < 0 || xR >= "+o+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+d+"; wC++) {\n            int xC = xCCorner + wC * "+f+";\n\n            if (xC < 0 || xC >= "+i+") {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        "+g+"\n        "+m+"\n        setOutput(result);\n      }\n    "},Zu=function(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.outShape;for(var o=e.inHeight,i=e.inWidth,a=e.padInfo.top,s=e.padInfo.left,u=e.strideHeight,c=e.strideWidth,l=e.dilationHeight,f=e.dilationWidth,h=e.filterHeight,d=e.filterWidth,p=d,v="int xR; int xC; int xCOffset;",m=0;m<h;m++)for(var g=0;g<d;g++)v+="\n          vec4 xTexelR"+m+"C"+2*g+" = vec4(0.);\n          vec4 wR"+m+"C"+g+" = vec4(0.);\n          vec4 xR"+m+"C"+g+" = vec4(0.);";for(m=0;m<h;m++)for(var y=0;y<p;y++){if(v+="\n          xR = xRCorner + "+m*l+";\n          xC = xCCorner + "+(g=2*y)*f+";\n        ",1===c){if(g<d&&(v+=s%2==1?"\n                xCOffset = xC + 1;\n                if(xR >= 0 && xR < "+o+" && xCOffset >= 0 && xCOffset < "+i+") {\n                  xTexelR"+m+"C"+g+" = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= "+i+") {\n                    xTexelR"+m+"C"+g+".zw = vec2(0.);\n                  }\n                } else {\n                  xTexelR"+m+"C"+g+" = vec4(0.);\n                }\n\n                xCOffset = xC + 1 - 2;\n                if(xR >= 0 && xR < "+o+" && xCOffset >= 0 && xCOffset < "+i+") {\n                  vec4 previous = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= "+i+") {\n                    previous.zw = vec2(0.);\n                  }\n\n                  xR"+m+"C"+g+" = vec4(previous.zw, xTexelR"+m+"C"+g+".xy);\n                } else {\n                  xR"+m+"C"+g+" = vec4(0, 0, xTexelR"+m+"C"+g+".xy);\n                }\n              ":"\n                if(xR >= 0 && xR < "+o+" && xC >= 0 && xC < "+i+") {\n                  xTexelR"+m+"C"+g+" = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR"+m+"C"+g+" = vec4(0.);\n                }\n\n                xR"+m+"C"+g+" = xTexelR"+m+"C"+g+";\n              ",g+1<d)){var b=s%2==0?Yn(f):f;f%2==0&&s%2==1||f%2!=0&&s%2!=1?(v+="\n                  xCOffset = xC + "+s%2+" + "+b+";\n\n                  if(xR >= 0 && xR < "+o+" &&\n                    xCOffset >= 0 && xCOffset < "+i+") {\n                    xTexelR"+m+"C"+(g+2)+" = getX(batch, xR, xCOffset, d1);\n                  }\n                ",f>1&&(v+="\n                    xCOffset -= 2;\n                    if(xR >= 0 && xR < "+o+" &&\n                      xCOffset >= 0 && xCOffset < "+i+") {\n                      xTexelR"+m+"C"+g+" = getX(batch, xR, xCOffset, d1);\n                    } else {\n                      xTexelR"+m+"C"+g+" = vec4(0.);\n                    }\n                  "),v+="\n                  xR"+m+"C"+(g+1)+" = vec4(\n                    xTexelR"+m+"C"+g+".zw, xTexelR"+m+"C"+(g+2)+".xy);\n                "):v+="\n                  xCOffset = xC + "+b+";\n\n                  if(xR >= 0 && xR < "+o+" &&\n                    xCOffset >= 0 && xCOffset < "+i+") {\n                    xTexelR"+m+"C"+(g+2)+" = getX(batch, xR, xCOffset, d1);\n                  }\n\n                  xR"+m+"C"+(g+1)+" = xTexelR"+m+"C"+(g+2)+";\n                "}}else g<d&&(v+="\n              if(xR >= 0 && xR < "+o+") {\n            ",s%2==1?(v+="\n                xCOffset = xC + 1 - "+c+";\n                if(xCOffset >= 0 && xCOffset < "+i+") {\n                  xTexelR"+m+"C"+g+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+m+"C"+g+" = vec4(0.);\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < "+i+") {\n                  xTexelR"+m+"C"+(g+2)+" = getX(batch, xR, xC + 1, d1);\n                } else {\n                  xTexelR"+m+"C"+(g+2)+" = vec4(0.);\n                }\n\n                xR"+m+"C"+g+" = vec4(\n                  xTexelR"+m+"C"+g+".zw, xTexelR"+m+"C"+(g+2)+".zw);\n              ",g+1<d&&(v+="\n                  vec4 final = vec4(0.);\n                  xCOffset = xC + 1 + "+c+";\n                  if(xCOffset >= 0 && xCOffset < "+i+") {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xR"+m+"C"+(g+1)+" = vec4(xTexelR"+m+"C"+(g+2)+".xy, final.xy);\n                ")):(v+="\n                if(xC >= 0 && xC < "+i+") {\n                  xTexelR"+m+"C"+g+" = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR"+m+"C"+g+" = vec4(0.);\n                }\n\n                xCOffset = xC + "+c+";\n                if(xCOffset >= 0 && xCOffset < "+i+") {\n                  xTexelR"+m+"C"+(g+2)+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+m+"C"+(g+2)+" = vec4(0.);\n                }\n\n                xR"+m+"C"+g+" = vec4(\n                  xTexelR"+m+"C"+g+".xy, xTexelR"+m+"C"+(g+2)+".xy);\n              ",g+1<d&&(v+="\n                  xR"+m+"C"+(g+1)+" = vec4(\n                    xTexelR"+m+"C"+g+".zw, xTexelR"+m+"C"+(g+2)+".zw);\n                ")),v+="}");g<d&&(v+="\n            vec4 wTexelR"+m+"C"+g+" = getW("+m+", "+g+", d1, q);\n            wR"+m+"C"+g+" = vec4(wTexelR"+m+"C"+g+".xz, wTexelR"+m+"C"+g+".xz);\n          ",g+1<d&&(v+="\n              vec4 wTexelR"+m+"C"+(g+1)+" = getW("+m+", "+(g+1)+", d1, q);\n              wR"+m+"C"+(g+1)+" =\n                vec4(wTexelR"+m+"C"+(g+1)+".xz, wTexelR"+m+"C"+(g+1)+".xz);"))}for(m=0;m<h;m++)for(g=0;g<d;g++)v+="dotProd += xR"+m+"C"+g+" * wR"+m+"C"+g+";";var w="",x="";n&&(w=r?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          "+n+"\n        }":"vec4 activation(vec4 x) {\n          "+n+"\n        }",x="result = activation(result);");var k=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+w+"\n\n      const ivec2 strides = ivec2("+u+", "+c+");\n      const ivec2 pads = ivec2("+a+", "+s+");\n\n      void main() {\n\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2;\n        int q = 0;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        vec4 dotProd = vec4(0.);\n\n        "+v+"\n\n        vec4 result = dotProd;\n        "+k+"\n        "+x+"\n        setOutput(result);\n      }\n    "},Wu=function(e,t,n,r,o){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var i=e[0],a=e[1],s=e[2],u=e[3],c=t[0],l=n[0],f=n[1];this.outputShape=[c,l,f,u];var h="bilinear"===r?1:0,d=[a-1+".0",s-1+".0"],p=d[0],v=d[1],m=l>1?[""+(a-1)/(l-1),"(y2-y1) * height_ratio","y1*"+p+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+p],g=m[0],y=m[1],b=m[2],w=f>1?[""+(s-1)/(f-1),"(x2-x1) * width_ratio","x1*"+v+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+v],x=w[0],k=w[1],_=w[2];this.userCode="\n      const float height_ratio = float("+g+");\n      const float width_ratio = float("+x+");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= "+i+") {\n          return;\n        }\n\n        float height_scale = "+y+";\n        float width_scale = "+k+";\n\n        float in_y = "+b+";\n        if( in_y < 0.0 || in_y > "+p+" ) {\n          setOutput(float("+o+"));\n          return;\n        }\n        float in_x = "+_+";\n        if( in_x < 0.0 || in_x > "+v+" ) {\n          setOutput(float("+o+"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if("+h+" == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    "},zu=function(e,t,n){this.variableNames=["x"],this.outputShape=e;var r=e.length,o=e[e.length-1],i=n?"<":">";this.userCode="\n      int getIndex(int i) {\n        "+(n?"return "+o+" -i - 1;":"return i;")+"\n      }\n\n      void main() {\n        "+lu(r)+" coords = getOutputCoords();\n        int end = "+Vu(r,"coords")+";\n        float val = 0.0;\n        for (int i = "+o+" - 1; i >= 0; i -= 1) {\n          int idx = getIndex(i);\n          if (idx "+i+" end) {\n            continue;\n          }\n          if (idx == end && "+t+") {\n            continue;\n          }\n          "+Vu(r,"coords")+" = idx;\n          val += getX("+function(e,t){if(1===e)return""+t;if(2===e)return t+".x, "+t+".y";if(3===e)return t+".x, "+t+".y, "+t+".z";if(4===e)return t+".x, "+t+".y, "+t+".z, "+t+".w";throw Error("Cumulative sum for rank "+e+" is not yet supported")}(r,"coords")+");\n        }\n        setOutput(val);\n      }\n    "};function Vu(e,t){if(1===e)return""+t;if(2===e)return t+".y";if(3===e)return t+".z";if(4===e)return t+".w";throw Error("Cumulative sum for rank "+e+" is not yet supported")}var Hu=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=vo.DENSE;var t=_o(e),n=Ys();this.outputShape=e,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        "+Qs(["r","c","d"],e)+"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2("+t[0]+", "+t[1]+"));\n        int index = 4 * (resTexRC.x * "+t[1]+" + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        "+n.output+" = result;\n      }\n    "},qu=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=vo.DENSE;var t=_o(e),n=Ys();this.outputShape=e,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        "+Qs(["r","c","d"],e)+"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2("+t[0]+", "+t[1]+"));\n        int index = 4 * (resTexRC.x * "+t[1]+" + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        "+n.output+" = result;\n      }\n    "},Gu=function(){function e(e,t,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=n,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = "+this.getHeightCoordString()+";\n      int w = "+this.getWidthCoordString()+";\n      int d = "+this.getDepthCoordString()+";\n\n      int in_h = h / "+t+";\n      int offset_h = imod(h, "+t+");\n      int in_w = w / "+t+";\n      int offset_w = imod(w, "+t+");\n      int offset_d = (offset_h * "+t+" + offset_w) *\n        "+this.getOutputDepthSize()+";\n      int in_d = d + offset_d;\n\n      float result = "+this.getInputSamplingString()+";\n      setOutput(result);\n    }\n  "}return e.prototype.getHeightCoordString=function(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"},e.prototype.getWidthCoordString=function(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"},e.prototype.getDepthCoordString=function(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"},e.prototype.getOutputDepthSize=function(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]},e.prototype.getInputSamplingString=function(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},e}(),Ku=function(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "},Xu=function(e){this.variableNames=["A"],this.outTexUsage=mo.DOWNLOAD;var t=Ys();this.outputShape=e,this.userCode="\n      "+eu+"\n\n      void main() {\n        float x = getAAtOutCoords();\n        "+t.output+" = encode_float(x);\n      }\n    "},$u=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=mo.DOWNLOAD;var t=Ys();this.outputShape=e,this.userCode="\n      "+eu+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        "+t.output+" = encode_float(x);\n      }\n    "},Yu=function(e,t,n){void 0===n&&(n=!1),this.variableNames=["A"];var r=Ys(),o=t[0],i=t[1];this.outputShape=e;var a="result";n&&(a="floor(result * 255. + 0.5)"),this.userCode="\n      "+Js(e)+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        int flatIndex = getFlatIndex(coords);\n        int offset = imod(flatIndex, 4);\n\n        flatIndex = idiv(flatIndex, 4, 1.);\n        \n        int r = flatIndex / "+i+";\n        int c = imod(flatIndex, "+i+");\n        vec2 uv = (vec2(c, r) + halfCR) / vec2("+i+".0, "+o+".0);\n        vec4 values = "+r.texture2D+"(A, uv);\n\n        float result;\n\n        if(offset == 0) {\n          result = values[0];\n        } else if(offset == 1) {\n          result = values[1];\n        } else if(offset == 2) {\n          result = values[2];\n        } else {\n          result = values[3];\n        }\n\n        "+r.output+" = vec4("+a+", 0., 0., 0.);\n      }\n    "},Qu=function(e,t,n){void 0===n&&(n=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var r=Ys(),o=t[0],i=t[1];this.outputShape=e;var a="",s="result";n&&(s="floor(result * 255. + 0.5)");for(var u=0;u<=1;u++)for(var c=0;c<=1;c++){var l=2*u+c;a+="\n          localCoords = coords;\n          if(localCoords[2] + "+c+" < "+e[2]+") {\n            localCoords[2] += "+c+";\n            if(localCoords[1] + "+u+" < "+e[1]+") {\n              localCoords[1] += "+u+";\n\n              flatIndex = getFlatIndex(localCoords);\n              offset = imod(flatIndex, 4);\n\n              flatIndex = idiv(flatIndex, 4, 1.);\n\n              r = flatIndex / "+i+";\n              c = imod(flatIndex, "+i+");\n              uv = (vec2(c, r) + halfCR) / vec2("+i+".0, "+o+".0);\n              values = "+r.texture2D+"(A, uv);\n\n              if(offset == 0) {\n                result["+l+"] = values[0];\n              } else if(offset == 1) {\n                result["+l+"] = values[1];\n              } else if(offset == 2) {\n                result["+l+"] = values[2];\n              } else {\n                result["+l+"] = values[3];\n              }\n            }\n          }\n        "}this.userCode="\n      "+Js(e)+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        vec4 result = vec4(0.);\n        int flatIndex, r, c, offset;\n        ivec3 localCoords;\n        vec2 uv;\n        vec4 values;\n\n        "+a+"\n\n        "+r.output+" = "+s+";\n      }\n    "},Ju=function(e,t,n){this.variableNames=["real","imag"];var r=t[1];this.outputShape=t;var o=n?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,i=n?r+".0":"1.0";this.userCode="\n      const float exponentMultiplier = "+o+";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        "+e+"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float("+r+");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < "+r+"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / "+i+";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    "},ec=function(){function e(e,t){this.outputShape=[],this.variableNames=["x"],this.outputShape=e,this.userCode="\n      uniform float value;\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e){var t=this;return function(n,r){null==t.valueLoc&&(t.valueLoc=n.getUniformLocationNoThrow(r,"value")),n.gl.uniform1f(t.valueLoc,e)}},e}(),tc=function(e,t,n){this.variableNames=["A","indices"];var r=e.slice();r[n]=t,this.outputShape=r,this.rank=r.length;var o=lu(this.rank),i=function(e,t){var n=e.length;if(n>4)throw Error("Gather for rank "+n+" is not yet supported");if(1===n)return"int(getIndices(resRC))";for(var r=["resRC.x","resRC.y","resRC.z","resRC.w"],o=[],i=0;i<e.length;i++)i===t?o.push("int(getIndices("+r[i]+"))"):o.push(""+r[i]);return o.join()}(e,n);this.userCode="\n      void main() {\n        "+o+" resRC = getOutputCoords();\n        setOutput(getA("+i+"));\n      }\n    "},nc=function(e,t,n){this.sliceDim=e,this.strides=t,this.variableNames=["x","indices"],this.outputShape=n;var r=lu(t.length),o=lu(n.length),i=this.sliceDim>1?"strides[j]":"strides";this.userCode="\n        "+r+" strides = "+r+"("+this.strides+");\n         void main() {\n          "+o+" coords = getOutputCoords();\n          int flattenIndex = 0;\n          for (int j = 0; j < "+this.sliceDim+"; j++) {\n            int index = round(getIndices(coords[0], j));\n            flattenIndex += index * "+i+";\n          }\n          setOutput(getX(flattenIndex, coords[1]));\n        }\n      "};function rc(e,t){var n=Ys();return Ao(e,t,n.version+"\n    precision highp float;\n    "+n.attribute+" vec3 clipSpacePos;\n    "+n.attribute+" vec2 uv;\n    "+n.varyingVs+" vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }")}function oc(e,t){return Bo(e,t,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function ic(e,t){return Uo(e,t,new Uint16Array([0,1,2,2,1,3]))}function ac(e,t,n,r,o,i,a){Zo(n,r);var s=jo(e,t),u=e.TEXTURE_2D;return So(e,t,(function(){return e.bindTexture(u,s)})),So(e,t,(function(){return e.texParameteri(u,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)})),So(e,t,(function(){return e.texParameteri(u,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)})),So(e,t,(function(){return e.texParameteri(u,e.TEXTURE_MIN_FILTER,e.NEAREST)})),So(e,t,(function(){return e.texParameteri(u,e.TEXTURE_MAG_FILTER,e.NEAREST)})),So(e,t,(function(){return e.texImage2D(u,0,o,n,r,0,i,a,null)})),So(e,t,(function(){return e.bindTexture(e.TEXTURE_2D,null)})),s}function sc(e,t,n,r,o){var i=ko(n,r);return ac(e,t,i[0],i[1],o.internalFormatFloat,o.textureFormatFloat,e.FLOAT)}function uc(e,t,n,r,o){var i=ko(n,r);return ac(e,t,i[0],i[1],o.internalFormatHalfFloat,o.textureFormatFloat,o.textureTypeHalfFloat)}function cc(e,t,n,r,o){var i=ko(n,r);return ac(e,t,i[0],i[1],e.RGBA,e.RGBA,e.UNSIGNED_BYTE)}function lc(e,t,n,r,o){var i=Eo(n,r);return ac(e,t,i[0],i[1],o.internalFormatPackedFloat,e.RGBA,e.FLOAT)}function fc(e,t,n,r,o){var i=Eo(n,r);return ac(e,t,i[0],i[1],o.internalFormatPackedHalfFloat,e.RGBA,o.textureTypeHalfFloat)}function hc(e,t,n,r){return So(e,t,(function(){return e.bindBuffer(e.ARRAY_BUFFER,r)})),zo(e,t,n,"clipSpacePos",r,3,20,0)&&zo(e,t,n,"uv",r,2,20,12)}function dc(e,t,n,r,o,i,a){var s,u,c;So(e,t,(function(){return e.bindTexture(e.TEXTURE_2D,n)})),i instanceof Uint8Array?(s=new Uint8Array(r*o*4),u=e.UNSIGNED_BYTE,c=e.RGBA):(s=new Float32Array(r*o*4),u=e.FLOAT,c=a.internalFormatPackedFloat),s.set(i),So(e,t,(function(){return e.texImage2D(e.TEXTURE_2D,0,c,r,o,0,e.RGBA,u,s)})),So(e,t,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))}function pc(e,t,n,r){So(e,t,(function(){return e.bindTexture(e.TEXTURE_2D,n)})),r.data instanceof Uint8Array?So(e,t,(function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,r.width,r.height,0,e.RGBA,e.UNSIGNED_BYTE,r.data)})):So(e,t,(function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r)})),So(e,t,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))}function vc(e,t,n,r,o){var i=e.createBuffer();So(e,t,(function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,i)}));var a=16*n*r;return So(e,t,(function(){return e.bufferData(e.PIXEL_PACK_BUFFER,a,e.STREAM_READ)})),So(e,t,(function(){return e.readPixels(0,0,r,n,e.RGBA,e.FLOAT,0)})),So(e,t,(function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,null)})),i}function mc(e,t,n){var r=e,o=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,o),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),o}function gc(e,t,n,r,o){var i=ko(n,r),a=i[0],s=i[1],u=new Uint8Array(n*r*4);return So(e,t,(function(){return e.readPixels(0,0,a,s,o.downloadTextureFormat,e.UNSIGNED_BYTE,u)})),new Float32Array(u.buffer)}function yc(e,t,n,r,o,i,a,s){var u=e,c=new Float32Array(function(e,t){var n=Eo(e,t);return n[0]*n[1]*4}(i,a));return u.bindBuffer(u.PIXEL_PACK_BUFFER,t),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,c),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),c}function bc(e,t,n,r){var o=new Float32Array(n*r*4);return So(e,t,(function(){return e.readPixels(0,0,r,n,e.RGBA,e.FLOAT,o)})),o}var wc=Object.freeze({createVertexShader:rc,createVertexBuffer:oc,createIndexBuffer:ic,createFloat32MatrixTexture:sc,createFloat16MatrixTexture:uc,createUnsignedBytesMatrixTexture:cc,createPackedMatrixTexture:lc,createFloat16PackedMatrixTexture:fc,bindVertexProgramAttributeStreams:hc,uploadDenseMatrixToTexture:dc,uploadPixelDataToTexture:pc,createBufferFromOutputTexture:vc,downloadFloat32MatrixFromBuffer:mc,downloadByteEncodedFloatMatrixFromOutputTexture:gc,downloadPackedMatrixFromBuffer:yc,downloadMatrixFromPackedOutputTexture:bc}),xc=function(){function e(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var t=jn().getNumber("WEBGL_VERSION");null!=e?(this.gl=e,wo(t,e)):this.gl=xo(t);var n="WEBGL_color_buffer_float";if(1===jn().getNumber("WEBGL_VERSION")){if(this.textureFloatExtension=To(this.gl,this.debug,"OES_texture_float"),ci(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=To(this.gl,this.debug,"OES_texture_half_float");else if(jn().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),ci(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=To(this.gl,this.debug,"EXT_color_buffer_half_float");else if(jn().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(n="EXT_color_buffer_float",ci(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else{if(!ci(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=oc(this.gl,this.debug),this.indexBuffer=ic(this.gl,this.debug),this.framebuffer=Wo(this.gl,this.debug),this.textureConfig=Co(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(e.prototype,"debug",{get:function(){return jn().getBool("DEBUG")},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){var e=this;if(!this.disposed){null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var t=this.gl;So(t,this.debug,(function(){return t.finish()})),So(t,this.debug,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)})),So(t,this.debug,(function(){return t.deleteFramebuffer(e.framebuffer)})),So(t,this.debug,(function(){return t.bindBuffer(t.ARRAY_BUFFER,null)})),So(t,this.debug,(function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)})),So(t,this.debug,(function(){return t.deleteBuffer(e.indexBuffer)})),this.disposed=!0}},e.prototype.createFloat32MatrixTexture=function(e,t){return this.throwIfDisposed(),sc(this.gl,this.debug,e,t,this.textureConfig)},e.prototype.createFloat16MatrixTexture=function(e,t){return this.throwIfDisposed(),uc(this.gl,this.debug,e,t,this.textureConfig)},e.prototype.createUnsignedBytesMatrixTexture=function(e,t){return this.throwIfDisposed(),cc(this.gl,this.debug,e,t,this.textureConfig)},e.prototype.uploadPixelDataToTexture=function(e,t){this.throwIfDisposed(),pc(this.gl,this.debug,e,t)},e.prototype.uploadDenseMatrixToTexture=function(e,t,n,r){this.throwIfDisposed(),dc(this.gl,this.debug,e,t,n,r,this.textureConfig)},e.prototype.createFloat16PackedMatrixTexture=function(e,t){return this.throwIfDisposed(),fc(this.gl,this.debug,e,t,this.textureConfig)},e.prototype.createPackedMatrixTexture=function(e,t){return this.throwIfDisposed(),lc(this.gl,this.debug,e,t,this.textureConfig)},e.prototype.deleteMatrixTexture=function(e){var t=this;this.throwIfDisposed(),this.outputTexture===e&&(Xo(this.gl,this.debug,this.framebuffer),this.outputTexture=null),So(this.gl,this.debug,(function(){return t.gl.deleteTexture(e)}))},e.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(e,t,n){var r=this;return this.downloadMatrixDriver(e,(function(){return gc(r.gl,r.debug,t,n,r.textureConfig)}))},e.prototype.downloadPackedMatrixFromBuffer=function(e,t,n,r,o,i){return yc(this.gl,e,0,0,0,o,i,this.textureConfig)},e.prototype.downloadFloat32MatrixFromBuffer=function(e,t){return mc(this.gl,e,t)},e.prototype.createBufferFromTexture=function(e,t,n){this.bindTextureToFrameBuffer(e);var r=vc(this.gl,this.debug,t,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r},e.prototype.createAndWaitForFence=function(){var e=this.createFence(this.gl);return this.pollFence(e)},e.prototype.createFence=function(e){var t,n,r=this;if(jn().getBool("WEBGL_FENCE_API_ENABLED")){var o=e,i=o.fenceSync(o.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=function(){var e=o.clientWaitSync(i,0,0);return e===o.ALREADY_SIGNALED||e===o.CONDITION_SATISFIED},t=i}else jn().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),n=function(){return r.isQueryAvailable(t,jn().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):n=function(){return!0};return{query:t,isFencePassed:n}},e.prototype.downloadMatrixFromPackedTexture=function(e,t,n){var r=this;return this.downloadMatrixDriver(e,(function(){return bc(r.gl,r.debug,t,n)}))},e.prototype.createProgram=function(e){this.throwIfDisposed();var t=this.gl,n=No(t,this.debug,e),r=rc(t,this.debug),o=Mo(t,this.debug);return So(t,this.debug,(function(){return t.attachShader(o,r)})),So(t,this.debug,(function(){return t.attachShader(o,n)})),Fo(t,this.debug,o),this.debug&&Lo(t,this.debug,o),this.vertexAttrsAreBound||(this.setProgram(o),this.vertexAttrsAreBound=hc(t,this.debug,this.program,this.vertexBuffer)),o},e.prototype.deleteProgram=function(e){var t=this;this.throwIfDisposed(),e===this.program&&(this.program=null),null!=e&&So(this.gl,this.debug,(function(){return t.gl.deleteProgram(e)}))},e.prototype.setProgram=function(e){var t=this;this.throwIfDisposed(),this.program=e,null!=this.program&&this.debug&&Lo(this.gl,this.debug,this.program),So(this.gl,this.debug,(function(){return t.gl.useProgram(e)}))},e.prototype.getUniformLocation=function(e,t,n){return void 0===n&&(n=!0),this.throwIfDisposed(),n?Ho(this.gl,this.debug,e,t):qo(this.gl,e,t)},e.prototype.getAttributeLocation=function(e,t){var n=this;return this.throwIfDisposed(),So(this.gl,this.debug,(function(){return n.gl.getAttribLocation(e,t)}))},e.prototype.getUniformLocationNoThrow=function(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)},e.prototype.setInputMatrixTexture=function(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),Go(this.gl,this.debug,this.program,e,t,n)},e.prototype.setOutputMatrixTexture=function(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)},e.prototype.setOutputPackedMatrixTexture=function(e,t,n){this.throwIfDisposed();var r=Eo(t,n),o=r[0],i=r[1];this.setOutputMatrixTextureDriver(e,o,i)},e.prototype.setOutputMatrixWriteRegion=function(e,t,n,r){this.setOutputMatrixWriteRegionDriver(n,e,r,t)},e.prototype.setOutputPackedMatrixWriteRegion=function(e,t,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},e.prototype.debugValidate=function(){null!=this.program&&Lo(this.gl,this.debug,this.program),$o(this.gl)},e.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var e=this.gl;this.debug&&this.debugValidate(),So(e,this.debug,(function(){return e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)}))},e.prototype.blockUntilAllProgramsCompleted=function(){var e=this;this.throwIfDisposed(),So(this.gl,this.debug,(function(){return e.gl.finish()}))},e.prototype.getQueryTimerExtension=function(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=To(this.gl,this.debug,2===jn().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},e.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},e.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},e.prototype.beginQuery=function(){if(2===jn().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.gl,t=this.getQueryTimerExtensionWebGL2(),n=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,n),n}var r=this.getQueryTimerExtensionWebGL1(),o=r.createQueryEXT();return r.beginQueryEXT(r.TIME_ELAPSED_EXT,o),o},e.prototype.endQuery=function(){if(2!==jn().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}else{var t=this.gl,n=this.getQueryTimerExtensionWebGL2();t.endQuery(n.TIME_ELAPSED_EXT)}},e.prototype.waitForQueryAndGetTime=function(e){return Ln(this,void 0,void 0,(function(){var t=this;return Bn(this,(function(n){switch(n.label){case 0:return[4,cr((function(){return t.disposed||t.isQueryAvailable(e,jn().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}))];case 1:return n.sent(),[2,this.getQueryTime(e,jn().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}}))}))},e.prototype.getQueryTime=function(e,t){if(0===t)return null;if(2===t){var n=this.gl;return n.getQueryParameter(e,n.QUERY_RESULT)/1e6}var r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6},e.prototype.isQueryAvailable=function(e,t){if(0===t)return!0;if(2===t){var n=this.gl,r=this.getQueryTimerExtensionWebGL2(),o=n.getQueryParameter(e,n.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),o&&!this.disjoint}return o=(r=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(e,r.QUERY_RESULT_AVAILABLE_EXT),null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),o&&!this.disjoint},e.prototype.pollFence=function(e){var t=this;return new Promise((function(n){t.addItemToPoll((function(){return e.isFencePassed()}),(function(){return n()}))}))},e.prototype.pollItems=function(){for(var e=function(e){for(var t=0;t<e.length&&e[t]();++t);return t-1}(this.itemsToPoll.map((function(e){return e.isDoneFn}))),t=0;t<=e;++t)(0,this.itemsToPoll[t].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(e+1)},e.prototype.addItemToPoll=function(e,t){var n=this;this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1||cr((function(){return n.pollItems(),0===n.itemsToPoll.length}))},e.prototype.bindTextureToFrameBuffer=function(e){this.throwIfDisposed(),Ko(this.gl,this.debug,e,this.framebuffer),this.debug&&$o(this.gl)},e.prototype.unbindTextureToFrameBuffer=function(){null!=this.outputTexture?(Ko(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&$o(this.gl)):Xo(this.gl,this.debug,this.framebuffer)},e.prototype.downloadMatrixDriver=function(e,t){this.bindTextureToFrameBuffer(e);var n=t();return this.unbindTextureToFrameBuffer(),n},e.prototype.setOutputMatrixTextureDriver=function(e,t,n){this.throwIfDisposed();var r=this.gl;Ko(r,this.debug,e,this.framebuffer),this.debug&&$o(r),this.outputTexture=e,So(r,this.debug,(function(){return r.viewport(0,0,t,n)})),So(r,this.debug,(function(){return r.scissor(0,0,t,n)}))},e.prototype.setOutputMatrixWriteRegionDriver=function(e,t,n,r){var o=this;this.throwIfDisposed(),So(this.gl,this.debug,(function(){return o.gl.scissor(e,t,n,r)}))},e.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},e.prototype.throwIfNoProgram=function(){if(null==this.program)throw new Error("No GPU program is currently set.")},e}();function kc(e,t){if(e.length!==t.length)throw Error("Binary was compiled with "+e.length+" inputs, but was executed with "+t.length+" inputs");e.forEach((function(e,n){var r=e.logicalShape,o=t[n],i=o.shape;if(!or(r,i))throw Error("Binary was compiled with different shapes than the current args. Shapes "+r+" and "+i+" must match");if(!e.isUniform||!o.isUniform){var a=e.texShape,s=o.isUniform?null:o.texData.texShape;if(!or(a,s))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+a+" and "+s+" must match")}}))}var _c=function(e,t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var r=n.filterWidth,o=n.inChannels,i=n.strideWidth,a=n.strideHeight,s=n.padInfo,u=n.outWidth,c=n.dilationWidth,l=n.dilationHeight,f=n.dataFormat,h=s.left,d=s.top,p=o*r,v=Ys(),m="channelsLast"===f,g=m?0:1,y=m?1:2,b="",w=0;w<=1;w++)for(var x=0;x<=1;x++)b+="\n          blockIndex = rc.y + "+x+";\n          pos = rc.x + "+w+";\n\n          if(blockIndex < "+e[1]+" && pos < "+e[0]+") {\n            offsetY = int(blockIndex / ("+u+")) * "+a+" - "+d+";\n            d0 = offsetY + "+l+" * (pos / "+p+");\n\n            if(d0 < "+t[g]+" && d0 >= 0) {\n\n              offsetX = int(mod(float(blockIndex), "+u+".) * "+i+". - "+h+".);\n              d1 = offsetX + "+c+" * (int(mod(float(pos), "+p+".) / "+o+".));\n\n              if(d1 < "+t[y]+" && d1 >= 0) {\n\n                ch = int(mod(float(pos), "+o+".));\n\n                if ("+m+") {\n                  innerDims = vec2(d1, ch);\n                  result["+(2*w+x)+"] = getChannel(\n                    getA(d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result["+(2*w+x)+"] = getChannel(\n                    getA(ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ";this.userCode="\n      void main() {\n        ivec2 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        "+b+"\n\n        "+v.output+" = result;\n      }\n    "},Ec=function(e,t,n,r,o){this.variableNames=["x"],this.outputShape=[];var i,a=t,s=e[3]-1;this.outputShape=e;var u="float("+n+") + float("+r+") * sum";i=.5===o?"inversesqrt("+u+")":1===o?"1.0/("+u+")":"exp(log("+u+") * float(-"+o+"));",this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -"+a+"; j <= "+a+"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  "+s+") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * "+i+";\n        setOutput(val);\n      }\n    "},Cc=function(e,t,n,r,o){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=n,this.alpha=r,this.beta=o,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < "+this.depth+"; ++d) {\n          int depthBegin = int(max(0.0, float(d - "+t+")));\n          int depthEnd = int(min(float("+this.depth+"),\n              float(d + "+t+" + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = "+this.depth+";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float("+r+") * norm + float("+n+");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float("+r+")\n                * float("+o+")\n                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * "+o+");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    "},Sc=function(e,t,n,r,o){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var i,a=t,s=e[3]-1;this.outputShape=e;var u="float("+n+") + float("+r+") * sum";i=.5===o?"inversesqrt("+u+")":1===o?"1.0/("+u+")":"exp(log("+u+") * float(-"+o+"));",this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < "+this.outputShape[3]+";\n        bool hasNextRow = c < "+this.outputShape[2]+";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - "+a+";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - "+a+"; j <= "+a+"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2("+s+"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * "+i+";\n        setOutput(result);\n      }\n    "},Ic=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideHeight,n=e.strideWidth,r=e.dilationHeight,o=e.effectiveFilterHeight,i=e.effectiveFilterWidth,a=o-1-e.padInfo.top,s=i-1-e.padInfo.left,u=o*i-1;this.userCode="\n      const ivec2 pads = ivec2("+a+", "+s+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+o+";\n          wR += "+r+") {\n          float dyR = float(dyRCorner + wR) / "+t+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+i+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+n+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = "+u+" - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * "+i+" + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Rc=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,o=e.dilationDepth,i=e.dilationHeight,a=e.dilationWidth,s=e.effectiveFilterDepth,u=e.effectiveFilterHeight,c=e.effectiveFilterWidth,l=s-1-e.padInfo.front,f=u-1-e.padInfo.top,h=c-1-e.padInfo.left,d=s*u*c-1;this.userCode="\n      const ivec3 pads = ivec3("+l+", "+f+", "+h+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < "+s+";\n           wD += "+o+") {\n          float dyD = float(dyDCorner + wD) / "+t+".0;\n\n          if (dyD < 0.0 || dyD >= "+e.outDepth+".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < "+u+";\n              wR += "+i+") {\n            float dyR = float(dyRCorner + wR) / "+n+".0;\n\n            if (dyR < 0.0 || dyR >= "+e.outHeight+".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < "+c+";\n                wC += "+a+") {\n              float dyC = float(dyCCorner + wC) / "+r+".0;\n\n              if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = "+d+" -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * "+u+" * "+c+" +\n                  wR * "+c+" + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Tc=function(e,t,n,r,o,i,a){void 0===n&&(n=!1),void 0===r&&(r=!1),void 0===o&&(o=!1),void 0===i&&(i=null),void 0===a&&(a=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;var s=n?e[1]:e[2],u=Math.ceil(s/2),c=n?"i * 2, rc.y":"rc.y, i * 2",l=r?"rc.z, i * 2":"i * 2, rc.z",f=n?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],h=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],d="",p="";i&&(d=a?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          "+i+"\n        }":"vec4 activation(vec4 x) {\n          "+i+"\n        }",p="result = activation(result);");var v=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+d+"\n\n      const float sharedDimension = "+u+".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        for (int i = 0; i < "+u+"; i++) {\n          vec4 a = getMatrixA(rc.x, "+c+");\n          vec4 b = getMatrixB(rc.x, "+l+");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += ("+f[0]+" * "+h[0]+");\n          result += ("+f[1]+" * "+h[1]+");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        "+v+"\n\n        "+p+"\n\n        setOutput(result);\n      }\n    "},Ac=function(){function e(e,t,n){this.variableNames=["probs"],this.outputShape=[e,n],this.userCode="\n      uniform float seed;\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < "+(t-1)+"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float("+(t-1)+"));\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e){var t=this;return function(n,r){null==t.seedLoc&&(t.seedLoc=n.getUniformLocation(r,"seed")),n.gl.uniform1f(t.seedLoc,e)}},e}(),Nc=function(e,t,n,r){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float("+r+"), float("+n+"),\n                      float(index == coords.y)));\n      }\n    "},Oc=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e;var t=e.length;if(0===t)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{var n=$s("rc",t),r=lu(t),o=function(e,t,n){if(1===e)return"rc > "+t[0];for(var r="",o=e-2;o<e;o++)r+=n[o]+" >= "+t[o],o<e-1&&(r+="||");return r}(t,e,n),i=function(e,t,n,r){if(1===e)return"";var o=r.slice(-2);return"\n    int r = "+o[0]+";\n    int c = "+o[1]+";\n    int rp1 = r + 1;\n    int cp1 = c + 1;\n\n    bool cEdge = cp1 >= "+t+";\n    bool rEdge = rp1 >= "+n+";\n  "}(t,e[e.length-1],e[e.length-2],n),a=function(e,t){var n=e.length,r=function(e,t){for(var n=[],r=0;r<=1;r++)for(var o=0;o<=1;o++){for(var i=(0===r?"r":"rp1")+", "+(0===o?"c":"cp1"),a=2;a<e;a++)i=t[t.length-1-a]+","+i;n.push(i)}return n}(n,t);return 1===n?"getA(rc),\n            rc + 1 >= "+e[0]+" ? 0. : getA(rc + 1),\n            0, 0":"getA("+r[0]+"),\n          cEdge ? 0. : getA("+r[1]+"),\n          rEdge ? 0. : getA("+r[2]+"),\n          rEdge || cEdge ? 0. : getA("+r[3]+")"}(e,n);this.userCode="\n        void main() {\n          "+r+" rc = getOutputCoords();\n\n          if("+o+") {\n            setOutput(vec4(0));\n          } else {\n            "+i+"\n\n            setOutput(vec4("+a+"));\n          }\n        }\n      "}},Dc=function(e,t,n){this.variableNames=["x"],this.outputShape=t.map((function(t,n){return t[0]+e[n]+t[1]}));var r=e.length,o=lu(r),i=t.map((function(e){return e[0]})).join(","),a=t.map((function(t,n){return t[0]+e[n]})).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=1!==r?"\n      "+o+" start = "+o+"("+i+");\n      "+o+" end = "+o+"("+a+");\n\n      void main() {\n        "+o+" outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(float("+n+"));\n        } else {\n          "+o+" coords = outC - start;\n          setOutput(getX("+s+"));\n        }\n      }\n    ":"\n        int start = "+i+";\n        int end = "+a+";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(float("+n+"));\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      "},Pc=function(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map((function(t,n){return t[0]+e[n]+t[1]}));for(var r=e.length,o=lu(r),i=t.map((function(e){return e[0]})).join(","),a=t.map((function(t,n){return t[0]+e[n]})).join(","),s=$s("rc",r),u=$s("source",r),c=s[r-1]+" < "+this.outputShape[r-1],l=1===r?"source":"vec2("+u.slice(-2).join()+")",f=[o+" rc = outputLoc;",s[r-1]+" += 1;\n       if("+c+") {\n      ",1===r?"":"}\n       rc = outputLoc;\n       "+s[r-2]+" += 1;\n       if("+s[r-2]+" < "+this.outputShape[r-2]+") {",1===r?"":"  "+s[r-1]+" += 1;\n         if("+c+") {"],h=1===r?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",d="",p=0,v=1===r?2:4;p<v;p++)d+="\n        "+f[p]+"\n        if ("+h+") {\n          result["+p+"] = float("+n+");\n        } else {\n          "+o+" source = rc - start;\n          result["+p+"] = getChannel(getX("+u.join()+"), "+l+");\n        }\n      ";d+=1===r?"} ":"}}",this.userCode="\n      const "+o+" start = "+o+"("+i+");\n      const "+o+" end = "+o+"("+a+");\n\n      void main() {\n        "+o+" outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        "+d+"\n        setOutput(result);\n      }\n    "},Mc=function(e,t,n){if(this.variableNames=["x"],"avg"===t&&n)throw new Error("Cannot compute positions for average pool.");var r=e.filterWidth,o=e.strideHeight,i=e.strideWidth,a=e.dilationHeight,s=e.dilationWidth,u=e.effectiveFilterHeight,c=e.effectiveFilterWidth,l=e.padInfo.top,f=e.padInfo.left;this.outputShape=e.outShape;var h="avg"===t,d="0.0";if(h||(d="-1.0 / 1e-20"),n)this.userCode="\n        const ivec2 strides = ivec2("+o+", "+i+");\n        const ivec2 pads = ivec2("+l+", "+f+");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < "+u+";\n              wR += "+a+") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+c+";\n                wC += "+s+") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= "+e.inWidth+") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value >= currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = wR * "+c+" + wC;\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";else{var p=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===t&&(p="avgValue / count");var v=4*Math.floor(r/4),m=r%4,g="\n      if ("+h+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec2 strides = ivec2("+o+", "+i+");\n      const ivec2 pads = ivec2("+l+", "+f+");\n      const float initializationValue = "+d+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= "+e.inWidth+") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+d+");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < "+u+";\n            wR += "+a+") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= "+e.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+v+"; wC += 4) {\n            int xC = xCCorner + wC * "+s+";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+s+", d),\n              getValue(batch, xR, xC + 2 * "+s+", d),\n              getValue(batch, xR, xC + 3 * "+s+", d)\n            );\n\n            "+g+"\n          }\n\n          int xC = xCCorner + "+v+";\n          if ("+(1===m)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            "+g+"\n          } else if ("+(2===m)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+s+", d),\n              initializationValue,\n              initializationValue\n            );\n\n            "+g+"\n          } else if ("+(3===m)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+s+", d),\n              getValue(batch, xR, xC + 2 * "+s+", d),\n              initializationValue\n            );\n\n            "+g+"\n          }\n        }\n        setOutput("+p+");\n      }\n    "}},Fc=function(e,t,n){if(this.variableNames=["x"],"avg"===t&&n)throw new Error("Cannot compute positions for average pool.");var r=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,l=e.effectiveFilterDepth,f=e.effectiveFilterHeight,h=e.effectiveFilterWidth,d=e.padInfo.front,p=e.padInfo.top,v=e.padInfo.left;this.outputShape=e.outShape;var m="avg"===t,g="0.0";if(m||(g="-1.0 / 1e-20"),n)this.userCode="\n        const ivec3 strides =\n            ivec3("+o+", "+i+", "+a+");\n        const ivec3 pads = ivec3("+d+", "+p+", "+v+");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < "+l+";\n              wD += "+s+") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= "+e.inDepth+") {\n              continue;\n            }\n\n            for (int wR = 0; wR < "+f+";\n                wR += "+u+") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= "+e.inHeight+") {\n                continue;\n              }\n\n              for (int wC = 0; wC < "+h+";\n                  wC += "+c+") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= "+e.inWidth+") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value >= currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition =\n                      wD * "+f+" * "+h+" +\n                      wR * "+h+" + wC;;\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";else{var y=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===t&&(y="avgValue / count");var b=4*Math.floor(r/4),w=r%4,x="\n      if ("+m+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec3 strides =\n        ivec3("+o+", "+i+", "+a+");\n      const ivec3 pads = ivec3("+d+", "+p+", "+v+");\n      const float initializationValue = "+g+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= "+e.inWidth+") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+g+");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < "+l+";\n            wD += "+s+") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= "+e.inDepth+") {\n            continue;\n          }\n\n          for (int wR = 0; wR < "+f+";\n            wR += "+u+") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+b+"; wC += 4) {\n              int xC = xCCorner + wC * "+c+";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+c+", ch),\n                getValue(batch, xD, xR, xC + 2 * "+c+", ch),\n                getValue(batch, xD, xR, xC + 3 * "+c+", ch)\n              );\n\n              "+x+"\n            }\n\n            int xC = xCCorner + "+b+";\n            if ("+(1===w)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              "+x+"\n            } else if ("+(2===w)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+c+", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              "+x+"\n            } else if ("+(3===w)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+c+", ch),\n                getValue(batch, xD, xR, xC + 2 * "+c+", ch),\n                initializationValue\n              );\n\n              "+x+"\n            }\n          }\n          setOutput("+y+");\n        }\n      }\n    "}},Lc=function(e,t){this.variableNames=["x"];var n=e.windowSize,r=e.batchSize,o=e.inSize,i=Math.ceil(o/n);this.outputShape=[r,i];var a="0.0",s="";"prod"===t?a="1.0":"min"===t?(a="1.0 / 1e-20",s="min"):"max"===t&&(a="-1.0 / 1e-20",s="max");var u=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===t?u="sumValue":"prod"===t?u="prodValue":"all"===t?u="allValue":"any"===t&&(u="anyValue");var c=4*Math.floor(n/4),l=n%4,f="\n      if ("+("sum"===t)+") {\n        sumValue += dot(values, ones);\n      } else if ("+("prod"===t)+") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = "+s+"(values, minMaxValue);\n      }\n    ",h="vec4";"all"===t?(a="1.0",f="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",h="bvec4"):"any"===t&&(a="0.0",f="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",h="bvec4");var d="";o%n>0&&(d="\n        if (inIdx < 0 || inIdx >= "+o+") {\n          return initializationValue;\n        }\n      "),this.userCode="\n      const float initializationValue = "+a+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        "+d+"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+n+";\n\n        vec4 minMaxValue = vec4("+a+");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < "+c+"; i += 4) {\n          int inIdx = inOffset + i;\n          "+h+" values = "+h+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          "+f+"\n        }\n\n        int inIdx = inOffset + "+c+";\n        if ("+(1===l)+") {\n          "+h+" values = "+h+"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          "+f+"\n        } else if ("+(2===l)+") {\n          "+h+" values = "+h+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          "+f+"\n        } else if ("+(3===l)+") {\n          "+h+" values = "+h+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          "+f+"\n        }\n        setOutput("+u+");\n      }\n    "},Bc=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var n="",r=0;r<4;r++){var o="thisRC = rc;";r%2==1&&(o+="thisRC.z += 1;"),r>1&&(o+="thisRC.y += 1;"),n+="\n        "+o+"\n        "+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+"\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result["+r+"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        "+(r>0?"}":"")+"\n      "}this.userCode="\n      \n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      "+Qs(["r","c","d"],t)+"\n      return ivec3(r, c, d);\n    }\n  \n      "+Js(e)+"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = "+e[1]+";\n        int cols = "+e[2]+";\n\n        "+n+"\n\n        setOutput(result);\n      }\n    "},Uc=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,o=r[1],i=r[2],a=e.shape,s=a[1],u=a[2],c=[n&&s>1?o-1:o,n&&u>1?i-1:i],l=[n&&s>1?s-1:s,n&&u>1?u-1:u],f=c[0]/l[0],h=c[1]/l[1],d=1/f,p=1/h,v=2*Math.ceil(d)+2,m=2*Math.ceil(p)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+f+");\n        const float widthScale = float("+h+");\n\n        const float invHeightScale = float("+d+");\n        const float invWidthScale = float("+p+");\n\n        const int winHeight = int("+v+");\n        const int winWidth = int("+m+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+s+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+u+") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), "+(o-1)+".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), "+(i-1)+".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "},jc=function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var o=e[0],i=e[1],a=e[2],s=e[3];this.outputShape=[o,t,n,s];var u=[r&&t>1?i-1:i,r&&n>1?a-1:a],c=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+u[0]/c[0]+",\n          "+u[1]/c[1]+");\n      const vec2 inputShapeRC = vec2("+i+".0, "+a+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    "},Zc=function(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var o=e[0],i=e[1],a=e[2],s=e[3];this.outputShape=[o,t,n,s];var u=[r&&t>1?i-1:i,r&&n>1?a-1:a],c=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          "+u[0]/c[0]+",\n          "+u[1]/c[1]+",\n          "+u[1]/c[1]+");\n      const vec3 inputShapeRC = vec3("+i+".0, "+a+".0,\n                                     "+a+".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < "+(s-1)+";\n        bool hasNextRow = coords.z < "+(n-1)+";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    "},Wc=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,o=r[1],i=r[2],a=e.shape,s=a[1],u=a[2],c=[n&&s>1?o-1:o,n&&u>1?i-1:i],l=[n&&s>1?s-1:s,n&&u>1?u-1:u],f=c[0]/l[0],h=c[1]/l[1],d=1/f,p=1/h,v=2*Math.ceil(d)+2,m=2*Math.ceil(p)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+f+");\n        const float widthScale = float("+h+");\n\n        const float invHeightScale = float("+d+");\n        const float invWidthScale = float("+p+");\n\n        const int winHeight = int("+v+");\n        const int winWidth = int("+m+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+s+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+u+") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float("+c[0]+") *\n                (float(dyR) / float("+l[0]+"));\n\n            float sourceFracCol =\n                float("+c[1]+") *\n                  (float(dyC) / float("+l[1]+"));\n\n            int sourceNearestRow = int(min(\n                float(int("+o+") - 1),\n                "+n+" ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int("+i+") - 1),\n                "+n+" ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "},zc=function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var o=e[0],i=e[1],a=e[2],s=e[3];this.outputShape=[o,t,n,s];var u=[r&&t>1?i-1:i,r&&n>1?a-1:a],c=[r&&t>1?t-1:t,r&&n>1?n-1:n],l=r?"0.5":"0.0";this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+u[0]/c[0]+",\n          "+u[1]/c[1]+");\n      const vec2 inputShapeRC = vec2("+i+".0, "+a+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + "+l+")));\n\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    "},Vc=function(e,t){this.variableNames=["x"];var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");if(this.outputShape=e,1!==n){var r=e.map((function(n,r){return function(n){return-1!==t.indexOf(n)&&1!==e[n]?e[n]+" - coords["+n+"] - 1":"coords["+n+"]"}(r)})).join(","),o=lu(n);this.userCode="\n      void main() {\n        "+o+" coords = getOutputCoords();\n        setOutput(getX("+r+"));\n      }\n    "}else this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX("+e[0]+" - coord - 1));\n        }\n      "},Hc=function(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");this.outputShape=e;var r=$s("rc",n),o=r[n-1]+" + 1 < "+this.outputShape[n-1],i=r[n-2]+" + 1 < "+this.outputShape[n-2],a=lu(n);function s(n){var r=e.map((function(r,o){return function(n,r){return-1!==t.indexOf(n)&&1!==e[n]?e[n]+" - "+r[n]+" - 1":""+r[n]}(o,n)}));return"getChannel(getX("+r.join(",")+"), vec2("+r.slice(-2).join(",")+"))"}this.userCode=1===n?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX("+e[0]+" - rc - 1),\n            "+e[0]+" - rc - 1);\n          if("+o+"){\n              result.g = getChannel(getX("+e[0]+" - (rc  + 1) - 1),\n                "+e[0]+" - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      ":"\n        void main() {\n          "+a+" rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = "+function(e){return s(e)}(r.slice())+";\n          if("+o+"){\n            result.g = "+function(e){return e[n-1]="("+e[n-1]+" + 1)",s(e)}(r.slice())+";\n          }\n          if("+i+") {\n            result.b = "+function(e){return e[n-2]="("+e[n-2]+" + 1)",s(e)}(r.slice())+";\n            if("+o+") {\n              result.a = "+function(e){return e[n-1]="("+e[n-1]+" + 1)",e[n-2]="("+e[n-2]+" + 1)",s(e)}(r.slice())+";\n            }\n          }\n          setOutput(result);\n        }\n    "},qc=function(e,t,n,r,o,i,a){void 0===a&&(a=!0),this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;var s=lu(o.length),u=lu(i.length),c="";1===n?c="i":2===n&&(c="i, j");var l="getIndices("+c+")",f="";1===r?f="i":2===r&&(f="i, coords[1]");var h="getUpdates("+f+")",d=t>1?"strides[j]":"strides";this.userCode="\n        "+s+" strides = "+s+"("+o+");\n\n        void main() {\n          "+u+" coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < "+e+"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < "+t+"; j++) {\n              int index = round("+l+");\n              flattenedIndex += index * "+d+";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += "+h+";\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(), sum, float(found)));\n        }\n      "},Gc=function(e,t){this.variableNames=["x","segmentIds"];var n=e.windowSize,r=e.batchSize,o=e.inSize,i=e.numSegments,a=i*Math.ceil(o/n);this.outputShape=[r,a];var s=4*Math.floor(n/4),u=n%4,c="\n        sumValue += dot(values, segFilter);\n    ",l="";o%n>0&&(l="\n        if (inIdx < 0 || inIdx >= "+o+") {\n          return initializationValue;\n        }\n      ");var f="";o%n>0&&(f="\n        if (inIdx < 0 || inIdx >= "+o+") {\n          return -1.0;\n        }\n      "),this.userCode="\n      const float initializationValue = 0.0;\n\n      float getValue(int batch, int inIdx) {\n        "+l+"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        "+f+"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          "+i+")) * float("+n+"));\n        int currentSeg = int(mod(float(outIdx), float("+i+")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < "+s+"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          "+c+"\n        }\n\n        int inIdx = inOffset + "+s+";\n        if ("+(1===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          "+c+"\n        } else if ("+(2===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          "+c+"\n        } else if ("+(3===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          "+c+"\n        }\n        setOutput(sumValue);\n      }\n    "},Kc=function(e,t,n){var r,o;if(this.variableNames=["c","a","b"],this.outputShape=t,n>4)throw Error("Where for rank "+n+" is not yet supported");if(1===n)o="resRC",r="resRC";else{for(var i=["resRC.x","resRC.y","resRC.z","resRC.w"],a=[],s=[],u=0;u<t.length;u++)s.push(""+i[u]),u<e&&a.push(""+i[u]);r=a.join(),o=s.join()}var c=lu(n);this.userCode="\n      void main() {\n        "+c+" resRC = getOutputCoords();\n        float cVal = getC("+r+");\n        if (cVal >= 1.0) {\n          setOutput(getA("+o+"));\n        } else {\n          setOutput(getB("+o+"));\n        }\n      }\n    "},Xc=function(){function e(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;var t,n=lu(this.rank),r="uniform int start["+this.rank+"];",o=function(e){if(1===e)return"sourceLoc";if(e<=6)return $c.slice(0,e).map((function(e){return"sourceLoc."+e})).join(",");throw Error("Slicing for rank "+e+" is not yet supported")}(this.rank);t="\n        "+n+" sourceLoc;\n        "+n+" coords = getOutputCoords();\n        "+e.map((function(e,t){return"sourceLoc."+$c[t]+" = start["+t+"] + coords."+$c[t]+";"})).join("\n")+"\n      ",this.userCode="\n      "+r+"\n      void main() {\n        "+t+"\n        setOutput(getSource("+o+"));\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e){var t=this;if(e.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+e.length+")");return function(n,r){null==t.startLoc&&(t.startLoc=n.getUniformLocationNoThrow(r,"start"),null==t.startLoc)||n.gl.uniform1iv(t.startLoc,e)}},e}(),$c=["x","y","z","w","u","v"],Yc=function(){function e(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length;var t=lu(this.rank),n=$s("coords",this.rank),r=$s("sourceLoc",this.rank),o=1===this.rank?"sourceLoc":"vec2("+r.slice(-2).join()+")",i="getChannel(getSource("+r.join()+"), "+o+")",a="\n      result.x = "+i+";\n      if (++"+n[this.rank-1]+" < "+e[this.rank-1]+") {\n        ++"+r[this.rank-1]+";\n        result.y = "+i+";\n        --"+r[this.rank-1]+";\n      }\n    ",s=1===this.rank?"":"\n      --"+n[this.rank-1]+";\n      if (++"+n[this.rank-2]+" < "+e[this.rank-2]+") {\n        ++"+r[this.rank-2]+";\n        result.z = "+i+";\n        if (++"+n[this.rank-1]+" < "+e[this.rank-1]+") {\n          ++"+r[this.rank-1]+";\n          result.w = "+i+";\n        }\n      }\n    ",u=this.rank<=4?"sourceLoc = coords +\n            "+t+"("+e.map((function(e,t){return"start["+t+"]"})).join()+");":e.map((function(e,t){return r[t]+" = "+n[t]+" + start["+t+"];"})).join("\n");this.userCode="\n      uniform int start["+this.rank+"];\n      void main() {\n        "+t+" coords = getOutputCoords();\n        "+t+" sourceLoc;\n        "+u+"\n        vec4 result = vec4(0.);\n        "+a+"\n        "+s+"\n        setOutput(result);\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e){var t=this;if(e.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+e.length+")");return function(n,r){null==t.startLoc&&(t.startLoc=n.getUniformLocationNoThrow(r,"start"),null==t.startLoc)||n.gl.uniform1iv(t.startLoc,e)}},e}(),Qc=function(e,t,n){this.variableNames=["x"],this.outputShape=n;var r=n.length,o=lu(n.length),i=lu(n.length),a="";if(1===r)a="coords * strides + begin";else{var s=0;a=n.map((function(e,t){return s++,1===n.length?"coords * strides["+t+"] + begin["+t+"]":"coords["+(s-1)+"] * strides["+t+"] + begin["+t+"]"})).join(",")}this.userCode="\n      "+o+" begin = "+o+"("+e+");\n      "+o+" strides = "+o+"("+t+");\n\n      void main() {\n        "+i+" coords = getOutputCoords();\n        setOutput(getX("+a+"));\n      }\n    "},Jc=function(){function e(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return e.prototype.acquireTexture=function(e,t,n){var r,o=el(t,n),i=tl(e,o,n);if(i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]),this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var a=this.freeTextures[i].shift();return this.usedTextures[i].push(a),a}return this.numUsedTextures++,this.log(),o===go.PACKED_2X2_FLOAT32?r=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):o===go.PACKED_2X2_FLOAT16?r=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):o===go.UNPACKED_FLOAT32?r=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):o===go.UNPACKED_FLOAT16?r=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):o===go.PACKED_4X1_UNSIGNED_BYTE&&(r=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[i].push(r),r},e.prototype.releaseTexture=function(e,t,n,r){if(null!=this.freeTextures){var o=tl(t,el(n,r),r);o in this.freeTextures||(this.freeTextures[o]=[]),this.freeTextures[o].push(e),this.numFreeTextures++,this.numUsedTextures--;var i=this.usedTextures[o],a=i.indexOf(e);if(a<0)throw new Error("Cannot release a texture that was never provided by this texture manager");i.splice(a,1),this.log()}},e.prototype.log=function(){if(this.logEnabled){var e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+e+")")}},e.prototype.getNumUsedTextures=function(){return this.numUsedTextures},e.prototype.getNumFreeTextures=function(){return this.numFreeTextures},e.prototype.dispose=function(){var e=this;if(null!=this.freeTextures){for(var t in this.freeTextures)this.freeTextures[t].forEach((function(t){e.gpgpu.deleteMatrixTexture(t)}));for(var t in this.usedTextures)this.usedTextures[t].forEach((function(t){e.gpgpu.deleteMatrixTexture(t)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},e}();function el(e,t){if(e===mo.UPLOAD)return go.PACKED_2X2_FLOAT32;if(e===mo.RENDER||null==e)return function(e){return jn().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?go.PACKED_2X2_FLOAT32:go.UNPACKED_FLOAT32:e?go.PACKED_2X2_FLOAT16:go.UNPACKED_FLOAT16}(t);if(e===mo.DOWNLOAD||e===mo.PIXELS)return go.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+e)}function tl(e,t,n){return e[0]+"_"+e[1]+"_"+t+"_"+n}var nl=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[r]*t[r];this.outputShape=n,this.rank=n.length;var o=lu(this.rank),i=function(e){var t=e.length;if(t>5)throw Error("Tile for rank "+t+" is not yet supported");if(1===t)return"imod(resRC, "+e[0]+")";for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[],o=0;o<e.length;o++)r.push("imod("+n[o]+", "+e[o]+")");return r.join()}(e);this.userCode="\n      void main() {\n        "+o+" resRC = getOutputCoords();\n        setOutput(getA("+i+"));\n      }\n    "},rl=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[t[r]];this.outputShape=n,this.rank=n.length;var o=lu(this.rank),i=function(e){var t=e.length;if(t>6)throw Error("Transpose for rank "+t+" is not yet supported");for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(t),o=0;o<e.length;o++)r[e[o]]=n[o];return r.join()}(t);this.userCode="\n    void main() {\n      "+o+" resRC = getOutputCoords();\n      setOutput(getA("+i+"));\n    }\n    "},ol=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[t[r]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var o=lu(this.rank),i=Xs("rc",this.rank),a=new Array(this.rank);for(r=0;r<t.length;r++)a[t[r]]=i[r];var s="vec2("+a.slice(-2).join()+")",u="++"+i[this.rank-1]+" < "+n[this.rank-1],c="getChannel(getA("+a.join()+"), "+s+")";this.userCode="\n    void main() {\n      "+o+" rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = "+c+";\n      if("+u+") {\n        result[1] = "+c+";\n      }\n      --"+i[this.rank-1]+";\n      if(++"+i[this.rank-2]+" < "+n[this.rank-2]+") {\n        result[2] = "+c+";\n        if("+u+") {\n          result[3] = "+c+";\n        }\n      }\n      setOutput(result);\n    }\n    "},il=1.7580993408473768,al=1.0507009873554805,sl=function(e,t){this.variableNames=["A"],this.outputShape=e,this.userCode="\n      float unaryOperation(float x) {\n        "+t+"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "},ul="if (isnan(x)) return x;",cl="return abs(x);",ll=ul+"\n  return (x < 0.0) ? 0.0 : x;\n",fl=ul+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",hl="return (x >= 0.0) ? x : (exp(x) - 1.0);",dl="\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = "+il+";\n  float scale = "+al+";\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n",pl="return -x;",vl="return ceil(x);",ml="return floor(x);",gl="return exp(x);",yl="return exp(x) - 1.0;",bl=ul+"\n  return sin(x);\n",wl=ul+"\n  return cos(x);\n",xl=ul+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n",kl=ul+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n",_l=ul+"\n  return atan(x);\n",El=ul+"return log(x + sqrt(x * x + 1.0));",Cl=ul+"\n  if (x < 1.0) return NAN;\n  return log(x + sqrt(x * x - 1.0));",Sl=ul+"\n  if ((x < -1.0) || (x > 1.0)) return NAN;\n  return (log(1.0 + x) - log(1.0 - x)) / 2.0;",Il="return x;",Rl="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",Tl="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",Al="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",Nl=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        "+t+"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "},Ol=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e;var t=e.length,n=$s("rc",t),r=lu(t),o=function(e,t){if(1===e)return"rc";for(var n="",r=0;r<e;r++)n+=t[r],r<e-1&&(n+=",");return n}(t,n),i=n.slice(-2),a=t<=1?"rc":"vec2("+i.join(",")+")";this.userCode="\n      void main() {\n        "+r+" rc = getOutputCoords();\n        vec4 packedInput = getA("+o+");\n\n        setOutput(getChannel(packedInput, "+a+"));\n      }\n    "},Dl={};function Pl(e,t){if(void 0===t&&(t=!1),"linear"===e)return"return x;";if("relu"===e)return t?Rl:ll;if("elu"===e)return t?Al:hl;if("relu6"===e)return t?Tl:fl;if("prelu"===e)return t?Eu:ku;throw new Error("Activation "+e+" has not been implemented for the WebGL backend.")}var Ml=function(e){function t(t){var n,r=e.call(this)||this;if(r.pendingRead=new WeakMap,r.pendingDisposal=new WeakSet,r.dataRefCount=new WeakMap,r.numBytesInGPU=0,r.uploadWaitMs=0,r.downloadWaitMs=0,r.warnedAboutMemory=!1,r.pendingDeletes=0,r.disposed=!1,!jn().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(null==t){var o=xo(jn().getNumber("WEBGL_VERSION"));r.binaryCache=((n=jn().getNumber("WEBGL_VERSION"))in Dl||(Dl[n]={}),Dl[n]),r.gpgpu=new xc(o),r.canvas=o.canvas,r.gpgpuCreatedLocally=!0}else r.gpgpu=t,r.binaryCache={},r.gpgpuCreatedLocally=!1,r.canvas=t.gl.canvas;return r.textureManager=new Jc(r.gpgpu),r.numMBBeforeWarning=null==jn().global.screen?1024:jn().global.screen.height*jn().global.screen.width*window.devicePixelRatio*600/1024/1024,r.texData=new cs(r,fo),r}return Fn(t,e),t.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},t.prototype.write=function(e,t,n){if(jn().getBool("DEBUG")&&this.checkNumericalProblems(e),"complex64"===n&&null!=e)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var r={};return this.texData.set(r,{shape:t,dtype:n,values:e,usage:mo.UPLOAD}),r},t.prototype.move=function(e,t,n,r){if(jn().getBool("DEBUG")&&this.checkNumericalProblems(t),"complex64"===r)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:n,dtype:r,values:t,usage:mo.UPLOAD})},t.prototype.readSync=function(e){var t=this.texData.get(e),n=t.values,r=t.dtype,o=t.complexTensors,i=t.slice,a=t.shape,s=t.isPacked;if(null!=i){var u;u=s?new Nl(a,Il):new sl(a,Il);var c=this.runWebGLProgram(u,[{dataId:e,shape:a,dtype:r}],r),l=this.readSync(c.dataId);return this.disposeData(c.dataId),l}if(null!=n)return this.convertAndCacheOnCPU(e);if("string"===r)return n;var f,h,d=null!=this.activeTimers;return d&&(f=Or()),h="complex64"===r?As(o.real.dataSync(),o.imag.dataSync()):this.getValuesFromTexture(e),d&&(this.downloadWaitMs+=Or()-f),this.convertAndCacheOnCPU(e,h)},t.prototype.read=function(e){return Ln(this,void 0,void 0,(function(){var t,n,r,o,i,a,s,u,c,l,f,h,d,p,v,m,g,y,b,w,x,k;return Bn(this,(function(_){switch(_.label){case 0:if(this.pendingRead.has(e))return t=this.pendingRead.get(e),[2,new Promise((function(e){return t.push(e)}))];if(n=this.texData.get(e),r=n.values,o=n.shape,i=n.slice,a=n.dtype,s=n.complexTensors,u=n.isPacked,null!=i)return void 0,c=u?new Nl(o,Il):new sl(o,Il),l=this.runWebGLProgram(c,[{dataId:e,shape:o,dtype:a}],a),f=this.read(l.dataId),this.disposeData(l.dataId),[2,f];if(null!=r)return[2,this.convertAndCacheOnCPU(e)];if(!jn().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===jn().getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return h=null,"complex64"!==a&&jn().get("WEBGL_BUFFER_SUPPORTED")&&(d=this.decode(e),p=this.texData.get(d.dataId),h=(k=this.gpgpu).createBufferFromTexture.apply(k,[p.texture].concat(_o(o)))),this.pendingRead.set(e,[]),"complex64"===a?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:_.sent(),_.label=2;case 2:return"complex64"!==a?[3,4]:[4,Promise.all([s.real.data(),s.imag.data()])];case 3:return m=_.sent(),g=m[0],y=m[1],v=As(g,y),[3,5];case 4:null==h?v=this.getValuesFromTexture(e):(b=rr(o),v=this.gpgpu.downloadFloat32MatrixFromBuffer(h,b)),_.label=5;case 5:return null!=d&&this.disposeData(d.dataId),w=this.convertAndCacheOnCPU(e,v),x=this.pendingRead.get(e),this.pendingRead.delete(e),x.forEach((function(e){return e(w)})),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e),this.pendingDeletes--),[2,w]}}))}))},t.prototype.checkNumericalProblems=function(e){if(null!=e)for(var t=0;t<e.length;t++){var n=e[t];if(!Io(n)){if(jn().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error("The value "+n+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'");throw Error("The value "+n+" cannot be represented on this device.")}}},t.prototype.getValuesFromTexture=function(e){var t,n=this.texData.get(e),r=n.shape,o=n.dtype,i=n.isPacked,a=rr(r);if(jn().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var s=this.decode(e),u=this.texData.get(s.dataId),c=(t=this.gpgpu).downloadMatrixFromPackedTexture.apply(t,[u.texture].concat(_o(r))).subarray(0,a);return this.disposeData(s.dataId),c}var l=jn().getBool("WEBGL_PACK")&&!0===i,f=l?ni(r):r,h=l?new $u(f):new Xu(f),d=this.runWebGLProgram(h,[{shape:f,dtype:o,dataId:e}],"float32"),p=this.texData.get(d.dataId),v=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(p.texture,p.texShape[0],p.texShape[1]).subarray(0,a);return this.disposeData(d.dataId),v},t.prototype.time=function(e){return Ln(this,void 0,void 0,(function(){var t,n,r,o,i,a,s;return Bn(this,(function(u){switch(u.label){case 0:return t=this.activeTimers,n=[],r=!1,null==this.programTimersStack?(this.programTimersStack=n,r=!0):this.activeTimers.push(n),this.activeTimers=n,e(),o=nr(this.activeTimers.map((function(e){return e.query}))).filter((function(e){return null!=e})),i=nr(this.activeTimers.map((function(e){return e.name}))).filter((function(e){return null!=e})),this.activeTimers=t,r&&(this.programTimersStack=null),a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},jn().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[4,Promise.all(o)]:[3,2];case 1:return s=u.sent(),a.kernelMs=Qn(s),a.getExtraProfileInfo=function(){return s.map((function(e,t){return{name:i[t],ms:e}})).map((function(e){return e.name+": "+e.ms})).join(", ")},[3,3];case 2:a.kernelMs={error:"WebGL query timers are not supported in this environment."},u.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,a]}}))}))},t.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},t.prototype.startTimer=function(){return jn().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Or(),endMs:null}},t.prototype.endTimer=function(e){return jn().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=Or(),e)},t.prototype.getQueryTime=function(e){return Ln(this,void 0,void 0,(function(){var t;return Bn(this,(function(n){return jn().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[2,this.gpgpu.waitForQueryAndGetTime(e)]:[2,(t=e).endMs-t.startMs]}))}))},t.prototype.disposeData=function(e){if(!this.pendingDisposal.has(e)){if(this.pendingRead.has(e))return this.pendingDisposal.add(e),void this.pendingDeletes++;if(this.texData.has(e)){this.releaseGPUData(e);var t=this.texData.get(e).complexTensors;null!=t&&(t.real.dispose(),t.imag.dispose()),this.texData.delete(e)}}},t.prototype.releaseGPUData=function(e){var t=this.texData.get(e),n=t.texture,r=t.dtype,o=t.texShape,i=t.usage,a=t.isPacked,s=t.slice,u=s&&s.origDataId||e,c=this.dataRefCount.get(u);c>1?this.dataRefCount.set(u,c-1):(this.dataRefCount.delete(u),null!=n&&(this.numBytesInGPU-=this.computeBytes(o,r),this.textureManager.releaseTexture(n,o,i,a)));var l=this.texData.get(e);l.texture=null,l.texShape=null,l.isPacked=!1,l.slice=null},t.prototype.getTexture=function(e){return this.uploadToGPU(e),this.texData.get(e).texture},t.prototype.getDataInfo=function(e){return this.texData.get(e)},t.prototype.getCPUBackend=function(){return jn().getBool("WEBGL_CPU_FORWARD")?(null==this.cpuBackend&&(this.cpuBackend=fo.findBackend("cpu")),this.cpuBackend):null},t.prototype.shouldExecuteOnCPU=function(e,t){var n=this;return void 0===t&&(t=128),null!=this.getCPUBackend()&&e.every((function(e){return null==n.texData.get(e.dataId).texture&&e.size<t}))},t.prototype.getGPGPUContext=function(){return this.gpgpu},t.prototype.complex=function(e,t){var n=this.makeOutput(e.shape,"complex64");return this.texData.get(n.dataId).complexTensors={real:fo.keep(e.clone()),imag:fo.keep(t.clone())},n},t.prototype.real=function(e){return this.texData.get(e.dataId).complexTensors.real.clone()},t.prototype.imag=function(e){return this.texData.get(e.dataId).complexTensors.imag.clone()},t.prototype.slice=function(e,t,n){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.slice(e,t,n);if(0===rr(n))return Ui([],n,e.dtype);var r=this.texData.get(e.dataId).isPacked,o=os(e.shape,t,n);if(r||!o){var i=jn().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Yc(n):new Xc(n),a=i.getCustomSetupFunc(t);return this.compileAndRun(i,[e],null,a)}return this.uploadToGPU(e.dataId),this.shallowSlice(e,t,n)},t.prototype.shallowSlice=function(e,t,n){var r=this.texData.get(e.dataId),o=this.makeOutput(n,e.dtype),i=this.texData.get(o.dataId);Object.assign(i,r),i.shape=n,i.dtype=e.dtype;var a=is(t,e.strides);r.slice&&(a+=r.slice.flatOffset),i.slice={flatOffset:a,origDataId:r.slice&&r.slice.origDataId||e.dataId};var s=this.dataRefCount.get(i.slice.origDataId)||1;return this.dataRefCount.set(i.slice.origDataId,s+1),o},t.prototype.stridedSlice=function(e,t,n,r){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.stridedSlice(e,t,n,r);var o=ts(t,n,r);if(o.some((function(e){return 0===e})))return Ui([],o);var i=new Qc(t,r,o);return this.compileAndRun(i,[e])},t.prototype.reverse=function(e,t){var n=jn().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Hc(e.shape,t):new Vc(e.shape,t);return this.compileAndRun(n,[e])},t.prototype.concat=function(e,t){if("complex64"===e[0].dtype){var n=e.map((function(e){return Li(e)})),r=e.map((function(e){return Bi(e)}));return Fi(this.concat(n,t),this.concat(r,t))}if(this.shouldExecuteOnCPU(e))return this.cpuBackend.concat(e,t);if(1===e.length)return e[0];if(e.length>jn().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var o=Math.floor(e.length/2),i=this.concat(e.slice(0,o),t),a=this.concat(e.slice(o),t);return this.concat([i,a],t)}if(jn().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&e[0].rank>1){var s=new Au(e.map((function(e){return e.shape})),t);return this.compileAndRun(s,e)}var u=Pi(e.map((function(e){return e.shape})),t),c=e.map((function(e){return e.as2D(-1,rr(e.shape.slice(t)))})),l=new Tu(c.map((function(e){return e.shape})));return this.compileAndRun(l,c).reshape(u)},t.prototype.neg=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.neg(e);if(jn().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,pl,e.dtype);var t=new sl(e.shape,pl);return this.compileAndRun(t,[e])},t.prototype.batchMatMul=function(e,t,n,r){var o=n?e.shape[2]:e.shape[1],i=r?t.shape[1]:t.shape[2],a=n?e.shape[1]:e.shape[2],s=e.shape[0];if((1===o||1===i)&&a>1e3){n&&(e=e.transpose([0,2,1])),r&&(t=t.transpose([0,2,1]));var u=1===i?e:e.as3D(s,a,1),c=1===i?2:1,l=1===i?t.as3D(s,1,a):t;return this.multiply(u,l).sum(c,!0)}var f=ro(e.dtype,t.dtype),h=new Tc(e.shape,[s,o,i],n,r);return this.compileAndRun(h,[e,t],f)},t.prototype.fusedBatchMatMul=function(e){var t=e.a,n=e.b,r=e.transposeA,o=e.transposeB,i=e.bias,a=e.activation,s=e.preluActivationWeights,u=r?t.shape[2]:t.shape[1],c=o?n.shape[1]:n.shape[2],l=t.shape[0],f=ro(t.dtype,n.dtype),h=null!=i,d=null!=s,p=a?Pl(a,!0):null,v=new Tc(t.shape,[l,u,c],r,o,h,p,d),m=[t,n];return i&&m.push(i),s&&m.push(s),this.compileAndRun(v,m,f)},t.prototype.multiply=function(e,t){if("complex64"===e.dtype){var n=this.texData.get(e.dataId),r=this.texData.get(t.dataId),o=new yu("return areal * breal - aimag * bimag;",e.shape,t.shape),i=new yu("return areal * bimag + aimag * breal;",e.shape,t.shape),a=[this.makeComplexComponentTensorInfo(e,n.complexTensors.real),this.makeComplexComponentTensorInfo(e,n.complexTensors.imag),this.makeComplexComponentTensorInfo(t,r.complexTensors.real),this.makeComplexComponentTensorInfo(t,r.complexTensors.imag)],s=this.compileAndRun(o,a),u=this.compileAndRun(i,a),c=this.complex(s,u);return s.dispose(),u.dispose(),c}if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.multiply(e,t);if(jn().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,xu,e.dtype);var l=new _u(xu,e.shape,t.shape);return this.compileAndRun(l,[e,t],e.dtype)},t.prototype.batchNormalization=function(e,t,n,r,o,i){var a=[e,t,n],s=null;null!=i&&(s=i.shape,a.push(i));var u=null;if(null!=o&&(u=o.shape,a.push(o)),jn().getBool("WEBGL_PACK_NORMALIZATION")){var c=new gu(e.shape,t.shape,n.shape,s,u,r);return this.compileAndRun(c,a)}var l=new mu(e.shape,t.shape,n.shape,s,u,r);return this.compileAndRun(l,a)},t.prototype.localResponseNormalization4D=function(e,t,n,r,o){var i=jn().getBool("WEBGL_PACK_NORMALIZATION")?new Sc(e.shape,t,n,r,o):new Ec(e.shape,t,n,r,o);return this.compileAndRun(i,[e])},t.prototype.LRNGrad=function(e,t,n,r,o,i,a){var s=new Cc(t.shape,r,o,i,a);return this.compileAndRun(s,[t,n,e])},t.prototype.tile=function(e,t){if("string"===e.dtype){var n=this.readSync(e.dataId).map((function(e){return Mr(e)}));return zs(ma(e.shape,e.dtype,n),t)}var r=new nl(e.shape,t);return this.compileAndRun(r,[e])},t.prototype.pad=function(e,t,n){var r=jn().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Pc(e.shape,t,n):new Dc(e.shape,t,n);return this.compileAndRun(r,[e])},t.prototype.transpose=function(e,t){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.transpose(e,t);var n=jn().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new ol(e.shape,t):new rl(e.shape,t);return this.compileAndRun(n,[e])},t.prototype.gather=function(e,t,n){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.gather(e,t,n);var r=new tc(e.shape,t.size,n);return this.compileAndRun(r,[e,t])},t.prototype.batchToSpaceND=function(e,t,n){Jn(e.rank<=4,(function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"}));var r=t.reduce((function(e,t){return e*t})),o=za(e.shape,t,r),i=Va(o.length,t.length),a=Ha(e.shape,t,r),s=qa(n,t.length),u=Ga(a,n,t.length);return e.reshape(o).transpose(i).reshape(a).slice(s,u)},t.prototype.spaceToBatchND=function(e,t,n){Jn(e.rank<=4,(function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"}));var r=t.reduce((function(e,t){return e*t})),o=[[0,0]];o.push.apply(o,n);for(var i=1+t.length;i<e.shape.length;++i)o.push([0,0]);var a=e.pad(o),s=za(a.shape,t,r,!1),u=Va(s.length,t.length,!1),c=Ha(a.shape,t,r,!1);return a.reshape(s).transpose(u).reshape(c)},t.prototype.reduce=function(e,t,n){var r=e.shape[0],o=e.shape[1],i=Xa(o),a=new Lc({windowSize:i,inSize:o,batchSize:r},t),s=this.compileAndRun(a,[e],n);return 1===s.shape[1]?s:this.reduce(s,t,n)},t.prototype.argReduce=function(e,t,n){void 0===n&&(n=null);var r=e.shape[0],o=e.shape[1];null!=n&&(r=n.shape[0],o=n.shape[1]);var i=Xa(o),a=new Ks({windowSize:i,inSize:o,batchSize:r},t,null==n),s=[e];null!=n&&s.push(n);var u=this.compileAndRun(a,s,"int32");return 1===u.shape[1]?u:this.argReduce(e,t,u)},t.prototype.argReducePacked=function(e,t,n){void 0===n&&(n=null);var r=null!=n?n.shape:e.shape,o=Xa(r[r.length-1]),i=new du(r,o,t,null==n),a=null==n?[e]:[e,n],s=this.compileAndRun(i,a,"int32");return s.rank===e.rank?this.argReducePacked(e,t,s):s},t.prototype.sum=function(e,t){Ti("sum",t,e.rank);var n=Ii(e.shape,t),r=n[0],o=rr(n[1]),i=e.as2D(-1,o),a=oo(e.dtype);return this.reduce(i,"sum",a).reshape(r)},t.prototype.prod=function(e,t){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.prod(e,t);var n=Ii(e.shape,t),r=n[0],o=rr(n[1]),i=e.as2D(-1,o),a=oo(e.dtype);return this.reduce(i,"prod",a).reshape(r)},t.prototype.unsortedSegmentSum=function(e,t,n){var r=0,o=Ai([r],e.rank),i=e;null!=o&&(i=e.transpose(o),r=Oi(1,e.rank)[0]);var a=function(e,t,n){for(var r=[],o=e.length,i=0;i<o;i++)i!==t?r.push(e[i]):r.push(n);return r}(i.shape,r,n),s=rr([i.shape[r]]),u=i.as2D(-1,s),c=oo(e.dtype),l=this.segOpCompute(u,"unsortedSegmentSum",t,c,n).reshape(a);return null!=o&&(l=l.transpose(Ni(o))),l},t.prototype.segOpCompute=function(e,t,n,r,o){var i=e.shape[0],a=e.shape[1],s=function(e,t){var n,r=!1;for(e<=30?(n=e,r=!0):n=Sr(e,Math.floor(Math.sqrt(e)));!r;)n>t||n===e?r=!0:n=Sr(e,n+1);return n}(a,o),u=new Gc({windowSize:s,inSize:a,batchSize:i,numSegments:o},t),c=this.compileAndRun(u,[e,n],r);return c.shape[1]===o?c:(n=Xi(0,o).tile([a/s]),this.segOpCompute(c,t,n,r,o))},t.prototype.argMinMaxReduce=function(e,t,n){var r=[t];if(Ti("arg"+n.charAt(0).toUpperCase()+n.slice(1),r,e.rank),!jn().getBool("WEBGL_PACK_REDUCE")||e.rank<=2){var o=Ii(e.shape,r),i=o[0],a=rr(o[1]),s=e.as2D(-1,a);return this.argReduce(s,n).reshape(i)}return this.argReducePacked(e,n)},t.prototype.argMin=function(e,t){return this.argMinMaxReduce(e,t,"min")},t.prototype.argMax=function(e,t){return this.argMinMaxReduce(e,t,"max")},t.prototype.cumsum=function(e,t,n,r){if(t!==e.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(e.rank-1)+" but got axis="+t);var o=new zu(e.shape,n,r);return this.compileAndRun(o,[e])},t.prototype.equal=function(e,t){if(jn().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(equal(a, b));\n","bool");var n=new _u("return float(a == b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.notEqual=function(e,t){if(jn().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(notEqual(a, b));\n","bool");var n=new _u("return float(a != b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.less=function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.less(e,t);if(jn().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(lessThan(a, b));\n","bool");var n=new _u("return float(a < b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.lessEqual=function(e,t){if(jn().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(lessThanEqual(a, b));\n","bool");var n=new _u("return float(a <= b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.greater=function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.greater(e,t);if(jn().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(greaterThan(a, b));\n","bool");var n=new _u("return float(a > b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.greaterEqual=function(e,t){if(jn().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(greaterThanEqual(a, b));\n","bool");var n=new _u("return float(a >= b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.logicalNot=function(e){var t=new sl(e.shape,"return float(!(x >= 1.0));");return this.compileAndRun(t,[e])},t.prototype.logicalAnd=function(e,t){if(jn().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n","bool");var n=new _u("return float(a >= 1.0 && b >= 1.0);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.logicalOr=function(e,t){if(jn().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n","bool");var n=new _u("return float(a >= 1.0 || b >= 1.0);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.select=function(e,t,n){var r=new Kc(e.rank,t.shape,t.rank);return this.compileAndRun(r,[e,t,n],ro(t.dtype,n.dtype))},t.prototype.where=function(e){wi("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var t=e.dataSync();return Hs(e.shape,t)},t.prototype.topk=function(e,t,n){return Vs(e.dataSync(),e.shape,e.dtype,t)},t.prototype.min=function(e,t){Ti("min",t,e.rank);var n=Ii(e.shape,t),r=n[0],o=rr(n[1]),i=e.as2D(-1,o);return this.reduce(i,"min",i.dtype).reshape(r)},t.prototype.minimum=function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.minimum(e,t);var n=jn().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Cu("\n  vec4 result = vec4(min(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new _u("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return min(a, b);\n",e.shape,t.shape);return this.compileAndRun(n,[e,t])},t.prototype.mod=function(e,t){var n=jn().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Cu("\n  vec4 result = mod(a, b);\n  vec4 isNaN = vec4(equal(b, vec4(0.0)));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new _u("if (b == 0.0) return NAN;\n  return mod(a, b);",e.shape,t.shape);return this.compileAndRun(n,[e,t])},t.prototype.max=function(e,t){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.max(e,t);Ti("max",t,e.rank);var n=Ii(e.shape,t),r=n[0],o=rr(n[1]),i=e.as2D(-1,o);return this.reduce(i,"max",i.dtype).reshape(r)},t.prototype.maximum=function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.maximum(e,t);var n=jn().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Cu("\n  vec4 result = vec4(max(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new _u("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return max(a, b);\n",e.shape,t.shape);return this.compileAndRun(n,[e,t])},t.prototype.all=function(e,t){Ti("all",t,e.rank);var n=Ii(e.shape,t),r=n[0],o=rr(n[1]),i=e.as2D(-1,o);return this.reduce(i,"all",i.dtype).reshape(r)},t.prototype.any=function(e,t){Ti("any",t,e.rank);var n=Ii(e.shape,t),r=n[0],o=rr(n[1]),i=e.as2D(-1,o);return this.reduce(i,"any",i.dtype).reshape(r)},t.prototype.realDivide=function(e,t){if(jn().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n","float32",!0);var n=new _u("\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",e.shape,t.shape);return this.compileAndRun(n,[e,t],"float32")},t.prototype.floorDiv=function(e,t){if(jn().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n","int32");var n=new _u("\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",e.shape,t.shape);return this.compileAndRun(n,[e,t],"int32")},t.prototype.add=function(e,t){if("complex64"===e.dtype&&"complex64"===t.dtype)return this.complexSeparableBinaryOp(e,t,bu);if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.add(e,t);var n=ro(e.dtype,t.dtype);if(jn().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,bu,n);var r=new _u(bu,e.shape,t.shape);return this.compileAndRun(r,[e,t],n)},t.prototype.packedUnaryOp=function(e,t,n){var r=new Nl(e.shape,t);return this.compileAndRun(r,[e],n)},t.prototype.packedBinaryOp=function(e,t,n,r,o){void 0===o&&(o=!1);var i=new Cu(n,e.shape,t.shape,o);return this.compileAndRun(i,[e,t],r)},t.prototype.complexSeparableBinaryOp=function(e,t,n){var r=this,o=this.texData.get(e.dataId),i=this.texData.get(t.dataId),a=[[o.complexTensors.real,i.complexTensors.real],[o.complexTensors.imag,i.complexTensors.imag]].map((function(o){var i=o[0],a=o[1],s=r.makeComplexComponentTensorInfo(e,i),u=r.makeComplexComponentTensorInfo(t,a),c=new _u(n,e.shape,t.shape);return r.compileAndRun(c,[s,u],ro(i.dtype,a.dtype))})),s=a[0],u=a[1],c=this.complex(s,u);return s.dispose(),u.dispose(),c},t.prototype.makeComplexComponentTensorInfo=function(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}},t.prototype.addN=function(e){if(1===e.length)return e[0];if(e.length>jn().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var t=Math.floor(e.length/2),n=this.addN(e.slice(0,t)),r=this.addN(e.slice(t));return this.addN([n,r])}var o=e.map((function(e){return e.dtype})).reduce((function(e,t){return ro(e,t)})),i=e.map((function(e){return e.shape})),a=jn().getBool("WEBGL_PACK")?new Gs(e[0].shape,i):new qs(e[0].shape,i);return this.compileAndRun(a,e,o)},t.prototype.subtract=function(e,t){if("complex64"===e.dtype&&"complex64"===t.dtype)return this.complexSeparableBinaryOp(e,t,wu);if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.subtract(e,t);var n=ro(e.dtype,t.dtype);if(jn().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,wu,e.dtype);var r=new _u(wu,e.shape,t.shape);return this.compileAndRun(r,[e,t],n)},t.prototype.pow=function(e,t){var n=jn().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Cu("\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new _u("\nif(a < 0.0 && floor(b) < b){\n  return NAN;\n}\nif (b == 0.0) {\n  return 1.0;\n}\nreturn (round(mod(b, 2.0)) != 1) ?\n    pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",e.shape,t.shape),r=ro(e.dtype,t.dtype);return this.compileAndRun(n,[e,t],r)},t.prototype.ceil=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.ceil(e);if(jn().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,vl,e.dtype);var t=new sl(e.shape,vl);return this.compileAndRun(t,[e])},t.prototype.floor=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.floor(e);if(jn().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,ml,e.dtype);var t=new sl(e.shape,ml);return this.compileAndRun(t,[e])},t.prototype.sign=function(e){var t=new sl(e.shape,"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n");return this.compileAndRun(t,[e])},t.prototype.isNaN=function(e){var t=new sl(e.shape,"return float(isnan(x));");return this.compileAndRun(t,[e],"bool")},t.prototype.isInf=function(e){var t=new sl(e.shape,"return float(isinf(x));");return this.compileAndRun(t,[e],"bool")},t.prototype.isFinite=function(e){var t=new sl(e.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(t,[e],"bool")},t.prototype.round=function(e){var t=new sl(e.shape,"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n");return this.compileAndRun(t,[e])},t.prototype.exp=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.exp(e);if(jn().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,gl,e.dtype);var t=new sl(e.shape,gl);return this.compileAndRun(t,[e])},t.prototype.expm1=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.expm1(e);if(jn().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,yl,e.dtype);var t=new sl(e.shape,yl);return this.compileAndRun(t,[e])},t.prototype.softmax=function(e,t){var n=fr([t],e.shape),r=this.max(e,n),o=Ri(r.shape,n),i=this.subtract(e,r.reshape(o)),a=this.exp(i),s=this.sum(a,n).reshape(o);return this.realDivide(a,s)},t.prototype.log=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.log(e);if(jn().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,"\n  vec4 result = log(x);\n  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));\n  result.r = isNaN.r == 1.0 ? NAN : result.r;\n  result.g = isNaN.g == 1.0 ? NAN : result.g;\n  result.b = isNaN.b == 1.0 ? NAN : result.b;\n  result.a = isNaN.a == 1.0 ? NAN : result.a;\n\n  return result;\n",e.dtype);var t=new sl(e.shape,"if (x < 0.0) return NAN;\n  return log(x);");return this.compileAndRun(t,[e])},t.prototype.log1p=function(e){var t=new sl(e.shape,"return log(1.0 + x);");return this.compileAndRun(t,[e])},t.prototype.sqrt=function(e){var t=new sl(e.shape,"return sqrt(x);");return this.compileAndRun(t,[e])},t.prototype.rsqrt=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.rsqrt(e);var t=new sl(e.shape,"return inversesqrt(x);");return this.compileAndRun(t,[e])},t.prototype.reciprocal=function(e){var t=new sl(e.shape,"return 1.0 / x;");return this.compileAndRun(t,[e])},t.prototype.relu=function(e){var t;return t=jn().getBool("WEBGL_PACK")?new Nl(e.shape,Rl):new sl(e.shape,ll),this.compileAndRun(t,[e])},t.prototype.relu6=function(e){var t;return t=jn().getBool("WEBGL_PACK")?new Nl(e.shape,Tl):new sl(e.shape,fl),this.compileAndRun(t,[e])},t.prototype.prelu=function(e,t){var n=jn().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Cu(Eu,e.shape,t.shape):new _u(ku,e.shape,t.shape);return this.compileAndRun(n,[e,t])},t.prototype.elu=function(e){if(jn().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,Al,e.dtype);var t=new sl(e.shape,hl);return this.compileAndRun(t,[e])},t.prototype.eluDer=function(e,t){var n=jn().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Cu("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",e.shape,t.shape):new _u("return (b >= 1.0) ? a : a * (b + 1.0);",e.shape,t.shape);return this.compileAndRun(n,[e,t])},t.prototype.selu=function(e){var t=new sl(e.shape,dl);return this.compileAndRun(t,[e])},t.prototype.int=function(e){var t=new sl(e.shape,"return float(int(x));");return this.compileAndRun(t,[e],"int32")},t.prototype.clip=function(e,t,n){var r,o=(r=jn().getBool("WEBGL_PACK_CLIP")?new Iu(e.shape):new Su(e.shape)).getCustomSetupFunc(t,n);return this.compileAndRun(r,[e],null,o)},t.prototype.abs=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.abs(e);if(jn().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,cl,e.dtype);var t=new sl(e.shape,cl);return this.compileAndRun(t,[e])},t.prototype.complexAbs=function(e){var t=this.texData.get(e.dataId),n=new Ru(e.shape),r=[this.makeComplexComponentTensorInfo(e,t.complexTensors.real),this.makeComplexComponentTensorInfo(e,t.complexTensors.imag)];return this.compileAndRun(n,r)},t.prototype.sigmoid=function(e){var t=new sl(e.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(t,[e])},t.prototype.softplus=function(e){var t=new sl(e.shape,"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n");return this.compileAndRun(t,[e])},t.prototype.sin=function(e){var t=new sl(e.shape,bl);return this.compileAndRun(t,[e])},t.prototype.cos=function(e){var t=new sl(e.shape,wl);return this.compileAndRun(t,[e])},t.prototype.tan=function(e){var t=new sl(e.shape,"return tan(x);");return this.compileAndRun(t,[e])},t.prototype.asin=function(e){var t=new sl(e.shape,xl);return this.compileAndRun(t,[e])},t.prototype.acos=function(e){var t=new sl(e.shape,kl);return this.compileAndRun(t,[e])},t.prototype.atan=function(e){var t=new sl(e.shape,_l);return this.compileAndRun(t,[e])},t.prototype.atan2=function(e,t){var n=jn().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Cu("\n  vec4 result = atan(a, b);\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new _u("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return atan(a, b);\n",e.shape,t.shape);return this.compileAndRun(n,[e,t])},t.prototype.sinh=function(e){var t=new sl(e.shape,"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n");return this.compileAndRun(t,[e])},t.prototype.cosh=function(e){var t=new sl(e.shape,"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n");return this.compileAndRun(t,[e])},t.prototype.tanh=function(e){var t=new sl(e.shape,"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n");return this.compileAndRun(t,[e])},t.prototype.asinh=function(e){var t=new sl(e.shape,El);return this.compileAndRun(t,[e])},t.prototype.acosh=function(e){var t=new sl(e.shape,Cl);return this.compileAndRun(t,[e])},t.prototype.atanh=function(e){var t=new sl(e.shape,Sl);return this.compileAndRun(t,[e])},t.prototype.erf=function(e){var t=new sl(e.shape,'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = 0.3275911;\n  float a1 = 0.254829592;\n  float a2 = -0.284496736;\n  float a3 = 1.421413741;\n  float a4 = -1.453152027;\n  float a5 = 1.061405429;\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n');return this.compileAndRun(t,[e])},t.prototype.step=function(e,t){var n=new sl(e.shape,function(e){return void 0===e&&(e=0),ul+"\n    return x > 0.0 ? 1.0 : float("+e+");\n  "}(t));return this.compileAndRun(n,[e])},t.prototype.conv2dByMatMul=function(e,t,n,r,o,i){var a=e.shape,s=this.texData.get(e.dataId),u=n.inChannels,c=a[0]*a[1]*a[2],l=n.outChannels,f="channelsLast"===n.dataFormat,h=(1===c||1===l)&&u>1e3,d=a[2]%2!=0&&!!s.isPacked;if(h||!jn().getBool("WEBGL_LAZILY_UNPACK")||!jn().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!d){var p=f?a[0]*a[1]*a[2]:a[0]*a[2]*a[3],v=this.reshape(e,[1,p,n.inChannels]),m=this.reshape(t,[1,n.inChannels,n.outChannels]);return this.reshape(this.fusedBatchMatMul({a:v,b:m,transposeA:!1,transposeB:!1,bias:r,activation:o,preluActivationWeights:i}),n.outShape)}var g=f?a[0]*a[1]*(a[2]+1):a[0]*a[2]*(a[3]+1),y={dataId:e.dataId,shape:[1,g,n.inChannels],dtype:e.dtype},b=s.shape;s.shape=s.shape.slice(),s.shape[s.shape.length-2]++,Jn(ii(s.shape,y.shape),(function(){return"packed reshape "+s.shape+" to "+y.shape+" isn't free"}));var w=this.reshape(t,[1,n.inChannels,n.outChannels]),x=this.fusedBatchMatMul({a:y,b:w,transposeA:!1,transposeB:!1,bias:r,activation:o,preluActivationWeights:i}),k=this.texData.get(x.dataId);return Jn(k.isPacked,(function(){return"batchMatMul result is expected to be packed"})),s.shape=b,k.shape=n.outShape,fo.makeTensorFromDataId(x.dataId,n.outShape,x.dtype)},t.prototype.conv2dWithIm2Row=function(e,t,n,r,o,i){var a=n.filterWidth,s=n.filterHeight,u=n.inChannels,c=n.outWidth,l=n.outHeight,f="channelsLast"===n.dataFormat,h=a*s*u,d=l*c,p=[h,d],v=e.squeeze([0]),m=t.reshape([1,h,-1]),g=new _c(p,v.shape,n),y=this.compileAndRun(g,[v]).reshape([1,p[0],p[1]]),b=null!=r,w=null!=i,x=o?Pl(o,!0):null,k=new Tc(y.shape,[1,d,n.outChannels],!0,!1,b,x,w),_=[y,m];r&&_.push(r),w&&_.push(i);var E=this.compileAndRun(k,_);return f?E.reshape([1,l,c,n.outChannels]):E.reshape([1,n.outChannels,l,c])},t.prototype.fusedConv2d=function(e){var t=e.input,n=e.filter,r=e.convInfo,o=e.bias,i=e.activation,a=e.preluActivationWeights;if(1===r.filterHeight&&1===r.filterWidth&&1===r.dilationHeight&&1===r.dilationWidth&&1===r.strideHeight&&1===r.strideWidth&&("SAME"===r.padInfo.type||"VALID"===r.padInfo.type))return this.conv2dByMatMul(t,n,r,o,i,a);if(jn().getBool("WEBGL_CONV_IM2COL")&&1===t.shape[0])return this.conv2dWithIm2Row(t,n,r,o,i,a);var s=null!=o,u=null!=a,c=i?Pl(i,!1):null,l=new Bu(r,s,c,u),f=[t,n];return o&&f.push(o),a&&f.push(a),this.compileAndRun(l,f)},t.prototype.conv2d=function(e,t,n){if(1===n.filterHeight&&1===n.filterWidth&&1===n.dilationHeight&&1===n.dilationWidth&&1===n.strideHeight&&1===n.strideWidth&&("SAME"===n.padInfo.type||"VALID"===n.padInfo.type))return this.conv2dByMatMul(e,t,n);if(jn().getBool("WEBGL_CONV_IM2COL")&&1===e.shape[0])return this.conv2dWithIm2Row(e,t,n);var r=new Bu(n);return this.compileAndRun(r,[e,t])},t.prototype.conv2dDerInput=function(e,t,n){var r=new Du(n);return this.compileAndRun(r,[e,t])},t.prototype.conv2dDerFilter=function(e,t,n){var r=new Ou(n);return this.compileAndRun(r,[e,t])},t.prototype.fusedDepthwiseConv2D=function(e){var t,n=e.input,r=e.filter,o=e.convInfo,i=e.bias,a=e.activation,s=e.preluActivationWeights,u=jn().getBool("WEBGL_PACK_DEPTHWISECONV")&&o.strideWidth<=2&&o.outChannels/o.inChannels==1,c=a?Pl(a,u):null,l=[n,r],f=null!=i,h=null!=s;return f&&l.push(i),h&&l.push(s),u?(t=new Zu(o,f,c,h),this.compileAndRun(t,l)):(t=new ju(o,f,c,h),this.compileAndRun(t,l))},t.prototype.depthwiseConv2D=function(e,t,n){var r;return jn().getBool("WEBGL_PACK_DEPTHWISECONV")&&n.strideWidth<=2&&n.outChannels/n.inChannels==1?(r=new Zu(n),this.compileAndRun(r,[e,t])):(r=new ju(n),this.compileAndRun(r,[e,t]))},t.prototype.depthwiseConv2DDerInput=function(e,t,n){var r=new Lu(n);return this.compileAndRun(r,[e,t])},t.prototype.depthwiseConv2DDerFilter=function(e,t,n){var r=new Fu(n);return this.compileAndRun(r,[e,t])},t.prototype.conv3d=function(e,t,n){var r=new Uu(n);return this.compileAndRun(r,[e,t])},t.prototype.conv3dDerInput=function(e,t,n){var r=new Mu(n);return this.compileAndRun(r,[e,t])},t.prototype.conv3dDerFilter=function(e,t,n){var r=new Pu(n);return this.compileAndRun(r,[e,t])},t.prototype.maxPool=function(e,t){var n=new Mc(t,"max",!1);return this.compileAndRun(n,[e])},t.prototype.avgPool=function(e,t){var n=new Mc(t,"avg",!1);return this.compileAndRun(n,[e],"float32")},t.prototype.maxPoolBackprop=function(e,t,n,r){var o=new Mc(r,"max",!0),i=this.compileAndRun(o,[t]),a=new Ic(r),s=this.compileAndRun(a,[e,i],t.dtype);return i.dispose(),s},t.prototype.avgPoolBackprop=function(e,t,n){var r=new pu(n);return this.compileAndRun(r,[e],t.dtype)},t.prototype.cast=function(e,t){return Is(e,t,this)},t.prototype.unstack=function(e,t){for(var n=e.shape[t],r=new Array(e.rank-1),o=0,i=0;i<e.rank;i++)i!==t&&(r[o++]=e.shape[i]);var a=new Array(e.rank).fill(0),s=e.shape.slice();s[t]=1;var u=new Array(n);for(i=0;i<u.length;i++)a[t]=i,u[i]=this.slice(e,a,s).reshape(r);return u},t.prototype.avgPool3d=function(e,t){var n=new Fc(t,"avg",!1);return this.compileAndRun(n,[e],"float32")},t.prototype.avgPool3dBackprop=function(e,t,n){var r=new vu(n);return this.compileAndRun(r,[e],t.dtype)},t.prototype.maxPool3d=function(e,t){var n=new Fc(t,"max",!1);return this.compileAndRun(n,[e],"float32")},t.prototype.maxPool3dBackprop=function(e,t,n,r){var o=new Fc(r,"max",!0),i=this.compileAndRun(o,[t]),a=new Rc(r),s=this.compileAndRun(a,[e,i],t.dtype);return i.dispose(),s},t.prototype.reshape=function(e,t){var n=this.texData.get(e.dataId);if(n.isPacked&&!ii(e.shape,t)&&(null===n.texture||!ii(n.shape,t))){var r=this.packedReshape(e,t);return fo.makeTensorFromDataId(r.dataId,r.shape,r.dtype)}return Rs(e,t)},t.prototype.resizeBilinear=function(e,t,n,r){var o=jn().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Zc(e.shape,t,n,r):new jc(e.shape,t,n,r);return this.compileAndRun(o,[e],"float32")},t.prototype.resizeBilinearBackprop=function(e,t,n){var r=new Uc(e,t,n);return this.compileAndRun(r,[e])},t.prototype.resizeNearestNeighbor=function(e,t,n,r){var o=new zc(e.shape,t,n,r);return this.compileAndRun(o,[e])},t.prototype.resizeNearestNeighborBackprop=function(e,t,n){var r=new Wc(e,t,n);return this.compileAndRun(r,[e])},t.prototype.multinomial=function(e,t,n,r){var o=t?e:ss(e),i=o.shape[0],a=o.shape[1],s=new Ac(i,a,n),u=s.getCustomSetupFunc(r);return this.compileAndRun(s,[o],"int32",u)},t.prototype.oneHot=function(e,t,n,r){var o=new Nc(e.size,t,n,r);return this.compileAndRun(o,[e])},t.prototype.diag=function(e){var t=new Ku(e.size);return this.compileAndRun(t,[e])},t.prototype.nonMaxSuppression=function(e,t,n,r,o){return wi("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),Fs(e.dataSync(),t.dataSync(),n,r,o)},t.prototype.cropAndResize=function(e,t,n,r,o,i){var a=new Wu(e.shape,t.shape,r,o,i);return this.compileAndRun(a,[e,t,n],"float32")},t.prototype.depthToSpace=function(e,t,n){Jn(t>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: "+t}));var r=e.shape[0],o="NHWC"===n?e.shape[1]:e.shape[2],i="NHWC"===n?e.shape[2]:e.shape[3],a="NHWC"===n?e.shape[3]:e.shape[1],s=o*t,u=i*t,c=a/(t*t),l=new Gu("NHWC"===n?[r,s,u,c]:[r,c,s,u],t,n);return this.compileAndRun(l,[e])},t.prototype.split=function(e,t,n){return Ws(e,t,n)},t.prototype.scatterND=function(e,t,n){var r=Qa(0,e,n),o=r.sliceRank,i=r.numUpdates,a=r.sliceSize,s=r.strides,u=r.outputSize,c=[u/a,a],l=e.reshape([i,o]),f=t.reshape([i,a]);if(0===u)return Rs(Ui([]),n);var h=Zi(0),d=new qc(i,o,l.rank,f.rank,s,c);return this.compileAndRun(d,[f,l,h]).reshape(n)},t.prototype.sparseToDense=function(e,t,n,r){var o=Qa(0,e,n),i=o.sliceRank,a=o.numUpdates,s=o.strides,u=o.outputSize,c=new qc(a,i,e.rank,t.rank,s,[u,1],!1);return this.compileAndRun(c,[t,e,r]).reshape(n)},t.prototype.fft=function(e){return this.fftImpl(e,!1)},t.prototype.ifft=function(e){return this.fftImpl(e,!0)},t.prototype.fftImpl=function(e,t){var n=this.texData.get(e.dataId),r=new Ju("return real * expR - imag * expI;",e.shape,t),o=new Ju("return real * expI + imag * expR;",e.shape,t),i=[this.makeComplexComponentTensorInfo(e,n.complexTensors.real),this.makeComplexComponentTensorInfo(e,n.complexTensors.imag)],a=this.compileAndRun(r,i),s=this.compileAndRun(o,i),u=this.complex(a,s).as2D(e.shape[0],e.shape[1]);return a.dispose(),s.dispose(),u},t.prototype.gatherND=function(e,t){var n=t.shape,r=n[n.length-1],o=Ka(e,t),i=o[0],a=o[1],s=o[2],u=o[3],c=t.reshape([a,r]),l=e.reshape([e.size/s,s]),f=new nc(r,u,[a,s]);return this.compileAndRun(f,[l,c]).reshape(i)},t.prototype.fill=function(e,t,n){if("string"===(n=n||Er(t))){var r=pr(n,rr(e));return r.fill(t),fo.makeTensor(r,e,n,this)}var o=new ec(e,t),i=o.getCustomSetupFunc(t);return this.compileAndRun(o,[],n,i)},t.prototype.onesLike=function(e){if("string"===e.dtype)throw new Error("onesLike is not supported under string dtype");return this.fill(e.shape,1,e.dtype)},t.prototype.zerosLike=function(e){return this.fill(e.shape,"string"===e.dtype?"":0,e.dtype)},t.prototype.linspace=function(e,t,n){return Ts(e,t,n)},t.prototype.makeTensorInfo=function(e,t){var n=this.write(null,e,t);return this.texData.get(n).usage=null,{dataId:n,shape:e,dtype:t}},t.prototype.makeOutput=function(e,t){var n=this.makeTensorInfo(e,t).dataId;return fo.makeTensorFromDataId(n,e,t,this)},t.prototype.unpackTensor=function(e){var t=new Ol(e.shape);return this.runWebGLProgram(t,[e],e.dtype)},t.prototype.packTensor=function(e){var t=new Oc(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)},t.prototype.packedReshape=function(e,t){var n=[ei(e.shape)].concat(ti(e.shape)),r={dtype:e.dtype,shape:n,dataId:e.dataId},o=[ei(t)].concat(ti(t)),i=new Bc(o,n),a=this.runWebGLProgram(i,[r],e.dtype,null,!0);return{dataId:a.dataId,shape:t,dtype:a.dtype}},t.prototype.decode=function(e){var t,n=this.texData.get(e),r=n.isPacked,o=n.shape,i=n.dtype,a=ni(o);return t=r?new qu(a):new Hu(a),{dtype:i,shape:o,dataId:this.runWebGLProgram(t,[{shape:a,dtype:i,dataId:e}],i,null,!0).dataId}},t.prototype.runWebGLProgram=function(e,t,n,r,o){var i=this;void 0===o&&(o=!1);var a=this.makeTensorInfo(e.outputShape,n),s=this.texData.get(a.dataId);if(e.packedOutput&&(s.isPacked=!0),e.outPackingScheme===vo.DENSE){var u=_o(e.outputShape);s.texShape=u.map((function(e){return 2*e}))}if(null!=e.outTexUsage&&(s.usage=e.outTexUsage),0===rr(a.shape))return s.values=dr(a.dtype,0),a;var c=[],l=t.map((function(t){if("complex64"===t.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var n=i.texData.get(t.dataId);if(null==n.texture){if(!e.packedInputs&&rr(t.shape)<=jn().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:t.shape,texData:null,isUniform:!0,uniformValues:n.values};e.packedInputs&&(n.isPacked=!0,n.shape=t.shape)}else if(!!n.isPacked!=!!e.packedInputs)t=n.isPacked?i.unpackTensor(t):i.packTensor(t),c.push(t),n=i.texData.get(t.dataId);else if(n.isPacked&&!ii(n.shape,t.shape)){var r=t,o=t.shape;t.shape=n.shape,t=i.packedReshape(t,o),c.push(t),n=i.texData.get(t.dataId),r.shape=o}return i.uploadToGPU(t.dataId),{shape:t.shape,texData:n,isUniform:!1}}));this.uploadToGPU(a.dataId);var f,h={shape:a.shape,texData:s,isUniform:!1},d=function(e,t,n){var r="";t.concat(n).forEach((function(e){var t=null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0,n=e.isUniform?"uniform":e.texData.texShape;r+=e.shape+"_"+n+"_"+t}));var o=e.userCode;return e.constructor.name+"_"+r+"_"+o}(e,l,h),p=this.getAndSaveBinary(d,(function(){return function(e,t,n,r){var o=t.userCode,i=n.map((function(e,n){var r={logicalShape:e.shape,texShape:e.isUniform?null:e.texData.texShape,isUniform:e.isUniform,isPacked:!e.isUniform&&e.texData.isPacked,flatOffset:null};return null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0&&(r.flatOffset=e.texData.slice.flatOffset),{name:t.variableNames[n],shapeInfo:r}})),a=i.map((function(e){return e.shapeInfo})),s={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},u=tu(i,s,o,t.packedInputs),c=e.createProgram(u),l=null,f=e.getUniformLocation(c,"NAN",!1);1===jn().getNumber("WEBGL_VERSION")&&(l=e.getUniformLocation(c,"INFINITY",!1));for(var h={},d=0;d<t.variableNames.length;d++){var p=t.variableNames[d];h[p]=e.getUniformLocation(c,p,!1),h["offset"+p]=e.getUniformLocation(c,"offset"+p,!1)}return{program:t,source:u,webGLProgram:c,uniformLocations:h,inShapeInfos:a,outShapeInfo:s,infLoc:l,nanLoc:f}}(i.gpgpu,e,l,h)})),v=null!=this.activeTimers;if(v&&(f=this.startTimer()),function(e,t,n,r,o){kc(t.inShapeInfos,n),kc([t.outShapeInfo],[r]);var i=r.texData.texture,a=r.texData.texShape;r.texData.isPacked?e.setOutputPackedMatrixTexture(i,a[0],a[1]):e.setOutputMatrixTexture(i,a[0],a[1]),e.setProgram(t.webGLProgram),1===jn().getNumber("WEBGL_VERSION")&&null!==t.infLoc&&e.gl.uniform1f(t.infLoc,1/0),null!==t.nanLoc&&e.gl.uniform1f(t.nanLoc,NaN),n.forEach((function(n,r){var o=t.program.variableNames[r],i=t.uniformLocations[o],a=t.uniformLocations["offset"+o];if(null!=i)if(n.isUniform)if(rr(n.shape)<2)e.gl.uniform1f(i,n.uniformValues[0]);else{var s=n.uniformValues;s instanceof Float32Array||(s=new Float32Array(s)),e.gl.uniform1fv(i,s)}else null!=n.texData.slice&&null!=a&&e.gl.uniform1i(a,n.texData.slice.flatOffset),e.setInputMatrixTexture(n.texData.texture,i,r)})),null!=o&&o(e,t.webGLProgram),e.executeProgram()}(this.gpgpu,p,l,h,r),c.forEach((function(e){return i.disposeData(e.dataId)})),v&&(f=this.endTimer(f),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(f)})),!jn().getBool("WEBGL_LAZILY_UNPACK")&&s.isPacked&&!1===o){var m=this.unpackTensor(a);return this.disposeData(a.dataId),m}return a},t.prototype.compileAndRun=function(e,t,n,r,o){void 0===o&&(o=!1),n=n||t[0].dtype;var i=this.runWebGLProgram(e,t,n,r,o);return fo.makeTensorFromDataId(i.dataId,i.shape,i.dtype)},t.prototype.getAndSaveBinary=function(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]},t.prototype.getTextureManager=function(){return this.textureManager},t.prototype.dispose=function(){var e=this;this.disposed||(jn().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach((function(t){e.gpgpu.deleteProgram(e.binaryCache[t].webGLProgram),delete e.binaryCache[t]})),this.textureManager.dispose(),null!=this.canvas&&"undefined"!=typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},t.prototype.floatPrecision=function(){var e=this;return null==this.floatPrecisionValue&&(this.floatPrecisionValue=yi((function(){if(!jn().get("WEBGL_RENDER_FLOAT32_ENABLED")){var t=jn().getBool("DEBUG");jn().set("DEBUG",!1);var n=e.abs(Zi(1e-8)).dataSync()[0];if(jn().set("DEBUG",t),n>0)return 32}return 16}))),this.floatPrecisionValue},t.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},t.prototype.uploadToGPU=function(e){var t,n=this.texData.get(e),r=n.shape,o=n.dtype,i=n.values,a=n.texture,s=n.usage,u=n.isPacked;if(null==a){var c,l=null!=this.activeTimers;l&&(c=Or());var f=n.texShape;if(null==f&&(f=ri(r,u),n.texShape=f),null!=i){var h=ni(r),d=void 0,p=f[1],v=f[0],m=i instanceof Uint8Array;u?(p=(t=Eo(f[0],f[1]))[0],v=t[1],d=new Qu(h,[v,p],m)):d=new Yu(h,[v,p],m);var g=this.makeTensorInfo([v,p],o);this.texData.get(g.dataId).usage=m?mo.PIXELS:mo.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(g.dataId),p,v,i);var y=this.runWebGLProgram(d,[g],o,null,!0),b=this.texData.get(y.dataId);n.texture=b.texture,n.texShape=b.texShape,n.isPacked=b.isPacked,n.usage=b.usage,this.disposeData(g.dataId),this.texData.delete(y.dataId),n.values=null,l&&(this.uploadWaitMs+=Or()-c)}else{var w=this.acquireTexture(f,s,o,u);n.texture=w}}},t.prototype.convertAndCacheOnCPU=function(e,t){var n=this.texData.get(e),r=n.dtype;return this.releaseGPUData(e),null!=t&&(n.values=function(e,t){if("float32"===t||"complex64"===t)return e;if("int32"===t||"bool"===t){for(var n="int32"===t?new Int32Array(e.length):new Uint8Array(e.length),r=0;r<n.length;++r)n[r]=Math.round(e[r]);return n}throw new Error("Unknown dtype "+t)}(t,r)),n.values},t.prototype.acquireTexture=function(e,t,n,r){if(this.numBytesInGPU+=this.computeBytes(e,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var o=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+o+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(e,t,r)},t.prototype.computeBytes=function(e,t){return e[0]*e[1]*br(t)},t}(ls);ho()&&fo.registerBackend("webgl",(function(){return new Ml}),2);var Fl=Mi({square_:function(e){var t=_i(e,"x","square"),n=[t];return fo.runKernelFunc((function(e,n){return n([t]),e.square(t)}),{x:t},null,"Square",{},n,[])}}),Ll="SquaredDifference",Bl=Mi({squaredDifference_:function(e,t){var n,r=_i(e,"a","squaredDifference"),o=_i(t,"b","squaredDifference");n=io(r,o),r=n[0],o=n[1],ps(r.shape,o.shape);var i={a:r,b:o},a=[r,o];return fo.runKernelFunc((function(e,t){var n=e.squaredDifference(r,o);return t([r,o]),n}),i,(function(e,t){var n=t[0],r=t[1],o=Zi(2);return{a:function(){return e.mul(n.sub(r).mul(o))},b:function(){return e.mul(r.sub(n).mul(o))}}}),Ll,{},a,[])}}),Ul=Mi({abs_:function(e){var t=_i(e,"x","abs");return"complex64"===t.dtype?fo.runKernelFunc((function(e){return e.complexAbs(t)}),{$x:t}):fo.runKernelFunc((function(e,n){var r=e.abs(t);return n([t]),r}),{x:t},(function(e,t){var n=t[0];return{x:function(){return e.mul(n.toFloat().step(-1))}}}),"Abs")}}),jl=Mi({acos_:function(e){var t=_i(e,"x","acos");return fo.runKernelFunc((function(e,n){var r=e.acos(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.divStrict(Zi(1).sub(n.toFloat().square()).sqrt()).neg()}}}))}}),Zl=Mi({acosh_:function(e){var t=_i(e,"x","acosh");return fo.runKernelFunc((function(e,n){var r=e.acosh(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.divStrict(n.toFloat().square().sub(1).sqrt())}}}))}}),Wl=Mi({asin_:function(e){var t=_i(e,"x","asin");return fo.runKernelFunc((function(e,n){var r=e.asin(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.divStrict(Zi(1).sub(n.toFloat().square()).sqrt())}}}))}}),zl=Mi({asinh_:function(e){var t=_i(e,"x","asinh");return fo.runKernelFunc((function(e,n){var r=e.asinh(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.divStrict(Zi(1).add(n.toFloat().square()).sqrt())}}}))}}),Vl=Mi({atan_:function(e){var t=_i(e,"x","atan");return fo.runKernelFunc((function(e,n){var r=e.atan(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.div(n.toFloat().square().add(1))}}}))}}),Hl=Mi({atanh_:function(e){var t=_i(e,"x","atanh");return fo.runKernelFunc((function(e,n){var r=e.atanh(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.div(Zi(1).sub(n.toFloat().square()))}}}))}}),ql=Mi({ceil_:function(e){var t=_i(e,"x","ceil");return fo.runKernelFunc((function(e){return e.ceil(t)}),{$x:t},(function(e){return{$x:function(){return Yi(e)}}}))}}),Gl=Mi({clipByValue_:function(e,t,n){var r=_i(e,"x","clipByValue");Jn(t<=n,(function(){return"Error in clip: min ("+t+") must be less than or equal to max ("+n+")."}));var o=[r],i={min:t,max:n};return fo.runKernelFunc((function(e,o){var i=e.clip(r,t,n);return o([r]),i}),{x:r},(function(e,r){var o=r[0];return{x:function(){return e.where(o.greaterEqual(t).logicalAnd(o.lessEqual(n)),Yi(e))}}}),"ClipByValue",i,o)}}),Kl=Mi({cos_:function(e){var t=_i(e,"x","cos"),n=[t];return fo.runKernelFunc((function(e,n){var r=e.cos(t);return n([t]),r}),{x:t},(function(e,t){var n=t[0];return{x:function(){return n.toFloat().sin().neg().mul(e)}}}),"Cos",{},n)}}),Xl=Mi({cosh_:function(e){var t=_i(e,"x","cosh");return fo.runKernelFunc((function(e,n){var r=e.cosh(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return n.toFloat().sinh().mulStrict(e)}}}))}}),$l=Mi({erf_:function(e){var t=_i(e,"x","erf");return Jn("int32"===t.dtype||"float32"===t.dtype,(function(){return"Input dtype must be `int32` or `float32`."})),"int32"===t.dtype&&(t=t.toFloat()),fo.runKernelFunc((function(e,n){var r=e.erf(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.mul(n.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}}))}}),Yl=Mi({exp_:function(e){var t=_i(e,"x","exp");return fo.runKernelFunc((function(e,n){var r=e.exp(t);return n([r]),r}),{x:t},(function(e,t){return{x:function(){return e.mulStrict(t[0])}}}),"Exp",{},[],[!0])}}),Ql=Mi({expm1_:function(e){var t=_i(e,"x","expm1");return fo.runKernelFunc((function(e,n){var r=e.expm1(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.mul(n.exp())}}}))}}),Jl=Mi({floor_:function(e){var t=_i(e,"x","floor");return fo.runKernelFunc((function(e){return e.floor(t)}),{$x:t},(function(e){return{$x:function(){return Yi(e)}}}))}}),ef=Mi({log_:function(e){var t=_i(e,"x","log"),n=[t];return fo.runKernelFunc((function(e,n){var r=e.log(t);return n([t]),r}),{x:t},(function(e,t){var n=t[0];return{x:function(){return e.div(n.toFloat())}}}),"Log",{},n)}}),tf=Mi({log1p_:function(e){var t=_i(e,"x","log1p");return fo.runKernelFunc((function(e,n){var r=e.log1p(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.div(n.add(1))}}}))}}),nf=Mi({logSigmoid_:function(e){var t=_i(e,"x","logSigmoid");return fo.runKernelFunc((function(e,n){var r=e.softplus(t.neg()).neg();return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.mul(n.neg().sigmoid())}}}))}}),rf=Mi({neg_:function(e){var t=_i(e,"x","neg"),n=[t];return fo.runKernelFunc((function(e){return e.neg(t)}),{x:t},(function(e){return{x:function(){return e.neg()}}}),"Neg",{},n)}}),of=Mi({reciprocal_:function(e){var t=_i(e,"x","reciprocal");return fo.runKernelFunc((function(e,n){var r=e.reciprocal(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.div(n.square().neg())}}}))}}),af=Mi({round_:function(e){var t=_i(e,"x","round");return fo.runKernelFunc((function(e){return e.round(t)}),{$x:t},(function(e){return{$x:function(){return Yi(e)}}}))}}),sf=Mi({rsqrt_:function(e){var t=_i(e,"x","rsqrt"),n=[t];return fo.runKernelFunc((function(e,n){var r=e.rsqrt(t);return n([t]),r}),{x:t},(function(e,t){var n=t[0];return{x:function(){return e.div(n.pow(1.5).mul(2)).neg()}}}),"Rsqrt",{},n)}}),uf=Mi({sigmoid_:function(e){var t=_i(e,"x","sigmoid");return fo.runKernelFunc((function(e,n){var r=e.sigmoid(t);return n([r]),r}),{x:t},(function(e,t){var n=t[0];return{x:function(){return e.mul(n.mul(Zi(1).sub(n)))}}}),"Sigmoid")}}),cf=Mi({sign_:function(e){var t=_i(e,"x","sign");return fo.runKernelFunc((function(e){return e.sign(t)}),{$x:t},(function(e){return{$x:function(){return Yi(e)}}}))}}),lf=Mi({isNaN_:function(e){var t=_i(e,"x","isNaN");return fo.runKernelFunc((function(e){return e.isNaN(t)}),{$x:t},(function(e){return{$x:function(){return Yi(e)}}}))}}),ff=Mi({isInf_:function(e){var t=_i(e,"x","isInf");return fo.runKernelFunc((function(e){return e.isInf(t)}),{$x:t},(function(e){return{$x:function(){return Yi(e)}}}))}}),hf=Mi({isFinite_:function(e){var t=_i(e,"x","isFinite");return fo.runKernelFunc((function(e){return e.isFinite(t)}),{$x:t},(function(e){return{$x:function(){return Yi(e)}}}))}}),df=Mi({sin_:function(e){var t=_i(e,"x","sin"),n=[t];return fo.runKernelFunc((function(e,n){var r=e.sin(t);return n([t]),r}),{x:t},(function(e,t){var n=t[0];return{x:function(){return n.toFloat().cos().mul(e)}}}),"Sin",{},n)}}),pf=Mi({sinh_:function(e){var t=_i(e,"x","sinh");return fo.runKernelFunc((function(e,n){var r=e.sinh(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return n.toFloat().cosh().mulStrict(e)}}}))}}),vf=Mi({softplus_:function(e){var t=_i(e,"x","softplus");return fo.runKernelFunc((function(e,n){var r=e.softplus(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.mul(n.sigmoid())}}}))}}),mf=Mi({sqrt_:function(e){var t=_i(e,"x","sqrt");return fo.runKernelFunc((function(e,n){var r=e.sqrt(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.div(n.toFloat().sqrt().mul(2))}}}))}}),gf=Mi({step_:function(e,t){void 0===t&&(t=0);var n=_i(e,"x","step");return fo.runKernelFunc((function(e){return e.step(n,t)}),{$x:n},(function(e){return{$x:function(){return Yi(e)}}}))}}),yf=Mi({tan_:function(e){var t=_i(e,"x","tan");return fo.runKernelFunc((function(e,n){var r=e.tan(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.div(n.cos().square())}}}))}}),bf=Mi({tanh_:function(e){var t=_i(e,"x","tanh");return fo.runKernelFunc((function(e,n){var r=e.tanh(t);return n([r]),r}),{x:t},(function(e,t){var n=t[0];return{x:function(){return Zi(1).sub(n.square()).mulStrict(e)}}}),"Tanh",{},null,[!0])}});function wf(e,t,n,r,o,i){var a,s,u=_i(e,"x","batchNorm"),c=_i(t,"mean","batchNorm"),l=_i(n,"variance","batchNorm");return null!=o&&(a=_i(o,"scale","batchNorm")),null!=r&&(s=_i(r,"offset","batchNorm")),Jn(2===u.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."})),Jn(2===c.rank||1===c.rank,(function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+c.rank+"."})),Jn(2===l.rank||1===l.rank,(function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+l.rank+"."})),null!=a&&Jn(2===a.rank||1===a.rank,(function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+a.rank+"."})),null!=s&&Jn(2===s.rank||1===s.rank,(function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+s.rank+"."})),_f(u,c,l,s,a,i)}function xf(e,t,n,r,o,i){var a,s,u=_i(e,"x","batchNorm"),c=_i(t,"mean","batchNorm"),l=_i(n,"variance","batchNorm");return null!=o&&(a=_i(o,"scale","batchNorm")),null!=r&&(s=_i(r,"offset","batchNorm")),Jn(3===u.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."})),Jn(3===c.rank||1===c.rank,(function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+c.rank+"."})),Jn(3===l.rank||1===l.rank,(function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+l.rank+"."})),null!=a&&Jn(3===a.rank||1===a.rank,(function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+a.rank+"."})),null!=s&&Jn(3===s.rank||1===s.rank,(function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+s.rank+"."})),_f(u,c,l,s,a,i)}function kf(e,t,n,r,o,i){var a,s,u=_i(e,"x","batchNorm"),c=_i(t,"mean","batchNorm"),l=_i(n,"variance","batchNorm");return null!=o&&(a=_i(o,"scale","batchNorm")),null!=r&&(s=_i(r,"offset","batchNorm")),Jn(4===u.rank,(function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+u.rank+"."})),Jn(4===c.rank||1===c.rank,(function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+c.rank+"."})),Jn(4===l.rank||1===l.rank,(function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+l.rank+"."})),null!=a&&Jn(4===a.rank||1===a.rank,(function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+a.rank+"."})),null!=s&&Jn(4===s.rank||1===s.rank,(function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+s.rank+"."})),_f(u,c,l,s,a,i)}function _f(e,t,n,r,o,i){null==i&&(i=.001);var a,s,u,c=_i(e,"x","batchNorm"),l=_i(t,"mean","batchNorm"),f=_i(n,"variance","batchNorm");null!=o&&(a=_i(o,"scale","batchNorm")),null!=r&&(s=_i(r,"offset","batchNorm")),Jn(l.rank===f.rank,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),Jn(null==s||l.rank===s.rank,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),Jn(null==a||l.rank===a.rank,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."})),u=0===c.rank||1===c.rank?c.as4D(1,1,1,c.size):2===c.rank?c.as4D(1,1,c.shape[0],c.shape[1]):3===c.rank?c.as4D(1,c.shape[0],c.shape[1],c.shape[2]):c;var h=[c,l,f,a];return fo.runKernelFunc((function(e,t){var n=e.batchNormalization(u,Ef(l),Ef(f),i,Ef(a),Ef(s));return t([c,l,f,a]),n}),{x:c,mean:l,variance:f,scale:a,offset:s},(function(e,t){var n=t,r=n[0],o=n[1],a=n[2],s=n[3],c=null==s?Zi(1):s,l=ds(o.shape,u.shape),f=[];if(1===o.rank){for(var h=0;h<u.shape.length-1;++h)f.push(u.shape[h]);f.push(1)}var d=r.sub(o),p=e.mul(c),v=sf(a.add(Zi(i))),m=v.mul(v).mul(v).mul(Zi(-.5));return{x:function(){return 1===o.rank?e.mul(ja(v.as4D(1,1,1,o.shape[0]),f)).mul(c).reshape(r.shape):e.mul(v).mul(c).reshape(r.shape)},mean:function(){var e=v.mul(Zi(-1)).mul(p);return 1===o.rank&&(e=e.sum(l)),e.reshape(o.shape)},variance:function(){var e=m.mul(d).mul(p);return 1===o.rank&&(e=e.sum(l)),e.reshape(o.shape)},scale:function(){var t=d.mul(v),n=e.mul(t);return 1===o.rank&&(n=n.sum(l)),n.reshape(o.shape)},offset:function(){var t=e;return 1===o.rank&&(t=t.sum(l)),t.reshape(o.shape)}}}),"BatchNormalization",{varianceEpsilon:i},h).reshape(c.shape)}function Ef(e){return null==e?null:0===e.rank?e.as1D():1===e.rank?e:2===e.rank?e.as4D(1,1,e.shape[0],e.shape[1]):3===e.rank?e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):e}function Cf(){gi("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}var Sf=Mi({batchNormalization2d_:function(e,t,n,r,o,i){return void 0===r&&(r=.001),Cf(),wf(e,t,n,i,o,r)}}),If=Mi({batchNormalization3d_:function(e,t,n,r,o,i){return void 0===r&&(r=.001),Cf(),xf(e,t,n,i,o,r)}}),Rf=Mi({batchNormalization4d_:function(e,t,n,r,o,i){return void 0===r&&(r=.001),Cf(),kf(e,t,n,i,o,r)}}),Tf=Mi({batchNormalization_:function(e,t,n,r,o,i){return void 0===r&&(r=.001),Cf(),_f(e,t,n,i,o,r)}}),Af=Mi({batchNorm_:_f}),Nf=Mi({batchNorm2d_:wf}),Of=Mi({batchNorm3d_:xf}),Df=Mi({batchNorm4d_:kf}),Pf=Mi({logicalAnd_:function(e,t){var n=_i(e,"a","logicalAnd","bool"),r=_i(t,"b","logicalAnd","bool");return ps(n.shape,r.shape),fo.runKernelFunc((function(e){return e.logicalAnd(n,r)}),{a:n,b:r},null,"LogicalAnd")}}),Mf=Mi({logicalNot_:function(e){var t=_i(e,"x","logicalNot","bool");return fo.runKernelFunc((function(e){return e.logicalNot(t)}),{$x:t})}}),Ff=Mi({logicalOr_:function(e,t){var n=_i(e,"a","logicalOr","bool"),r=_i(t,"b","logicalOr","bool");return ps(n.shape,r.shape),fo.runKernelFunc((function(e){return e.logicalOr(n,r)}),{$a:n,$b:r})}}),Lf=Mi({logicalXor_:function(e,t){var n=_i(e,"a","logicalXor","bool"),r=_i(t,"b","logicalXor","bool");return ps(n.shape,r.shape),Ff(e,t).logicalAnd(Pf(e,t).logicalNot())}}),Bf=Mi({where_:function(e,t,n){var r=_i(t,"a","where"),o=_i(n,"b","where"),i=_i(e,"condition","where","bool");return er(r.shape,o.shape,"Error in where: "),1===i.rank?Jn(i.shape[0]===r.shape[0],(function(){return"The first dimension of `a` must match the size of `condition`."})):er(i.shape,o.shape,"Error in where: "),fo.runKernelFunc((function(e,t){var n=e.select(i,r,o);return t([i]),n}),{$condition:i,$a:r,$b:o},(function(e,t){var n=t[0];return{$condition:function(){return Yi(n).toFloat()},$a:function(){return e.mul(n.cast(e.dtype))},$b:function(){return e.mul(n.logicalNot().cast(e.dtype))}}}))}}),Uf=function(e){return Ln(this,void 0,void 0,(function(){var t,n,r;return Bn(this,(function(o){switch(o.label){case 0:return[4,(t=_i(e,"condition","whereAsync","bool")).data()];case 1:return n=o.sent(),r=Hs(t.shape,n),e!==t&&t.dispose(),[2,r]}}))}))},jf=Mi({add_:function(e,t){var n,r=_i(e,"a","add"),o=_i(t,"b","add");n=io(r,o),r=n[0],o=n[1];var i=ps(r.shape,o.shape);return fo.runKernelFunc((function(e){return e.add(r,o)}),{a:r,b:o},(function(e){return{a:function(){var t=e,n=ds(r.shape,i);return n.length>0&&(t=t.sum(n)),t.reshape(r.shape)},b:function(){var t=e,n=ds(o.shape,i);return n.length>0&&(t=t.sum(n)),t.reshape(o.shape)}}}),"Add")}}),Zf=Mi({addN_:function(e){Jn(Array.isArray(e),(function(){return"The argument passed to tf.addN() must be a list of tensors"})),Jn(e.length>=1,(function(){return"Must pass at least one tensor to tf.addN(), but got "+e.length}));var t=e.map((function(e,t){return _i(e,"tensors"+t,"addN")})),n=t[0];t.forEach((function(e){if(e.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),t.forEach((function(e){if(!or(e.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}));var r=t;return fo.runKernelFunc((function(e){return e.addN(t)}),r,(function(e){var n={};return t.forEach((function(t,r){n[r]=function(){return e.clone()}})),n}),"AddN")}}),Wf=Mi({addStrict_:function(e,t){var n=_i(e,"a","addStrict"),r=_i(t,"b","addStrict");return er(n.shape,r.shape,"Error in addStrict: "),n.add(r)}}),zf=Mi({atan2_:function(e,t){var n,r=_i(e,"a","atan2"),o=_i(t,"b","atan2");n=io(r,o),r=n[0],o=n[1];var i=ps(r.shape,o.shape);return fo.runKernelFunc((function(e,t){var n=e.atan2(r,o);return t([r,o]),n}),{$a:r,$b:o},(function(e,t){var n=t[0],r=t[1];return{$a:function(){var t=jf(n.square(),r.square()),o=e.mul(r.div(t)),a=ds(n.shape,i);return a.length>0&&(o=o.sum(a)),o.reshape(n.shape)},$b:function(){var t=jf(n.square(),r.square()),o=rf(e.mul(n.div(t))),a=ds(r.shape,i);return a.length>0&&(o=o.sum(a)),o.reshape(r.shape)}}}))}}),Vf=Mi({div_:function(e,t){var n,r=_i(e,"a","div"),o=_i(t,"b","div");if(n=io(r,o),r=n[0],o=n[1],"int32"===r.dtype&&"int32"===o.dtype)return Gf(r,o);var i=ps(r.shape,o.shape);return fo.runKernelFunc((function(e,t){var n=e.realDivide(r,o);return t([r,o]),n}),{a:r,b:o},(function(e,t){var n=t[0],r=t[1];return{a:function(){var t=e.div(r.toFloat()),o=ds(n.shape,i);return o.length>0?t.sum(o).reshape(n.shape):t},b:function(){var t=e.mul(n.toFloat()),o=ds(r.shape,i);o.length>0&&(t=t.sum(o).reshape(r.shape));var a=r.square();return t.div(a.toFloat()).neg()}}}),"Div")}}),Hf=Mi({divNoNan_:function(e,t){var n,r=_i(e,"a","div"),o=_i(t,"b","div");r=(n=io(r,o))[0],o=n[1];var i=Vf(r,o),a=Yi(i),s=o.equal(a);return Bf(s,a,i)}}),qf=Mi({divStrict_:function(e,t){var n=_i(e,"a","div"),r=_i(t,"b","div");return er(n.shape,r.shape,"Error in divideStrict: "),n.div(r)}}),Gf=Mi({floorDiv_:function(e,t){var n,r=_i(e,"a","floorDiv"),o=_i(t,"b","floorDiv");n=io(r,o),r=n[0],o=n[1];var i=ps(r.shape,o.shape);return fo.runKernelFunc((function(e,t){var n=e.floorDiv(r,o);return t([r,o]),n}),{a:r,b:o},(function(e,t){var n=t[0],r=t[1];return{a:function(){var t=e.div(r.toFloat()),o=ds(n.shape,i);return o.length>0?t.sum(o).reshape(n.shape):t},b:function(){var t=e.mul(n.toFloat()),o=ds(r.shape,i);o.length>0&&(t=t.sum(o).reshape(r.shape));var a=r.square();return t.div(a.toFloat()).neg()}}}),"FloorDiv")}}),Kf=Mi({maximum_:function(e,t){var n,r=_i(e,"a","maximum"),o=_i(t,"b","maximum");return n=io(r,o),r=n[0],o=n[1],"bool"===r.dtype&&(r=r.toInt(),o=o.toInt()),ps(r.shape,o.shape),fo.runKernelFunc((function(e,t){var n=e.maximum(r,o);return t([r,o]),n}),{a:r,b:o},(function(e,t){var n=t[0],r=t[1];return{a:function(){return e.mul(n.greaterEqual(r).toFloat())},b:function(){return e.mul(n.less(r).toFloat())}}}),"Maximum")}}),Xf=Mi({maximumStrict_:function(e,t){var n=_i(e,"a","maximumStrict"),r=_i(t,"b","maximumStrict");return er(n.shape,r.shape,"Error in maximumStrict: "),n.maximum(r)}}),$f=Mi({minimum_:function(e,t){var n,r=_i(e,"a","minimum"),o=_i(t,"b","minimum");return n=io(r,o),r=n[0],o=n[1],"bool"===r.dtype&&(r=r.toInt(),o=o.toInt()),ps(r.shape,o.shape),fo.runKernelFunc((function(e,t){var n=e.minimum(r,o);return t([r,o]),n}),{a:r,b:o},(function(e,t){var n=t[0],r=t[1];return{a:function(){return e.mul(n.lessEqual(r).toFloat())},b:function(){return e.mul(n.greater(r).toFloat())}}}),"Minimum")}}),Yf=Mi({minimumStrict_:function(e,t){var n=_i(e,"a","minimumStrict"),r=_i(t,"b","minimumStrict");return er(n.shape,r.shape,"Error in minimumStrict: "),n.minimum(r)}}),Qf=Mi({mod_:function(e,t){var n,r=_i(e,"a","mod"),o=_i(t,"b","mod");n=io(r,o),r=n[0],o=n[1];var i=ps(r.shape,o.shape);return fo.runKernelFunc((function(e,t){var n=e.mod(r,o);return t([r,o]),n}),{$a:r,$b:o},(function(e,t){var n=t[0],r=t[1];return{$a:function(){var t=ds(n.shape,i);return t.length>0?e.sum(t).reshape(n.shape):e},$b:function(){var t=e.mul(n.div(r).floor().neg()),o=ds(r.shape,i);return o.length>0?t.sum(o).reshape(r.shape):t}}}))}}),Jf=Mi({modStrict_:function(e,t){var n=_i(e,"a","modStrict"),r=_i(t,"b","modStrict");return er(n.shape,r.shape,"Error in modStrict: "),n.mod(r)}}),eh=Mi({mul_:function(e,t){var n,r=_i(e,"a","mul"),o=_i(t,"b","mul");n=io(r,o),r=n[0],o=n[1];var i=ps(r.shape,o.shape);return fo.runKernelFunc((function(e,t){var n=e.multiply(r,o);return t([r,o]),n}),{a:r,b:o},(function(e,t){var n=t[0],r=t[1];return{a:function(){var t=e.mul(r.toFloat()),o=ds(n.shape,i);return o.length>0?t.sum(o).reshape(n.shape):t},b:function(){var t=e.mul(n.toFloat()),o=ds(r.shape,i);return o.length>0?t.sum(o).reshape(r.shape):t}}}),"Mul")}}),th=Mi({mulStrict_:function(e,t){var n=_i(e,"a","mul"),r=_i(t,"b","mul");return er(n.shape,r.shape,"Error in multiplyStrict: "),n.mul(r)}}),nh=Mi({pow_:function(e,t){var n,r=_i(e,"base","pow"),o=_i(t,"exp","pow");n=io(r,o),r=n[0],o=n[1];var i=ps(r.shape,o.shape),a=[r,o];return fo.runKernelFunc((function(e,t){var n=e.pow(r,o);return t([r,o,n]),n}),{a:r,b:o},(function(e,t){var n=t[0],r=t[1],o=t[2];return{a:function(){var t=r.toFloat(),o=e.mul(t.mul(n.pow(t.sub(Zi(1))))),a=ds(n.shape,i);return a.length>0&&(o=o.sum(a)),o.reshape(n.shape)},b:function(){var t=n.greater(0),a=n.log().where(t,Yi(n)),s=e.mul(o.mul(a)),u=ds(r.shape,i);return u.length>0&&(s=s.sum(u)),s.reshape(r.shape)}}}),"Pow",{},a,[!0])}}),rh=Mi({powStrict_:function(e,t){return er(e.shape,t.shape,"Error in powStrict: "),e.pow(t)}}),oh=Mi({squaredDifferenceStrict_:function(e,t){var n=_i(e,"a","squaredDifferenceStrict"),r=_i(t,"b","squaredDifferenceStrict");return er(n.shape,r.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(r)}}),ih=Mi({sub_:function(e,t){var n,r=_i(e,"a","sub"),o=_i(t,"b","sub");n=io(r,o),r=n[0],o=n[1];var i=ps(r.shape,o.shape);return fo.runKernelFunc((function(e){return e.subtract(r,o)}),{a:r,b:o},(function(e){return{a:function(){var t=e,n=ds(r.shape,i);return n.length>0&&(t=t.sum(n)),t.reshape(r.shape)},b:function(){var t=e,n=ds(o.shape,i);return n.length>0&&(t=t.sum(n)),t.neg().reshape(o.shape)}}}),"Sub")}}),ah=Mi({subStrict_:function(e,t){var n=_i(e,"a","subStrict"),r=_i(t,"b","subStrict");return er(n.shape,r.shape,"Error in subStrict: "),n.sub(r)}}),sh=Mi({equal_:function(e,t){var n,r=_i(e,"a","equal"),o=_i(t,"b","equal");return n=io(r,o),r=n[0],o=n[1],ps(r.shape,o.shape),fo.runKernelFunc((function(e){return e.equal(r,o)}),{$a:r,$b:o})}}),uh=Mi({equalStrict_:function(e,t){var n=_i(e,"a","equalStrict"),r=_i(t,"b","equalStrict");return er(n.shape,r.shape,"Error in equalStrict: "),n.equal(r)}}),ch=Mi({greater_:function(e,t){var n,r=_i(e,"a","greater"),o=_i(t,"b","greater");return n=io(r,o),r=n[0],o=n[1],ps(r.shape,o.shape),fo.runKernelFunc((function(e){return e.greater(r,o)}),{a:r,b:o},null,"Greater")}}),lh=Mi({greaterEqual_:function(e,t){var n,r=_i(e,"a","greaterEqual"),o=_i(t,"b","greaterEqual");return n=io(r,o),r=n[0],o=n[1],ps(r.shape,o.shape),fo.runKernelFunc((function(e,t){var n=e.greaterEqual(r,o);return t([r,o]),n}),{a:r,b:o},(function(e,t){var n=t[0],r=t[1];return{a:function(){return Yi(n)},b:function(){return Yi(r)}}}),"GreaterEqual")}}),fh=Mi({greaterEqualStrict_:function(e,t){var n=_i(e,"a","greaterEqualStrict"),r=_i(t,"b","greaterEqualStrict");return er(n.shape,r.shape,"Error in greaterEqualStrict: "),n.greaterEqual(r)}}),hh=Mi({greaterStrict_:function(e,t){var n=_i(e,"a","greaterStrict"),r=_i(t,"b","greaterStrict");return er(n.shape,r.shape,"Error in greaterStrict: "),n.greater(r)}}),dh=Mi({less_:function(e,t){var n,r=_i(e,"a","less"),o=_i(t,"b","less");return n=io(r,o),r=n[0],o=n[1],ps(r.shape,o.shape),fo.runKernelFunc((function(e){return e.less(r,o)}),{a:r,b:o},null,"Less")}}),ph=Mi({lessEqual_:function(e,t){var n,r=_i(e,"a","lessEqual"),o=_i(t,"b","lessEqual");return n=io(r,o),r=n[0],o=n[1],ps(r.shape,o.shape),fo.runKernelFunc((function(e,t){var n=e.lessEqual(r,o);return t([r,o]),n}),{a:r,b:o},null,"LessEqual")}}),vh=Mi({lessEqualStrict_:function(e,t){var n=_i(e,"a","lessEqualStrict"),r=_i(t,"b","lessEqualStrict");return er(n.shape,r.shape,"Error in lessEqualStrict: "),n.lessEqual(r)}}),mh=Mi({lessStrict_:function(e,t){var n=_i(e,"a","lessStrict"),r=_i(t,"b","lessStrict");return er(n.shape,r.shape,"Error in lessStrict: "),n.less(r)}}),gh=Mi({notEqual_:function(e,t){var n,r=_i(e,"a","notEqual"),o=_i(t,"b","notEqual");return n=io(r,o),r=n[0],o=n[1],ps(r.shape,o.shape),fo.runKernelFunc((function(e){return e.notEqual(r,o)}),{a:r,b:o},null,"NotEqual")}}),yh=Mi({notEqualStrict_:function(e,t){var n=_i(e,"a","notEqualStrict"),r=_i(t,"b","notEqualStrict");return er(n.shape,r.shape,"Error in notEqualStrict: "),n.notEqual(r)}});function bh(e,t){for(var n=[],r=e;r<t;++r)n.push(r);return n}function wh(e){for(var t=[],n=0;n<e.length;++n)for(var r=0;r<e[n].length;++r)t.push(e[n][r]);return t}var xh=Mi({gather_:function(e,t,n){void 0===n&&(n=0);var r=_i(e,"x","gather"),o=_i(t,"indices","gather","int32");n=fr(n,r.shape)[0];var i=function(e,t,n){for(var r=e.shape[n],o=[],i=1,a=1,s=0;s<n;s++)o.push(e.shape[s]),i*=e.shape[s];for(s=0;s<t.rank;s++)o.push(t.shape[s]);for(s=n+1;s<e.rank;s++)o.push(e.shape[s]),a*=e.shape[s];return{batchSize:i,sliceSize:a,dimSize:r,outputShape:o}}(r,o,n);return fo.runKernelFunc((function(e,t){var i=e.gather(r,o.flatten(),n);return t([o]),i}),{x:r,indices:o},(function(e,t){var o=t[0];return{x:function(){var t=r.shape,i=o.size,a=t.slice(0,n),s=a.length,u=t.slice(n,t.length).slice(1),c=u.length,l=bh(0,s),f=bh(s+1,s+1+c),h=wh([a,[i],u]),d=e.reshape(h),p=o.reshape([i]),v=wh([[s],l,f]),m=d.transpose(v),g=kh(m,p,r.shape[n]),y=Ni(v);return g.transpose(y)},indices:function(){return o}}}),"Gather",{axis:n}).reshape(i.outputShape)}}),kh=Mi({unsortedSegmentSum_:function(e,t,n){var r=_i(e,"x","unsortedSegmentSum"),o=_i(t,"segmentIds","unsortedSegmentSum","int32");return Jn(ir(n),(function(){return"numSegments must be of dtype int"})),fo.runKernelFunc((function(e,t){var i=e.unsortedSegmentSum(r,o,n);return t([o]),i}),{$x:r},(function(e,t){var n=t[0];return{$x:function(){return function(e,t){for(var n=Kf(t,Yi(t)),r=xh(e,n),o=lh(t,Zi(0,"int32")),i=r.rank-o.rank,a=0;a<i;++a)o=_a(o,a+1);o=Pf(o,qi(r.shape,"bool"));var s=Yi(r);return Bf(o,r,s)}(e,n)}}}))}});function _h(e,t,n,r,o,i,a){void 0===i&&(i="NHWC"),Jn(e.length===t.rank,(function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"}));var s=e,u=t,c=!1;3===t.rank&&(c=!0,u=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]),s=[1,e[0],e[1],e[2]]),Jn(4===s.length,(function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+s.length+"."})),Jn(4===u.rank,(function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+u.rank})),Jn(4===n.rank,(function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+n.rank}));var l="NHWC"===i?s[3]:s[1],f="NHWC"===i?u.shape[3]:u.shape[1];Jn(l===n.shape[2],(function(){return"Error in conv2dDerInput: depth of input ("+l+") must match input depth for filter "+n.shape[2]+"."})),Jn(f===n.shape[3],(function(){return"Error in conv2dDerInput: depth of output ("+f+") must match output depth for filter "+n.shape[3]+"."})),null!=a&&Jn(ir(o),(function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+o+"."}));var h=Ss(i),d=gs(s,n.shape,r,1,o,a,!1,h),p=fo.runKernelFunc((function(e,t){var r=e.conv2dDerInput(u,n,d);return t([n,u]),r}),{dy4D:u,filter:n},(function(e,t){var n=t[0],s=t[1];return{dy4D:function(){return Ih(e,n,r,o,i,1,a)},filter:function(){return Th(e,s,n.shape,r,o,i,a)}}}));return c?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}function Eh(e){var t=function(e){return"number"==typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}(e),n=t[0],r=t[1],o=t[2];return 1===n&&1===r&&1===o}function Ch(e,t,n,r,o){Jn(e.length===t.rank,(function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"}));var i=e,a=t,s=!1;4===t.rank&&(s=!0,a=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]),i=[1,e[0],e[1],e[2],e[3]]);var u=i[4],c=a.shape[4];Jn(5===i.length,(function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+i.length+"."})),Jn(5===a.rank,(function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+a.rank})),Jn(5===n.rank,(function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+n.rank})),Jn(u===n.shape[3],(function(){return"Error in conv3dDerInput: depth of input ("+u+") must match input depth for filter "+n.shape[3]+"."})),Jn(c===n.shape[4],(function(){return"Error in conv3dDerInput: depth of output ("+c+") must match output depth for filter "+n.shape[4]+"."}));var l=ys(i,n.shape,r,1,o),f=fo.runKernelFunc((function(e){return e.conv3dDerInput(a,n,l)}),{dy5D:a});return s?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}var Sh=Mi({conv1d_:function(e,t,n,r,o,i,a){void 0===o&&(o="NWC"),void 0===i&&(i=1);var s=_i(e,"x","conv1d"),u=_i(t,"filter","conv1d"),c=s,l=!1;2===s.rank&&(l=!0,c=s.as3D(1,s.shape[0],s.shape[1])),Jn(3===c.rank,(function(){return"Error in conv1d: input must be rank 3, but got rank "+c.rank+"."})),Jn(3===u.rank,(function(){return"Error in conv1d: filter must be rank 3, but got rank "+u.rank+"."})),null!=a&&Jn(ir(r),(function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."})),Jn(c.shape[2]===u.shape[1],(function(){return"Error in conv1d: depth of input ("+c.shape[2]+") must match input depth for filter "+u.shape[1]+"."})),Jn(Cs(n,i),(function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+n+" and dilation '"+i+"'"})),Jn("NWC"===o,(function(){return"Error in conv1d: got dataFormat of "+o+" but only NWC is currently supported."}));var f=u.as4D(1,u.shape[0],u.shape[1],u.shape[2]),h=c.as4D(c.shape[0],1,c.shape[1],c.shape[2]),d=Ih(h,f,[1,n],r,"NHWC",[1,i],a);return l?d.as2D(d.shape[2],d.shape[3]):d.as3D(d.shape[0],d.shape[2],d.shape[3])}}),Ih=Mi({conv2d_:function(e,t,n,r,o,i,a){void 0===o&&(o="NHWC"),void 0===i&&(i=[1,1]);var s=_i(e,"x","conv2d"),u=_i(t,"filter","conv2d"),c=s,l=!1;3===s.rank&&(l=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),Jn(4===c.rank,(function(){return"Error in conv2d: input must be rank 4, but got rank "+c.rank+"."})),Jn(4===u.rank,(function(){return"Error in conv2d: filter must be rank 4, but got rank "+u.rank+"."})),null!=a&&Jn(ir(r),(function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."}));var f="NHWC"===o?c.shape[3]:c.shape[1];Jn(f===u.shape[2],(function(){return"Error in conv2d: depth of input ("+f+") must match input depth for filter "+u.shape[2]+"."})),Jn(Cs(n,i),(function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"}));var h=Ss(o),d=gs(c.shape,u.shape,n,i,r,a,!1,h),p=[u,c],v=fo.runKernelFunc((function(e,t){var n=e.conv2d(c,u,d);return t([u,c]),n}),{x:c,filter:u},(function(e,t){var a=t,s=a[0],u=a[1];return Jn(Es(i),(function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"})),{x:function(){return Ah(u.shape,e,s,n,r,o)},filter:function(){return Th(u,e,s.shape,n,r,o)}}}),"Conv2D",d,p);return l?v.as3D(v.shape[1],v.shape[2],v.shape[3]):v}}),Rh=Mi({conv3d_:function(e,t,n,r,o,i){void 0===o&&(o="NDHWC"),void 0===i&&(i=[1,1,1]);var a=_i(e,"x","conv3d"),s=_i(t,"filter","conv3d"),u=a,c=!1;4===a.rank&&(c=!0,u=a.as5D(1,a.shape[0],a.shape[1],a.shape[2],a.shape[3])),Jn(5===u.rank,(function(){return"Error in conv3d: input must be rank 5, but got rank "+u.rank+"."})),Jn(5===s.rank,(function(){return"Error in conv3d: filter must be rank 5, but got rank "+s.rank+"."})),Jn(u.shape[4]===s.shape[3],(function(){return"Error in conv3d: depth of input ("+u.shape[4]+") must match input depth for filter "+s.shape[3]+"."})),Jn(function(e,t){return Eh(e)||Eh(t)}(n,i),(function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"})),Jn("NDHWC"===o,(function(){return"Error in conv3d: got dataFormat of "+o+" but only NDHWC is currently supported."}));var l=ys(u.shape,s.shape,n,i,r),f=fo.runKernelFunc((function(e,t){var n=e.conv3d(u,s,l);return t([u,s]),n}),{x:u,$filter:s},(function(e,t){Jn(Eh(i),(function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"}));var o=t[0],a=t[1];return{x:function(){return Ch(o.shape,e,a,n,r)},$filter:function(){return function(e,t,n,r,o){var i=e;4===e.rank&&(i=e.as5D(1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]));var a=t;4===a.rank&&(a=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3])),Jn(5===i.rank,(function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+i.shape+"."})),Jn(5===a.rank,(function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+a.shape+"."})),Jn(5===n.length,(function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+n+"."})),Jn(i.shape[4]===n[3],(function(){return"Error in conv3dDerFilter: depth of input "+i.shape[4]+") must match input depth in filter ("+n[3]+"."})),Jn(a.shape[4]===n[4],(function(){return"Error in conv3dDerFilter: depth of dy ("+a.shape[4]+") must match output depth for filter ("+n[4]+")."}));var s=ys(i.shape,n,r,1,o);return fo.runKernelFunc((function(e){return e.conv3dDerFilter(i,a,s)}),{x5D:i,dy5D:a})}(o,e,a.shape,n,r)}}}));return c?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}}),Th=Mi({conv2dDerFilter_:function(e,t,n,r,o,i,a){void 0===i&&(i="NHWC");var s=e;3===e.rank&&(s=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var u=t;3===u.rank&&(u=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),Jn(4===s.rank,(function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+s.shape+"."})),Jn(4===u.rank,(function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+u.shape+"."})),Jn(4===n.length,(function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+n+"."}));var c="NHWC"===i?s.shape[3]:s.shape[1],l="NHWC"===i?u.shape[3]:u.shape[1];Jn(c===n[2],(function(){return"Error in conv2dDerFilter: depth of input "+c+") must match input depth in filter ("+n[2]+"."})),Jn(l===n[3],(function(){return"Error in conv2dDerFilter: depth of dy ("+l+") must match output depth for filter ("+n[3]+")."})),null!=a&&Jn(ir(o),(function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+o+"."}));var f=Ss(i),h=gs(s.shape,n,r,1,o,a,!1,f);return fo.runKernelFunc((function(e){return e.conv2dDerFilter(s,u,h)}),{x4D:s,dy4D:u})}}),Ah=Mi({conv2dDerInput_:_h}),Nh=Mi({depthwiseConv2d_:function(e,t,n,r,o,i,a){void 0===o&&(o="NHWC"),void 0===i&&(i=[1,1]);var s=_i(e,"x","depthwiseConv2d"),u=_i(t,"filter","depthwiseConv2d"),c=s,l=!1;3===s.rank&&(l=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),Jn(4===c.rank,(function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+c.rank+"."})),Jn(4===u.rank,(function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+u.rank+"."})),Jn(c.shape[3]===u.shape[2],(function(){return"Error in depthwiseConv2d: number of input channels ("+c.shape[3]+") must match the inChannels dimension in filter "+u.shape[2]+"."})),null==i&&(i=[1,1]),Jn(Cs(n,i),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"})),null!=a&&Jn(ir(r),(function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."}));var f=gs(c.shape,u.shape,n,i,r,a,!0),h=[c,u],d=fo.runKernelFunc((function(e,t){var n=e.depthwiseConv2D(c,u,f);return t([c,u]),n}),{x:c,filter:u},(function(e,t){Jn(Es(i),(function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+i+"'"}));var n=t[0],r=t[1];return{x:function(){return Oh(n.shape,e,r,f)},filter:function(){return Dh(n,e,r.shape,f)}}}),"DepthwiseConv2dNative",f,h);return l?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}}),Oh=Mi({depthwiseConv2dDerInput_:function(e,t,n,r){var o=t,i=!1;3===t.rank&&(i=!0,o=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var a=fo.runKernelFunc((function(e){return e.depthwiseConv2DDerInput(o,n,r)}),{dy4D:o});return i?a.as3D(a.shape[1],a.shape[2],a.shape[3]):a}}),Dh=Mi({depthwiseConv2dDerFilter_:function(e,t,n,r){var o=e;3===e.rank&&(o=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var i=t;return 3===i.rank&&(i=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),fo.runKernelFunc((function(e){return e.depthwiseConv2DDerFilter(o,i,r)}),{x4D:o,dy4D:i})}}),Ph=Mi({separableConv2d_:function(e,t,n,r,o,i,a){void 0===i&&(i=[1,1]),void 0===a&&(a="NHWC");var s=_i(e,"x","separableConv2d"),u=_i(t,"depthwiseFilter","separableConv2d"),c=_i(n,"pointwiseFilter","separableConv2d"),l=s,f=!1;if(3===s.rank&&(f=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),"NCHW"===a)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");Jn(4===l.rank,(function(){return"Error in separableConv2d: input must be rank 4, but got rank "+l.rank+"."})),Jn(4===u.rank,(function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+u.rank+"."})),Jn(4===c.rank,(function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+u.rank+"."})),Jn(1===c.shape[0],(function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+c.shape[0]+"."})),Jn(1===c.shape[1],(function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+c.shape[1]+"."}));var h=u.shape[2],d=u.shape[3];Jn(c.shape[2]===h*d,(function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+h*d+", but got "+c.shape[2]+"."}));var p=Nh(l,u,r,o,a,i),v=Ih(p,c,1,"valid",a);return f?v.as3D(v.shape[1],v.shape[2],v.shape[3]):v}}),Mh=Mi({conv2dTranspose_:function(e,t,n,r,o,i){return _h(n,_i(e,"x","conv2dTranspose"),_i(t,"filter","conv2dTranspose"),r,o,"NHWC",i)}}),Fh=Mi({conv3dTranspose_:function(e,t,n,r,o){return Ch(n,_i(e,"x","conv3dTranspose"),_i(t,"filter","conv3dTranspose"),r,o)}}),Lh=Mi({matMul_:function(e,t,n,r){var o;void 0===n&&(n=!1),void 0===r&&(r=!1);var i=_i(e,"a","matMul"),a=_i(t,"b","matMul");o=io(i,a),i=o[0],a=o[1];var s=n?i.shape[i.rank-2]:i.shape[i.rank-1],u=r?a.shape[a.rank-1]:a.shape[a.rank-2],c=n?i.shape[i.rank-1]:i.shape[i.rank-2],l=r?a.shape[a.rank-2]:a.shape[a.rank-1],f=i.shape.slice(0,-2),h=a.shape.slice(0,-2),d=rr(f),p=rr(h);Jn(i.rank>=2&&a.rank>=2&&i.rank===a.rank,(function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+i.rank+" and "+a.rank+"."})),Jn(or(f,h),(function(){return"Error in matMul: outer dimensions ("+f+") and ("+h+") of Tensors with shapes "+i.shape+" and "+a.shape+" must match."})),Jn(s===u,(function(){return"Error in matMul: inner shapes ("+s+") and ("+u+") of Tensors with shapes "+i.shape+" and "+a.shape+" and transposeA="+n+" and transposeB="+r+" must match."}));var v=i.shape.slice(0,-2).concat([c,l]),m=n?i.as3D(d,s,c):i.as3D(d,c,s),g=r?a.as3D(p,l,u):a.as3D(p,u,l),y={transposeA:n,transposeB:r};return fo.runKernelFunc((function(e,t){var o=e.batchMatMul(m,g,n,r);return t([m,g]),o}),{a:m,b:g},(function(e,t){var o=t,i=o[0],a=o[1];return n||r?!n&&r?{a:function(){return e.matMul(a,!1,!1)},b:function(){return e.matMul(i,!0,!1)}}:n&&!r?{a:function(){return a.matMul(e,!1,!0)},b:function(){return i.matMul(e,!1,!1)}}:{a:function(){return a.matMul(e,!0,!0)},b:function(){return e.matMul(i,!0,!0)}}:{a:function(){return e.matMul(a,!1,!0)},b:function(){return i.matMul(e,!0,!1)}}}),"BatchMatMul",y).reshape(v)}}),Bh=Mi({dot_:function(e,t){var n=_i(e,"t1","dot"),r=_i(t,"t2","dot");Jn(!(1!==n.rank&&2!==n.rank||1!==r.rank&&2!==r.rank),(function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+n.rank+" and "+r.rank+"."}));var o=1===n.rank?n.size:n.shape[1],i=1===r.rank?r.size:r.shape[0];return Jn(o===i,(function(){return"Error in dot: inner dimensions of inputs must match, but got "+o+" and "+i+"."})),1===n.rank&&1===r.rank?n.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():1===n.rank&&2===r.rank?n.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():2===n.rank&&1===r.rank?n.matMul(r.as2D(-1,1)).as1D():n.matMul(r.as2D(r.shape[0],r.shape[1]))}}),Uh=Mi({outerProduct_:function(e,t){var n=_i(e,"v1","outerProduct"),r=_i(t,"v2","outerProduct");return Jn(1===n.rank&&1===r.rank,(function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+n.rank+" and "+r.rank+"."})),n.as2D(-1,1).matMul(r.as2D(1,-1))}}),jh=Mi({reverse_:function(e,t){var n=_i(e,"x","reverse");if(0===n.rank)return n.clone();var r=fr(t,n.shape);return fo.runKernelFunc((function(e){return e.reverse(n,r)}),{$x:n},(function(e){return{$x:function(){return e.reverse(r)}}})).reshapeAs(n)}}),Zh=Mi({reverse1d_:function(e){var t=_i(e,"x","reverse");return Jn(1===t.rank,(function(){return"Error in reverse1D: x must be rank 1 but got rank "+t.rank+"."})),jh(t,0)}}),Wh=Mi({reverse2d_:function(e,t){var n=_i(e,"x","reverse");return Jn(2===n.rank,(function(){return"Error in reverse2D: x must be rank 2 but got rank "+n.rank+"."})),jh(n,t)}}),zh=Mi({reverse3d_:function(e,t){var n=_i(e,"x","reverse");return Jn(3===n.rank,(function(){return"Error in reverse3D: x must be rank 3 but got rank "+n.rank+"."})),jh(n,t)}}),Vh=Mi({reverse4d_:function(e,t){var n=_i(e,"x","reverse");return Jn(4===n.rank,(function(){return"Error in reverse4D: x must be rank 4 but got rank "+n.rank+"."})),jh(n,t)}});function Hh(e,t,n,r,o,i){var a=_i(e,"x","maxPool"),s=a,u=!1;3===a.rank&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),null==r&&(r=[1,1]),Jn(4===s.rank,(function(){return"Error in maxPool: input must be rank 4 but got rank "+s.rank+"."})),Jn(Cs(n,r),(function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"})),null!=i&&Jn(ir(o),(function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+o+"."}));var c=vs(s.shape,t,n,r,o,i);if(1===c.filterWidth&&1===c.filterHeight&&or(c.inShape,c.outShape))return a.clone();var l=[s],f=fo.runKernelFunc((function(e,t){var n=e.maxPool(s,c);return t([s,n]),n}),{x:s},(function(e,i){var a=i[0],s=i[1];return{x:function(){return function(e,t,n,r,o,i,a,s){var u=_i(e,"dy","maxPoolBackprop"),c=_i(t,"input","maxPoolBackprop"),l=_i(n,"output","maxPoolBackprop");Jn(c.rank===u.rank,(function(){return"Rank of input ("+c.rank+") does not match rank of dy ("+u.rank+")"})),null==i&&(i=[1,1]),Jn(Cs(o,i),(function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+o+" and dilations '"+i+"'"})),Jn(4===u.rank,(function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+u.rank+"."})),Jn(4===c.rank,(function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+c.rank+"."}));var f=vs(c.shape,r,o,i,a,s);return fo.runKernelFunc((function(e){return e.maxPoolBackprop(u,c,l,f)}),{$dy:u,$input:c})}(e,a,s,t,n,r,o)}}}),"MaxPool",c,l);return u?f.as3D(f.shape[1],f.shape[2],f.shape[3]):f}function qh(e,t,n,r,o,i){var a=_i(e,"x","avgPool","float32");null==r&&(r=[1,1]),Jn(Cs(n,r),(function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"}));var s=a,u=!1;3===a.rank&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),Jn(4===s.rank,(function(){return"Error in avgPool: x must be rank 4 but got rank "+s.rank+"."})),null!=i&&Jn(ir(o),(function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+o+"."}));var c=vs(s.shape,t,n,r,o,i);if(1===c.filterWidth&&1===c.filterHeight&&or(c.inShape,c.outShape))return a.clone();var l=fo.runKernelFunc((function(e){return e.avgPool(s,c)}),{x:s},(function(e){return{x:function(){return function(e,t,n,r,o,i){var a=_i(e,"dy","avgPoolBackprop"),s=_i(t,"input","avgPoolBackprop");Jn(s.rank===a.rank,(function(){return"Rank of input ("+s.rank+") does not match rank of dy ("+a.rank+")"})),null==o&&(o=[1,1]),Jn(Cs(r,o),(function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+o+"'"}));var u=s,c=a,l=!1;3===s.rank&&(l=!0,u=s.as4D(1,s.shape[0],s.shape[1],s.shape[2]),c=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),Jn(4===c.rank,(function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+c.rank+"."})),Jn(4===u.rank,(function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+u.rank+"."}));var f=vs(u.shape,n,r,o,i),h=fo.runKernelFunc((function(e){return e.avgPoolBackprop(c,u,f)}),{dy4D:c,input4D:u});return l?h.as3D(h.shape[1],h.shape[2],h.shape[3]):h}(e,s,t,n,r,o)}}}),"AvgPool",c);return l=l.cast(a.dtype),u?l.as3D(l.shape[1],l.shape[2],l.shape[3]):l}var Gh=Mi({maxPool_:function(e,t,n,r,o){return Hh(e,t,n,1,r,o)}}),Kh=Mi({avgPool_:function(e,t,n,r,o){return qh(e,t,n,1,r,o)}}),Xh=Mi({pool_:function(e,t,n,r,o,i){null==o&&(o=[1,1]),null==i&&(i=1),0===r&&(r="valid");var a=_i(e,"x","maxPool"),s=a,u=!1;3===a.rank&&(u=!0,s=a.as4D(1,a.shape[0],a.shape[1],a.shape[2])),Jn(Cs(i,o),(function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+o+"'"}));var c,l=vs(s.shape,t,i,o,r),f=[l.dilationHeight,l.dilationWidth];c="same"===r?function(e,t){var n=e.map((function(e,n){return e+(e-1)*(t[n]-1)})).map((function(e){return e-1})),r=n.map((function(e){return Math.floor(e/2)})),o=n.map((function(e,t){return e-r[t]}));return n.map((function(e,t){return[r[t],o[t]]}))}([l.filterHeight,l.filterWidth],f):[[0,0],[0,0]];var h=1===f[0]&&1===f[1],d=function(e,t,n){var r=n.map((function(e){return e[0]})),o=n.map((function(e){return e[1]})),i=e.concat(r,o),a=t.map((function(e,t){return(e-i[t]%e)%e})),s=o.map((function(e,t){return e+a[t]}));return[t.map((function(e,t){return[r[t],s[t]]})),t.map((function(e,t){return[0,a[t]]}))]}([l.inHeight,l.inWidth],f,c),p=d[0],v=d[1],m=h?r:"valid",g=h?s:La(s,f,p),y=("avg"===n?function(){return qh(g,t,i,1,m)}:function(){return Hh(g,t,i,1,m)})(),b=h?y:ga(y,f,v);return u?b.as3D(b.shape[1],b.shape[2],b.shape[3]):b}}),$h=Mi({maxPool3d_:function(e,t,n,r,o,i,a){void 0===i&&(i="NDHWC");var s=_i(e,"x","maxPool3d"),u=s,c=!1;4===s.rank&&(c=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),null==a&&(a=[1,1,1]),Jn(5===u.rank,(function(){return"Error in maxPool3d: x must be rank 5 but got rank "+u.rank+"."})),Jn("NDHWC"===i,(function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+i})),Jn(Cs(n,a),(function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"})),null!=o&&Jn(ir(r),(function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."}));var l=ms(u.shape,t,n,a,r,o,i),f=fo.runKernelFunc((function(e,t){var n=e.maxPool3d(u,l);return t([u,n]),n}),{x:u},(function(e,i){var s=i[0],u=i[1];return{x:function(){return function(e,t,n,r,o,i,a,s){var u=_i(e,"dy","maxPool3dBackprop"),c=_i(t,"input","maxPool3dBackprop"),l=_i(n,"output","maxPool3dBackprop"),f=u,h=c,d=l,p=!1;4===c.rank&&(p=!0,f=u.as5D(1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]),h=c.as5D(1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]),d=l.as5D(1,l.shape[0],l.shape[1],l.shape[2],l.shape[3])),Jn(5===f.rank,(function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+f.rank+"."})),Jn(5===h.rank,(function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+h.rank+"."})),Jn(5===d.rank,(function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+d.rank+"."})),null==i&&(i=[1,1,1]),Jn(Cs(o,i),(function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+o+" and dilations '"+i+"'"})),null!=s&&Jn(ir(a),(function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+a+"."}));var v=ms(h.shape,r,o,i,a,s),m=fo.runKernelFunc((function(e){return e.maxPool3dBackprop(f,h,d,v)}),{dy5D:f,input5D:h});return p?m.as4D(m.shape[1],m.shape[2],m.shape[3],m.shape[4]):m}(e,s,u,t,n,a,r,o)}}}));return c?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}}),Yh=Mi({avgPool3d_:function(e,t,n,r,o,i,a){void 0===i&&(i="NDHWC");var s=_i(e,"x","avgPool3d","float32"),u=s,c=!1;4===s.rank&&(c=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),null==a&&(a=[1,1,1]),Jn(5===u.rank,(function(){return"Error in avgPool3d: x must be rank 5 but got rank "+u.rank+"."})),Jn("NDHWC"===i,(function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+i})),Jn(Cs(n,a),(function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+a+"'"})),null!=o&&Jn(ir(r),(function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."}));var l=ms(u.shape,t,n,a,r,o,i),f=fo.runKernelFunc((function(e){return e.avgPool3d(u,l)}),{x:u},(function(e){return{x:function(){return function(e,t,n,r,o,i,a){var s=_i(e,"dy","avgPool3dBackprop"),u=_i(t,"input","avgPool3dBackprop"),c=s,l=u,f=!1;4===u.rank&&(f=!0,c=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]),l=u.as5D(1,u.shape[0],u.shape[1],u.shape[2],u.shape[3])),Jn(5===c.rank,(function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+c.rank+"."})),Jn(5===l.rank,(function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+l.rank+"."})),null==o&&(o=[1,1,1]),Jn(Cs(r,o),(function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+o+"'"})),null!=a&&Jn(ir(i),(function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+i+"."}));var h=ms(l.shape,n,r,o,i,a),d=fo.runKernelFunc((function(e){return e.avgPool3dBackprop(c,l,h)}),{dy5D:c,input5D:l});return f?d.as4D(d.shape[1],d.shape[2],d.shape[3],d.shape[4]):d}(e,u,t,n,a,r,o)}}}));return f=f.cast(u.dtype),c?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}}),Qh=Mi({slice_:function(e,t,n){var r,o,i=_i(e,"x","slice");if(0===i.rank)throw new Error("Slicing scalar is not possible");(r="number"==typeof t?[t].concat(new Array(i.rank-1).fill(0)):t.length<i.rank?t.concat(new Array(i.rank-t.length).fill(0)):t.slice()).forEach((function(e){Jn(-1!==e,(function(){return"slice() does not support negative begin indexing."}))})),o=(o=null==n?new Array(i.rank).fill(-1):"number"==typeof n?[n].concat(new Array(i.rank-1).fill(-1)):n.length<i.rank?n.concat(new Array(i.rank-n.length).fill(-1)):n).map((function(e,t){return e>=0?e:(Jn(-1===e,(function(){return"Negative size values should be exactly -1 but got "+e+" for the slice() size at index "+t+"."})),i.shape[t]-r[t])})),Ja(i,r,o);var a=i.shape,s={begin:r,size:o};return fo.runKernelFunc((function(e){return e.slice(i,r,o)}),{x:i},(function(e){for(var t=[],n=0;n<e.rank;n++)t.push([r[n],a[n]-r[n]-o[n]]);return{x:function(){return e.pad(t)}}}),"Slice",s)}}),Jh=Mi({slice1d_:function(e,t,n){var r=_i(e,"x","slice1d");return Jn(1===r.rank,(function(){return"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"})),Qh(r,[t],[n])}}),ed=Mi({slice2d_:function(e,t,n){var r=_i(e,"x","slice2d");return Jn(2===r.rank,(function(){return"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"})),Qh(r,t,n)}}),td=Mi({slice3d_:function(e,t,n){var r=_i(e,"x","slice3d");return Jn(3===r.rank,(function(){return"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"})),Qh(r,t,n)}}),nd=Mi({slice4d_:function(e,t,n){var r=_i(e,"x","slice4d");return Jn(4===r.rank,(function(){return"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"})),Qh(r,t,n)}});function rd(e,t,n,r,o){return t.rank<n.rank&&(t=t.reshape(Ri(t.shape,r))),e.rank<n.rank&&(e=e.reshape(Ri(e.shape,r))),{x:function(){var r=e.mul(n.equal(t).cast(e.dtype));return null==o?r:r.transpose(o)}}}var od=Mi({all_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=_i(e,"x","all","bool"),o=fr(t,r.shape),i=o,a=Ai(i,r.rank);null!=a&&(r=r.transpose(a),i=Oi(i.length,r.rank));var s=fo.runKernelFunc((function(e){return e.all(r,i)}),{$x:r});if(n){var u=Ri(s.shape,o);return s.reshape(u)}return s}}),id=Mi({any_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=_i(e,"x","any","bool"),o=fr(t,r.shape),i=o,a=Ai(i,r.rank);null!=a&&(r=r.transpose(a),i=Oi(i.length,r.rank));var s=fo.runKernelFunc((function(e){return e.any(r,i)}),{$x:r});if(n){var u=Ri(s.shape,o);return s.reshape(u)}return s}}),ad=Mi({argMax_:function(e,t){void 0===t&&(t=0);var n=_i(e,"x","argMax");null==t&&(t=0);var r=fr(t,n.shape),o=Ai(r,n.rank);null!=o&&(n=n.transpose(o),r=Oi(r.length,n.rank));var i={axis:r[0]},a=[n];return fo.runKernelFunc((function(e,t){var o=e.argMax(n,r[0]);return t([n]),o}),{x:n},(function(e,t){var n=t[0];return{x:function(){return Yi(n)}}}),"ArgMax",i,a)}}),sd=Mi({argMin_:function(e,t){void 0===t&&(t=0);var n=_i(e,"x","argMin");null==t&&(t=0);var r=fr(t,n.shape),o=Ai(r,n.rank);return null!=o&&(n=n.transpose(o),r=Oi(r.length,n.rank)),fo.runKernelFunc((function(e,t){var o=e.argMin(n,r[0]);return t([n]),o}),{$x:n},(function(e,t){var n=t[0];return{$x:function(){return Yi(n)}}}))}}),ud=Mi({logSumExp_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=_i(e,"x","logSumExp"),o=fr(t,r.shape),i=r.max(o,!0),a=r.sub(i).exp().sum(o).log(),s=i.reshape(a.shape).add(a);if(n){var u=Ri(s.shape,o);return s.reshape(u)}return s}}),cd=Mi({max_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=_i(e,"x","max"),o=r,i=fr(t,r.shape),a=i,s=Ai(a,r.rank);null!=s&&(r=r.transpose(s),a=Oi(a.length,r.rank));var u=[r],c=fo.runKernelFunc((function(e,t){var n=e.max(r,a);return t([o,n]),n}),{x:r},(function(e,t){return rd(e,t[1],t[0],i,s)}),"Max",{axes:a},u,[!0]);if(n){var l=Ri(c.shape,i);c=c.reshape(l)}return c}}),ld=Mi({mean_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=_i(e,"x","mean"),o=fr(t,r.shape),i=rr(Ii(r.shape,o)[1]);return as((function(e){var r=Zi(i);return{value:(r.dtype===e.dtype?e:e.cast(r.dtype)).div(r).sum(t,n),gradFunc:function(t){var n=e.shape.slice();return o.forEach((function(e){n[e]=1})),t.reshape(n).mul(qi(e.shape,"float32")).div(i)}}}))(r)}}),fd=Mi({min_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=_i(e,"x","min"),o=r,i=fr(t,r.shape),a=i,s=Ai(a,r.rank);null!=s&&(r=r.transpose(s),a=Oi(a.length,r.rank));var u=[r],c=fo.runKernelFunc((function(e,t){var n=e.min(r,a);return t([o,n]),n}),{x:r},(function(e,t){return rd(e,t[1],t[0],i,s)}),"Min",{axes:a},u,[!0]);if(n){var l=Ri(c.shape,i);c=c.reshape(l)}return c}}),hd=Mi({moments_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=fr(t,(e=_i(e,"x","moments")).shape),o=e.mean(r,n),i=o.shape;n||(i=Ri(o.shape,r));var a=e.toFloat().sub(o.reshape(i)).square();return{mean:o,variance:a.mean(r,n)}}}),dd=Mi({sum_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=_i(e,"x","sum");"bool"===r.dtype&&(r=r.toInt());var o=fr(t,r.shape);return as((function(e){var t=Ai(o,e.rank),r=o,i=e;null!=t&&(i=e.transpose(t),r=Oi(r.length,e.rank));var a=function(t){var n=e.shape.slice();return o.forEach((function(e){n[e]=1})),t.reshape(n).mul(qi(e.shape,"float32"))},s={axes:r},u=fo.runKernelFunc((function(e){return e.sum(i,r)}),{x:i},(function(e){return{x:function(){return a(e)}}}),"Sum",s);if(n){var c=Ri(u.shape,o);u=u.reshape(c)}return{value:u,gradFunc:a}}))(r)}}),pd=Mi({prod_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=_i(e,"x","prod");"bool"===r.dtype&&(r=r.toInt());var o=fr(t,r.shape),i=Ai(o,r.rank),a=o,s=r;null!=i&&(s=r.transpose(i),a=Oi(a.length,r.rank));var u=fo.runKernelFunc((function(e){return e.prod(s,a)}),{permutedX:s});if(n){var c=Ri(u.shape,o);u=u.reshape(c)}return u}}),vd=Mi({elu_:function(e){var t=_i(e,"x","elu");return fo.runKernelFunc((function(e,n){var r=e.elu(t);return n([r]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return fo.runKernelFunc((function(t){return t.eluDer(e,n)}),{dy:e,y:n})}}}))}}),md=Mi({leakyRelu_:function(e,t){void 0===t&&(t=.2);var n=_i(e,"x","leakyRelu");return Kf(Zi(t).mul(n),n)}}),gd=Mi({prelu_:function(e,t){var n=_i(e,"x","prelu"),r=_i(t,"alpha","prelu");return fo.runKernelFunc((function(e,t){var o=e.prelu(n,r);return t([n,r]),o}),{x:n,alpha:r},(function(e,t){var n=t[0],r=t[1],o=n.greater(0);return{x:function(){return Bf(o,e,e.mul(r))},alpha:function(){var t=Bf(o,Yi(e),e.mul(n)),i=ds(r.shape,e.shape);return i.length>0&&(t=t.sum(i)),t.reshape(r.shape)}}}),"Prelu")}}),yd=Mi({relu_:function(e){var t=_i(e,"x","relu");return"bool"===t.dtype?t.toInt():fo.runKernelFunc((function(e,n){var r=e.relu(t);return n([t]),r}),{x:t},(function(e,t){var n=t[0];return{x:function(){return e.mulStrict(n.step().toFloat())}}}),"Relu")}}),bd=Mi({relu6_:function(e){var t=_i(e,"x","relu6");return"bool"===t.dtype?t.toInt():fo.runKernelFunc((function(e,n){var r=e.relu6(t);return n([t]),r}),{x:t},(function(e,t){var n=t[0],r=n.lessEqual(6).mul(n.step());return{x:function(){return e.mulStrict(r.toFloat())}}}),"Relu6")}}),wd=Mi({selu_:function(e){var t=_i(e,"x","selu");return fo.runKernelFunc((function(e,n){var r=e.selu(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){var t=n.greater(Zi(0)),r=Zi(il),o=Zi(al),i=e.mul(o),a=e.mul(r).mul(n.toFloat().exp());return Bf(t,i,a)}}}))}}),xd=Mi({transpose_:function(e,t){var n=_i(e,"x","transpose");if(null==t&&(t=n.shape.map((function(e,t){return t})).reverse()),Jn(n.rank===t.length,(function(){return"Error in transpose: rank of input "+n.rank+" must match length of perm "+t+"."})),t.forEach((function(e){Jn(e>=0&&e<n.rank,(function(){return"All entries in 'perm' must be between 0 and "+(n.rank-1)+" but got "+t}))})),n.rank<=1)return n.clone();var r={perm:t};return fo.runKernelFunc((function(e){return e.transpose(n,t)}),{x:n},(function(e){var n=Ni(t);return{x:function(){return e.transpose(n)}}}),"Transpose",r)}}),kd=Mi({localResponseNormalization_:function(e,t,n,r,o){void 0===t&&(t=5),void 0===n&&(n=1),void 0===r&&(r=1),void 0===o&&(o=.5);var i=_i(e,"x","localResponseNormalization");Jn(4===i.rank||3===i.rank,(function(){return"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank "+i.rank+"."})),Jn(ir(t),(function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+t+"."}));var a=i,s=!1;3===i.rank&&(s=!0,a=i.as4D(1,i.shape[0],i.shape[1],i.shape[2]));var u=fo.runKernelFunc((function(e,i){var s=e.localResponseNormalization4D(a,t,n,r,o);return i([a,s]),s}),{x4D:a},(function(e,i){var a=i[0],s=i[1];return{x4D:function(){return fo.runKernelFunc((function(i){return i.LRNGrad(e,a,s,t,n,r,o)}),{})}}}));return s?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),_d=Mi({norm_:function(e,t,n,r){void 0===t&&(t="euclidean"),void 0===n&&(n=null),void 0===r&&(r=!1);var o=function e(t,n,r){if(void 0===r&&(r=null),0===t.rank)return t.abs();if(1!==t.rank&&null===r)return e(t.reshape([-1]),n,r);if(1===t.rank||"number"==typeof r||Array.isArray(r)&&1===r.length){if(1===n)return t.abs().sum(r);if(n===1/0)return t.abs().max(r);if(n===-1/0)return t.abs().min(r);if("euclidean"===n||2===n)return t.abs().pow(Zi(2,"int32")).sum(r).sqrt();throw new Error("Error in norm: invalid ord value: "+n)}if(Array.isArray(r)&&2===r.length){if(1===n)return t.abs().sum(r[0]).max(r[1]-1);if(n===1/0)return t.abs().sum(r[1]).max(r[0]);if(n===-1/0)return t.abs().sum(r[1]).min(r[0]);if("fro"===n||"euclidean"===n)return t.square().sum(r).sqrt();throw new Error("Error in norm: invalid ord value: "+n)}throw new Error("Error in norm: invalid axis: "+r)}(e=_i(e,"x","norm"),t,n),i=o.shape;if(r){var a=fr(n,e.shape);i=Ri(o.shape,a)}return o.reshape(i)}}),Ed=Mi({basicLSTMCell_:function(e,t,n,r,o,i){var a=_i(e,"forgetBias","basicLSTMCell"),s=_i(t,"lstmKernel","basicLSTMCell"),u=_i(n,"lstmBias","basicLSTMCell"),c=_i(r,"data","basicLSTMCell"),l=_i(o,"c","basicLSTMCell"),f=_i(i,"h","basicLSTMCell"),h=c.concat(f,1).matMul(s).add(u),d=h.shape[0],p=h.shape[1]/4,v=[d,p],m=h.slice([0,0],v),g=h.slice([0,p],v),y=h.slice([0,2*p],v),b=h.slice([0,3*p],v),w=m.sigmoid().mulStrict(g.tanh()).addStrict(l.mulStrict(a.add(y).sigmoid())),x=w.tanh().mulStrict(b.sigmoid());return[w,x]}}),Cd=Mi({multiRNNCell_:function(e,t,n,r){for(var o=_i(t,"data","multiRNNCell"),i=Ei(n,"c","multiRNNCell"),a=Ei(r,"h","multiRNNCell"),s=o,u=[],c=0;c<e.length;c++){var l=e[c](s,i[c],a[c]);u.push(l[0]),u.push(l[1]),s=l[1]}var f=[],h=[];for(c=0;c<u.length;c+=2)f.push(u[c]),h.push(u[c+1]);return[f,h]}}),Sd=Mi({movingAverage_:function(e,t,n,r,o){void 0===o&&(o=!0);var i=_i(e,"v","movingAverage"),a=_i(t,"x","movingAverage"),s=_i(n,"decay","movingAverage");ao(i,a),Jn(or(i.shape,a.shape),(function(){return"Shape mismatch in v and x"}));var u=Zi(1),c=u.sub(s),l=a.sub(i).mul(c);if(o){Jn(null!=r,(function(){return"When using zeroDebias: true, step is required."}));var f=_i(r,"step","movingAverage");l=l.div(u.sub(nh(s,f)))}return i.add(l)}}),Id=Mi({stridedSlice_:function(e,t,n,r,o,i,a,s,u){if(void 0===o&&(o=0),void 0===i&&(i=0),void 0===a&&(a=0),void 0===s&&(s=0),void 0===u&&(u=0),null==r&&(r=new Array(t.length)),0!==a)throw new Error("ellipsis mask is not yet supported");var c=_i(e,"x","stridedSlice"),l=es(s),f=c.shape.slice();l.forEach((function(e){t[e]=0,n[e]=1,f.splice(e,0,1)})),c=c.reshape(f);for(var h=0;h<c.rank;h++)t[h]=ns(o,t,r,c.shape,h),n[h]=rs(i,n,r,c.shape,h),r[h]=r[h]||1;var d=es(u);d.forEach((function(e){n[e]=t[e]+1,r[e]=1}));var p=ts(t,n,r),v=p.filter((function(e,t){return-1===d.indexOf(t)}));return r.every((function(e){return 1===e}))?Qh(c,t,p).reshape(v):fo.runKernelFunc((function(e){return e.stridedSlice(c,t,n,r)}),{$x:c}).reshape(v)}}),Rd=Mi({topk_:function(e,t,n){void 0===t&&(t=1),void 0===n&&(n=!0);var r=_i(e,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");var o=r.shape[r.shape.length-1];if(t>o)throw new Error("'k' passed to topk() must be <= the last dimension ("+o+") but got "+t);var i=fo.runKernelFunc((function(e){return e.topk(r,t,n)}),{$x:r});return{values:i[0],indices:i[1]}}}),Td=Mi({scatterND_:function(e,t,n){var r=_i(e,"indices","scatterND","int32"),o=_i(t,"updates","scatterND");return Ya(o,r,n),fo.runKernelFunc((function(e){return e.scatterND(r,o,n)}),{indices:r,updates:o},null,"ScatterNd",{shape:n})}}),Ad=Mi({fft_:function(e){Jn("complex64"===e.dtype,(function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+e.dtype+"."}));var t=e.shape[e.shape.length-1],n=e.size/t,r=e.as2D(n,t);return fo.runKernelFunc((function(e){return e.fft(r)}),{input:e}).reshape(e.shape)}}),Nd=Mi({ifft_:function(e){Jn("complex64"===e.dtype,(function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+e.dtype+"."}));var t=e.shape[e.shape.length-1],n=e.size/t,r=e.as2D(n,t);return fo.runKernelFunc((function(e){return e.ifft(r)}),{input:e}).reshape(e.shape)}}),Od=Mi({rfft_:function(e,t){Jn("float32"===e.dtype,(function(){return"The dtype for rfft() must be real value but got "+e.dtype}));var n,r=e.shape[e.shape.length-1],o=e.size/r;if(null!=t&&t<r){var i=e.shape.map((function(e){return 0})),a=e.shape.map((function(e){return e}));a[e.shape.length-1]=t,n=e.slice(i,a),r=t}else if(null!=t&&t>r){var s=e.shape.map((function(e){return e}));s[e.shape.length-1]=t-r,n=e.concat(Gi(s),e.shape.length-1),r=t}else n=e;var u=n.zerosLike(),c=Fi(n,u).as2D(o,r),l=Ad(c),f=Math.floor(r/2)+1,h=Li(l),d=Bi(l),p=h.split([f,r-f],h.shape.length-1),v=d.split([f,r-f],d.shape.length-1),m=n.shape.slice();return m[n.shape.length-1]=f,Fi(p[0],v[0]).reshape(m)}}),Dd=Mi({irfft_:function(e){var t=e.shape[e.shape.length-1],n=e.size/t;if(t<=2){var r=e.as2D(n,t),o=Nd(r);return Li(o)}var i=[n,2*(t-1)],a=Li(e).as2D(n,t),s=Bi(e).as2D(n,t),u=a.slice([0,1],[n,t-2]).reverse(1),c=s.slice([0,1],[n,t-2]).reverse(1).mul(Zi(-1)),l=a.concat(u,1),f=s.concat(c,1);return r=Fi(l,f).as2D(i[0],i[1]),o=Nd(r),Li(o)}}),Pd=Object.freeze({fft:Ad,ifft:Nd,rfft:Od,irfft:Dd}),Md=Mi({sparseToDense_:function(e,t,n,r){void 0===r&&(r=0);var o=_i(e,"sparseIndices","sparseToDense","int32"),i=_i(t,"sparseValues","sparseToDense"),a=_i(r,"defaultValue","sparseToDense",i.dtype);return function(e,t,n,r){if("int32"!==e.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+e.dtype+".");if(e.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+e.shape+".");var o=e.rank>0?e.shape[0]:1,i=e.rank>1?e.shape[1]:1;if(n.length!==i)throw new Error("outputShape has incorrect number of elements:, "+n.length+", should be: "+i+".");var a=t.size;if(0!==t.rank&&(1!==t.rank||a!==o))throw new Error("sparseValues has incorrect shape "+t.shape+", should be [] or ["+o+"]");if(t.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(o,i,n,a),fo.runKernelFunc((function(e){return e.sparseToDense(o,i,n,a)}),{$sparseIndices:o,$sparseValues:i,$defaultValue:a})}}),Fd=Mi({gatherND_:function(e,t){var n=_i(t,"indices","gatherND","int32"),r=_i(e,"x","gatherND");return fo.runKernelFunc((function(e){return e.gatherND(r,n)}),{x:r,indices:n},null,"GatherNd")}}),Ld=Mi({diag_:function(e){var t=_i(e,"x","diag").flatten(),n=e.shape.concat(e.shape);return fo.runKernelFunc((function(e){return e.diag(t)}),{$x:t}).reshape(n)}}),Bd=Mi({dropout_:function(e,t,n,r){var o=_i(e,"x","dropout");if(Jn("float32"===o.dtype,(function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+o.dtype+" tensor instead."})),Jn(t>=0&&t<1,(function(){return"rate must be a float in the range [0, 1), but got "+t+"."})),0===t)return e instanceof Kr?o.clone():o;var i=function(e,t){if(null==t)return e.shape.slice();if(or(e.shape,t))return t;if(e.shape.length===t.length){for(var n=[],r=0;r<e.shape.length;r++)null==t[r]&&null!=e.shape[r]?n.push(e.shape[r]):n.push(t[r]);return n}return t}(o,n),a=1-t,s=Ma(i,0,1,"float32",r).add(a).floor().div(a);return o.mul(s)}});function Ud(e,t,n){for(var r=1-e%2,o=new Float32Array(e),i=0;i<e;++i){var a=2*Math.PI*i/(e+r-1);o[i]=t-n*Math.cos(a)}return Wi(o,"float32")}var jd,Zd=Mi({hannWindow_:function(e){return Ud(e,.5,.5)}}),Wd=Mi({hammingWindow_:function(e){return Ud(e,.54,.46)}}),zd=Mi({frame_:function(e,t,n,r,o){void 0===r&&(r=!1),void 0===o&&(o=0);for(var i=0,a=[];i+t<=e.size;)a.push(Qh(e,i,t)),i+=n;if(r)for(;i<e.size;){var s=i+t-e.size,u=Qi([Qh(e,i,t-s),Ki([s],o)]);a.push(u),i+=n}return 0===a.length?zi([],[0,t]):Qi(a).as2D(a.length,t)}}),Vd=Mi({stft_:function(e,t,n,r,o){var i;void 0===o&&(o=Zd),null==r&&(i=t,r=Math.floor(Math.pow(2,Math.ceil(Math.log(i)/Math.log(2)))));for(var a=zd(e,t,n),s=eh(a,o(t)),u=[],c=0;c<a.shape[0];c++)u.push(Od(s.slice([c,0],[1,t]),r));return Qi(u)}}),Hd=Object.freeze({hannWindow:Zd,hammingWindow:Wd,frame:zd,stft:Vd});!function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(jd||(jd={}));var qd=Mi({absoluteDifference_:function(e,t,n,r){void 0===r&&(r=jd.SUM_BY_NONZERO_WEIGHTS);var o=_i(e,"labels","absoluteDifference"),i=_i(t,"predictions","absoluteDifference"),a=null;null!=n&&(a=_i(n,"weights","absoluteDifference")),er(o.shape,i.shape,"Error in absoluteDifference: ");var s=o.sub(i).abs();return Gd(s,a,r)}}),Gd=Mi({computeWeightedLoss_:function(e,t,n){void 0===n&&(n=jd.SUM_BY_NONZERO_WEIGHTS);var r=_i(e,"losses","computeWeightedLoss"),o=null;null!=t&&(o=_i(t,"weights","computeWeightedLoss"));var i=null==o?r:r.mul(o);if(n===jd.NONE)return i;if(n===jd.SUM)return i.sum();if(n===jd.MEAN){if(null==o)return i.mean();var a=r.size/o.size,s=i.sum().div(o.sum());return a>1?s.div(Zi(a)):s}if(n===jd.SUM_BY_NONZERO_WEIGHTS){if(null==o)return i.sum().div(Zi(r.size));var u=o.mul(qi(r.shape)).notEqual(Zi(0)).sum().toFloat();return i.sum().div(u)}throw Error("Unknown reduction: "+n)}}),Kd=Mi({cosineDistance_:function(e,t,n,r,o){void 0===o&&(o=jd.SUM_BY_NONZERO_WEIGHTS);var i=_i(e,"labels","cosineDistance"),a=_i(t,"predictions","cosineDistance"),s=null;null!=r&&(s=_i(r,"weights","cosineDistance")),er(i.shape,a.shape,"Error in cosineDistance: ");var u=Zi(1).sub(i.mul(a).sum(n,!0));return Gd(u,s,o)}}),Xd=Mi({hingeLoss_:function(e,t,n,r){void 0===r&&(r=jd.SUM_BY_NONZERO_WEIGHTS);var o=_i(e,"labels","hingeLoss"),i=_i(t,"predictions","hingeLoss"),a=null;null!=n&&(a=_i(n,"weights","hingeLoss")),er(o.shape,i.shape,"Error in hingeLoss: ");var s=Zi(1);o=Zi(2).mul(o).sub(s);var u=s.sub(o.mul(i)).relu();return Gd(u,a,r)}}),$d=Mi({huberLoss_:function(e,t,n,r,o){void 0===r&&(r=1),void 0===o&&(o=jd.SUM_BY_NONZERO_WEIGHTS);var i=_i(e,"labels","huberLoss"),a=_i(t,"predictions","huberLoss"),s=null;null!=n&&(s=_i(n,"weights","huberLoss")),er(i.shape,a.shape,"Error in huberLoss: ");var u=Zi(r),c=a.sub(i).abs(),l=$f(c,u),f=c.sub(l),h=Zi(.5).mul(l.square()).add(u.mul(f));return Gd(h,s,o)}}),Yd=Mi({logLoss_:function(e,t,n,r,o){void 0===r&&(r=1e-7),void 0===o&&(o=jd.SUM_BY_NONZERO_WEIGHTS);var i=_i(e,"labels","logLoss"),a=_i(t,"predictions","logLoss"),s=null;null!=n&&(s=_i(n,"weights","logLoss")),er(i.shape,a.shape,"Error in logLoss: ");var u=Zi(1),c=Zi(r),l=i.mul(a.add(c).log()).neg().sub(u.sub(i).mul(u.sub(a).add(c).log()));return Gd(l,s,o)}}),Qd=Mi({meanSquaredError_:function(e,t,n,r){void 0===r&&(r=jd.SUM_BY_NONZERO_WEIGHTS);var o=_i(e,"labels","meanSquaredError"),i=_i(t,"predictions","meanSquaredError"),a=null;null!=n&&(a=_i(n,"weights","meanSquaredError")),er(o.shape,i.shape,"Error in meanSquaredError: ");var s=o.squaredDifference(i);return Gd(s,a,r)}}),Jd=Mi({sigmoidCrossEntropy_:function(e,t,n,r,o){void 0===r&&(r=0),void 0===o&&(o=jd.SUM_BY_NONZERO_WEIGHTS);var i=_i(e,"multiClassLabels","sigmoidCrossEntropy"),a=_i(t,"logits","sigmoidCrossEntropy"),s=null;if(null!=n&&(s=_i(n,"weights","sigmoidCrossEntropy")),er(i.shape,a.shape,"Error in sigmoidCrossEntropy: "),r>0){var u=Zi(r),c=Zi(1),l=Zi(.5);i=i.mul(c.sub(u)).add(l.mul(u))}var f=function(e,t){var n=_i(e,"labels","sigmoidCrossEntropyWithLogits"),r=_i(t,"logits","sigmoidCrossEntropyWithLogits");er(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");var o=r.relu(),i=r.mul(n),a=r.abs().neg().exp().log1p();return o.sub(i).add(a)}(i,a);return Gd(f,s,o)}}),ep=Mi({softmaxCrossEntropy_:function(e,t,n,r,o){void 0===r&&(r=0),void 0===o&&(o=jd.SUM_BY_NONZERO_WEIGHTS);var i=_i(e,"onehotLabels","softmaxCrossEntropy"),a=_i(t,"logits","softmaxCrossEntropy"),s=null;if(null!=n&&(s=_i(n,"weights","softmaxCrossEntropy")),er(i.shape,a.shape,"Error in softmaxCrossEntropy: "),r>0){var u=Zi(r),c=Zi(1),l=Zi(i.shape[1]);i=i.mul(c.sub(u)).add(u.div(l))}var f=function(e,t,n){if(void 0===n&&(n=-1),-1===n&&(n=t.rank-1),n!==t.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+t.rank+" and dim was "+n);return as((function(e,t,r){var o=t.logSumExp([n],!0),i=t.toFloat().sub(o);return r([e,i]),{value:i.mul(e).neg().sum([n]),gradFunc:function(e,t){var r=t[0],o=t[1],i=Ri(e.shape,[n]);return[e.reshape(i).mul(r.toFloat().sub(o.exp())),e.reshape(i).mul(o.exp().sub(r.toFloat()))]}}}))(e,t)}(i,a);return Gd(f,s,o)}}),tp=Object.freeze({get Reduction(){return jd},absoluteDifference:qd,computeWeightedLoss:Gd,cosineDistance:Kd,hingeLoss:Xd,huberLoss:$d,logLoss:Yd,meanSquaredError:Qd,sigmoidCrossEntropy:Jd,softmaxCrossEntropy:ep});function np(e,t){return void 0===t&&(t=!1),fo.tidy((function(){if(2!==e.shape.length)throw new Error("qr2d() requires a 2D Tensor, but got a "+e.shape.length+"D Tensor.");for(var n=e.shape[0],r=e.shape[1],o=Ea(n),i=e.clone(),a=zi([[1]],[1,1]),s=a.clone(),u=n>=r?r:n,c=function(e){var t,u=i,c=s,l=o;t=fo.tidy((function(){var t=i.slice([e,e],[n-e,1]),u=t.norm(),c=i.slice([e,e],[1,1]),l=zi([[-1]]).where(c.greater(0),zi([[1]])),f=c.sub(l.mul(u)),h=t.div(f);s=1===h.shape[0]?a.clone():a.concat(h.slice([1,0],[h.shape[0]-1,h.shape[1]]),0);var d=l.matMul(f).div(u).neg(),p=i.slice([e,0],[n-e,r]),v=d.mul(s);if(0===e)i=p.sub(v.matMul(s.transpose().matMul(p)));else{var m=p.sub(v.matMul(s.transpose().matMul(p)));i=i.slice([0,0],[e,r]).concat(m,0)}var g=o.slice([0,e],[n,o.shape[1]-e]);if(0===e)o=g.sub(g.matMul(s).matMul(v.transpose()));else{var y=g.sub(g.matMul(s).matMul(v.transpose()));o=o.slice([0,0],[n,e]).concat(y,1)}return[s,i,o]})),s=t[0],i=t[1],o=t[2],bi([u,c,l])},l=0;l<u;++l)c(l);return!t&&n>r&&(o=o.slice([0,0],[n,r]),i=i.slice([0,0],[r,r])),[o,i]}))}var rp=Mi({bandPart_:function(e,t,n){if(t%1!=0)throw new Error("bandPart(): numLower must be an integer, got "+t+".");if(n%1!=0)throw new Error("bandPart(): numUpper must be an integer, got "+n+".");var r=_i(e,"a","bandPart");if(r.rank<2)throw new Error("bandPart(): Rank must be at least 2, got "+r.rank+".");var o=r.shape,i=r.shape.slice(-2),a=i[0],s=i[1];if(!(t<=a))throw new Error("bandPart(): numLower ("+t+") must not be greater than the number of rows ("+a+").");if(!(n<=s))throw new Error("bandPart(): numUpper ("+n+") must not be greater than the number of columns ("+s+").");t<0&&(t=a),n<0&&(n=s);var u=Xi(0,a,1,"int32").reshape([-1,1]),c=Xi(0,s,1,"int32"),l=ih(u,c),f=Pf(l.lessEqual(Zi(+t,"int32")),l.greaterEqual(Zi(-n,"int32"))),h=Gi([a,s],r.dtype);return Ua(Wa(r.reshape([-1,a,s])).map((function(e){return Bf(f,e,h)}))).reshape(o)}}),op=Mi({gramSchmidt_:function(e){var t;if(Array.isArray(e)){t=!1,Jn(null!=e&&e.length>0,(function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"}));for(var n=e[0].shape[0],r=function(t){Jn(e[t].shape[0]===n,(function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+e[t].shape[0]+" vs. "+n+")"}))},o=1;o<e.length;++o)r(o)}else t=!0,e=ra(e,e.shape[0],0).map((function(e){return Ba(e,[0])}));Jn(e.length<=e[0].shape[0],(function(){return"Gram-Schmidt: Number of vectors ("+e.length+") exceeds number of dimensions ("+e[0].shape[0]+")."}));var i=[],a=e,s=function(e){i.push(fo.tidy((function(){var t=a[e];if(e>0)for(var n=0;n<e;++n){var r=dd(i[n].mulStrict(t)).mul(i[n]);t=t.sub(r)}return t.div(_d(t,"euclidean"))})))};for(o=0;o<e.length;++o)s(o);return t?Ua(i,0):i}}),ip=Mi({qr_:function(e,t){if(void 0===t&&(t=!1),e.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+e.rank);if(2===e.rank)return np(e,t);var n=e.shape.slice(0,e.shape.length-2).reduce((function(e,t){return e*t})),r=Wa(e.reshape([n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),o=[],i=[];return r.forEach((function(e){var n=np(e,t),r=n[0],a=n[1];o.push(r),i.push(a)})),[Ua(o,0).reshape(e.shape),Ua(i,0).reshape(e.shape)]}}),ap=Object.freeze({bandPart:rp,gramSchmidt:op,qr:ip});function sp(e,t,n,r,o,i){null==r&&(r=.5),null==o&&(o=Number.NEGATIVE_INFINITY),null==i&&(i=0);var a=e.shape[0];return n=Math.min(n,a),Jn(0<=r&&r<=1,(function(){return"iouThreshold must be in [0, 1], but was '"+r+"'"})),Jn(2===e.rank,(function(){return"boxes must be a 2D tensor, but was of rank '"+e.rank+"'"})),Jn(4===e.shape[1],(function(){return"boxes must have 4 columns, but 2nd dimension was "+e.shape[1]})),Jn(1===t.rank,(function(){return"scores must be a 1D tensor"})),Jn(t.shape[0]===a,(function(){return"scores has incompatible shape with boxes. Expected "+a+", but was "+t.shape[0]})),Jn(0<=i&&i<=1,(function(){return"softNmsSigma must be in [0, 1], but was '"+i+"'"})),{maxOutputSize:n,iouThreshold:r,scoreThreshold:o,softNmsSigma:i}}var up=Mi({resizeBilinear_:function(e,t,n){void 0===n&&(n=!1);var r=_i(e,"images","resizeBilinear");Jn(3===r.rank||4===r.rank,(function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."})),Jn(2===t.length,(function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+t+"."}));var o=r,i=!1;3===r.rank&&(i=!0,o=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var a=t[0],s=t[1],u=fo.runKernelFunc((function(e,t){return t([o]),e.resizeBilinear(o,a,s,n)}),{x:o},(function(e,t){return{x:function(){return fo.runKernelFunc((function(r){return r.resizeBilinearBackprop(e,t[0],n)}),{})}}}),"ResizeBilinear",{alignCorners:n,newHeight:a,newWidth:s});return i?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),cp=Mi({resizeNearestNeighbor_:function(e,t,n){void 0===n&&(n=!1);var r=_i(e,"images","resizeNearestNeighbor");Jn(3===r.rank||4===r.rank,(function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."})),Jn(2===t.length,(function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+t+"."})),Jn("float32"===r.dtype||"int32"===r.dtype,(function(){return"`images` must have `int32` or `float32` as dtype"}));var o=r,i=!1;3===r.rank&&(i=!0,o=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var a=t[0],s=t[1],u=fo.runKernelFunc((function(e,t){return t([o]),e.resizeNearestNeighbor(o,a,s,n)}),{batchImages:o},(function(e,t){return{batchImages:function(){return fo.runKernelFunc((function(r){return r.resizeNearestNeighborBackprop(e,t[0],n)}),{})}}}));return i?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),lp=Mi({nonMaxSuppression_:function(e,t,n,r,o){void 0===r&&(r=.5),void 0===o&&(o=Number.NEGATIVE_INFINITY);var i=_i(e,"boxes","nonMaxSuppression"),a=_i(t,"scores","nonMaxSuppression"),s=sp(i,a,n,r,o);n=s.maxOutputSize,r=s.iouThreshold,o=s.scoreThreshold;var u={maxOutputSize:n,iouThreshold:r,scoreThreshold:o};return fo.runKernelFunc((function(e){return e.nonMaxSuppression(i,a,n,r,o)}),{boxes:i,scores:a},null,"NonMaxSuppressionV3",u)}}),fp=Mi({nonMaxSuppressionWithScore_:function(e,t,n,r,o,i){void 0===r&&(r=.5),void 0===o&&(o=Number.NEGATIVE_INFINITY),void 0===i&&(i=0);var a=_i(e,"boxes","nonMaxSuppression"),s=_i(t,"scores","nonMaxSuppression"),u=sp(a,s,n,r,o,i),c={maxOutputSize:n=u.maxOutputSize,iouThreshold:r=u.iouThreshold,scoreThreshold:o=u.scoreThreshold,softNmsSigma:i=u.softNmsSigma},l=fo.runKernel("NonMaxSuppressionV5",{boxes:a,scores:s},c);return{selectedIndices:l[0],selectedScores:l[1]}}}),hp=Mi({cropAndResize_:function(e,t,n,r,o,i){var a=_i(e,"image","cropAndResize"),s=_i(t,"boxes","cropAndResize","float32"),u=_i(n,"boxInd","cropAndResize","int32");o=o||"bilinear",i=i||0;var c=s.shape[0];return Jn(4===a.rank,(function(){return"Error in cropAndResize: image must be rank 4,but got rank "+a.rank+"."})),Jn(2===s.rank&&4===s.shape[1],(function(){return"Error in cropAndResize: boxes must be have size ["+c+",4] but had shape "+s.shape+"."})),Jn(1===u.rank&&u.shape[0]===c,(function(){return"Error in cropAndResize: boxInd must be have size ["+c+"] but had shape "+s.shape+"."})),Jn(2===r.length,(function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."})),Jn(r[0]>=1&&r[1]>=1,(function(){return"cropSize must be atleast [1,1], but was "+r})),Jn("bilinear"===o||"nearest"===o,(function(){return"method must be bilinear or nearest, but was "+o})),fo.runKernelFunc((function(e,t){return e.cropAndResize(a,s,u,r,o,i)}),{images:a,boxes:s,boxInd:u},null,"CropAndResize",{method:o,extrapolationValue:i,cropSize:r})}}),dp=Object.freeze({resizeBilinear:up,resizeNearestNeighbor:cp,nonMaxSuppression:lp,nonMaxSuppressionAsync:function(e,t,n,r,o){return void 0===r&&(r=.5),void 0===o&&(o=Number.NEGATIVE_INFINITY),Ln(this,void 0,void 0,(function(){var i,a,s,u,c,l,f;return Bn(this,(function(h){switch(h.label){case 0:return i=_i(e,"boxes","nonMaxSuppressionAsync"),a=_i(t,"scores","nonMaxSuppressionAsync"),s=sp(i,a,n,r,o),n=s.maxOutputSize,r=s.iouThreshold,o=s.scoreThreshold,[4,Promise.all([i.data(),a.data()])];case 1:return u=h.sent(),c=u[0],l=u[1],f=Fs(c,l,n,r,o),i!==e&&i.dispose(),a!==t&&a.dispose(),[2,f]}}))}))},nonMaxSuppressionWithScore:fp,nonMaxSuppressionWithScoreAsync:function(e,t,n,r,o,i){return void 0===r&&(r=.5),void 0===o&&(o=Number.NEGATIVE_INFINITY),void 0===i&&(i=0),Ln(this,void 0,void 0,(function(){var a,s,u,c,l,f,h;return Bn(this,(function(d){switch(d.label){case 0:return a=_i(e,"boxes","nonMaxSuppressionAsync"),s=_i(t,"scores","nonMaxSuppressionAsync"),u=sp(a,s,n,r,o,i),n=u.maxOutputSize,r=u.iouThreshold,o=u.scoreThreshold,i=u.softNmsSigma,[4,Promise.all([a.data(),s.data()])];case 1:return c=d.sent(),l=c[0],f=c[1],h=Ls(l,f,n,r,o,i),a!==e&&a.dispose(),s!==t&&s.dispose(),[2,h]}}))}))},cropAndResize:hp}),pp=function(e,t){return!(e>0)||"linear"===t},vp=function(e,t,n){if(null==n||"linear"===n)return e;if("relu"===n)return e.mul(t.step());throw new Error("Gradient for activation "+n+" has not been implemented yet.")},mp=function(e,t){var n=t,r=ds(e.shape,t.shape);return r.length>0&&(n=n.sum(r)),n.reshape(e.shape)},gp=function(e,t,n){if("linear"===t)return e;if("relu"===t)return yd(e);if("elu"===t)return vd(e);if("relu6"===t)return bd(e);if("prelu"===t)return gd(e,n);throw new Error("Unknown fused activation "+t+".")},yp=Mi({fusedMatMul_:function(e){var t,n=e.a,r=e.b,o=e.transposeA,i=void 0!==o&&o,a=e.transposeB,s=void 0!==a&&a,u=e.bias,c=e.activation,l=void 0===c?"linear":c,f=e.preluActivationWeights;if(!1===pp(fo.state.gradientDepth,l)){var h=Lh(n,r,i,s);return null!=u&&(h=jf(h,u)),gp(h,l,f)}var d=_i(n,"a","fused matMul"),p=_i(r,"b","fused matMul");t=io(d,p),d=t[0],p=t[1];var v=i?d.shape[d.rank-2]:d.shape[d.rank-1],m=s?p.shape[p.rank-1]:p.shape[p.rank-2],g=i?d.shape[d.rank-1]:d.shape[d.rank-2],y=s?p.shape[p.rank-2]:p.shape[p.rank-1],b=d.shape.slice(0,-2),w=p.shape.slice(0,-2),x=rr(b),k=rr(w);Jn(d.rank>=2&&p.rank>=2&&d.rank===p.rank,(function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+d.rank+" and "+p.rank+"."})),Jn(or(b,w),(function(){return"Error in fused matMul: outer dimensions ("+b+") and ("+w+") of Tensors with shapes "+d.shape+" and "+p.shape+" must match."})),Jn(v===m,(function(){return"Error in fused matMul: inner shapes ("+v+") and ("+m+") of Tensors with shapes "+d.shape+" and "+p.shape+" and transposeA="+i+" and transposeB="+s+" must match."}));var _,E,C=d.shape.slice(0,-2).concat([g,y]),S=i?d.as3D(x,v,g):d.as3D(x,g,v),I=s?p.as3D(k,y,m):p.as3D(k,m,y);null!=u&&ps(C,(_=io(_=_i(u,"bias","fused matMul"),d)[0]).shape),null!=f&&(E=_i(f,"prelu weights","fused matMul"));var R={a:S,b:I};null!=u&&(R.bias=_),null!=f&&(R.preluActivationWeights=E);var T=[S,I];return fo.runKernelFunc((function(e,t){var n=e.fusedBatchMatMul({a:S,b:I,transposeA:i,transposeB:s,bias:_,activation:l,preluActivationWeights:E});return t([S,I,n]),n}),R,(function(e,t){var n=t[0],r=t[1],o=t[2],a=vp(e,o,l),c={};return null!=u&&(c={bias:function(){return mp(_,a)}}),i||s?!i&&s?Object.assign({a:function(){return a.matMul(r,!1,!1)},b:function(){return a.matMul(n,!0,!1)}},c):i&&!s?Object.assign({a:function(){return r.matMul(a,!1,!0)},b:function(){return n.matMul(a,!1,!1)}},c):Object.assign({a:function(){return r.matMul(a,!0,!0)},b:function(){return a.matMul(n,!0,!0)}},c):Object.assign({a:function(){return a.matMul(r,!1,!0)},b:function(){return n.matMul(a,!0,!1)}},c)}),"_FusedMatMul",{transposeA:i,transposeB:s,activation:l},T,[!0]).reshape(C)}}),bp=Mi({fusedConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,o=e.pad,i=e.dataFormat,a=void 0===i?"NHWC":i,s=e.dilations,u=void 0===s?[1,1]:s,c=e.dimRoundingMode,l=e.bias,f=e.activation,h=void 0===f?"linear":f,d=e.preluActivationWeights;if(h=h||"linear",!1===pp(fo.state.gradientDepth,h)){var p=Ih(t,n,r,o,a,u,c);return null!=l&&(p=jf(p,l)),gp(p,h,d)}var v=_i(t,"x","conv2d"),m=_i(n,"filter","conv2d"),g=v,y=!1;3===v.rank&&(y=!0,g=v.as4D(1,v.shape[0],v.shape[1],v.shape[2])),Jn(4===g.rank,(function(){return"Error in fused conv2d: input must be rank 4, but got rank "+g.rank+"."})),Jn(4===m.rank,(function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+m.rank+"."})),null!=c&&Jn(ir(o),(function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+c+" but got pad "+o+"."})),Jn(g.shape[3]===m.shape[2],(function(){return"Error in conv2d: depth of input ("+g.shape[3]+") must match input depth for filter "+m.shape[2]+"."})),Jn(Cs(r,u),(function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"})),Jn("NHWC"===a,(function(){return"Error in conv2d: got dataFormat of "+a+" but only NHWC is currently supported."}));var b,w,x=gs(g.shape,m.shape,r,u,o,c);null!=l&&(b=io(b=_i(l,"bias","fused conv2d"),v)[0],ps(x.outShape,b.shape)),null!=d&&(w=_i(d,"prelu weights","fused conv2d"));var k={x:g,filter:m};null!=l&&(k.bias=b),null!=d&&(k.preluActivationWeights=w);var _=[m,g],E=fo.runKernelFunc((function(e,t){var n=e.fusedConv2d({input:g,filter:m,convInfo:x,bias:b,activation:h,preluActivationWeights:w});return t([m,g,n]),n}),k,(function(e,t){var n=t,i=n[0],a=n[1],s=n[2],c=vp(e,s,h);Jn(Es(u),(function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+u+"'"}));var f={};return null!=l&&(f={bias:function(){return mp(b,c)}}),Object.assign({x:function(){return Ah(a.shape,c,i,r,o)},filter:function(){return Th(a,c,i.shape,r,o)}},f)}),"FusedConv2D",{convInfo:x,activation:h},_,[!0]);return y?E.as3D(E.shape[1],E.shape[2],E.shape[3]):E}}),wp=Mi({fusedDepthwiseConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,o=e.pad,i=e.dataFormat,a=void 0===i?"NHWC":i,s=e.dilations,u=void 0===s?[1,1]:s,c=e.dimRoundingMode,l=e.bias,f=e.activation,h=void 0===f?"linear":f,d=e.preluActivationWeights;if(!1===pp(fo.state.gradientDepth,h)){var p=Nh(t,n,r,o,a,u,c);return null!=l&&(p=jf(p,l)),gp(p,h,d)}var v=_i(t,"x","depthwiseConv2d"),m=_i(n,"filter","depthwiseConv2d"),g=v,y=!1;3===v.rank&&(y=!0,g=v.as4D(1,v.shape[0],v.shape[1],v.shape[2])),Jn(4===g.rank,(function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+g.rank+"."})),Jn(4===m.rank,(function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+m.rank+"."})),Jn(g.shape[3]===m.shape[2],(function(){return"Error in fused depthwiseConv2d: number of input channels ("+g.shape[3]+") must match the inChannels dimension in filter "+m.shape[2]+"."})),null==u&&(u=[1,1]),Jn(Cs(r,u),(function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"})),null!=c&&Jn(ir(o),(function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+c+" but got pad "+o+"."}));var b,w,x=gs(g.shape,m.shape,r,u,o,c,!0);null!=l&&(b=io(b=_i(l,"bias","fused conv2d"),v)[0],ps(x.outShape,b.shape)),null!=d&&(w=_i(d,"prelu weights","fused depthwiseConv2d"));var k={x:g,filter:m};null!=l&&(k.bias=b),null!=d&&(k.preluActivationWeights=w);var _=[m,g],E=fo.runKernelFunc((function(e,t){var n=e.fusedDepthwiseConv2D({input:g,filter:m,convInfo:x,bias:b,activation:h,preluActivationWeights:w});return t([m,g,n]),n}),k,(function(e,t){Jn(Es(u),(function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+u+"'"}));var n=t[0],r=t[1],o=t[2],i=vp(e,o,h),a={};return null!=l&&(a={bias:function(){return mp(b,i)}}),Object.assign({x:function(){return Oh(r.shape,i,n,x)},filter:function(){return Dh(r,i,n.shape,x)}},a)}),"FusedDepthwiseConv2D",{convInfo:x,activation:h},_,[!0]);return y?E.as3D(E.shape[1],E.shape[2],E.shape[3]):E}}),xp=Object.freeze({matMul:yp,conv2d:bp,depthwiseConv2d:wp}),kp=Object.freeze({image:dp,linalg:ap,losses:tp,spectral:Pd,fused:xp,signal:Hd,square:Fl,squaredDifference:Bl,conv1d:Sh,conv2d:Ih,conv3d:Rh,depthwiseConv2d:Nh,separableConv2d:Ph,conv2dTranspose:Mh,conv3dTranspose:Fh,op:Mi,batchNormalization2d:Sf,batchNormalization3d:If,batchNormalization4d:Rf,batchNormalization:Tf,batchNorm:Af,batchNorm2d:Nf,batchNorm3d:Of,batchNorm4d:Df,booleanMaskAsync:function(e,t,n){return Ln(this,void 0,void 0,(function(){var r,o,i,a,s,u,c,l,f,h,d,p,v;return Bn(this,(function(m){switch(m.label){case 0:for(r=_i(e,"tensor","boolMask"),o=_i(t,"mask","boolMask","bool"),i=null==n?0:n,a=o.rank,s=r.shape,Jn(a>0,(function(){return"mask cannot be scalar"})),er(s.slice(i,i+a),o.shape,"mask's shape must match the first K dimensions of tensor's shape,"),u=1,c=i;c<i+a;c++)u*=s[c];return l=s.slice(0,i).concat([u],s.slice(i+a)),f=r.reshape(l),h=o.reshape([-1]),[4,Uf(h)];case 1:return d=m.sent(),p=d.squeeze([1]),v=xh(f,p,i),e!==r&&r.dispose(),t!==o&&o.dispose(),p.dispose(),f.dispose(),h.dispose(),d.dispose(),[2,v]}}))}))},complex:Fi,real:Li,imag:Bi,concat:Qi,concat1d:Ji,concat2d:ea,concat3d:ta,concat4d:na,split:ra,matMul:Lh,dot:Bh,outerProduct:Uh,reverse:jh,reverse1d:Zh,reverse2d:Wh,reverse3d:zh,reverse4d:Vh,maxPool:Gh,avgPool:Kh,pool:Xh,maxPool3d:$h,avgPool3d:Yh,slice:Qh,slice1d:Jh,slice2d:ed,slice3d:td,slice4d:nd,abs:Ul,acos:jl,acosh:Zl,asin:Wl,asinh:zl,atan:Vl,atanh:Hl,ceil:ql,clipByValue:Gl,cos:Kl,cosh:Xl,erf:$l,exp:Yl,expm1:Ql,floor:Jl,log:ef,log1p:tf,logSigmoid:nf,neg:rf,reciprocal:of,round:af,rsqrt:sf,sigmoid:uf,sign:cf,isNaN:lf,isInf:ff,isFinite:hf,sin:df,sinh:pf,softplus:vf,sqrt:mf,step:gf,tan:yf,tanh:bf,all:od,any:id,argMax:ad,argMin:sd,logSumExp:ud,max:cd,mean:ld,min:fd,moments:hd,sum:dd,prod:pd,equal:sh,equalStrict:uh,greater:ch,greaterEqual:lh,greaterEqualStrict:fh,greaterStrict:hh,less:dh,lessEqual:ph,lessEqualStrict:vh,lessStrict:mh,notEqual:gh,notEqualStrict:yh,add:jf,addN:Zf,addStrict:Wf,atan2:zf,div:Vf,divNoNan:Hf,divStrict:qf,floorDiv:Gf,maximum:Kf,maximumStrict:Xf,minimum:$f,minimumStrict:Yf,mod:Qf,modStrict:Jf,mul:eh,mulStrict:th,pow:nh,powStrict:rh,squaredDifferenceStrict:oh,sub:ih,subStrict:ah,elu:vd,leakyRelu:md,prelu:gd,relu:yd,relu6:bd,selu:wd,logicalAnd:Pf,logicalNot:Mf,logicalOr:Ff,logicalXor:Lf,where:Bf,whereAsync:Uf,buffer:ma,print:function(e,t){void 0===t&&(t=!1),console.log(e.toString(t))},batchToSpaceND:ga,broadcastTo:ya,cast:ba,clone:wa,cumsum:xa,depthToSpace:ka,expandDims:_a,eye:Ea,multinomial:Ca,oneHot:Sa,pad:Ia,pad1d:Ra,pad2d:Ta,pad3d:Aa,pad4d:Na,rand:Oa,randomNormal:Da,randomGamma:Pa,randomUniform:Ma,reshape:Fa,spaceToBatchND:La,squeeze:Ba,stack:Ua,tile:ja,truncatedNormal:Za,unstack:Wa,setdiff1dAsync:function(e,t){return Ln(this,void 0,void 0,(function(){var n,r,o,i,a,s,u,c,l,f;return Bn(this,(function(h){switch(h.label){case 0:return n=_i(e,"x","setdiff1d"),r=_i(t,"y","setdiff1d"),Jn(n.dtype===r.dtype,(function(){return"x and y should have the same dtype, but got x ("+n.dtype+") and y ("+r.dtype+")."})),Jn(1===n.rank,(function(){return"x should be 1D tensor, but got x ("+n.shape+")."})),Jn(1===r.rank,(function(){return"y should be 1D tensor, but got y ("+r.shape+")."})),[4,n.data()];case 1:return o=h.sent(),[4,r.data()];case 2:for(i=h.sent(),a=new Set(i),s=0,l=0;l<o.length;l++)a.has(o[l])||s++;for(u=new Vr([s],n.dtype),c=new Vr([s],"int32"),l=0,f=0;l<o.length;l++)a.has(o[l])||(u.values[f]=o[l],c.values[f]=l,f++);return[2,[u.toTensor(),c.toTensor()]]}}))}))},fill:Ki,linspace:function(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");return fo.runKernelFunc((function(r){return r.linspace(e,t,n)}),{})},ones:qi,range:Xi,scalar:Zi,tensor:Ui,tensor1d:Wi,tensor2d:zi,tensor3d:Vi,tensor4d:Hi,tensor5d:function(e,t,n){if(tr(e),null!=t&&5!==t.length)throw new Error("tensor5d() requires shape to have five numbers");var r=xi(e,n);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return ji(e,t,r,n)},tensor6d:function(e,t,n){if(tr(e),null!=t&&6!==t.length)throw new Error("tensor6d() requires shape to have six numbers");var r=xi(e,n);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return ji(e,t=t||r,r,n)},variable:function(e,t,n,r){return void 0===t&&(t=!0),fo.makeVariable(e,t,n,r)},zeros:Gi,onesLike:$i,zerosLike:Yi,transpose:xd,softmax:ss,logSoftmax:us,localResponseNormalization:kd,norm:_d,gather:xh,unsortedSegmentSum:kh,basicLSTMCell:Ed,multiRNNCell:Cd,movingAverage:Sd,stridedSlice:Id,topk:Rd,scatterND:Td,fft:Ad,ifft:Nd,rfft:Od,irfft:Dd,sparseToDense:Md,gatherND:Fd,diag:Ld,dropout:Bd,hannWindow:Zd,hammingWindow:Wd,frame:zd,stft:Vd,inTopKAsync:function(e,t,n){return void 0===n&&(n=1),Ln(this,void 0,void 0,(function(){var r,o,i,a,s,u,c,l,f,h,d,p,v,m;return Bn(this,(function(g){switch(g.label){case 0:return r=_i(e,"predictions","inTopK"),o=_i(t,"targets","inTopK"),Jn(r.rank>1,(function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+r.rank})),Jn(r.rank-1===o.rank,(function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+r.rank+" and targets rank "+o.rank})),er(r.shape.slice(0,r.shape.length-1),o.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),i=r.shape[r.shape.length-1],Jn(n>0&&n<=i,(function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+i+"), but got "+n})),[4,r.data()];case 1:return a=g.sent(),[4,o.data()];case 2:for(s=g.sent(),u=[a.length/i,i],l=u[1],f=dr("bool",c=u[0]),h=0;h<c;h++){for(d=h*l,p=a.subarray(d,d+l),v=[],m=0;m<p.length;m++)v.push({value:p[m],index:m});for(v.sort((function(e,t){return t.value-e.value})),f[h]=0,m=0;m<n;m++)if(v[m].index===s[h]){f[h]=1;break}}return e!==r&&r.dispose(),t!==o&&o.dispose(),[2,Ui(f,o.shape,"bool")]}}))}))}});function _p(e,t){Array.isArray(e)||(e=[e]),e.forEach((function(e){null!=e&&Jn("complex64"!==e.dtype,(function(){return t+" does not support complex64 tensors."}))}))}function Ep(e,t,n,r){if("linear"===n)return e.linear(t);if("relu"===n)return e.relu(t);if("elu"===n)return e.elu(t);if("relu6"===n)return e.relu6(t);if("prelu"===n)return e.prelu(t,r);throw new Error("Activation "+n+" has not been implemented for the CPU backend.")}var Cp=function(e){function t(){var t=e.call(this)||this;return t.blockSize=48,t.firstUse=!0,t.data=new cs(t,fo),t}return Fn(t,e),t.prototype.write=function(e,t,n){this.firstUse&&(this.firstUse=!1,jn().get("IS_NODE")&&wi("\n============================\nHi there \ud83d\udc4b. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.\n============================"));var r={};return this.data.set(r,{values:e,dtype:n}),r},t.prototype.move=function(e,t,n,r){this.data.set(e,{values:t,dtype:r})},t.prototype.numDataIds=function(){return this.data.numDataIds()},t.prototype.read=function(e){return Ln(this,void 0,void 0,(function(){return Bn(this,(function(t){return[2,this.readSync(e)]}))}))},t.prototype.readSync=function(e){var t=this.data.get(e),n=t.dtype,r=t.complexTensors;return"complex64"===n?As(this.readSync(r.real.dataId),this.readSync(r.imag.dataId)):this.data.get(e).values},t.prototype.bufferSync=function(e){var t=this.readSync(e.dataId),n=t;if("string"===e.dtype)try{n=t.map((function(e){return Mr(e)}))}catch(e){throw new Error("Failed to decode encoded string bytes into utf-8")}return ma(e.shape,e.dtype,n)},t.prototype.makeOutput=function(e,t,n){var r=this.write(e,t,n);return fo.makeTensorFromDataId(r,t,n,this)},t.prototype.disposeData=function(e){if(this.data.has(e)){var t=this.data.get(e).complexTensors;null!=t&&(t.real.dispose(),t.imag.dispose()),this.data.delete(e)}},t.prototype.time=function(e){return Ln(this,void 0,void 0,(function(){var t;return Bn(this,(function(n){return t=Or(),e(),[2,{kernelMs:Or()-t}]}))}))},t.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},t.prototype.complex=function(e,t){var n=this.makeOutput(null,e.shape,"complex64");return this.data.get(n.dataId).complexTensors={real:fo.keep(e.clone()),imag:fo.keep(t.clone())},n},t.prototype.real=function(e){return this.data.get(e.dataId).complexTensors.real.clone()},t.prototype.imag=function(e){return this.data.get(e.dataId).complexTensors.imag.clone()},t.prototype.slice=function(e,t,n){if(_p(e,"slice"),os(e.shape,t,n)){var r=is(t,e.strides),o=rr(n);return Ui(this.readSync(e.dataId).subarray(r,r+o),n,e.dtype)}for(var i=ma(n,e.dtype),a=this.bufferSync(e),s=0;s<i.size;++s){var u=i.indexToLoc(s).map((function(e,n){return e+t[n]}));i.values[s]=a.get.apply(a,u)}return i.toTensor()},t.prototype.stridedSlice=function(e,t,n,r){_p(e,"stridedSlice");var o=ts(t,n,r);if(o.some((function(e){return 0===e})))return Ui([],o);for(var i=ma(o,e.dtype),a=this.bufferSync(e),s=0;s<i.size;s++){for(var u=i.indexToLoc(s),c=new Array(u.length),l=0;l<c.length;l++)c[l]=u[l]*r[l]+t[l];i.set.apply(i,[a.get.apply(a,c)].concat(u))}return i.toTensor()},t.prototype.diag=function(e){for(var t=this.readSync(e.dataId),n=ma([e.size,e.size],e.dtype),r=n.values,o=0;o<t.length;o++)r[o*e.size+o]=t[o];return n.toTensor()},t.prototype.unstack=function(e,t){for(var n=e.shape[t],r=new Array(e.rank-1),o=0,i=0;i<e.rank;i++)i!==t&&(r[o++]=e.shape[i]);var a=new Array(e.rank).fill(0),s=e.shape.slice();s[t]=1;var u=new Array(n);for(i=0;i<u.length;i++)a[t]=i,u[i]=this.slice(e,a,s).reshape(r);return u},t.prototype.reverse=function(e,t){_p(e,"reverse");for(var n=ma(e.shape,e.dtype),r=this.bufferSync(e),o=function(o){var i=n.indexToLoc(o),a=i.slice();t.forEach((function(t){return a[t]=e.shape[t]-1-a[t]})),n.set.apply(n,[r.get.apply(r,a)].concat(i))},i=0;i<n.size;i++)o(i);return n.toTensor()},t.prototype.concat=function(e,t){var n=this;if("complex64"===e[0].dtype){var r=e.map((function(e){return Li(e)})),o=e.map((function(e){return Bi(e)}));return Fi(this.concat(r,t),this.concat(o,t))}var i=e.map((function(e){var n=rr(e.shape.slice(t));return e.as2D(-1,n)})),a=Pi(i.map((function(e){return e.shape})),1),s=ma(a,e[0].dtype).values;if(1===i[0].shape[0]){var u=0;i.forEach((function(e){s.set(n.readSync(e.dataId),u),u+=e.size}))}else{var c=0;i.forEach((function(e){for(var t=n.readSync(e.dataId),r=0,o=0;o<e.shape[0];++o)for(var i=o*a[1]+c,u=0;u<e.shape[1];++u)s[i+u]=t[r++];c+=e.shape[1]}))}var l=Pi(e.map((function(e){return e.shape})),t);return Ui(s,l,e[0].dtype)},t.prototype.neg=function(e){return _p(e,"neg"),this.multiply(Zi(-1),e)},t.prototype.add=function(e,t){return"complex64"===e.dtype||"complex64"===t.dtype?this.broadcastedBinaryComplexOp(e.cast("complex64"),t.cast("complex64"),(function(e,t,n,r){return{real:e+n,imag:t+r}})):this.broadcastedBinaryOp(e,t,ro(e.dtype,t.dtype),(function(e,t){return e+t}))},t.prototype.addN=function(e){var t=this;_p(e,"addN");for(var n=e.map((function(e){return t.readSync(e.dataId)})),r=ma(e[0].shape,e[0].dtype),o=r.values,i=0;i<e.length;i++)for(var a=n[i],s=0;s<o.length;s++)o[s]+=a[s];return r.toTensor()},t.prototype.softmax=function(e,t){var n=fr([t],e.shape),r=this.max(e,n),o=Ri(r.shape,n),i=this.subtract(e,r.reshape(o)),a=this.exp(i),s=this.sum(a,n).reshape(o);return this.realDivide(a,s)},t.prototype.subtract=function(e,t){return"complex64"===e.dtype||"complex64"===t.dtype?this.broadcastedBinaryComplexOp(e.cast("complex64"),t.cast("complex64"),(function(e,t,n,r){return{real:e-n,imag:t-r}})):this.broadcastedBinaryOp(e,t,ro(e.dtype,t.dtype),(function(e,t){return e-t}))},t.prototype.pow=function(e,t){return _p([e,t],"pow"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){return Math.pow(e,t)}))},t.prototype.batchMatMul=function(e,t,n,r){_p([e,t],"matMul");for(var o=n?e.shape[1]:e.shape[2],i=n?e.shape[2]:e.shape[1],a=r?t.shape[1]:t.shape[2],s=e.shape[0],u=this.readSync(e.dataId),c=this.readSync(t.dataId),l=n?[e.strides[0],1,e.strides[1]]:[e.strides[0],e.strides[1],1],f=l[0],h=l[1],d=l[2],p=r?[1,t.strides[1],t.strides[0]]:[t.strides[1],1,t.strides[0]],v=p[0],m=p[1],g=p[2],y=i*a,b=ma([s,i,a],e.dtype),w=b.values,x=this.blockSize,k=0;k<s;k++)for(var _=0;_<i;_+=x)for(var E=0;E<a;E+=x)for(var C=0;C<o;C+=x)for(var S=Math.min(_+x,i),I=Math.min(E+x,a),R=Math.min(C+x,o),T=_;T<S;T++)for(var A=E;A<I;A++){for(var N=0,O=C;O<R;O++)N+=u[k*f+T*h+O*d]*c[O*v+A*m+k*g];w[k*y+(T*a+A)]+=N}return b.toTensor()},t.prototype.fusedBatchMatMul=function(e){var t=e.a,n=e.b,r=e.transposeA,o=e.transposeB,i=e.bias,a=e.activation,s=e.preluActivationWeights,u=this.batchMatMul(t,n,r,o);return i&&(u=this.add(u,i)),a&&(u=Ep(this,u,a,s)),u},t.prototype.multiply=function(e,t){return"complex64"===e.dtype||"complex64"===t.dtype?this.broadcastedBinaryComplexOp(e.cast("complex64"),t.cast("complex64"),(function(e,t,n,r){return{real:e*n-t*r,imag:e*r+t*n}})):this.broadcastedBinaryOp(e,t,ro(e.dtype,t.dtype),(function(e,t){return e*t}))},t.prototype.realDivide=function(e,t){return _p([e,t],"realDivide"),this.broadcastedBinaryOp(e,t,"float32",(function(e,t){return e/t}))},t.prototype.floorDiv=function(e,t){return _p([e,t],"floorDiv"),this.broadcastedBinaryOp(e,t,"int32",(function(e,t){return Math.floor(e/t)}))},t.prototype.sum=function(e,t){_p(e,"sum"),Ti("sum",t,e.rank);for(var n=Ii(e.shape,t),r=n[0],o=n[1],i=Gi(r,ro(e.dtype,"int32")),a=rr(o),s=this.readSync(i.dataId),u=this.readSync(e.dataId),c=0;c<s.length;++c){for(var l=c*a,f=0,h=0;h<a;++h)f+=u[l+h];s[c]=f}return i},t.prototype.prod=function(e,t){_p(e,"sum");for(var n=Ii(e.shape,t),r=n[0],o=n[1],i=Gi(r,ro(e.dtype,"int32")),a=rr(o),s=this.readSync(i.dataId),u=this.readSync(e.dataId),c=0;c<s.length;++c){for(var l=c*a,f=1,h=0;h<a;++h)f*=u[l+h];s[c]=f}return i},t.prototype.unsortedSegmentSum=function(e,t,n){_p(e,"unsortedSegmentSum");for(var r=[],o=e.rank-t.rank,i=0;i<o;++i)t=t.expandDims(i+1);for(i=0;i<n;++i){var a=Zi(i,"int32"),s=sh(a,t).asType("float32").mul(e).sum(0);r.push(s)}return Ua(r)},t.prototype.argMin=function(e,t){_p(e,"argMin");var n=[t];Ti("argMin",n,e.rank);for(var r=Ii(e.shape,n),o=r[0],i=r[1],a=Gi(o,"int32"),s=rr(i),u=this.readSync(a.dataId),c=this.readSync(e.dataId),l=0;l<u.length;++l){for(var f=l*s,h=c[f],d=0,p=0;p<s;++p){var v=c[f+p];v<h&&(h=v,d=p)}u[l]=d}return a},t.prototype.argMax=function(e,t){_p(e,"argMax");var n=[t];Ti("argMax",n,e.rank);for(var r=Ii(e.shape,n),o=r[0],i=r[1],a=Gi(o,"int32"),s=rr(i),u=this.readSync(a.dataId),c=this.readSync(e.dataId),l=0;l<u.length;++l){for(var f=l*s,h=c[f],d=0,p=0;p<s;++p){var v=c[f+p];v>h&&(h=v,d=p)}u[l]=d}return a},t.prototype.cumsum=function(e,t,n,r){if(_p(e,"cumsum"),t!==e.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(e.rank-1)+" but got axis="+t);for(var o=ro(e.dtype,"int32"),i=Gi(e.shape,o),a=this.readSync(i.dataId),s=this.readSync(e.dataId),u=e.shape[e.rank-1],c=r?function(e,t){return e+u-t-1}:function(e,t){return e+t},l=0;l<s.length;l+=u)for(var f=0;f<u;f++){var h=c(l,f);if(0===f)a[h]=n?0:s[h];else{var d=c(l,f-1);a[h]=n?s[d]+a[d]:s[h]+a[d]}}return i},t.prototype.equal=function(e,t){return _p([e,t],"equal"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e===t?1:0}))},t.prototype.notEqual=function(e,t){return _p([e,t],"notEqual"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e!==t?1:0}))},t.prototype.less=function(e,t){return _p([e,t],"less"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e<t?1:0}))},t.prototype.lessEqual=function(e,t){return _p([e,t],"lessEqual"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e<=t?1:0}))},t.prototype.greater=function(e,t){return _p([e,t],"greater"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e>t?1:0}))},t.prototype.greaterEqual=function(e,t){return _p([e,t],"greaterEqual"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e>=t?1:0}))},t.prototype.logicalNot=function(e){_p(e,"logicalNot");for(var t=this.readSync(e.dataId),n=new Uint8Array(t.length),r=0;r<t.length;++r)n[r]=t[r]?0:1;return this.makeOutput(n,e.shape,"bool")},t.prototype.logicalAnd=function(e,t){return _p([e,t],"logicalAnd"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e&&t}))},t.prototype.logicalOr=function(e,t){return _p([e,t],"logicalOr"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e||t}))},t.prototype.select=function(e,t,n){_p([e,t,n],"select");for(var r=this.readSync(e.dataId),o=this.readSync(t.dataId),i=this.readSync(n.dataId),a=Gi(t.shape,ro(t.dtype,n.dtype)),s=this.readSync(a.dataId),u=0,c=0===e.rank||e.rank>1||1===t.rank?1:rr(t.shape.slice(1)),l=0;l<r.length;l++)for(var f=0;f<c;f++)1===r[l]?s[u++]=o[l]:s[u++]=i[l];return a},t.prototype.where=function(e){_p([e],"where");var t=this.readSync(e.dataId);return Hs(e.shape,t)},t.prototype.topk=function(e,t,n){return _p(e,"topk"),Vs(this.readSync(e.dataId),e.shape,e.dtype,t)},t.prototype.min=function(e,t){_p(e,"min"),Ti("min",t,e.rank);for(var n=Ii(e.shape,t),r=n[0],o=n[1],i=Gi(r,e.dtype),a=rr(o),s=this.readSync(i.dataId),u=this.readSync(e.dataId),c=0;c<s.length;++c){for(var l=c*a,f=u[l],h=0;h<a;++h){var d=u[l+h];d<f&&(f=d)}s[c]=f}return i},t.prototype.minimum=function(e,t){return _p([e,t],"minimum"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){return Math.min(e,t)}))},t.prototype.mod=function(e,t){return _p([e,t],"mod"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){var n=e%t;return e<0&&t<0||e>=0&&t>=0?n:(n+t)%t}))},t.prototype.max=function(e,t){_p(e,"max"),Ti("max",t,e.rank);for(var n=Ii(e.shape,t),r=n[0],o=n[1],i=Gi(r,e.dtype),a=rr(o),s=this.readSync(i.dataId),u=this.readSync(e.dataId),c=0;c<s.length;++c){for(var l=c*a,f=u[l],h=0;h<a;++h){var d=u[l+h];d>f&&(f=d)}s[c]=f}return i},t.prototype.maximum=function(e,t){return _p([e,t],"maximum"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){return Math.max(e,t)}))},t.prototype.all=function(e,t){_p(e,"all"),Ti("all",t,e.rank);for(var n=Ii(e.shape,t),r=n[0],o=n[1],i=Gi(r,e.dtype),a=rr(o),s=this.readSync(i.dataId),u=this.readSync(e.dataId),c=0;c<s.length;++c){for(var l=c*a,f=u[l],h=0;h<a;++h){var d=u[l+h];f=f&&d}s[c]=f}return i},t.prototype.any=function(e,t){_p(e,"any"),Ti("any",t,e.rank);for(var n=Ii(e.shape,t),r=n[0],o=n[1],i=Gi(r,e.dtype),a=rr(o),s=this.readSync(i.dataId),u=this.readSync(e.dataId),c=0;c<s.length;++c){for(var l=c*a,f=u[l],h=0;h<a;++h){var d=u[l+h];f=f||d}s[c]=f}return i},t.prototype.squaredDifference=function(e,t){return _p([e,t],"squaredDifference"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){var n=e-t;return n*n}))},t.prototype.ceil=function(e){_p(e,"ceil");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.ceil(t[r]);return this.makeOutput(n,e.shape,"float32")},t.prototype.floor=function(e){_p(e,"floor");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.floor(t[r]);return this.makeOutput(n,e.shape,"float32")},t.prototype.sign=function(e){_p(e,"x");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)t[r]<0?n[r]=-1:t[r]>0?n[r]=1:n[r]=0;return this.makeOutput(n,e.shape,"float32")},t.prototype.isNaN=function(e){_p(e,"x");for(var t=this.readSync(e.dataId),n=new Uint8Array(t.length),r=0;r<t.length;++r)Number.isNaN(t[r])&&(n[r]=1);return this.makeOutput(n,e.shape,"bool")},t.prototype.isInf=function(e){_p(e,"x");for(var t=this.readSync(e.dataId),n=new Uint8Array(t.length),r=0;r<t.length;++r)Math.abs(t[r])===1/0&&(n[r]=1);return this.makeOutput(n,e.shape,"bool")},t.prototype.isFinite=function(e){_p(e,"x");for(var t=this.readSync(e.dataId),n=new Uint8Array(t.length),r=0;r<t.length;++r)Number.isFinite(t[r])&&(n[r]=1);return this.makeOutput(n,e.shape,"bool")},t.prototype.round=function(e){_p(e,"round");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var o=Math.floor(t[r]);t[r]-o<.5?n[r]=Math.floor(t[r]):t[r]-o>.5?n[r]=Math.ceil(t[r]):n[r]=o%2==0?o:o+1}return this.makeOutput(n,e.shape,"float32")},t.prototype.exp=function(e){_p(e,"exp");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.exp(t[r]);return this.makeOutput(n,e.shape,"float32")},t.prototype.expm1=function(e){_p(e,"expm1");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.expm1(t[r]);return this.makeOutput(n,e.shape,"float32")},t.prototype.log=function(e){_p(e,"log");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var o=t[r];n[r]=Math.log(o)}return this.makeOutput(n,e.shape,"float32")},t.prototype.log1p=function(e){_p(e,"log1p");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var o=t[r];n[r]=Math.log1p(o)}return this.makeOutput(n,e.shape,"float32")},t.prototype.sqrt=function(e){_p(e,"sqrt");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var o=t[r];n[r]=Math.sqrt(o)}return this.makeOutput(n,e.shape,"float32")},t.prototype.rsqrt=function(e){_p(e,"rsqrt");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var o=t[r];n[r]=1/Math.sqrt(o)}return this.makeOutput(n,e.shape,"float32")},t.prototype.reciprocal=function(e){_p(e,"reciprocal");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=1/t[r];return this.makeOutput(n,e.shape,"float32")},t.prototype.linear=function(e){return e},t.prototype.relu=function(e){_p(e,"relu");for(var t=Gi(e.shape,e.dtype),n=this.readSync(t.dataId),r=this.readSync(e.dataId),o=0;o<r.length;++o)n[o]=Math.max(0,r[o]);return t},t.prototype.relu6=function(e){_p(e,"relu");for(var t=Gi(e.shape,e.dtype),n=this.readSync(t.dataId),r=this.readSync(e.dataId),o=0;o<r.length;++o)n[o]=Math.min(Math.max(0,r[o]),6);return t},t.prototype.prelu=function(e,t){return _p([e,t],"prelu"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){return e<0?t*e:e}))},t.prototype.elu=function(e){_p(e,"elu");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r){var o=n[r];t[r]=o>=0?o:Math.exp(o)-1}return this.makeOutput(t,e.shape,"float32")},t.prototype.eluDer=function(e,t){_p([e,t],"eluDer");for(var n=new Float32Array(t.size),r=this.readSync(t.dataId),o=this.readSync(e.dataId),i=0;i<r.length;++i){var a=r[i];n[i]=a>=1?o[i]:o[i]*(a+1)}return this.makeOutput(n,t.shape,"float32")},t.prototype.selu=function(e){_p(e,"selu");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r){var o=n[r];t[r]=o>=0?1.0507009873554805*o:1.7580993408473768*(Math.exp(o)-1)}return this.makeOutput(t,e.shape,"float32")},t.prototype.clip=function(e,t,n){_p(e,"clip");for(var r=new Float32Array(e.size),o=this.readSync(e.dataId),i=0;i<o.length;++i){var a=o[i];r[i]=a>n?n:a<t?t:a}return this.makeOutput(r,e.shape,"float32")},t.prototype.abs=function(e){for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.abs(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.complexAbs=function(e){for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<e.size;++r){var o=n[2*r],i=n[2*r+1];t[r]=Math.hypot(o,i)}return this.makeOutput(t,e.shape,"float32")},t.prototype.int=function(e){_p(e,"int");for(var t=new Int32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=n[r];return this.makeOutput(t,e.shape,"int32")},t.prototype.sigmoid=function(e){_p(e,"sigmoid");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=1/(1+Math.exp(-n[r]));return this.makeOutput(t,e.shape,"float32")},t.prototype.softplus=function(e){_p(e,"softplus");for(var t=Math.log(1.1920928955078125e-7)+2,n=new Float32Array(e.size),r=this.readSync(e.dataId),o=0;o<r.length;++o){var i,a=r[o]>-t,s=r[o]<t,u=Math.exp(r[o]);i=s?u:a?r[o]:Math.log(1+u),n[o]=i}return this.makeOutput(n,e.shape,"float32")},t.prototype.sin=function(e){_p(e,"sin");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.sin(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.cos=function(e){_p(e,"cos");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.cos(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.tan=function(e){_p(e,"tan");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.tan(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.asin=function(e){_p(e,"asin");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.asin(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.acos=function(e){_p(e,"acos");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.acos(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.atan=function(e){_p(e,"atan");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.atan(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.atan2=function(e,t){return _p([e,t],"atan2"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){return Math.atan2(e,t)}))},t.prototype.sinh=function(e){_p(e,"sinh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.sinh(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.cosh=function(e){_p(e,"cosh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.cosh(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.tanh=function(e){_p(e,"tanh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=ar(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.asinh=function(e){_p(e,"asinh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.asinh(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.acosh=function(e){_p(e,"acosh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.acosh(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.atanh=function(e){_p(e,"atanh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.atanh(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.erf=function(e){_p(e,"erf");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r){var o=Math.sign(n[r]),i=Math.abs(n[r]),a=1/(1+.3275911*i);t[r]=o*(1-((((1.061405429*a-1.453152027)*a+1.421413741)*a-.284496736)*a+.254829592)*a*Math.exp(-i*i))}return this.makeOutput(t,e.shape,"float32")},t.prototype.step=function(e,t){void 0===t&&(t=0),_p(e,"step");for(var n=new Float32Array(e.size),r=this.readSync(e.dataId),o=0;o<r.length;++o){var i=r[o];isNaN(i)?n[o]=NaN:n[o]=i>0?1:t}return this.makeOutput(n,e.shape,"float32")},t.prototype.fusedConv2d=function(e){var t=e.input,n=e.filter,r=e.convInfo,o=e.bias,i=e.activation,a=e.preluActivationWeights,s=this.conv2d(t,n,r);return o&&(s=this.add(s,o)),i&&(s=Ep(this,s,i,a)),s},t.prototype.conv2d=function(e,t,n){_p([e,t],"conv2d");for(var r=n.filterHeight,o=n.filterWidth,i=n.dilationHeight,a=n.dilationWidth,s=n.padInfo.left,u=n.padInfo.top,c="channelsLast"===n.dataFormat,l=ma(n.outShape,e.dtype),f=e.strides[0],h=c?e.strides[1]:e.strides[2],d=c?e.strides[2]:1,p=c?1:e.strides[1],v=l.strides[0],m=c?l.strides[1]:l.strides[2],g=c?l.strides[2]:1,y=c?1:l.strides[1],b=this.readSync(e.dataId),w=this.readSync(t.dataId),x=l.values,k=0;k<n.batchSize;++k)for(var _=k*f,E=k*v,C=0;C<n.outHeight;++C)for(var S=E+C*m,I=C*n.strideHeight-u,R=0;R<r;R++){var T=I+R*i;if(!(T<0||T>=n.inHeight))for(var A=R*t.strides[0],N=_+T*h,O=0;O<n.outWidth;++O)for(var D=S+O*g,P=O*n.strideWidth-s,M=0;M<o;M++){var F=P+M*a;if(!(F<0||F>=n.inWidth))for(var L=N+F*d,B=A+M*t.strides[1],U=0;U<n.inChannels;++U){for(var j=b[L+U*p],Z=0;Z<n.outChannels;++Z)x[D+Z*y]+=j*w[B+Z];B+=n.outChannels}}}return l.toTensor()},t.prototype.conv3d=function(e,t,n){for(var r=n.filterDepth,o=n.filterHeight,i=n.filterWidth,a=n.dilationDepth,s=n.dilationHeight,u=n.dilationWidth,c=n.padInfo.front,l=n.padInfo.left,f=n.padInfo.top,h=ma(n.outShape,e.dtype),d=this.readSync(e.dataId),p=this.readSync(t.dataId),v=h.values,m=0;m<n.batchSize;++m)for(var g=m*e.strides[0],y=m*h.strides[0],b=0;b<n.outDepth;++b)for(var w=y+b*h.strides[1],x=b*n.strideDepth-c,k=0;k<r;k++){var _=x+k*a;if(!(_<0||_>=n.inDepth))for(var E=k*t.strides[0],C=g+_*e.strides[1],S=0;S<n.outHeight;++S)for(var I=w+S*h.strides[2],R=S*n.strideHeight-f,T=0;T<o;T++){var A=R+T*s;if(!(A<0||A>=n.inHeight))for(var N=E+T*t.strides[1],O=C+A*e.strides[2],D=0;D<n.outWidth;++D)for(var P=I+D*n.outChannels,M=D*n.strideWidth-l,F=0;F<i;F++){var L=M+F*u;if(!(L<0||L>=n.inWidth))for(var B=N+F*t.strides[2],U=O+L*n.inChannels,j=B,Z=0;Z<n.inChannels;++Z){for(var W=d[U+Z],z=0;z<n.outChannels;++z)v[P+z]+=W*p[j+z];j+=n.outChannels}}}}return h.toTensor()},t.prototype.conv2dDerInput=function(e,t,n){_p([e,t],"conv2dDerInput");for(var r=ma(n.inShape,"float32"),o=r.values,i=this.readSync(e.dataId),a=this.readSync(t.dataId),s=t.strides,u=s[0],c=s[1],l=s[2],f=n.batchSize,h=n.filterHeight,d=n.filterWidth,p=n.inChannels,v=n.inHeight,m=n.inWidth,g=n.outChannels,y=n.outHeight,b=n.outWidth,w=n.strideHeight,x=n.strideWidth,k=n.dataFormat,_=h-1-n.padInfo.top,E=d-1-n.padInfo.left,C="channelsLast"===k,S=r.strides[0],I=C?r.strides[1]:r.strides[2],R=C?r.strides[2]:1,T=C?1:r.strides[1],A=e.strides[0],N=C?e.strides[1]:e.strides[2],O=C?e.strides[2]:1,D=C?1:e.strides[1],P=0;P<f;++P)for(var M=0;M<p;++M)for(var F=0;F<v;++F)for(var L=F-_,B=Math.max(0,Math.ceil(L/w)),U=Math.min(y,(h+L)/w),j=0;j<m;++j){for(var Z=j-E,W=Math.max(0,Math.ceil(Z/x)),z=Math.min(b,(d+Z)/x),V=0,H=B;H<U;++H)for(var q=H*w-L,G=W;G<z;++G)for(var K=A*P+N*H+O*G,X=u*(h-1-q)+c*(d-1-(G*x-Z))+l*M,$=0;$<g;++$)V+=i[K+D*$]*a[X+$];o[S*P+I*F+R*j+T*M]=V}return r.toTensor()},t.prototype.conv3dDerInput=function(e,t,n){for(var r=ma(n.inShape,"float32"),o=r.values,i=r.strides,a=i[0],s=i[1],u=i[2],c=i[3],l=this.readSync(e.dataId),f=e.strides,h=f[0],d=f[1],p=f[2],v=f[3],m=this.readSync(t.dataId),g=t.strides,y=g[0],b=g[1],w=g[2],x=g[3],k=n.batchSize,_=n.filterDepth,E=n.filterHeight,C=n.filterWidth,S=n.inChannels,I=n.inDepth,R=n.inHeight,T=n.inWidth,A=n.outChannels,N=n.outDepth,O=n.outHeight,D=n.outWidth,P=n.strideDepth,M=n.strideHeight,F=n.strideWidth,L=_-1-n.padInfo.front,B=E-1-n.padInfo.top,U=C-1-n.padInfo.left,j=0;j<k;++j)for(var Z=0;Z<S;++Z)for(var W=0;W<I;++W)for(var z=W-L,V=Math.max(0,Math.ceil(z/P)),H=Math.min(N,(_+z)/P),q=0;q<R;++q)for(var G=q-B,K=Math.max(0,Math.ceil(G/M)),X=Math.min(O,(E+G)/M),$=0;$<T;++$){for(var Y=$-U,Q=Math.max(0,Math.ceil(Y/F)),J=Math.min(D,(C+Y)/F),ee=0,te=V;te<H;++te)for(var ne=te*P-z,re=K;re<X;++re)for(var oe=re*M-G,ie=Q;ie<J;++ie)for(var ae=h*j+d*te+p*re+v*ie,se=y*(_-1-ne)+b*(E-1-oe)+w*(C-1-(ie*F-Y))+x*Z,ue=0;ue<A;++ue)ee+=l[ae+ue]*m[se+ue];o[a*j+s*W+u*q+c*$+Z]=ee}return r.toTensor()},t.prototype.conv2dDerFilter=function(e,t,n){_p([e,t],"conv2dDerFilter");for(var r=n.strideHeight,o=n.strideWidth,i=n.filterHeight,a=n.filterWidth,s="channelsLast"===n.dataFormat,u=ma(n.filterShape,"float32"),c=n.padInfo.left,l=n.padInfo.top,f=this.bufferSync(e),h=this.bufferSync(t),d=0;d<i;++d)for(var p=Math.max(0,Math.ceil((l-d)/r)),v=Math.min(n.outHeight,(n.inHeight+l-d)/r),m=0;m<a;++m)for(var g=Math.max(0,Math.ceil((c-m)/o)),y=Math.min(n.outWidth,(n.inWidth+c-m)/o),b=0;b<n.inChannels;++b)for(var w=0;w<n.outChannels;++w){for(var x=0,k=0;k<n.batchSize;++k)for(var _=p;_<v;++_)for(var E=d+_*r-l,C=g;C<y;++C){var S=m+C*o-c;x+=s?f.get(k,E,S,b)*h.get(k,_,C,w):f.get(k,b,E,S)*h.get(k,w,_,C)}u.set(x,d,m,b,w)}return u.toTensor()},t.prototype.conv3dDerFilter=function(e,t,n){for(var r=n.strideDepth,o=n.strideHeight,i=n.strideWidth,a=n.filterDepth,s=n.filterHeight,u=n.filterWidth,c=ma(n.filterShape,"float32"),l=c.values,f=c.strides,h=f[0],d=f[1],p=f[2],v=f[3],m=this.readSync(t.dataId),g=t.strides,y=g[0],b=g[1],w=g[2],x=g[3],k=this.readSync(e.dataId),_=e.strides,E=_[0],C=_[1],S=_[2],I=_[3],R=n.padInfo.front,T=n.padInfo.left,A=n.padInfo.top,N=0;N<a;++N)for(var O=Math.max(0,Math.ceil((R-N)/r)),D=Math.min(n.outDepth,(n.inDepth+R-N)/r),P=N*h,M=0;M<s;++M)for(var F=Math.max(0,Math.ceil((A-M)/o)),L=Math.min(n.outHeight,(n.inHeight+A-M)/o),B=M*d+P,U=0;U<u;++U)for(var j=Math.max(0,Math.ceil((T-U)/i)),Z=Math.min(n.outWidth,(n.inWidth+T-U)/i),W=U*p+B,z=0;z<n.inChannels;++z)for(var V=z*v+W,H=0;H<n.outChannels;++H){for(var q=0,G=0;G<n.batchSize;++G)for(var K=G*E,X=G*y,$=O;$<D;++$)for(var Y=(N+$*r-R)*C+K,Q=$*b+X,J=F;J<L;++J)for(var ee=(M+J*o-A)*S+Y,te=J*w+Q,ne=j;ne<Z;++ne){var re=ne*x+te;q+=k[(U+ne*i-T)*I+ee+z]*m[re+H]}l[V+H]=q}return c.toTensor()},t.prototype.fusedDepthwiseConv2D=function(e){var t=e.input,n=e.filter,r=e.convInfo,o=e.bias,i=e.activation,a=e.preluActivationWeights,s=this.depthwiseConv2D(t,n,r);return o&&(s=this.add(s,o)),i&&(s=Ep(this,s,i,a)),s},t.prototype.depthwiseConv2D=function(e,t,n){_p([e,t],"depthwiseConv2D");for(var r=n.filterHeight,o=n.filterWidth,i=n.dilationHeight,a=n.dilationWidth,s=n.padInfo.left,u=n.padInfo.top,c=n.outChannels/n.inChannels,l=ma(n.outShape,e.dtype),f=this.readSync(e.dataId),h=this.readSync(t.dataId),d=l.values,p=0;p<n.batchSize;++p)for(var v=p*e.strides[0],m=p*l.strides[0],g=0;g<n.outHeight;++g)for(var y=m+g*l.strides[1],b=g*n.strideHeight-s,w=0;w<r;++w){var x=b+w*i;if(!(x<0||x>=n.inHeight))for(var k=w*t.strides[0],_=v+x*e.strides[1],E=0;E<n.outWidth;++E)for(var C=y+E*l.strides[2],S=E*n.strideWidth-u,I=0;I<o;++I){var R=S+I*a;if(!(R<0||R>=n.inWidth))for(var T=k+I*t.strides[1],A=_+R*n.inChannels,N=C,O=T,D=0;D<n.inChannels;++D){for(var P=f[A+D],M=0;M<c;++M)d[N+M]+=P*h[O+M];N+=c,O+=c}}}return l.toTensor()},t.prototype.depthwiseConv2DDerInput=function(e,t,n){_p([e,t],"depthwiseConv2DDerInput");for(var r=ma(n.inShape,"float32"),o=r.values,i=r.strides,a=i[0],s=i[1],u=i[2],c=this.readSync(e.dataId),l=e.strides,f=l[0],h=l[1],d=l[2],p=this.readSync(t.dataId),v=t.strides,m=v[0],g=v[1],y=v[2],b=n.batchSize,w=n.filterHeight,x=n.filterWidth,k=n.inChannels,_=n.inHeight,E=n.inWidth,C=n.outChannels,S=n.outHeight,I=n.outWidth,R=n.strideHeight,T=n.strideWidth,A=w-1-n.padInfo.top,N=x-1-n.padInfo.left,O=C/k,D=0;D<b;++D)for(var P=0;P<k;++P)for(var M=0;M<_;++M)for(var F=M-A,L=Math.max(0,Math.ceil(F/R)),B=Math.min(S,(w+F)/R),U=0;U<E;++U){for(var j=U-N,Z=Math.max(0,Math.ceil(j/T)),W=Math.min(I,(x+j)/T),z=0,V=L;V<B;++V)for(var H=V*R-F,q=Z;q<W;++q)for(var G=f*D+h*V+d*q,K=m*(w-1-H)+g*(x-1-(q*T-j))+y*P,X=0;X<O;++X)z+=c[G+(P*O+X)]*p[K+X];o[a*D+s*M+u*U+P]=z}return r.toTensor()},t.prototype.depthwiseConv2DDerFilter=function(e,t,n){_p([e,t],"depthwiseConv2DDerFilter");for(var r=n.strideHeight,o=n.strideWidth,i=n.filterHeight,a=n.filterWidth,s=ma(n.filterShape,"float32"),u=n.padInfo.left,c=n.padInfo.top,l=n.outChannels/n.inChannels,f=this.bufferSync(e),h=this.bufferSync(t),d=0;d<i;++d)for(var p=Math.max(0,Math.ceil((c-d)/r)),v=Math.min(n.outHeight,(n.inHeight+c-d)/r),m=0;m<a;++m)for(var g=Math.max(0,Math.ceil((u-m)/o)),y=Math.min(n.outWidth,(n.inWidth+u-m)/o),b=0;b<n.outChannels;++b){for(var w=Math.trunc(b/l),x=b%l,k=0,_=0;_<n.batchSize;++_)for(var E=p;E<v;++E)for(var C=d+E*r-c,S=g;S<y;++S){var I=m+S*o-u;k+=f.get(_,C,I,w)*h.get(_,E,S,b)}s.set(k,d,m,w,x)}return s.toTensor()},t.prototype.tile=function(e,t){return _p(e,"tile"),zs(this.bufferSync(e),t)},t.prototype.pad=function(e,t,n){_p(e,"pad");var r=t.map((function(t,n){return t[0]+e.shape[n]+t[1]})),o=t.map((function(e){return e[0]})),i=this.bufferSync(e),a=ma(r,e.dtype);0!==n&&a.values.fill(n);for(var s=0;s<e.size;s++){var u=i.indexToLoc(s),c=u.map((function(e,t){return e+o[t]}));a.set.apply(a,[i.get.apply(i,u)].concat(c))}return a.toTensor()},t.prototype.transpose=function(e,t){_p(e,"transpose");for(var n=new Array(e.rank),r=0;r<n.length;r++)n[r]=e.shape[t[r]];var o=this.readSync(e.dataId),i=ma(n,e.dtype),a=this.bufferSync(e);for(r=0;r<e.size;++r){for(var s=a.indexToLoc(r),u=new Array(s.length),c=0;c<u.length;c++)u[c]=s[t[c]];var l=i.locToIndex(u);i.values[l]=o[r]}return i.toTensor()},t.prototype.gather=function(e,t,n){_p([e,t],"gather");var r=e.shape.slice(),o=this.readSync(t.dataId);r[n]=o.length;for(var i=ma(r,e.dtype),a=this.bufferSync(e),s=0;s<i.size;++s){var u=i.indexToLoc(s),c=u.slice();c[n]=o[u[n]];var l=a.locToIndex(c);i.values[s]=a.values[l]}return i.toTensor()},t.prototype.batchToSpaceND=function(e,t,n){_p([e],"batchToSpaceND");var r=t.reduce((function(e,t){return e*t})),o=za(e.shape,t,r),i=Va(o.length,t.length),a=Ha(e.shape,t,r),s=qa(n,t.length),u=Ga(a,n,t.length);return e.reshape(o).transpose(i).reshape(a).slice(s,u)},t.prototype.spaceToBatchND=function(e,t,n){_p([e],"spaceToBatchND");var r=t.reduce((function(e,t){return e*t})),o=[[0,0]];o.push.apply(o,n);for(var i=1+t.length;i<e.shape.length;++i)o.push([0,0]);var a=e.pad(o),s=za(a.shape,t,r,!1),u=Va(s.length,t.length,!1),c=Ha(a.shape,t,r,!1);return a.reshape(s).transpose(u).reshape(c)},t.prototype.pool=function(e,t,n){_p(e,"pool");for(var r=t.strideHeight,o=t.strideWidth,i=t.dilationHeight,a=t.dilationWidth,s=t.effectiveFilterHeight,u=t.effectiveFilterWidth,c=t.padInfo.top,l=t.padInfo.left,f="max"===n?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,h=this.readSync(e.dataId),d=ma(t.outShape,e.dtype),p=d.values,v=t.outShape[1]*t.outShape[2]*t.outShape[3],m=t.outShape[2]*t.outShape[3],g=t.outShape[3],y=0;y<t.batchSize;++y)for(var b=y*v,w=y*e.strides[0],x=0;x<t.inChannels;++x)for(var k=0;k<t.outHeight;++k)for(var _=k*r-c,E=Math.max(0,_),C=Math.min(t.inHeight,s+_),S=b+k*m,I=0;I<t.outWidth;++I){for(var R=I*o-l,T=Math.max(0,R),A=Math.min(t.inWidth,u+R),N=f,O=0,D=0,P=E;P<C;P+=i){for(var M=w+P*e.strides[1],F=T;F<A;F+=a){var L=h[M+F*e.strides[2]+x];"max"===n&&L>N?N=L:"avg"===n&&(O+=L,D++)}if(isNaN(N))break}p[S+I*g+x]="avg"===n?O/D:N}return d.toTensor()},t.prototype.maxPool=function(e,t){return this.pool(e,t,"max")},t.prototype.maxPoolPositions=function(e,t){for(var n=ma(t.outShape,"int32"),r=t.strideHeight,o=t.strideWidth,i=t.dilationHeight,a=t.dilationWidth,s=t.effectiveFilterHeight,u=t.effectiveFilterWidth,c=t.padInfo.top,l=t.padInfo.left,f=this.bufferSync(e),h=0;h<t.batchSize;++h)for(var d=0;d<t.inChannels;++d)for(var p=0;p<t.outHeight;++p){for(var v=p*r-c,m=v;m<0;)m+=i;for(var g=Math.min(t.inHeight,s+v),y=0;y<t.outWidth;++y){for(var b=y*o-l,w=b;w<0;)w+=a;for(var x=Math.min(t.inWidth,u+b),k=Number.NEGATIVE_INFINITY,_=-1,E=m;E<g;E+=i)for(var C=E-v,S=w;S<x;S+=a){var I=S-b,R=f.get(h,E,S,d);R>k&&(k=R,_=C*u+I)}n.set(_,h,p,y,d)}}return n.toTensor()},t.prototype.maxPoolBackprop=function(e,t,n,r){_p([t,n],"maxPoolBackprop");for(var o=this.maxPoolPositions(t,r),i=r.strideHeight,a=r.strideWidth,s=r.dilationHeight,u=r.dilationWidth,c=r.effectiveFilterHeight,l=r.effectiveFilterWidth,f=l-1-r.padInfo.left,h=c-1-r.padInfo.top,d=ma(t.shape,"float32"),p=this.bufferSync(o),v=this.bufferSync(e),m=0;m<r.batchSize;++m)for(var g=0;g<r.inChannels;++g)for(var y=0;y<r.inHeight;++y)for(var b=0;b<r.inWidth;++b){for(var w=y-h,x=b-f,k=0,_=0;_<c;_+=s){var E=(w+_)/i;if(!(E<0||E>=r.outHeight||Math.floor(E)!==E))for(var C=0;C<l;C+=u){var S=(x+C)/a;if(!(S<0||S>=r.outWidth||Math.floor(S)!==S)){var I=c*l-1-p.get(m,E,S,g)===_*l+C?1:0;0!==I&&(k+=v.get(m,E,S,g)*I)}}}d.set(k,m,y,b,g)}return d.toTensor()},t.prototype.avgPoolBackprop=function(e,t,n){_p([e,t],"avgPoolBackprop");for(var r=n.strideHeight,o=n.strideWidth,i=n.filterHeight,a=n.filterWidth,s=n.dilationHeight,u=n.dilationWidth,c=n.effectiveFilterHeight,l=n.effectiveFilterWidth,f=l-1-n.padInfo.left,h=c-1-n.padInfo.top,d=ma(t.shape,"float32"),p=1/(i*a),v=this.bufferSync(e),m=0;m<n.batchSize;++m)for(var g=0;g<n.inChannels;++g)for(var y=0;y<n.inHeight;++y)for(var b=0;b<n.inWidth;++b){for(var w=y-h,x=b-f,k=0,_=0;_<c;_+=s){var E=(w+_)/r;if(!(E<0||E>=n.outHeight||Math.floor(E)!==E))for(var C=0;C<l;C+=u){var S=(x+C)/o;S<0||S>=n.outWidth||Math.floor(S)!==S||(k+=v.get(m,E,S,g))}}d.set(k*p,m,y,b,g)}return d.toTensor()},t.prototype.pool3d=function(e,t,n){_p(e,"pool3d");for(var r=t.strideDepth,o=t.strideHeight,i=t.strideWidth,a=t.dilationDepth,s=t.dilationHeight,u=t.dilationWidth,c=t.effectiveFilterDepth,l=t.effectiveFilterHeight,f=t.effectiveFilterWidth,h=t.padInfo.front,d=t.padInfo.top,p=t.padInfo.left,v="max"===n?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=this.readSync(e.dataId),g=ma(t.outShape,e.dtype),y=g.values,b=t.outShape[1]*t.outShape[2]*t.outShape[3]*t.outShape[4],w=t.outShape[2]*t.outShape[3]*t.outShape[4],x=t.outShape[3]*t.outShape[4],k=t.outShape[4],_=0;_<t.batchSize;++_)for(var E=_*b,C=_*e.strides[0],S=0;S<t.inChannels;++S)for(var I=0;I<t.outDepth;++I){for(var R=I*r-h,T=R;T<0;)T+=a;for(var A=Math.min(t.inDepth,c+R),N=E+I*w,O=0;O<t.outHeight;++O){for(var D=O*o-d,P=D;P<0;)P+=s;for(var M=Math.min(t.inHeight,l+D),F=N+O*x,L=0;L<t.outWidth;++L){for(var B=L*i-p,U=B;U<0;)U+=u;for(var j=Math.min(t.inWidth,f+B),Z=F+L*k,W=v,z=0,V=0,H=T;H<A;H+=a){for(var q=C+H*e.strides[1],G=P;G<M;G+=s){for(var K=q+G*e.strides[2],X=U;X<j;X+=u){var $=m[K+X*e.strides[3]+S];if("max"===n&&$>W?W=$:"avg"===n&&(z+=$,V++),isNaN(W))break}if(isNaN(W))break}if(isNaN(W))break}y[Z+S]="avg"===n?z/V:W}}}return g.toTensor()},t.prototype.avgPool3d=function(e,t){return _p(e,"avgPool3d"),this.pool3d(e,t,"avg").toFloat()},t.prototype.avgPool3dBackprop=function(e,t,n){_p([e,t],"avgPool3dBackprop");for(var r=n.strideDepth,o=n.strideHeight,i=n.strideWidth,a=n.filterDepth,s=n.filterHeight,u=n.filterWidth,c=n.dilationDepth,l=n.dilationHeight,f=n.dilationWidth,h=n.effectiveFilterDepth,d=n.effectiveFilterHeight,p=n.effectiveFilterWidth,v=h-1-n.padInfo.front,m=p-1-n.padInfo.left,g=d-1-n.padInfo.top,y=ma(t.shape,"float32"),b=1/(a*s*u),w=this.bufferSync(e),x=0;x<n.batchSize;++x)for(var k=0;k<n.inChannels;++k)for(var _=0;_<n.inDepth;++_)for(var E=0;E<n.inHeight;++E)for(var C=0;C<n.inWidth;++C){for(var S=_-v,I=E-g,R=C-m,T=0,A=0;A<h;A+=c){var N=(S+A)/r;if(!(N<0||N>=n.outDepth||Math.floor(N)!==N))for(var O=0;O<d;O+=l){var D=(I+O)/o;if(!(D<0||D>=n.outHeight||Math.floor(D)!==D))for(var P=0;P<p;P+=f){var M=(R+P)/i;M<0||M>=n.outWidth||Math.floor(M)!==M||(T+=w.get(x,N,D,M,k))}}}y.set(T*b,x,_,E,C,k)}return y.toTensor()},t.prototype.maxPool3d=function(e,t){return _p(e,"maxPool3d"),this.pool3d(e,t,"max").toFloat()},t.prototype.maxPool3dPositions=function(e,t){for(var n=ma(t.outShape,"int32"),r=t.strideDepth,o=t.strideHeight,i=t.strideWidth,a=t.dilationDepth,s=t.dilationHeight,u=t.dilationWidth,c=t.effectiveFilterDepth,l=t.effectiveFilterHeight,f=t.effectiveFilterWidth,h=t.padInfo.front,d=t.padInfo.top,p=t.padInfo.left,v=this.bufferSync(e),m=0;m<t.batchSize;++m)for(var g=0;g<t.inChannels;++g)for(var y=0;y<t.outDepth;++y){for(var b=y*r-h,w=b;w<0;)w+=a;for(var x=Math.min(t.inDepth,c+b),k=0;k<t.outHeight;++k){for(var _=k*o-d,E=_;E<0;)E+=s;for(var C=Math.min(t.inHeight,l+_),S=0;S<t.outWidth;++S){for(var I=S*i-p,R=I;R<0;)R+=u;for(var T=Math.min(t.inWidth,f+I),A=Number.NEGATIVE_INFINITY,N=-1,O=w;O<x;O+=a)for(var D=O-b,P=E;P<C;P+=s)for(var M=P-_,F=R;F<T;F+=u){var L=F-I,B=v.get(m,O,P,F,g);B>=A&&(A=B,N=D*l*f+M*l+L)}n.set(N,m,y,k,S,g)}}}return n.toTensor()},t.prototype.maxPool3dBackprop=function(e,t,n,r){_p([t,n],"maxPool3dBackprop");for(var o=this.maxPool3dPositions(t,r),i=r.strideDepth,a=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,c=r.dilationHeight,l=r.dilationWidth,f=r.effectiveFilterDepth,h=r.effectiveFilterHeight,d=r.effectiveFilterWidth,p=f-1-r.padInfo.front,v=d-1-r.padInfo.left,m=h-1-r.padInfo.top,g=ma(t.shape,"float32"),y=this.bufferSync(o),b=this.bufferSync(e),w=0;w<r.batchSize;++w)for(var x=0;x<r.inChannels;++x)for(var k=0;k<r.inDepth;++k)for(var _=0;_<r.inHeight;++_)for(var E=0;E<r.inWidth;++E){for(var C=k-p,S=_-m,I=E-v,R=0,T=0;T<f;T+=u){var A=(C+T)/i;if(!(A<0||A>=r.outDepth||Math.floor(A)!==A))for(var N=0;N<h;N+=c){var O=(S+N)/a;if(!(O<0||O>=r.outHeight||Math.floor(O)!==O))for(var D=0;D<d;D+=l){var P=(I+D)/s;if(!(P<0||P>=r.outWidth||Math.floor(P)!==P)){var M=f*h*d-1-y.get(w,A,O,P,x)===T*h*d+N*d+D?1:0;0!==M&&(R+=b.get(w,A,O,P,x)*M)}}}}g.set(R,w,k,_,E,x)}return g.toTensor()},t.prototype.cast=function(e,t){return Is(e,t,this)},t.prototype.reshape=function(e,t){return Rs(e,t)},t.prototype.avgPool=function(e,t){return _p(e,"avgPool"),this.pool(e,t,"avg").toFloat()},t.prototype.resizeBilinear=function(e,t,n,r){_p(e,"resizeBilinear");for(var o=e.shape,i=o[0],a=o[1],s=o[2],u=o[3],c=this.readSync(e.dataId),l=new Float32Array(rr([i,t,n,u])),f=[r&&t>1?a-1:a,r&&n>1?s-1:s],h=[r&&t>1?t-1:t,r&&n>1?n-1:n],d=0,p=f[0]/h[0],v=f[1]/h[1],m=0;m<i;m++)for(var g=0;g<t;g++)for(var y=p*g,b=Math.floor(y),w=y-b,x=Math.min(a-1,Math.ceil(y)),k=m*e.strides[0]+b*e.strides[1],_=m*e.strides[0]+x*e.strides[1],E=0;E<n;E++)for(var C=v*E,S=Math.floor(C),I=C-S,R=Math.min(s-1,Math.ceil(C)),T=k+S*e.strides[2],A=_+S*e.strides[2],N=k+R*e.strides[2],O=_+R*e.strides[2],D=0;D<u;D++){var P=c[T+D],M=c[A+D],F=P+(c[N+D]-P)*I,L=F+(M+(c[O+D]-M)*I-F)*w;l[d++]=L}return Ui(l,[i,t,n,u])},t.prototype.resizeBilinearBackprop=function(e,t,n){_p([e,t],"resizeBilinearBackprop");for(var r=t.shape,o=r[0],i=r[1],a=r[2],s=r[3],u=e.shape,c=u[1],l=u[2],f=new Float32Array(o*i*a*s),h=[n&&c>1?i-1:i,n&&l>1?a-1:a],d=[n&&c>1?c-1:c,n&&l>1?l-1:l],p=h[0]/d[0],v=h[1]/d[1],m=this.readSync(e.dataId),g=0,y=0;y<o;y++)for(var b=y*t.strides[0],w=0;w<c;w++)for(var x=w*p,k=Math.floor(x),_=Math.min(Math.ceil(x),i-1),E=b+k*t.strides[1],C=b+_*t.strides[1],S=x-k,I=1-S,R=0;R<l;R++)for(var T=R*v,A=Math.floor(T),N=Math.min(Math.ceil(T),a-1),O=T-A,D=1-O,P=E+A*t.strides[2],M=E+N*t.strides[2],F=C+A*t.strides[2],L=C+N*t.strides[2],B=I*D,U=I*O,j=S*D,Z=S*O,W=0;W<s;W++){var z=m[g++];f[P+W]+=z*B,f[M+W]+=z*U,f[F+W]+=z*j,f[L+W]+=z*Z}return Hi(f,[o,a,i,s],t.dtype)},t.prototype.resizeNearestNeighbor=function(e,t,n,r){_p(e,"resizeNearestNeighbor");for(var o=e.shape,i=o[0],a=o[1],s=o[2],u=o[3],c=this.readSync(e.dataId),l=new Float32Array(i*t*n*u),f=[r&&t>1?a-1:a,r&&n>1?s-1:s],h=[r&&t>1?t-1:t,r&&n>1?n-1:n],d=f[0]/h[0],p=f[1]/h[1],v=0,m=0;m<i;m++)for(var g=m*e.strides[0],y=0;y<t;y++)for(var b=d*y,w=g+Math.min(a-1,r?Math.round(b):Math.floor(b))*e.strides[1],x=0;x<n;x++)for(var k=p*x,_=w+Math.min(s-1,r?Math.round(k):Math.floor(k))*e.strides[2],E=0;E<u;E++){var C=c[_+E];l[v++]=C}return Ui(l,[i,t,n,u],e.dtype)},t.prototype.resizeNearestNeighborBackprop=function(e,t,n){_p([e,t],"resizeNearestNeighborBackprop");for(var r=t.shape,o=r[0],i=r[1],a=r[2],s=r[3],u=e.shape,c=u[1],l=u[2],f=new Float32Array(o*i*a*s),h=this.readSync(e.dataId),d=[n&&c>1?i-1:i,n&&l>1?a-1:a],p=[n&&c>1?c-1:c,n&&l>1?l-1:l],v=d[0]/p[0],m=d[1]/p[1],g=1/v,y=1/m,b=2*Math.ceil(g)+2,w=2*Math.ceil(y)+2,x=0;x<o;x++)for(var k=x*t.strides[0],_=0;_<i;_++)for(var E=k+_*t.strides[1],C=Math.floor(_*g),S=Math.floor(C-b/2),I=0;I<a;I++)for(var R=E+I*t.strides[2],T=Math.floor(I*y),A=Math.floor(T-w/2),N=0;N<s;N++){for(var O=0,D=0;D<b;D++){var P=D+S;if(!(P<0||P>=c)){var M=k+P*e.strides[1],F=P*v;if(_===Math.min(i-1,n?Math.round(F):Math.floor(F)))for(var L=0;L<w;L++){var B=L+A;if(!(B<0||B>=l)){var U=M+B*e.strides[2],j=B*m;I===Math.min(a-1,n?Math.round(j):Math.floor(j))&&(O+=h[U+N])}}}}f[R+N]=O}return Hi(f,t.shape,t.dtype)},t.prototype.batchNormalization=function(e,t,n,r,o,i){_p([e,t,n,o,i],"batchNorm");for(var a=this.readSync(e.dataId),s=this.readSync(t.dataId),u=this.readSync(n.dataId),c=o?this.readSync(o.dataId):new Float32Array([1]),l=i?this.readSync(i.dataId):new Float32Array([0]),f=new Float32Array(a.length),h=l.length,d=c.length,p=u.length,v=s.length,m=0,g=0,y=0,b=0,w=0;w<a.length;++w)f[w]=l[m++]+(a[w]-s[g++])*c[y++]/Math.sqrt(u[b++]+r),m>=h&&(m=0),g>=v&&(g=0),y>=d&&(y=0),b>=p&&(b=0);return Hi(f,e.shape)},t.prototype.localResponseNormalization4D=function(e,t,n,r,o){_p(e,"localResponseNormalization4D");var i=e.shape[3],a=i-1,s=this.readSync(e.dataId),u=e.size,c=new Float32Array(u);function l(e){for(var n=e%i,r=e-n+Math.max(0,n-t),o=e-n+Math.min(n+t,a),u=0;r<=o;r++){var c=s[r];u+=c*c}return u}for(var f=0;f<u;f++){var h=l(f),d=s[f]*Math.pow(n+r*h,-o);c[f]=d}return Hi(c,e.shape)},t.prototype.LRNGrad=function(e,t,n,r,o,i,a){_p(e,"LRNGrad");for(var s=e.shape[3],u=this.readSync(e.dataId),c=this.readSync(t.dataId),l=this.readSync(n.dataId),f=new Float32Array(e.size),h=e.size,d=0;d<h;d++){for(var p=d%s,v=d-p+Math.max(0,p-r),m=d-p+Math.min(s,p+r+1),g=0,y=v;y<m;y++)g+=Math.pow(c[y],2);for(g=i*g+o,y=v;y<m;y++){var b=-2*i*a*c[y]*l[d]/g;d===y&&(b+=Math.pow(g,-a)),b*=u[d],f[y]+=b}}return Hi(f,e.shape)},t.prototype.multinomial=function(e,t,n,r){_p(e,"multinomial");for(var o=t?e:ss(e),i=o.shape[0],a=o.shape[1],s=Gi([i,n],"int32"),u=this.readSync(s.dataId),c=this.readSync(o.dataId),l=0;l<i;++l){var f=l*a,h=new Float32Array(a-1);h[0]=c[f];for(var d=1;d<h.length;++d)h[d]=h[d-1]+c[f+d];for(var p=ha(r.toString()),v=l*n,m=0;m<n;++m){var g=p();u[v+m]=h.length;for(var y=0;y<h.length;y++)if(g<h[y]){u[v+m]=y;break}}}return s},t.prototype.oneHot=function(e,t,n,r){_p(e,"oneHot");var o=new Float32Array(e.size*t);o.fill(r);for(var i=this.readSync(e.dataId),a=0;a<e.size;++a)i[a]>=0&&i[a]<t&&(o[a*t+i[a]]=n);return zi(o,[e.size,t],"int32")},t.prototype.nonMaxSuppression=function(e,t,n,r,o){return _p(e,"nonMaxSuppression"),Fs(this.readSync(e.dataId),this.readSync(t.dataId),n,r,o)},t.prototype.fft=function(e){return this.fftBatch(e,!1)},t.prototype.ifft=function(e){return this.fftBatch(e,!0)},t.prototype.fftBatch=function(e,t){for(var n=e.shape[0],r=e.shape[1],o=ma(e.shape,"float32"),i=ma(e.shape,"float32"),a=Li(e).as2D(n,r),s=Bi(e).as2D(n,r),u=0;u<n;u++)for(var c=a.slice([u,0],[1,r]),l=s.slice([u,0],[1,r]),f=Fi(c,l),h=this.readSync(this.fftImpl(f,t).dataId),d=0;d<r;d++){var p=Ns(h,d);o.values[u*r+d]=p.real,i.values[u*r+d]=p.imag}return Fi(o.toTensor(),i.toTensor()).as2D(n,r)},t.prototype.fftImpl=function(e,t){var n=e.as1D(),r=n.size;if(this.isExponentOf2(r)){var o=this.fftRadix2(n,r,t).as2D(e.shape[0],e.shape[1]);return t&&(o=Fi(Li(o).div(Zi(r)),Bi(o).div(Zi(r)))),o}var i=this.readSync(e.dataId),a=function(e){for(var t=new Float32Array(e.length/2),n=new Float32Array(e.length/2),r=0;r<e.length;r+=2)t[r/2]=e[r],n[r/2]=e[r+1];return{real:t,imag:n}}(this.fourierTransformByMatmul(i,r,t));return Fi(a.real,a.imag).as2D(e.shape[0],e.shape[1])},t.prototype.isExponentOf2=function(e){return 0==(e&e-1)},t.prototype.fftRadix2=function(e,t,n){if(1===t)return e;var r=this.readSync(e.dataId),o=t/2,i=function(e){for(var t=Math.ceil(e.length/4),n=new Float32Array(t),r=new Float32Array(t),o=0;o<e.length;o+=4)n[Math.floor(o/4)]=e[o],r[Math.floor(o/4)]=e[o+1];return{real:n,imag:r}}(r),a=Fi(i.real,i.imag).as1D(),s=function(e){for(var t=Math.floor(e.length/4),n=new Float32Array(t),r=new Float32Array(t),o=2;o<e.length;o+=4)n[Math.floor(o/4)]=e[o],r[Math.floor(o/4)]=e[o+1];return{real:n,imag:r}}(r),u=Fi(s.real,s.imag).as1D();a=this.fftRadix2(a,o,n),u=this.fftRadix2(u,o,n);var c=function(e,t){for(var n=new Float32Array(e/2),r=new Float32Array(e/2),o=0;o<Math.ceil(e/2);o++){var i=(t?2:-2)*Math.PI*(o/e);n[o]=Math.cos(i),r[o]=Math.sin(i)}return{real:n,imag:r}}(t,n),l=Fi(c.real,c.imag).mul(u),f=a.add(l),h=a.sub(l),d=Li(f).concat(Li(h)),p=Bi(f).concat(Bi(h));return Fi(d,p).as1D()},t.prototype.fourierTransformByMatmul=function(e,t,n){for(var r=new Float32Array(2*t),o=0;o<t;o++){for(var i=0,a=0,s=0;s<t;s++){var u=Ds(o*s,t,n),c=Ns(e,s);i+=c.real*u.real-c.imag*u.imag,a+=c.real*u.imag+c.imag*u.real}n&&(i/=t,a/=t),Os(r,i,a,o)}return r},t.prototype.depthToSpace=function(e,t,n){Jn("NHWC"===n,(function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+n})),Jn(t>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: "+t}));for(var r=e.shape[0],o=e.shape[1],i=e.shape[2],a=e.shape[3],s=o*t,u=i*t,c=a/(t*t),l=this.readSync(e.dataId),f=new Float32Array(r*s*u*c),h=0,d=0;d<r;++d)for(var p=0;p<s;++p)for(var v=Math.floor(p/t),m=p%t,g=0;g<u;++g)for(var y=Math.floor(g/t),b=(m*t+g%t)*c,w=0;w<c;++w){var x=w+b+a*(y+i*(v+o*d));f[h++]=l[x]}return Hi(f,[r,s,u,c])},t.prototype.broadcastedBinaryOp=function(e,t,n,r){var o=ps(e.shape,t.shape),i=ma(o,n),a=this.readSync(e.dataId),s=this.readSync(t.dataId),u=hs(e.shape,o),c=hs(t.shape,o),l=i.values;if(u.length+c.length===0)for(var f=0;f<l.length;++f)l[f]=r(a[f%a.length],s[f%s.length]);else{var h=this.bufferSync(e),d=this.bufferSync(t),p=function(n){var o=i.indexToLoc(n),f=o.slice(-e.rank);u.forEach((function(e){return f[e]=0}));var p=h.locToIndex(f),v=o.slice(-t.rank);c.forEach((function(e){return v[e]=0}));var m=d.locToIndex(v);l[n]=r(a[p],s[m])};for(f=0;f<l.length;++f)p(f)}return i.toTensor()},t.prototype.broadcastedBinaryComplexOp=function(e,t,n){var r=ps(e.shape,t.shape),o=ma(r,"float32"),i=ma(r,"float32"),a=this.readSync(e.dataId),s=this.readSync(t.dataId),u=hs(e.shape,r),c=hs(t.shape,r),l=o.values,f=i.values;if(u.length+c.length===0)for(var h=0;h<l.length;h++){var d=h%a.length,p=h%s.length,v=n(a[2*d],a[2*d+1],s[2*p],s[2*p+1]);l[h]=v.real,f[h]=v.imag}else{var m=this.bufferSync(this.data.get(e.dataId).complexTensors.real),g=this.bufferSync(this.data.get(t.dataId).complexTensors.real),y=function(r){var i=o.indexToLoc(r),h=i.slice(-e.rank);u.forEach((function(e){return h[e]=0}));var d=m.locToIndex(h),p=i.slice(-t.rank);c.forEach((function(e){return p[e]=0}));var v=g.locToIndex(p),y=n(a[2*d],a[2*d+1],s[2*v],s[2*v+1]);l[r]=y.real,f[r]=y.imag};for(h=0;h<l.length;h++)y(h)}return this.complex(o.toTensor(),i.toTensor())},t.prototype.split=function(e,t,n){return Ws(e,t,n)},t.prototype.dispose=function(){},t.prototype.floatPrecision=function(){return 32},t.prototype.epsilon=function(){return 1e-7},t.prototype.cropAndResize=function(e,t,n,r,o,i){for(var a=e.shape,s=a[0],u=a[1],c=a[2],l=a[3],f=t.shape[0],h=r[0],d=r[1],p=ma([f,h,d,l],"float32"),v=this.readSync(t.dataId),m=this.readSync(n.dataId),g=this.readSync(e.dataId),y=e.strides,b=p.strides,w=0;w<f;w++){var x=4*w,k=v[x],_=v[x+1],E=v[x+2],C=v[x+3],S=m[w];if(!(S>=s))for(var I=h>1?(E-k)*(u-1)/(h-1):0,R=d>1?(C-_)*(c-1)/(d-1):0,T=0;T<h;T++){var A=h>1?k*(u-1)+T*I:.5*(k+E)*(u-1);if(A<0||A>u-1)for(var N=0;N<d;N++)for(var O=0;O<l;O++){var D=O+N*b[2]+T*b[1]+w*b[0];p.values[D]=i}else if("bilinear"===o){var P=Math.floor(A),M=Math.ceil(A),F=A-P;for(N=0;N<d;N++)if((H=d>1?_*(c-1)+N*R:.5*(_+C)*(c-1))<0||H>c-1)for(O=0;O<l;O++)D=O+N*b[2]+T*b[1]+w*b[0],p.values[D]=i;else{var L=Math.floor(H),B=Math.ceil(H),U=H-L;for(O=0;O<l;O++){var j=g[D=O+L*y[2]+P*y[1]+S*y[0]],Z=g[D=O+B*y[2]+P*y[1]+S*y[0]],W=g[D=O+L*y[2]+M*y[1]+S*y[0]],z=j+(Z-j)*U,V=W+(g[D=O+B*y[2]+M*y[1]+S*y[0]]-W)*U;D=O+N*b[2]+T*b[1]+w*b[0],p.values[D]=z+(V-z)*F}}}else for(N=0;N<d;++N){var H;if((H=d>1?_*(c-1)+N*R:.5*(_+C)*(c-1))<0||H>c-1)for(O=0;O<l;O++)D=O+N*b[2]+T*b[1]+w*b[0],p.values[D]=i;else{var q=Math.round(H),G=Math.round(A);for(O=0;O<l;O++){var K=O+q*y[2]+G*y[1]+S*y[0],X=O+N*b[2]+T*b[1]+w*b[0];p.values[X]=g[K]}}}}}return p.toTensor()},t.prototype.sparseToDense=function(e,t,n,r){var o=Qa(0,e,n),i=o.sliceRank,a=o.numUpdates,s=o.sliceSize,u=o.strides,c=o.outputSize;return this.scatter(e,t,n,c,s,a,i,u,r,!1)},t.prototype.gatherND=function(e,t){var n=t.shape,r=n[n.length-1],o=Ka(e,t),i=o[0],a=o[1],s=o[2],u=o[3];if(0===a)return Ui([],i,e.dtype);for(var c=new Vr([a,s],e.dtype),l=this.readSync(t.dataId),f=this.readSync(e.dataId),h=0;h<a;h++){for(var d=[],p=0,v=0;v<r;v++){var m=l[h*r+v];p+=m*u[v],d.push(m)}if(p<0||p>=e.size/s)throw new Error("Invalid indices: "+d+" does not index into "+e.shape);for(var g=0;g<s;g++)c.values[h*s+g]=f[p*s+g]}return c.toTensor().reshape(i)},t.prototype.scatterND=function(e,t,n){var r=Qa(0,e,n),o=r.sliceRank,i=r.numUpdates,a=r.sliceSize,s=r.strides,u=r.outputSize,c=Zi(0);return this.scatter(e,t,n,u,a,i,o,s,c,!0)},t.prototype.fill=function(e,t,n){var r=pr(n=n||Er(t),rr(e));return r.fill(t),fo.makeTensor(r,e,n,this)},t.prototype.onesLike=function(e){if("string"===e.dtype)throw new Error("onesLike is not supported for string tensors");return this.fill(e.shape,1,e.dtype)},t.prototype.zerosLike=function(e){var t=pr(e.dtype,rr(e.shape));return this.makeOutput(t,e.shape,e.dtype)},t.prototype.linspace=function(e,t,n){return Ts(e,t,n)},t.prototype.scatter=function(e,t,n,r,o,i,a,s,u,c){var l=[r/o,o],f=this.readSync(e.dataId),h=this.readSync(t.dataId);if(0===r)return Ui([],n,t.dtype);var d=new Vr(l,t.dtype);d.values.fill(this.readSync(u.dataId)[0]);for(var p=0;p<i;p++){for(var v=[],m=0,g=0;g<a;g++){var y=f[p*a+g];v.push(y),m+=y*s[g]}if(m<0||m>=r/o)throw new Error("Invalid indices: "+v+" does not index into "+n);for(var b=0;b<o;b++)c?d.values[m*o+b]+=h[p*o+b]:d.values[m*o+b]=0===t.rank?h[0]:h[p*o+b]}return d.toTensor().reshape(n)},t}(ls);fo.registerBackend("cpu",(function(){return new Cp}),1);for(var Sp=0,Ip=[{kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,o=t,i=o.boxes,a=o.scores,s=r,u=s.maxOutputSize,c=s.iouThreshold,l=s.scoreThreshold,f=s.softNmsSigma,h=n;_p(i,"NonMaxSuppressionWithScore");var d=Ls(h.data.get(i.dataId).values,h.data.get(a.dataId).values,u,c,l,f);return[d.selectedIndices,d.selectedScores]}},{kernelName:"Square",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,o=n;_p(r,"square");for(var i=o.data.get(r.dataId).values,a=new Float32Array(i.length),s=0;s<i.length;++s){var u=i[s];a[s]=u*u}return{dataId:o.write(a,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},{kernelName:Ll,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t,o=r.a,i=r.b,a=n;_p([o,i],Ll);var s=a.data.get(o.dataId).values,u=a.data.get(i.dataId).values,c=function(e,t,n,r,o,i){var a=ps(e,t),s=a.length,u=Ir(a),c=dr(o,rr(a)),l=e.length,f=t.length,h=Ir(e),d=Ir(t),p=hs(e,a),v=hs(t,a);if(p.length+v.length===0)for(var m=0;m<c.length;++m)c[m]=i(n[m%n.length],r[m%r.length]);else{var g=function(e){var t=Lr(e,s,u),o=t.slice(-l);p.forEach((function(e){return o[e]=0}));var a=Fr(o,l,h),m=t.slice(-f);v.forEach((function(e){return m[e]=0}));var g=Fr(m,f,d);c[e]=i(n[a],r[g])};for(m=0;m<c.length;++m)g(m)}return[c,a]}(o.shape,i.shape,s,u,o.dtype,(function(e,t){var n=e-t;return n*n})),l=c[0],f=c[1];return{dataId:a.write(l,f,o.dtype),shape:f,dtype:o.dtype}}}];Sp<Ip.length;Sp++)qn(Ip[Sp]);for(var Rp,Tp=function(e){this.variableNames=["A"];var t=Ys(),n=e[0],r=e[1];this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+r+".0, "+n+".0);\n\n        vec4 values = "+t.texture2D+"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    "},Ap=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var t=Ys(),n=e[0],r=e[1];this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2("+r+".0, "+n+".0);\n            vec4 values = "+t.texture2D+"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        "+t.output+" = result;\n      }\n    "},Np=0,Op=[{kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,o=t.pixels,i=r.numChannels,a="undefined"!=typeof HTMLVideoElement&&o instanceof HTMLVideoElement,s="undefined"!=typeof HTMLImageElement&&o instanceof HTMLImageElement,u=a?[o.videoWidth,o.videoHeight]:[o.width,o.height],c=u[0],l=u[1],f=[l,c],h=[l,c,i];(s||a)&&(null==Rp&&(Rp=document.createElement("canvas").getContext("2d")),Rp.canvas.width=c,Rp.canvas.height=l,Rp.drawImage(o,0,0,c,l),o=Rp.canvas);var d=n.makeTensorInfo(f,"int32");n.texData.get(d.dataId).usage=mo.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(d.dataId),o);var p=jn().getBool("WEBGL_PACK")?new Ap(h):new Tp(h),v=n.runWebGLProgram(p,[d],"int32");return n.disposeData(d.dataId),v}},{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs;wi("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var o=t,i=o.boxes,a=o.scores,s=r,u=s.maxOutputSize,c=s.iouThreshold,l=s.scoreThreshold,f=s.softNmsSigma,h=n,d=Ls(h.readSync(i.dataId),h.readSync(a.dataId),u,c,l,f);return[d.selectedIndices,d.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,o=n,i=new sl(r.shape,"return x * x;");return o.runWebGLProgram(i,[r],r.dtype)}},{kernelName:Ll,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t,o=r.a,i=r.b,a=n,s=jn().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Cu("return (a - b) * (a - b);",o.shape,i.shape):new _u("return (a - b) * (a - b);",o.shape,i.shape);return a.compileAndRun(s,[o,i])}}];Np<Op.length;Np++)qn(Op[Np]);for(var Dp=0,Pp=[{kernelName:"Square",gradFunc:function(e,t){var n=t[0];return{x:function(){return e.mul(n.toFloat().mul(2))}}}},{kernelName:Ll,gradFunc:function(e,t){var n=t[0],r=t[1],o=Zi(2);return{a:function(){return eh(e,eh(o,ih(n,r)))},b:function(){return eh(e,eh(o,ih(r,n)))}}}}];Dp<Pp.length;Dp++)Gn(Pp[Dp]);var Mp=function(){function e(){}return e.prototype.fetch=function(e,t){return fetch(e,t)},e.prototype.now=function(){return performance.now()},e.prototype.encode=function(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Browser's encoder only supports utf-8, but got "+t);return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)},e.prototype.decode=function(e,t){return new TextDecoder(t).decode(e)},e}();jn().get("IS_BROWSER")&&jn().setPlatform("browser",new Mp);var Fp,Lp=function(){function e(){this.util=n(753),this.textEncoder=new this.util.TextEncoder}return e.prototype.fetch=function(e,t){return null!=jn().global.fetch?jn().global.fetch(e,t):(null==Fp&&(Fp=n(522)),Fp(e,t))},e.prototype.now=function(){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6},e.prototype.encode=function(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Node built-in encoder only supports utf-8, but got "+t);return this.textEncoder.encode(e)},e.prototype.decode=function(e,t){return 0===e.length?"":new this.util.TextDecoder(t).decode(e)},e}();jn().get("IS_NODE")&&jn().setPlatform("node",new Lp);var Bp={float32:4,int32:4,uint16:2,uint8:1,bool:1},Up=4;function jp(e,t){for(var n={},r=0,o=function(t){var o=t.name,i=t.dtype,a=t.shape,s=rr(a),u=void 0;if("quantization"in t){var c=t.quantization;if("uint8"!==c.dtype&&"uint16"!==c.dtype)throw new Error("Weight "+t.name+" has unknown quantization dtype "+c.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var l=Bp[c.dtype],f=e.slice(r,r+s*l),h="uint8"===c.dtype?new Uint8Array(f):new Uint16Array(f);if("float32"===i)u=Float32Array.from(h,(function(e){return e*c.scale+c.min}));else{if("int32"!==i)throw new Error("Unsupported dtype in weight '"+o+"': "+i);u=Int32Array.from(h,(function(e){return Math.round(e*c.scale+c.min)}))}r+=s*l}else if("string"===i){var d=rr(t.shape);u=[];for(var p=0;p<d;p++){var v=new Uint32Array(e.slice(r,r+Up))[0];r+=Up;var m=new Uint8Array(e.slice(r,r+v));u.push(m),r+=v}}else{var g=Bp[i];if(f=e.slice(r,r+s*g),"float32"===i)u=new Float32Array(f);else if("int32"===i)u=new Int32Array(f);else{if("bool"!==i)throw new Error("Unsupported dtype in weight '"+o+"': "+i);u=new Uint8Array(f)}r+=s*g}n[o]=Ui(u,a,i)},i=0,a=t;i<a.length;i++)o(a[i]);return n}function Zp(e){if(null===e)throw new Error("Invalid input value: "+JSON.stringify(e));var t=0,n=[];e.forEach((function(e){if(t+=e.byteLength,n.push(e.byteLength===e.buffer.byteLength?e:new e.constructor(e)),!(e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+e.constructor.name)}));var r=new Uint8Array(t),o=0;return n.forEach((function(e){r.set(new Uint8Array(e.buffer),o),o+=e.byteLength})),r.buffer}var Wp="undefined"!=typeof Buffer&&("undefined"==typeof Blob||"undefined"==typeof atob||"undefined"==typeof btoa);function zp(e){return Wp?Buffer.byteLength(e):new Blob([e]).size}function Vp(e){var t=0;e.forEach((function(e){t+=e.byteLength}));var n=new Uint8Array(t),r=0;return e.forEach((function(e){n.set(new Uint8Array(e),r),r+=e.byteLength})),n.buffer}function Hp(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);var t=e.split("/");return t[t.length-1]}function qp(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==e.modelTopology?0:zp(JSON.stringify(e.modelTopology)),weightSpecsBytes:null==e.weightSpecs?0:zp(JSON.stringify(e.weightSpecs)),weightDataBytes:null==e.weightData?0:e.weightData.byteLength}}var Gp=function(){function e(){this.saveRouters=[],this.loadRouters=[]}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.registerSaveRouter=function(t){e.getInstance().saveRouters.push(t)},e.registerLoadRouter=function(t){e.getInstance().loadRouters.push(t)},e.getSaveHandlers=function(t){return e.getHandlers(t,"save")},e.getLoadHandlers=function(t,n){return e.getHandlers(t,"load",n)},e.getHandlers=function(t,n,r){var o=[];return("load"===n?e.getInstance().loadRouters:e.getInstance().saveRouters).forEach((function(e){var n=e(t,r);null!==n&&o.push(n)})),o},e}(),Kp="://",Xp=function(){function e(){this.managers={}}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.registerManager=function(t,n){Jn(null!=t,(function(){return"scheme must not be undefined or null."})),t.endsWith(Kp)&&(t=t.slice(0,t.indexOf(Kp))),Jn(t.length>0,(function(){return"scheme must not be an empty string."}));var r=e.getInstance();Jn(null==r.managers[t],(function(){return"A model store manager is already registered for scheme '"+t+"'."})),r.managers[t]=n},e.getManager=function(e){var t=this.getInstance().managers[e];if(null==t)throw new Error("Cannot find model manager for scheme '"+e+"'");return t},e.getSchemes=function(){return Object.keys(this.getInstance().managers)},e}();function $p(e){if(-1===e.indexOf(Kp))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+Xp.getSchemes().join(","));return{scheme:e.split(Kp)[0],path:e.split(Kp)[1]}}function Yp(e,t,n){return void 0===n&&(n=!1),Ln(this,void 0,void 0,(function(){var r,o,i,a,s,u,c,l,f;return Bn(this,(function(h){switch(h.label){case 0:return Jn(e!==t,(function(){return"Old path and new path are the same: '"+e+"'"})),Jn((r=Gp.getLoadHandlers(e)).length>0,(function(){return"Copying failed because no load handler is found for source URL "+e+"."})),Jn(r.length<2,(function(){return"Copying failed because more than one ("+r.length+") load handlers for source URL "+e+"."})),o=r[0],Jn((i=Gp.getSaveHandlers(t)).length>0,(function(){return"Copying failed because no save handler is found for destination URL "+t+"."})),Jn(i.length<2,(function(){return"Copying failed because more than one ("+r.length+") save handlers for destination URL "+t+"."})),a=i[0],s=$p(e).scheme,u=$p(e).path,c=s===$p(e).scheme,[4,o.load()];case 1:return l=h.sent(),n&&c?[4,Xp.getManager(s).removeModel(u)]:[3,3];case 2:h.sent(),h.label=3;case 3:return[4,a.save(l)];case 4:return f=h.sent(),!n||c?[3,6]:[4,Xp.getManager(s).removeModel(u)];case 5:h.sent(),h.label=6;case 6:return[2,f.modelArtifactsInfo]}}))}))}var Qp="models_store",Jp="model_info_store";function ev(){if(!jn().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var e=window||self,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(null==t)throw new Error("The current browser does not appear to support IndexedDB.");return t}function tv(e){var t=e.result;t.createObjectStore(Qp,{keyPath:"modelPath"}),t.createObjectStore(Jp,{keyPath:"modelPath"})}var nv=function(){function e(e){if(this.indexedDB=ev(),null==e||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}return e.prototype.save=function(e){return Ln(this,void 0,void 0,(function(){return Bn(this,(function(t){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,e)]}))}))},e.prototype.load=function(){return Ln(this,void 0,void 0,(function(){return Bn(this,(function(e){return[2,this.databaseAction(this.modelPath)]}))}))},e.prototype.databaseAction=function(e,t){var n=this;return new Promise((function(e,r){var o=n.indexedDB.open("tensorflowjs",1);o.onupgradeneeded=function(){return tv(o)},o.onsuccess=function(){var i=o.result;if(null==t){var a=i.transaction(Qp,"readonly"),s=a.objectStore(Qp).get(n.modelPath);s.onsuccess=function(){if(null==s.result)return i.close(),r(new Error("Cannot find model with path '"+n.modelPath+"' in IndexedDB."));e(s.result.modelArtifacts)},s.onerror=function(e){return i.close(),r(s.error)},a.oncomplete=function(){return i.close()}}else{var u,c=qp(t),l=i.transaction(Jp,"readwrite"),f=l.objectStore(Jp),h=f.put({modelPath:n.modelPath,modelArtifactsInfo:c});h.onsuccess=function(){var o=(u=i.transaction(Qp,"readwrite")).objectStore(Qp).put({modelPath:n.modelPath,modelArtifacts:t,modelArtifactsInfo:c});o.onsuccess=function(){return e({modelArtifactsInfo:c})},o.onerror=function(e){var t=(f=l.objectStore(Jp)).delete(n.modelPath);t.onsuccess=function(){return i.close(),r(o.error)},t.onerror=function(e){return i.close(),r(o.error)}}},h.onerror=function(e){return i.close(),r(h.error)},l.oncomplete=function(){null==u?i.close():u.oncomplete=function(){return i.close()}}}},o.onerror=function(e){return r(o.error)}}))},e.URL_SCHEME="indexeddb://",e}(),rv=function(e){return jn().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(nv.URL_SCHEME)?(t=e.slice(nv.URL_SCHEME.length),new nv(t)):null;var t};Gp.registerSaveRouter(rv),Gp.registerLoadRouter(rv);var ov=function(){function e(){this.indexedDB=ev()}return e.prototype.listModels=function(){return Ln(this,void 0,void 0,(function(){var e=this;return Bn(this,(function(t){return[2,new Promise((function(t,n){var r=e.indexedDB.open("tensorflowjs",1);r.onupgradeneeded=function(){return tv(r)},r.onsuccess=function(){var e=r.result,o=e.transaction(Jp,"readonly"),i=o.objectStore(Jp).getAll();i.onsuccess=function(){for(var e={},n=0,r=i.result;n<r.length;n++){var o=r[n];e[o.modelPath]=o.modelArtifactsInfo}t(e)},i.onerror=function(t){return e.close(),n(i.error)},o.oncomplete=function(){return e.close()}},r.onerror=function(e){return n(r.error)}}))]}))}))},e.prototype.removeModel=function(e){return Ln(this,void 0,void 0,(function(){var t=this;return Bn(this,(function(n){var r;return e=(r=e).startsWith(nv.URL_SCHEME)?r.slice(nv.URL_SCHEME.length):r,[2,new Promise((function(n,r){var o=t.indexedDB.open("tensorflowjs",1);o.onupgradeneeded=function(){return tv(o)},o.onsuccess=function(){var t,i=o.result,a=i.transaction(Jp,"readwrite"),s=a.objectStore(Jp),u=s.get(e);u.onsuccess=function(){if(null==u.result)return i.close(),r(new Error("Cannot find model with path '"+e+"' in IndexedDB."));var o=s.delete(e),a=function(){var o=(t=i.transaction(Qp,"readwrite")).objectStore(Qp).delete(e);o.onsuccess=function(){return n(u.result.modelArtifactsInfo)},o.onerror=function(e){return r(u.error)}};o.onsuccess=a,o.onerror=function(e){return a(),i.close(),r(u.error)}},u.onerror=function(e){return i.close(),r(u.error)},a.oncomplete=function(){null==t?i.close():t.oncomplete=function(){return i.close()}}},o.onerror=function(e){return r(o.error)}}))]}))}))},e}();if(jn().getBool("IS_BROWSER"))try{Xp.registerManager(nv.URL_SCHEME,new ov)}catch(eo){}var iv="/",av="tensorflowjs_models",sv="info",uv="model_topology",cv="weight_specs",lv="weight_data",fv="model_metadata";function hv(e){return{info:[av,e,sv].join(iv),topology:[av,e,uv].join(iv),weightSpecs:[av,e,cv].join(iv),weightData:[av,e,lv].join(iv),modelMetadata:[av,e,fv].join(iv)}}function dv(e){var t=e.split(iv);if(t.length<3)throw new Error("Invalid key format: "+e);return t.slice(1,t.length-1).join(iv)}var pv=function(){function e(e){if(!jn().getBool("IS_BROWSER")||"undefined"==typeof window||void 0===window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==e||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=hv(this.modelPath)}return e.prototype.save=function(e){return Ln(this,void 0,void 0,(function(){var t,n,r;return Bn(this,(function(o){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");t=JSON.stringify(e.modelTopology),n=JSON.stringify(e.weightSpecs),r=qp(e);try{return this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,function(e){if(Wp)return Buffer.from(e).toString("base64");for(var t=new Uint8Array(e),n="",r=0,o=t.length;r<o;r++)n+=String.fromCharCode(t[r]);return btoa(n)}(e.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,userDefinedMetadata:e.userDefinedMetadata})),[2,{modelArtifactsInfo:r}]}catch(e){throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+r.modelTopologyBytes+", weightSpecsBytes="+r.weightSpecsBytes+", weightDataBytes="+r.weightDataBytes+".")}return[2]}))}))},e.prototype.load=function(){return Ln(this,void 0,void 0,(function(){var e,t,n,r,o,i,a;return Bn(this,(function(s){if(null==(e=JSON.parse(this.LS.getItem(this.keys.info))))throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if("JSON"!==e.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(t={},null==(n=JSON.parse(this.LS.getItem(this.keys.topology))))throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(t.modelTopology=n,null==(r=JSON.parse(this.LS.getItem(this.keys.weightSpecs))))throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(t.weightSpecs=r,null!=(o=this.LS.getItem(this.keys.modelMetadata))&&(i=JSON.parse(o),t.format=i.format,t.generatedBy=i.generatedBy,t.convertedBy=i.convertedBy,t.userDefinedMetadata=i.userDefinedMetadata),null==(a=this.LS.getItem(this.keys.weightData)))throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return t.weightData=function(e){if(Wp){var t=Buffer.from(e,"base64");return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}for(var n=atob(e),r=new Uint8Array(n.length),o=0;o<n.length;++o)r.set([n.charCodeAt(o)],o);return r.buffer}(a),[2,t]}))}))},e.URL_SCHEME="localstorage://",e}(),vv=function(e){return jn().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(pv.URL_SCHEME)?(t=e.slice(pv.URL_SCHEME.length),new pv(t)):null;var t};Gp.registerSaveRouter(vv),Gp.registerLoadRouter(vv);var mv=function(){function e(){Jn(jn().getBool("IS_BROWSER"),(function(){return"Current environment is not a web browser"})),Jn("undefined"==typeof window||void 0!==window.localStorage,(function(){return"Current browser does not appear to support localStorage"})),this.LS=window.localStorage}return e.prototype.listModels=function(){return Ln(this,void 0,void 0,(function(){var e,t,n,r,o,i;return Bn(this,(function(a){for(e={},t=av+iv,n=iv+sv,r=0;r<this.LS.length;++r)(o=this.LS.key(r)).startsWith(t)&&o.endsWith(n)&&(i=dv(o),e[i]=JSON.parse(this.LS.getItem(o)));return[2,e]}))}))},e.prototype.removeModel=function(e){return Ln(this,void 0,void 0,(function(){var t,n;return Bn(this,(function(r){var o;if(e=(o=e).startsWith(pv.URL_SCHEME)?o.slice(pv.URL_SCHEME.length):o,t=hv(e),null==this.LS.getItem(t.info))throw new Error("Cannot find model at path '"+e+"'");return n=JSON.parse(this.LS.getItem(t.info)),this.LS.removeItem(t.info),this.LS.removeItem(t.topology),this.LS.removeItem(t.weightSpecs),this.LS.removeItem(t.weightData),[2,n]}))}))},e}();if(jn().getBool("IS_BROWSER"))try{Xp.registerManager(pv.URL_SCHEME,new mv)}catch(eo){}function gv(e){return new Promise((function(e){return setTimeout(e)})).then(e)}var yv=function(){function e(t){if(!jn().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(e.URL_SCHEME)&&(t=t.slice(e.URL_SCHEME.length)),null!=t&&0!==t.length||(t="model"),this.modelTopologyFileName=t+".json",this.weightDataFileName=t+".weights.bin"}return e.prototype.save=function(e){return Ln(this,void 0,void 0,(function(){var t,n,r,o,i,a;return Bn(this,(function(s){switch(s.label){case 0:if("undefined"==typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(t=window.URL.createObjectURL(new Blob([e.weightData],{type:"application/octet-stream"})),!(e.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return n=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],r={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:n},o=window.URL.createObjectURL(new Blob([JSON.stringify(r)],{type:"application/json"})),(i=null==this.jsonAnchor?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,i.href=o,[4,gv((function(){return i.dispatchEvent(new MouseEvent("click"))}))];case 2:return s.sent(),null==e.weightData?[3,4]:((a=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,a.href=t,[4,gv((function(){return a.dispatchEvent(new MouseEvent("click"))}))]);case 3:s.sent(),s.label=4;case 4:return[2,{modelArtifactsInfo:qp(e)}]}}))}))},e.URL_SCHEME="downloads://",e}(),bv=function(){function e(e){if(null==e||e.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+e);this.files=e}return e.prototype.load=function(){return Ln(this,void 0,void 0,(function(){var e,t,n=this;return Bn(this,(function(r){return e=this.files[0],t=this.files.slice(1),[2,new Promise((function(r,o){var i=new FileReader;i.onload=function(i){var a=JSON.parse(i.target.result),s=a.modelTopology;if(null!=s){0===t.length&&r({modelTopology:s});var u=a.weightsManifest;if(null!=u){var c;try{c=n.checkManifestAndWeightFiles(u,t)}catch(e){return void o(e)}var l=[],f=[],h=[];u.forEach((function(e){e.paths.forEach((function(e){f.push(e),h.push(null)})),l.push.apply(l,e.weights)})),u.forEach((function(e){e.paths.forEach((function(e){var t=new FileReader;t.onload=function(t){var n=t.target.result,o=f.indexOf(e);h[o]=n,-1===h.indexOf(null)&&r({modelTopology:s,weightSpecs:l,weightData:Vp(h),format:a.format,generatedBy:a.generatedBy,convertedBy:a.convertedBy,userDefinedMetadata:a.userDefinedMetadata})},t.onerror=function(t){return o("Failed to weights data from file of path '"+e+"'.")},t.readAsArrayBuffer(c[e])}))}))}else o(new Error("weightManifest field is missing from file "+e.name))}else o(new Error("modelTopology field is missing from file "+e.name))},i.onerror=function(t){return o("Failed to read model topology and weights manifest JSON from file '"+e.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},i.readAsText(e)}))]}))}))},e.prototype.checkManifestAndWeightFiles=function(e,t){for(var n=[],r=t.map((function(e){return Hp(e.name)})),o={},i=0,a=e;i<a.length;i++)a[i].paths.forEach((function(e){var i=Hp(e);if(-1!==n.indexOf(i))throw new Error("Duplicate file basename found in weights manifest: '"+i+"'");if(n.push(i),-1===r.indexOf(i))throw new Error("Weight file with basename '"+i+"' is not provided.");o[e]=t[r.indexOf(i)]}));if(n.length!==t.length)throw new Error("Mismatch in the number of files in weights manifest ("+n.length+") and the number of weight files provided ("+t.length+").");return o},e}();function wv(e,t,n,r){!function(e){Jn(null!=e&&Array.isArray(e)&&e.length>0,(function(){return"promises must be a none empty array"}))}(e),function(e,t){Jn(e>=0&&e<=1,(function(){return"Progress fraction must be in range [0, 1], but got startFraction "+e})),Jn(t>=0&&t<=1,(function(){return"Progress fraction must be in range [0, 1], but got endFraction "+t})),Jn(t>=e,(function(){return"startFraction must be no more than endFraction, but got startFraction "+e+" and endFraction "+t}))}(n=null==n?0:n,r=null==r?1:r);var o=0;return Promise.all(e.map((function(i){return i.then((function(i){var a=n+ ++o/e.length*(r-n);return t(a),i})),i})))}function xv(e,t){return Ln(this,void 0,void 0,(function(){var n,r,o,i,a,s,u,c,l;return Bn(this,(function(f){switch(f.label){case 0:return null==t&&(t={}),n=null==t.fetchFunc?jn().platform.fetch:t.fetchFunc,r=e.map((function(e){return n(e,t.requestInit,{isBinary:!0})})),o=0,i=.5,null!=t.onProgress?[3,2]:[4,Promise.all(r)];case 1:return a=f.sent(),[3,4];case 2:return[4,wv(r,t.onProgress,o,i)];case 3:a=f.sent(),f.label=4;case 4:return s=a.map((function(e){return e.arrayBuffer()})),u=.5,c=1,null!=t.onProgress?[3,6]:[4,Promise.all(s)];case 5:return l=f.sent(),[3,8];case 6:return[4,wv(s,t.onProgress,u,c)];case 7:l=f.sent(),f.label=8;case 8:return[2,l]}}))}))}function kv(e){var t=this;return function(n,r,o){return void 0===r&&(r=""),Ln(t,void 0,void 0,(function(){var t,i,a,s,u,c,l,f,h,d;return Bn(this,(function(p){switch(p.label){case 0:if(t=n.map((function(){return!1})),i={},a=null!=o?o.map((function(){return!1})):[],s=[],n.forEach((function(e,n){var r=0;e.weights.forEach((function(e){var u="quantization"in e?e.quantization.dtype:e.dtype,c=Bp[u]*rr(e.shape),l=function(){t[n]=!0,null==i[n]&&(i[n]=[]),i[n].push({manifestEntry:e,groupOffset:r,sizeBytes:c})};null!=o?o.forEach((function(t,n){t===e.name&&(l(),a[n]=!0)})):l(),s.push(e.name),r+=c}))})),!a.every((function(e){return e})))throw u=o.filter((function(e,t){return!a[t]})),new Error("Could not find weights in manifest with names: "+u.join(", ")+". \nManifest JSON has weights with names: "+s.join(", ")+".");return c=t.reduce((function(e,t,n){return t&&e.push(n),e}),[]),l=[],c.forEach((function(e){n[e].paths.forEach((function(e){var t=r+(r.endsWith("/")?"":"/")+e;l.push(t)}))})),[4,e(l)];case 1:return f=p.sent(),h={},d=0,c.forEach((function(e){for(var t=n[e].paths.length,r=0,o=0;o<t;o++)r+=f[d+o].byteLength;for(var a=new ArrayBuffer(r),s=new Uint8Array(a),u=0,c=0;c<t;c++){var l=new Uint8Array(f[d+c]);s.set(l,u),u+=l.byteLength}i[e].forEach((function(e){var t=jp(a.slice(e.groupOffset,e.groupOffset+e.sizeBytes),[e.manifestEntry]);for(var n in t)h[n]=t[n]})),d+=t})),[2,h]}}))}))}}Gp.registerSaveRouter((function(e){return jn().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(yv.URL_SCHEME)?function(e){return void 0===e&&(e="model"),new yv(e)}(e.slice(yv.URL_SCHEME.length)):null}));var _v=function(){function e(e,t){if(this.DEFAULT_METHOD="POST",null==t&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.onProgress=t.onProgress,null!=t.fetchFunc?(Jn("function"==typeof t.fetchFunc,(function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"})),this.fetch=t.fetchFunc):this.fetch=jn().platform.fetch,Jn(null!=e&&e.length>0,(function(){return"URL path for http must not be null, undefined or empty."})),Array.isArray(e)&&Jn(2===e.length,(function(){return"URL paths for http must have a length of 2, (actual length is "+e.length+")."})),this.path=e,null!=t.requestInit&&null!=t.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{}}return e.prototype.save=function(e){return Ln(this,void 0,void 0,(function(){var t,n,r,o;return Bn(this,(function(i){switch(i.label){case 0:if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,n=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],r={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,userDefinedMetadata:e.userDefinedMetadata,weightsManifest:n},t.body.append("model.json",new Blob([JSON.stringify(r)],{type:"application/json"}),"model.json"),null!=e.weightData&&t.body.append("model.weights.bin",new Blob([e.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,t)];case 1:if((o=i.sent()).ok)return[2,{modelArtifactsInfo:qp(e),responses:[o]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+o.status+".")}}))}))},e.prototype.load=function(){return Ln(this,void 0,void 0,(function(){var e,t,n,r,o,i,a,s,u,c,l,f;return Bn(this,(function(h){switch(h.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(e=h.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+e.status+". Please verify this URL points to the model JSON of the model to load.");h.label=2;case 2:return h.trys.push([2,4,,5]),[4,e.json()];case 3:return t=h.sent(),[3,5];case 4:throw h.sent(),n="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?n+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":n+=" Please make sure the server is serving valid JSON for this request.",new Error(n);case 5:if(r=t.modelTopology,o=t.weightsManifest,i=t.generatedBy,a=t.convertedBy,s=t.format,u=t.userDefinedMetadata,null==r&&null==o)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return null==o?[3,7]:[4,this.loadWeights(o)];case 6:f=h.sent(),c=f[0],l=f[1],h.label=7;case 7:return[2,{modelTopology:r,weightSpecs:c,weightData:l,userDefinedMetadata:u,generatedBy:i,convertedBy:a,format:s}]}}))}))},e.prototype.loadWeights=function(e){return Ln(this,void 0,void 0,(function(){var t,n,r,o,i,a,s,u,c,l,f;return Bn(this,(function(h){switch(h.label){case 0:for(t=Array.isArray(this.path)?this.path[1]:this.path,n=function(e){var t=e.lastIndexOf("/"),n=e.lastIndexOf("?");return[e.substring(0,t)+"/",n>t?e.substring(n):""]}(t),r=n[0],o=n[1],i=this.weightPathPrefix||r,a=[],s=0,u=e;s<u.length;s++)c=u[s],a.push.apply(a,c.weights);return l=[],e.forEach((function(e){e.paths.forEach((function(e){l.push(i+e+o)}))})),[4,xv(l,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return f=h.sent(),[2,[a,Vp(f)]]}}))}))},e.URL_SCHEME_REGEX=/^https?:\/\//,e}();function Ev(e){return null!=e.match(_v.URL_SCHEME_REGEX)}var Cv=function(e,t){return"undefined"==typeof fetch?null:(Array.isArray(e)?e.every((function(e){return Ev(e)})):Ev(e))?Sv(e,{onProgress:t}):null};function Sv(e,t){return new _v(e,t)}Gp.registerSaveRouter(Cv),Gp.registerLoadRouter(Cv);var Iv,Rv=function(){function e(e){this.modelArtifacts=e}return e.prototype.load=function(){return Ln(this,void 0,void 0,(function(){return Bn(this,(function(e){return[2,this.modelArtifacts]}))}))},e}(),Tv=function(){function e(e){this.saveHandler=e}return e.prototype.save=function(e){return Ln(this,void 0,void 0,(function(){return Bn(this,(function(t){return[2,this.saveHandler(e)]}))}))},e}(),Av=Object.freeze({browserFiles:function(e){return new bv(e)},browserHTTPRequest:function(e,t){return Sv(e,t)},concatenateArrayBuffers:Vp,decodeWeights:jp,encodeWeights:function(e,t){return Ln(this,void 0,void 0,(function(){var n,r,o,i,a,s=this;return Bn(this,(function(u){switch(u.label){case 0:for(n=[],r=[],o=Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e),i=function(i){var a=o[i],u=Array.isArray(e)?e[i].tensor:e[a];if("float32"!==u.dtype&&"int32"!==u.dtype&&"bool"!==u.dtype&&"string"!==u.dtype)throw new Error("Unsupported dtype in weight '"+a+"': "+u.dtype);var c={name:a,shape:u.shape,dtype:u.dtype};if("string"===u.dtype){var l=new Promise((function(e){return Ln(s,void 0,void 0,(function(){var t,n,r,o,i,a,s;return Bn(this,(function(c){switch(c.label){case 0:return[4,u.bytes()];case 1:for(t=c.sent(),n=t.reduce((function(e,t){return e+t.length}),0)+Up*t.length,r=new Uint8Array(n),o=0,i=0;i<t.length;i++)a=t[i],s=new Uint8Array(new Uint32Array([a.length]).buffer),r.set(s,o),o+=Up,r.set(a,o),o+=a.length;return e(r),[2]}}))}))}));r.push(l)}else r.push(u.data());null!=t&&(c.group=t),n.push(c)},a=0;a<o.length;++a)i(a);return[4,Promise.all(r)];case 1:return[2,{data:Zp(u.sent()),specs:n}]}}))}))},fromMemory:function(e,t,n,r){return 1===arguments.length?null!=e.modelTopology||null!=e.weightSpecs?new Rv(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Rv({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Rv({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r}))},getLoadHandlers:function(e,t){return Gp.getLoadHandlers(e,t)},getModelArtifactsInfoForJSON:qp,getSaveHandlers:function(e){return Gp.getSaveHandlers(e)},http:Sv,isHTTPScheme:Ev,loadWeights:function(e,t,n,r){return void 0===t&&(t=""),Ln(this,void 0,void 0,(function(){return Bn(this,(function(o){return[2,kv((function(e){return xv(e,{requestInit:r})}))(e,t,n)]}))}))},registerLoadRouter:function(e){return Gp.registerLoadRouter(e)},registerSaveRouter:function(e){return Gp.registerSaveRouter(e)},weightsLoaderFactory:kv,withSaveHandler:function(e){return new Tv(e)},copyModel:function(e,t){return Ln(this,void 0,void 0,(function(){return Bn(this,(function(n){return[2,Yp(e,t,!1)]}))}))},listModels:function(){return Ln(this,void 0,void 0,(function(){var e,t,n,r,o,i,a;return Bn(this,(function(s){switch(s.label){case 0:e=Xp.getSchemes(),t={},n=0,r=e,s.label=1;case 1:return n<r.length?(o=r[n],[4,Xp.getManager(o).listModels()]):[3,4];case 2:for(a in i=s.sent())t[o+Kp+a]=i[a];s.label=3;case 3:return n++,[3,1];case 4:return[2,t]}}))}))},moveModel:function(e,t){return Ln(this,void 0,void 0,(function(){return Bn(this,(function(n){return[2,Yp(e,t,!0)]}))}))},removeModel:function(e){return Ln(this,void 0,void 0,(function(){var t;return Bn(this,(function(n){return t=$p(e),[2,Xp.getManager(t.scheme).removeModel(t.path)]}))}))}}),Nv=Mi({confusionMatrix_:function(e,t,n){var r=_i(e,"labels","confusionMatrix"),o=_i(t,"predictions","confusionMatrix");Jn(null==n||n>0&&Number.isInteger(n),(function(){return"If provided, numClasses must be a positive integer, but got "+n})),Jn(1===r.rank,(function(){return"Expected the rank of labels to be 1, but got "+r.rank})),Jn(1===o.rank,(function(){return"Expected the rank of predictions to be 1, but got "+o.rank})),Jn(r.shape[0]===o.shape[0],(function(){return"Mismatch in the number of examples: "+r.shape[0]+" vs. "+o.shape[0]+". Labels and predictions should have the same number of elements."})),Jn(n>0&&Number.isInteger(n),(function(){return"numClasses is required to be a positive integer, but got "+n}));var i=Sa(r.asType("int32"),n),a=Sa(o.asType("int32"),n);return i.transpose().matMul(a).asType("int32")}}),Ov=(Object.freeze({confusionMatrix:Nv}),Mi({fromPixels_:function(e,t){if(void 0===t&&(t=3),t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==e)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=!1,r=!1,o=!1,i=!1,a=!1;if(e.data instanceof Uint8Array)n=!0;else if("undefined"!=typeof ImageData&&e instanceof ImageData)r=!0;else if("undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement)o=!0;else if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement)i=!0;else{if(null==e.getContext)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+e.constructor.name);a=!0}if(o&&o&&e.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(null!=Vn("FromPixels",fo.backendName))return fo.runKernel("FromPixels",{pixels:e},{numChannels:t});var s,u,c=o?[e.videoWidth,e.videoHeight]:[e.width,e.height],l=c[0],f=c[1];if(a?s=e.getContext("2d").getImageData(0,0,l,f).data:r||n?s=e.data:(i||o)&&(null==Iv&&(Iv=document.createElement("canvas").getContext("2d")),Iv.canvas.width=l,Iv.canvas.height=f,Iv.drawImage(e,0,0,l,f),s=Iv.getImageData(0,0,l,f).data),4===t)u=new Int32Array(s);else{var h=l*f;u=new Int32Array(h*t);for(var d=0;d<h;d++)for(var p=0;p<t;++p)u[d*t+p]=s[4*d+p]}return Vi(u,[f,l,t],"int32")}})),Dv=Object.freeze({toPixels:function(e,t){return Ln(this,void 0,void 0,(function(){var n,r,o,i,a,s,u,c,l,f,h,d,p,v,m,g,y,b,w,x,k,_,E;return Bn(this,(function(C){switch(C.label){case 0:if(n=_i(e,"img","toPixels"),e instanceof Kr||(n=n.toInt()),2!==n.rank&&3!==n.rank)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+n.rank+".");if(r=n.shape.slice(0,2),o=r[0],i=r[1],(a=2===n.rank?1:n.shape[2])>4||2===a)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+a);return[4,n.data()];case 1:return s=C.sent(),u=n.min(),c=n.max(),[4,Promise.all([u.data(),c.data()])];case 2:if(l=C.sent(),f=l[0],h=l[1],d=f[0],p=h[0],u.dispose(),c.dispose(),"float32"===n.dtype){if(d<0||p>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+d+" - "+p+"].")}else{if("int32"!==n.dtype)throw new Error("Unsupported type for toPixels: "+n.dtype+". Please use float32 or int32 tensors.");if(d<0||p>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+d+" - "+p+"].")}for(v="float32"===n.dtype?255:1,m=new Uint8ClampedArray(i*o*4),g=0;g<o*i;++g)y=void 0,b=void 0,w=void 0,x=void 0,1===a?(y=s[g]*v,b=s[g]*v,w=s[g]*v,x=255):3===a?(y=s[3*g]*v,b=s[3*g+1]*v,w=s[3*g+2]*v,x=255):4===a&&(y=s[4*g]*v,b=s[4*g+1]*v,w=s[4*g+2]*v,x=s[4*g+3]*v),m[0+(k=4*g)]=Math.round(y),m[k+1]=Math.round(b),m[k+2]=Math.round(w),m[k+3]=Math.round(x);return null!=t&&(t.width=i,t.height=o,_=t.getContext("2d"),E=new ImageData(m,i,o),_.putImageData(E,0,0)),n!==e&&n.dispose(),[2,m]}}))}))},fromPixels:Ov}),Pv=function(){function e(){}return e.prototype.getClassName=function(){return this.constructor.className},e.fromConfig=function(e,t){return new e(t)},e}(),Mv=function(){function e(){this.classNameMap={}}return e.getMap=function(){return null==e.instance&&(e.instance=new e),e.instance},e.register=function(t){e.getMap().classNameMap[t.className]=[t,t.fromConfig]},e}();function Fv(e){Jn(null!=e.className,(function(){return"Class being registered does not have the static className property defined."})),Jn("string"==typeof e.className,(function(){return"className is required to be a string, but got type "+typeof e.className})),Jn(e.className.length>0,(function(){return"Class being registered has an empty-string as its className, which is disallowed."})),Mv.register(e)}Object.freeze({Serializable:Pv,SerializationMap:Mv,registerClass:Fv});function Lv(){return 32===fo.backend.floatPrecision()?.001:.1}function Bv(e,t,n){var r=!0;if((yr(e)||yr(t))&&(r=!1),yr(e)&&yr(t)&&(r=!0),r){var o=e.constructor.name,i=t.constructor.name;if(o!==i)throw new Error("Arrays are of different type. Actual: "+o+". Expected: "+i)}if(Array.isArray(e)&&Array.isArray(t)){var a=xi(e),s=xi(t);if(!or(a,s))throw new Error("Arrays have different shapes. Actual: ["+a+"]. Expected: ["+s+"]")}var u=yr(e)?e:nr(e),c=yr(t)?t:nr(t);if(u.length!==c.length)throw new Error("Arrays have different lengths actual: "+u.length+" vs expected: "+c.length+".\nActual:   "+u+".\nExpected: "+c+".");for(var l=0;l<c.length;++l){var f=u[l],h=c[l];if(!n(f,h))throw new Error("Arrays differ: actual["+l+"] = "+f+", expected["+l+"] = "+h+".\nActual:   "+u+".\nExpected: "+c+".")}}function Uv(e,t,n){return!isFinite(e)&&!isFinite(t)||!(isNaN(e)||isNaN(t)||Math.abs(e-t)>n)}Object.freeze({TEST_EPSILON_FLOAT16:.1,expectArraysClose:function(e,t,n){return null==n&&(n=Lv()),Bv(e,t,(function(e,t){return Uv(e,t,n)}))},testEpsilon:Lv,expectPromiseToFail:function(e,t){e().then((function(){return t.fail()}),(function(){return t()}))},expectArraysEqual:function(e,t){var n="string"==typeof t||"number"==typeof t||"boolean"==typeof t?[t]:t;return xr(e)||xr(e[0])||xr(t)||xr(t[0])?Bv(e,n,(function(e,t){return e==t})):Bv(e,t,(function(e,t){return Uv(e,t,0)}))},expectNumbersClose:function(e,t,n){if(null==n&&(n=Lv()),!Uv(e,t,n))throw new Error("Numbers differ: actual === "+e+", expected === "+t)},expectValuesInRange:function(e,t,n){for(var r=0;r<e.length;r++)if(e[r]<t||e[r]>n)throw new Error("Value out of range:"+e[r]+" low: "+t+", high: "+n)},expectArrayBuffersEqual:function(e,t){expect(new Float32Array(e)).toEqual(new Float32Array(t))}}),Object.freeze({gpgpu_util:wc,webgl_util:vi,forceHalfFloat:function(){jn().set("WEBGL_FORCE_F16_TEXTURES",!0)},MathBackendWebGL:Ml,setWebGLContext:wo,GPGPUContext:xc});var jv=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Fn(t,e),t.prototype.minimize=function(e,t,n){void 0===t&&(t=!1);var r=this.computeGradients(e,n),o=r.value,i=r.grads;if(null!=n){var a=n.map((function(e){return{name:e.name,tensor:i[e.name]}}));this.applyGradients(a)}else this.applyGradients(i);return bi(i),t?o:(o.dispose(),null)},Object.defineProperty(t.prototype,"iterations",{get:function(){return null==this.iterations_&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),t.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},t.prototype.computeGradients=function(e,t){return function(e,t){Jn(Cr(e),(function(){return"The f passed in variableGrads(f) must be a function"})),Jn(null==t||Array.isArray(t)&&t.every((function(e){return e instanceof to})),(function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"}));var n=null!=t;if(!n)for(var r in t=[],fo.registeredVariables)t.push(fo.registeredVariables[r]);var o=n?t.filter((function(e){return!e.trainable})):null,i=t.length;Jn((t=t.filter((function(e){return e.trainable}))).length>0,(function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+i+" variables is trainable."}));var a=fo.gradients(e,t,null,!0),s=a.value,u=a.grads;Jn(u.some((function(e){return null!=e})),(function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."})),Jn(0===s.rank,(function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+s.rank+" tensor"}));var c={};return t.forEach((function(e,t){null!=u[t]&&(c[e.name]=u[t])})),null!=o&&o.forEach((function(e){return c[e.name]=null})),{value:s,grads:c}}(e,t)},t.prototype.dispose=function(){null!=this.iterations_&&bi(this.iterations_)},t.prototype.saveIterations=function(){return Ln(this,void 0,void 0,(function(){return Bn(this,(function(e){return null==this.iterations_&&(this.iterations_=0),[2,{name:"iter",tensor:Zi(this.iterations_,"int32")}]}))}))},t.prototype.getWeights=function(){return Ln(this,void 0,void 0,(function(){return Bn(this,(function(e){throw new Error("getWeights() is not implemented for this optimizer yet.")}))}))},t.prototype.setWeights=function(e){return Ln(this,void 0,void 0,(function(){return Bn(this,(function(e){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())}))}))},t.prototype.extractIterations=function(e){return Ln(this,void 0,void 0,(function(){var t;return Bn(this,(function(n){switch(n.label){case 0:return t=this,[4,e[0].tensor.data()];case 1:return t.iterations_=n.sent()[0],[2,e.slice(1)]}}))}))},t}(Pv);Object.defineProperty(jv,Symbol.hasInstance,{value:function(e){return null!=e.minimize&&null!=e.computeGradients&&null!=e.applyGradients}});var Zv=function(e){function t(t,n,r){void 0===r&&(r=null);var o=e.call(this)||this;return o.learningRate=t,o.rho=n,o.epsilon=r,o.accumulatedGrads=[],o.accumulatedUpdates=[],null==r&&(o.epsilon=fo.backend.epsilon()),o}return Fn(t,e),t.prototype.applyGradients=function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var o=fo.registeredVariables[n];null==t.accumulatedGrads[r]&&(t.accumulatedGrads[r]={originalName:n+"/accum_grad",variable:yi((function(){return Yi(o).variable(!1)}))}),null==t.accumulatedUpdates[r]&&(t.accumulatedUpdates[r]={originalName:n+"/accum_var",variable:yi((function(){return Yi(o).variable(!1)}))});var i=Array.isArray(e)?e[r].tensor:e[n];if(null!=i){var a=t.accumulatedGrads[r].variable,s=t.accumulatedUpdates[r].variable;yi((function(){var e=a.mul(t.rho).add(i.square().mul(1-t.rho)),n=s.add(t.epsilon).sqrt().div(a.add(t.epsilon).sqrt()).mul(i),r=s.mul(t.rho).add(n.square().mul(1-t.rho));a.assign(e),s.assign(r);var u=n.mul(-t.learningRate).add(o);o.assign(u)}))}})),this.incrementIterations()},t.prototype.dispose=function(){null!=this.accumulatedUpdates&&(bi(this.accumulatedGrads.map((function(e){return e.variable}))),bi(this.accumulatedUpdates.map((function(e){return e.variable}))))},t.prototype.getWeights=function(){return Ln(this,void 0,void 0,(function(){var e;return Bn(this,(function(t){switch(t.label){case 0:return e=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(e.map((function(e){return{name:e.originalName,tensor:e.variable}})))]}}))}))},t.prototype.setWeights=function(e){return Ln(this,void 0,void 0,(function(){var t;return Bn(this,(function(n){switch(n.label){case 0:return[4,this.extractIterations(e)];case 1:return e=n.sent(),t=e.length/2,this.accumulatedGrads=e.slice(0,t).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),this.accumulatedUpdates=e.slice(t,2*t).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),[2]}}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},t.fromConfig=function(e,t){return new e(t.learningRate,t.rho,t.epsilon)},t.className="Adadelta",t}(jv);Fv(Zv);var Wv=function(e){function t(t,n){void 0===n&&(n=.1);var r=e.call(this)||this;return r.learningRate=t,r.initialAccumulatorValue=n,r.accumulatedGrads=[],r}return Fn(t,e),t.prototype.applyGradients=function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var o=fo.registeredVariables[n];null==t.accumulatedGrads[r]&&(t.accumulatedGrads[r]={originalName:n+"/accumulator",variable:yi((function(){return Ki(o.shape,t.initialAccumulatorValue).variable(!1)}))});var i=Array.isArray(e)?e[r].tensor:e[n];if(null!=i){var a=t.accumulatedGrads[r].variable;yi((function(){var e=a.add(i.square());a.assign(e);var n=i.div(e.add(fo.backend.epsilon()).sqrt()).mul(-t.learningRate).add(o);o.assign(n)}))}})),this.incrementIterations()},t.prototype.dispose=function(){null!=this.accumulatedGrads&&bi(this.accumulatedGrads.map((function(e){return e.variable})))},t.prototype.getWeights=function(){return Ln(this,void 0,void 0,(function(){return Bn(this,(function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(this.accumulatedGrads.map((function(e){return{name:e.originalName,tensor:e.variable}})))]}}))}))},t.prototype.setWeights=function(e){return Ln(this,void 0,void 0,(function(){return Bn(this,(function(t){switch(t.label){case 0:return[4,this.extractIterations(e)];case 1:return e=t.sent(),this.accumulatedGrads=e.map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),[2]}}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},t.fromConfig=function(e,t){return new e(t.learningRate,t.initialAccumulatorValue)},t.className="Adagrad",t}(jv);Fv(Wv);var zv=function(e){function t(t,n,r,o){void 0===o&&(o=null);var i=e.call(this)||this;return i.learningRate=t,i.beta1=n,i.beta2=r,i.epsilon=o,i.accumulatedFirstMoment=[],i.accumulatedSecondMoment=[],yi((function(){i.accBeta1=Zi(n).variable(),i.accBeta2=Zi(r).variable()})),null==o&&(i.epsilon=fo.backend.epsilon()),i}return Fn(t,e),t.prototype.applyGradients=function(e){var t=this,n=Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e);yi((function(){var r=ih(1,t.accBeta1),o=ih(1,t.accBeta2);n.forEach((function(n,i){var a=fo.registeredVariables[n];null==t.accumulatedFirstMoment[i]&&(t.accumulatedFirstMoment[i]={originalName:n+"/m",variable:yi((function(){return Yi(a).variable(!1)}))}),null==t.accumulatedSecondMoment[i]&&(t.accumulatedSecondMoment[i]={originalName:n+"/v",variable:yi((function(){return Yi(a).variable(!1)}))});var s=Array.isArray(e)?e[i].tensor:e[n];if(null!=s){var u=t.accumulatedFirstMoment[i].variable,c=t.accumulatedSecondMoment[i].variable,l=u.mul(t.beta1).add(s.mul(1-t.beta1)),f=c.mul(t.beta2).add(s.square().mul(1-t.beta2)),h=l.div(r),d=f.div(o);u.assign(l),c.assign(f);var p=h.div(d.sqrt().add(t.epsilon)).mul(-t.learningRate).add(a);a.assign(p)}})),t.accBeta1.assign(t.accBeta1.mul(t.beta1)),t.accBeta2.assign(t.accBeta2.mul(t.beta2))})),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&bi(this.accumulatedFirstMoment.map((function(e){return e.variable}))),null!=this.accumulatedSecondMoment&&bi(this.accumulatedSecondMoment.map((function(e){return e.variable})))},t.prototype.getWeights=function(){return Ln(this,void 0,void 0,(function(){var e;return Bn(this,(function(t){switch(t.label){case 0:return e=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(e.map((function(e){return{name:e.originalName,tensor:e.variable}})))]}}))}))},t.prototype.setWeights=function(e){return Ln(this,void 0,void 0,(function(){var t,n=this;return Bn(this,(function(r){switch(r.label){case 0:return[4,this.extractIterations(e)];case 1:return e=r.sent(),yi((function(){n.accBeta1.assign(nh(n.beta1,n.iterations_+1)),n.accBeta2.assign(nh(n.beta2,n.iterations_+1))})),t=e.length/2,this.accumulatedFirstMoment=e.slice(0,t).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),this.accumulatedSecondMoment=e.slice(t,2*t).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),[2]}}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},t.fromConfig=function(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)},t.className="Adam",t}(jv);Fv(zv);var Vv=function(e){function t(t,n,r,o,i){void 0===o&&(o=null),void 0===i&&(i=0);var a=e.call(this)||this;return a.learningRate=t,a.beta1=n,a.beta2=r,a.epsilon=o,a.decay=i,a.accumulatedFirstMoment=[],a.accumulatedWeightedInfNorm=[],yi((function(){a.iteration=Zi(0).variable(),a.accBeta1=Zi(n).variable()})),null==o&&(a.epsilon=fo.backend.epsilon()),a}return Fn(t,e),t.prototype.applyGradients=function(e){var t=this,n=Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e);yi((function(){var r=ih(1,t.accBeta1),o=Vf(-t.learningRate,t.iteration.mul(t.decay).add(1));n.forEach((function(n,i){var a=fo.registeredVariables[n];null==t.accumulatedFirstMoment[i]&&(t.accumulatedFirstMoment[i]={originalName:n+"/m",variable:Yi(a).variable(!1)}),null==t.accumulatedWeightedInfNorm[i]&&(t.accumulatedWeightedInfNorm[i]={originalName:n+"/v",variable:Yi(a).variable(!1)});var s=Array.isArray(e)?e[i].tensor:e[n];if(null!=s){var u=t.accumulatedFirstMoment[i].variable,c=t.accumulatedWeightedInfNorm[i].variable,l=u.mul(t.beta1).add(s.mul(1-t.beta1)),f=c.mul(t.beta2),h=s.abs(),d=f.maximum(h);u.assign(l),c.assign(d);var p=o.div(r).mul(l.div(d.add(t.epsilon))).add(a);a.assign(p)}})),t.iteration.assign(t.iteration.add(1)),t.accBeta1.assign(t.accBeta1.mul(t.beta1))})),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&bi(this.accumulatedFirstMoment.map((function(e){return e.variable}))),null!=this.accumulatedWeightedInfNorm&&bi(this.accumulatedWeightedInfNorm.map((function(e){return e.variable})))},t.prototype.getWeights=function(){return Ln(this,void 0,void 0,(function(){return Bn(this,(function(e){throw new Error("getWeights() is not implemented for Adamax yet.")}))}))},t.prototype.setWeights=function(e){return Ln(this,void 0,void 0,(function(){return Bn(this,(function(e){throw new Error("setWeights() is not implemented for Adamax yet.")}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},t.fromConfig=function(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)},t.className="Adamax",t}(jv);Fv(Vv);var Hv=function(e){function t(t){var n=e.call(this)||this;return n.learningRate=t,n.setLearningRate(t),n}return Fn(t,e),t.prototype.applyGradients=function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var o=Array.isArray(e)?e[r].tensor:e[n];if(null!=o){var i=fo.registeredVariables[n];yi((function(){var e=t.c.mul(o).add(i);i.assign(e)}))}})),this.incrementIterations()},t.prototype.setLearningRate=function(e){this.learningRate=e,null!=this.c&&this.c.dispose(),this.c=function(e){return fo.keep(e)}(Zi(-e))},t.prototype.dispose=function(){this.c.dispose()},t.prototype.getWeights=function(){return Ln(this,void 0,void 0,(function(){return Bn(this,(function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()]]}}))}))},t.prototype.setWeights=function(e){return Ln(this,void 0,void 0,(function(){return Bn(this,(function(t){switch(t.label){case 0:return[4,this.extractIterations(e)];case 1:if(0!==(e=t.sent()).length)throw new Error("SGD optimizer does not have settable weights.");return[2]}}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate}},t.fromConfig=function(e,t){return new e(t.learningRate)},t.className="SGD",t}(jv);Fv(Hv);var qv=function(e){function t(t,n,r){void 0===r&&(r=!1);var o=e.call(this,t)||this;return o.learningRate=t,o.momentum=n,o.useNesterov=r,o.accumulations=[],o.m=Zi(o.momentum),o}return Fn(t,e),t.prototype.applyGradients=function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var o=fo.registeredVariables[n];null==t.accumulations[r]&&(t.accumulations[r]={originalName:n+"/momentum",variable:yi((function(){return Yi(o).variable(!1)}))});var i=t.accumulations[r].variable,a=Array.isArray(e)?e[r].tensor:e[n];null!=a&&yi((function(){var e,n=t.m.mul(i).add(a);e=t.useNesterov?t.c.mul(a.add(n.mul(t.m))).add(o):t.c.mul(n).add(o),i.assign(n),o.assign(e)}))})),this.incrementIterations()},t.prototype.dispose=function(){this.m.dispose(),null!=this.accumulations&&bi(this.accumulations.map((function(e){return e.variable})))},t.prototype.setMomentum=function(e){this.momentum=e},t.prototype.getWeights=function(){return Ln(this,void 0,void 0,(function(){return Bn(this,(function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(this.accumulations.map((function(e){return{name:e.originalName,tensor:e.variable}})))]}}))}))},t.prototype.setWeights=function(e){return Ln(this,void 0,void 0,(function(){return Bn(this,(function(t){switch(t.label){case 0:return[4,this.extractIterations(e)];case 1:return e=t.sent(),this.accumulations=e.map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),[2]}}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},t.fromConfig=function(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)},t.className="Momentum",t}(Hv);Fv(qv);var Gv=function(e){function t(t,n,r,o,i){void 0===n&&(n=.9),void 0===r&&(r=0),void 0===o&&(o=null),void 0===i&&(i=!1);var a=e.call(this)||this;if(a.learningRate=t,a.decay=n,a.momentum=r,a.epsilon=o,a.accumulatedMeanSquares=[],a.accumulatedMoments=[],a.accumulatedMeanGrads=[],a.centered=i,null==o&&(a.epsilon=fo.backend.epsilon()),null==t)throw new Error("learningRate for RMSPropOptimizer must be defined.");return a}return Fn(t,e),t.prototype.applyGradients=function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var o=fo.registeredVariables[n];null==t.accumulatedMeanSquares[r]&&(t.accumulatedMeanSquares[r]={originalName:n+"/rms",variable:yi((function(){return Yi(o).variable(!1)}))}),null==t.accumulatedMoments[r]&&(t.accumulatedMoments[r]={originalName:n+"/momentum",variable:yi((function(){return Yi(o).variable(!1)}))}),null==t.accumulatedMeanGrads[r]&&t.centered&&(t.accumulatedMeanGrads[r]={originalName:n+"/mg",variable:yi((function(){return Yi(o).variable(!1)}))});var i=Array.isArray(e)?e[r].tensor:e[n];if(null!=i){var a=t.accumulatedMeanSquares[r].variable,s=t.accumulatedMoments[r].variable;yi((function(){var e=a.mul(t.decay).add(i.square().mul(1-t.decay));if(t.centered){var n=t.accumulatedMeanGrads[r].variable,u=n.mul(t.decay).add(i.mul(1-t.decay)),c=s.mul(t.momentum).add(i.mul(t.learningRate).div(e.sub(u.square().add(t.epsilon)).sqrt()));a.assign(e),n.assign(u),s.assign(c);var l=o.sub(c);o.assign(l)}else{var f=a.mul(t.decay).add(i.square().mul(1-t.decay));c=s.mul(t.momentum).add(i.mul(t.learningRate).div(f.add(t.epsilon).sqrt())),a.assign(f),s.assign(c),l=o.sub(c),o.assign(l)}}))}})),this.incrementIterations()},t.prototype.dispose=function(){null!=this.accumulatedMeanSquares&&bi(this.accumulatedMeanSquares.map((function(e){return e.variable}))),null!=this.accumulatedMeanGrads&&this.centered&&bi(this.accumulatedMeanGrads.map((function(e){return e.variable}))),null!=this.accumulatedMoments&&bi(this.accumulatedMoments.map((function(e){return e.variable})))},t.prototype.getWeights=function(){return Ln(this,void 0,void 0,(function(){var e;return Bn(this,(function(t){switch(t.label){case 0:return e=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&e.push.apply(e,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(e.map((function(e){return{name:e.originalName,tensor:e.variable}})))]}}))}))},t.prototype.setWeights=function(e){return Ln(this,void 0,void 0,(function(){var t;return Bn(this,(function(n){switch(n.label){case 0:return[4,this.extractIterations(e)];case 1:return e=n.sent(),t=this.centered?e.length/3:e.length/2,this.accumulatedMeanSquares=e.slice(0,t).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),this.accumulatedMoments=e.slice(t,2*t).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),this.centered&&(this.accumulatedMeanGrads=e.slice(2*t,3*t).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}}))),[2]}}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},t.fromConfig=function(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)},t.className="RMSProp",t}(jv);Fv(Gv);var Kv=function(){function e(){}return e.sgd=function(e){return new Hv(e)},e.momentum=function(e,t,n){return void 0===n&&(n=!1),new qv(e,t,n)},e.rmsprop=function(e,t,n,r,o){return void 0===t&&(t=.9),void 0===n&&(n=0),void 0===r&&(r=null),void 0===o&&(o=!1),new Gv(e,t,n,r,o)},e.adam=function(e,t,n,r){return void 0===e&&(e=.001),void 0===t&&(t=.9),void 0===n&&(n=.999),void 0===r&&(r=null),new zv(e,t,n,r)},e.adadelta=function(e,t,n){return void 0===e&&(e=.001),void 0===t&&(t=.95),void 0===n&&(n=null),new Zv(e,t,n)},e.adamax=function(e,t,n,r,o){return void 0===e&&(e=.002),void 0===t&&(t=.9),void 0===n&&(n=.999),void 0===r&&(r=null),void 0===o&&(o=0),new Vv(e,t,n,r,o)},e.adagrad=function(e,t){return void 0===t&&(t=.1),new Wv(e,t)},e}();Kv.sgd,Kv.momentum,Kv.adadelta,Kv.adagrad,Kv.rmsprop,Kv.adamax,Kv.adam,"undefined"!=typeof requestAnimationFrame?requestAnimationFrame:"undefined"!=typeof setImmediate&&setImmediate;Kr.prototype.squaredDifference=function(e){return Bl(this,e)},qr=kp;var Xv=function(e,t){return Xv=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},Xv(e,t)};function $v(e,t){function n(){this.constructor=e}Xv(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var Yv=function(){return Yv=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Yv.apply(this,arguments)};function Qv(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(Fn){i(Fn)}}function s(e){try{u(r.throw(e))}catch(Fn){i(Fn)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))}function Jv(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(Fn){i=[6,Fn],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function em(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r}var tm=function(){function e(e,t){if(!cm(e)||!cm(t))throw new Error("Dimensions.constructor - expected width and height to be valid numbers, instead have "+JSON.stringify({width:e,height:t}));this._width=e,this._height=t}return Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),e.prototype.reverse=function(){return new e(1/this.width,1/this.height)},e}();function nm(e,t){return e instanceof Kr&&e.shape.length===t}function rm(e){return nm(e,3)}function om(e){return nm(e,4)}function im(e){return e%2===0}function am(e){return e&&e.width&&e.height}function sm(e){return e.reduce((function(e,t){return e.add(t)}),new fm(0,0)).div(new fm(e.length,e.length))}function um(e,t,n){return Array(e).fill(0).map((function(e,r){return t+r*n}))}function cm(e){return!!e&&e!==1/0&&e!==-1/0&&!isNaN(e)||0===e}function lm(e){return cm(e)&&0<=e&&e<=1}var fm=function(){function e(e,t){this._x=e,this._y=t}return Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),e.prototype.add=function(t){return new e(this.x+t.x,this.y+t.y)},e.prototype.sub=function(t){return new e(this.x-t.x,this.y-t.y)},e.prototype.mul=function(t){return new e(this.x*t.x,this.y*t.y)},e.prototype.div=function(t){return new e(this.x/t.x,this.y/t.y)},e.prototype.abs=function(){return new e(Math.abs(this.x),Math.abs(this.y))},e.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},e.prototype.floor=function(){return new e(Math.floor(this.x),Math.floor(this.y))},e}(),hm=function(){function e(t,n){void 0===n&&(n=!0);var r=t||{},o=[r.left,r.top,r.right,r.bottom].every(cm),i=[r.x,r.y,r.width,r.height].every(cm);if(!i&&!o)throw new Error("Box.constructor - expected box to be IBoundingBox | IRect, instead have "+JSON.stringify(r));var a=i?[r.x,r.y,r.width,r.height]:[r.left,r.top,r.right-r.left,r.bottom-r.top],s=a[0],u=a[1],c=a[2],l=a[3];e.assertIsValidBox({x:s,y:u,width:c,height:l},"Box.constructor",n),this._x=s,this._y=u,this._width=c,this._height=l}return e.isRect=function(e){return!!e&&[e.x,e.y,e.width,e.height].every(cm)},e.assertIsValidBox=function(t,n,r){if(void 0===r&&(r=!1),!e.isRect(t))throw new Error(n+" - invalid box: "+JSON.stringify(t)+", expected object with properties x, y, width, height");if(!r&&(t.width<0||t.height<0))throw new Error(n+" - width ("+t.width+") and height ("+t.height+") must be positive numbers")},Object.defineProperty(e.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"area",{get:function(){return this.width*this.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topLeft",{get:function(){return new fm(this.left,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"topRight",{get:function(){return new fm(this.right,this.top)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomLeft",{get:function(){return new fm(this.left,this.bottom)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bottomRight",{get:function(){return new fm(this.right,this.bottom)},enumerable:!0,configurable:!0}),e.prototype.round=function(){var t=[this.x,this.y,this.width,this.height].map((function(e){return Math.round(e)}));return new e({x:t[0],y:t[1],width:t[2],height:t[3]})},e.prototype.floor=function(){var t=[this.x,this.y,this.width,this.height].map((function(e){return Math.floor(e)}));return new e({x:t[0],y:t[1],width:t[2],height:t[3]})},e.prototype.toSquare=function(){var t=this,n=t.x,r=t.y,o=t.width,i=t.height,a=Math.abs(o-i);return o<i&&(n-=a/2,o+=a),i<o&&(r-=a/2,i+=a),new e({x:n,y:r,width:o,height:i})},e.prototype.rescale=function(t){var n=am(t)?t.width:t,r=am(t)?t.height:t;return new e({x:this.x*n,y:this.y*r,width:this.width*n,height:this.height*r})},e.prototype.pad=function(t,n){var r=[this.x-t/2,this.y-n/2,this.width+t,this.height+n];return new e({x:r[0],y:r[1],width:r[2],height:r[3]})},e.prototype.clipAtImageBorders=function(t,n){var r=this,o=r.x,i=r.y,a=r.right,s=r.bottom,u=Math.max(o,0),c=Math.max(i,0),l=a-u,f=s-c;return new e({x:u,y:c,width:Math.min(l,t-u),height:Math.min(f,n-c)}).floor()},e.prototype.shift=function(t,n){var r=this.width,o=this.height;return new e({x:this.x+t,y:this.y+n,width:r,height:o})},e.prototype.padAtBorders=function(e,t){var n=this.width+1,r=this.height+1,o=n,i=r,a=this.left,s=this.top,u=this.right,c=this.bottom;return u>t&&(o=-u+t+n,u=t),c>e&&(i=-c+e+r,c=e),a<1&&(i=2-a,a=1),s<1&&(i=2-s,s=1),{dy:1,edy:i,dx:1,edx:o,y:s,ey:c,x:a,ex:u,w:n,h:r}},e.prototype.calibrate=function(t){return new e({left:this.left+t.left*this.width,top:this.top+t.top*this.height,right:this.right+t.right*this.width,bottom:this.bottom+t.bottom*this.height}).toSquare().round()},e}(),dm=function(e){function t(t,n,r,o,i){return void 0===i&&(i=!1),e.call(this,{left:t,top:n,right:r,bottom:o},i)||this}return $v(t,e),t}(hm),pm=function(){function e(e,t,n,r,o){this._imageDims=new tm(o.width,o.height),this._score=e,this._classScore=t,this._className=n,this._box=new hm(r).rescale(this._imageDims)}return Object.defineProperty(e.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"className",{get:function(){return this._className},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"box",{get:function(){return this._box},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageDims",{get:function(){return this._imageDims},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageWidth",{get:function(){return this.imageDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageHeight",{get:function(){return this.imageDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"relativeBox",{get:function(){return new hm(this._box).rescale(this.imageDims.reverse())},enumerable:!0,configurable:!0}),e.prototype.forSize=function(t,n){return new e(this.score,this.classScore,this.className,this.relativeBox,{width:t,height:n})},e}(),vm=function(e){function t(t,n,r){return e.call(this,t,t,"",n,r)||this}return $v(t,e),t.prototype.forSize=function(n,r){var o=e.prototype.forSize.call(this,n,r);return new t(o.score,o.relativeBox,o.imageDims)},t}(pm);function mm(e,t,n){void 0===n&&(n=!0);var r=Math.max(0,Math.min(e.right,t.right)-Math.max(e.left,t.left))*Math.max(0,Math.min(e.bottom,t.bottom)-Math.max(e.top,t.top));return n?r/(e.area+t.area-r):r/Math.min(e.area,t.area)}function gm(e,t,n,r){void 0===r&&(r=!0);for(var o=t.map((function(e,t){return{score:e,boxIndex:t}})).sort((function(e,t){return e.score-t.score})).map((function(e){return e.boxIndex})),i=[],a=function(){var t=o.pop();i.push(t);for(var a=o,s=[],u=0;u<a.length;u++){var c=a[u],l=e[t],f=e[c];s.push(mm(l,f,r))}o=o.filter((function(e,t){return s[t]<=n}))};o.length>0;)a();return i}function ym(e,t){return yi((function(){var n=t[0],r=t[1],o=t[2],i=Ki(em(e.shape.slice(0,3),[1]),n),a=Ki(em(e.shape.slice(0,3),[1]),r),s=Ki(em(e.shape.slice(0,3),[1]),o),u=Qi([i,a,s],3);return ih(e,u)}))}function bm(e){return 1/(1+Math.exp(-e))}var wm,xm=function(e){function t(t,n,r,o,i){return void 0===i&&(i=!1),e.call(this,{x:t,y:n,width:r,height:o},i)||this}return $v(t,e),t}(hm),km=function(){function e(e,t,n){void 0===n&&(n=new fm(0,0));var r=t.width,o=t.height;this._imgDims=new tm(r,o),this._shift=n,this._positions=e.map((function(e){return e.mul(new fm(r,o)).add(n)}))}return Object.defineProperty(e.prototype,"shift",{get:function(){return new fm(this._shift.x,this._shift.y)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageWidth",{get:function(){return this._imgDims.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"imageHeight",{get:function(){return this._imgDims.height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"positions",{get:function(){return this._positions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"relativePositions",{get:function(){var e=this;return this._positions.map((function(t){return t.sub(e._shift).div(new fm(e.imageWidth,e.imageHeight))}))},enumerable:!0,configurable:!0}),e.prototype.forSize=function(e,t){return new this.constructor(this.relativePositions,{width:e,height:t})},e.prototype.shiftBy=function(e,t){return new this.constructor(this.relativePositions,this._imgDims,new fm(e,t))},e.prototype.shiftByPoint=function(e){return this.shiftBy(e.x,e.y)},e.prototype.align=function(e,t){if(void 0===t&&(t={}),e){var n=e instanceof vm?e.box.floor():new hm(e);return this.shiftBy(n.x,n.y).align(null,t)}var r=Object.assign({},{useDlibAlignment:!1,minBoxPadding:.2},t),o=r.useDlibAlignment,i=r.minBoxPadding;return o?this.alignDlib():this.alignMinBbox(i)},e.prototype.alignDlib=function(){var e=this.getRefPointsForAlignment(),t=e[0],n=e[1],r=e[2],o=function(e){return r.sub(e).magnitude()},i=(o(t)+o(n))/2,a=Math.floor(i/.45),s=sm(e),u=Math.floor(Math.max(0,s.x-.5*a)),c=Math.floor(Math.max(0,s.y-.43*a));return new xm(u,c,Math.min(a,this.imageWidth+u),Math.min(a,this.imageHeight+c))},e.prototype.alignMinBbox=function(e){var t=function(e){var t=e.map((function(e){return e.x})),n=e.map((function(e){return e.y})),r=t.reduce((function(e,t){return t<e?t:e}),1/0),o=n.reduce((function(e,t){return t<e?t:e}),1/0),i=t.reduce((function(e,t){return e<t?t:e}),0),a=n.reduce((function(e,t){return e<t?t:e}),0);return new dm(r,o,i,a)}(this.positions);return t.pad(t.width*e,t.height*e)},e.prototype.getRefPointsForAlignment=function(){throw new Error("getRefPointsForAlignment not implemented by base class")},e}(),_m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $v(t,e),t.prototype.getRefPointsForAlignment=function(){var e=this.positions;return[e[0],e[1],sm([e[3],e[4]])]},t}(km),Em=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $v(t,e),t.prototype.getJawOutline=function(){return this.positions.slice(0,17)},t.prototype.getLeftEyeBrow=function(){return this.positions.slice(17,22)},t.prototype.getRightEyeBrow=function(){return this.positions.slice(22,27)},t.prototype.getNose=function(){return this.positions.slice(27,36)},t.prototype.getLeftEye=function(){return this.positions.slice(36,42)},t.prototype.getRightEye=function(){return this.positions.slice(42,48)},t.prototype.getMouth=function(){return this.positions.slice(48,68)},t.prototype.getRefPointsForAlignment=function(){return[this.getLeftEye(),this.getRightEye(),this.getMouth()].map(sm)},t}(km),Cm=function(){function e(e,t){this._label=e,this._distance=t}return Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"distance",{get:function(){return this._distance},enumerable:!0,configurable:!0}),e.prototype.toString=function(e){return void 0===e&&(e=!0),this.label+(e?" ("+function(e,t){void 0===t&&(t=2);var n=Math.pow(10,t);return Math.floor(e*n)/n}(this.distance)+")":"")},e}(),Sm=function(e){function t(t,n){var r=e.call(this,t)||this;return r._label=n,r}return $v(t,e),t.assertIsValidLabeledBox=function(e,t){if(hm.assertIsValidBox(e,t),!cm(e.label))throw new Error(t+" - expected property label ("+e.label+") to be a number")},Object.defineProperty(t.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),t}(hm),Im=function(){function e(e,t){if("string"!==typeof e)throw new Error("LabeledFaceDescriptors - constructor expected label to be a string");if(!Array.isArray(t)||t.some((function(e){return!(e instanceof Float32Array)})))throw new Error("LabeledFaceDescriptors - constructor expected descriptors to be an array of Float32Array");this._label=e,this._descriptors=t}return Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"descriptors",{get:function(){return this._descriptors},enumerable:!0,configurable:!0}),e.prototype.toJSON=function(){return{label:this.label,descriptors:this.descriptors.map((function(e){return Array.from(e)}))}},e.fromJSON=function(t){var n=t.descriptors.map((function(e){return new Float32Array(e)}));return new e(t.label,n)},e}();!function(e){function t(t,n,r,o){var i=e.call(this,t,n)||this;return i._score=r,i._classScore=o,i}$v(t,e),t.assertIsValidPredictedBox=function(e,t){if(Sm.assertIsValidLabeledBox(e,t),!lm(e.score)||!lm(e.classScore))throw new Error(t+" - expected properties score ("+e.score+") and ("+e.classScore+") to be a number between [0, 1]")},Object.defineProperty(t.prototype,"score",{get:function(){return this._score},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"classScore",{get:function(){return this._classScore},enumerable:!0,configurable:!0})}(Sm);function Rm(e,t){var n={detection:t};return Object.assign({},e,n)}function Tm(){var e=window.fetch||function(){throw new Error("fetch - missing fetch implementation for browser environment")};return{Canvas:HTMLCanvasElement,CanvasRenderingContext2D:CanvasRenderingContext2D,Image:HTMLImageElement,ImageData:ImageData,Video:HTMLVideoElement,createCanvasElement:function(){return document.createElement("canvas")},createImageElement:function(){return document.createElement("img")},fetch:e,readFile:function(){throw new Error("readFile - filesystem not available for browser environment")}}}function Am(e){var t="";if(!e)try{e=n(Object(function(){var e=new Error("Cannot find module 'fs'");throw e.code="MODULE_NOT_FOUND",e}()))}catch(r){t=r.toString()}return{readFile:e?function(t){return new Promise((function(n,r){e.readFile(t,(function(e,t){return e?r(e):n(t)}))}))}:function(){throw new Error("readFile - failed to require fs in nodejs environment with error: "+t)}}}function Nm(){var e=n.g.Canvas||n.g.HTMLCanvasElement,t=n.g.Image||n.g.HTMLImageElement,r=n.g.fetch||function(){throw new Error("fetch - missing fetch implementation for nodejs environment")},o=Am();return Yv({Canvas:e||function(){},CanvasRenderingContext2D:n.g.CanvasRenderingContext2D||function(){},Image:t||function(){},ImageData:n.g.ImageData||function(){},Video:n.g.HTMLVideoElement||function(){},createCanvasElement:function(){if(e)return new e;throw new Error("createCanvasElement - missing Canvas implementation for nodejs environment")},createImageElement:function(){if(t)return new t;throw new Error("createImageElement - missing Image implementation for nodejs environment")},fetch:r},o)}function Om(){return"object"===typeof window&&"undefined"!==typeof document&&"undefined"!==typeof HTMLImageElement&&"undefined"!==typeof HTMLCanvasElement&&"undefined"!==typeof HTMLVideoElement&&"undefined"!==typeof ImageData&&"undefined"!==typeof CanvasRenderingContext2D}function Dm(){return"object"===typeof n.g&&"undefined"!==typeof process&&!!process.version}function Pm(e){wm=e}function Mm(){Om()&&Pm(Tm()),Dm()&&Pm(Nm())}var Fm,Lm={getEnv:function(){if(!wm)throw new Error("getEnv - environment is not defined, check isNodejs() and isBrowser()");return wm},setEnv:Pm,initialize:Mm,createBrowserEnv:Tm,createFileSystem:Am,createNodejsEnv:Nm,monkeyPatch:function(e){if(wm||Mm(),!wm)throw new Error("monkeyPatch - environment is not defined, check isNodejs() and isBrowser()");var t=e.Canvas,n=void 0===t?wm.Canvas:t,r=e.Image,o=void 0===r?wm.Image:r;wm.Canvas=n,wm.Image=o,wm.createCanvasElement=e.createCanvasElement||function(){return new n},wm.createImageElement=e.createImageElement||function(){return new o},wm.ImageData=e.ImageData||wm.ImageData,wm.Video=e.Video||wm.Video,wm.fetch=e.fetch||wm.fetch,wm.readFile=e.readFile||wm.readFile},isBrowser:Om,isNodejs:Dm};function Bm(e){return Lm.isNodejs()||"string"!==typeof e?e:document.getElementById(e)}function Um(e){var t=Lm.getEnv(),n=t.Canvas;if(e instanceof t.CanvasRenderingContext2D)return e;var r=Bm(e);if(!(r instanceof n))throw new Error("resolveContext2d - expected canvas to be of instance of Canvas");var o=r.getContext("2d");if(!o)throw new Error("resolveContext2d - canvas 2d context is null");return o}Mm(),function(e){e.TOP_LEFT="TOP_LEFT",e.TOP_RIGHT="TOP_RIGHT",e.BOTTOM_LEFT="BOTTOM_LEFT",e.BOTTOM_RIGHT="BOTTOM_RIGHT"}(Fm||(Fm={}));var jm=function(e){void 0===e&&(e={});var t=e.anchorPosition,n=e.backgroundColor,r=e.fontColor,o=e.fontSize,i=e.fontStyle,a=e.padding;this.anchorPosition=t||Fm.TOP_LEFT,this.backgroundColor=n||"rgba(0, 0, 0, 0.5)",this.fontColor=r||"rgba(255, 255, 255, 1)",this.fontSize=o||14,this.fontStyle=i||"Georgia",this.padding=a||4},Zm=function(){function e(t,n,r){void 0===r&&(r={}),this.text="string"===typeof t?[t]:t instanceof e?t.text:t,this.anchor=n,this.options=new jm(r)}return e.prototype.measureWidth=function(e){var t=this.options.padding;return this.text.map((function(t){return e.measureText(t).width})).reduce((function(e,t){return e<t?t:e}),0)+2*t},e.prototype.measureHeight=function(){var e=this.options,t=e.fontSize,n=e.padding;return this.text.length*t+2*n},e.prototype.getUpperLeft=function(e,t){var n=this.options.anchorPosition,r=n===Fm.BOTTOM_RIGHT||n===Fm.TOP_RIGHT,o=n===Fm.BOTTOM_LEFT||n===Fm.BOTTOM_RIGHT,i=this.measureWidth(e),a=this.measureHeight(),s=r?this.anchor.x-i:this.anchor.x,u=o?this.anchor.y-a:this.anchor.y;if(t){var c=t.width,l=t.height;return{x:Math.max(Math.min(s,c-i),0),y:Math.max(Math.min(u,l-a),0)}}return{x:s,y:u}},e.prototype.draw=function(e){var t=Bm(e),n=Um(t),r=this.options,o=r.backgroundColor,i=r.fontColor,a=r.fontSize,s=r.fontStyle,u=r.padding;n.font=a+"px "+s;var c=this.measureWidth(n),l=this.measureHeight();n.fillStyle=o;var f=this.getUpperLeft(n,t);n.fillRect(f.x,f.y,c,l),n.fillStyle=i,this.text.forEach((function(e,t){var r=u+f.x,o=u+f.y+(t+1)*a;n.fillText(e,r,o)}))},e}(),Wm=function(e){void 0===e&&(e={});var t=e.boxColor,n=e.lineWidth,r=e.label,o=e.drawLabelOptions;this.boxColor=t||"rgba(0, 0, 255, 1)",this.lineWidth=n||2,this.label=r;var i={anchorPosition:Fm.BOTTOM_LEFT,backgroundColor:this.boxColor};this.drawLabelOptions=new jm(Object.assign({},i,o))};!function(){function e(e,t){void 0===t&&(t={}),this.box=new hm(e),this.options=new Wm(t)}e.prototype.draw=function(e){var t=Um(e),n=this.options,r=n.boxColor,o=n.lineWidth,i=this.box,a=i.x,s=i.y,u=i.width,c=i.height;t.strokeStyle=r,t.lineWidth=o,t.strokeRect(a,s,u,c);var l=this.options.label;l&&new Zm([l],{x:a-o/2,y:s},this.options.drawLabelOptions).draw(e)}}();function zm(e){var t=Lm.getEnv(),n=t.Image,r=t.Video;return e instanceof n&&e.complete||e instanceof r&&e.readyState>=3}function Vm(e){var t=Lm.getEnv(),n=t.Image,r=t.Video;return e instanceof n?new tm(e.naturalWidth,e.naturalHeight):e instanceof r?new tm(e.videoWidth,e.videoHeight):new tm(e.width,e.height)}function Hm(e){var t=e.width,n=e.height,r=(0,Lm.getEnv().createCanvasElement)();return r.width=t,r.height=n,r}function qm(e,t){var n=Lm.getEnv().ImageData;if(!(e instanceof n)&&!zm(e))throw new Error("createCanvasFromMedia - media has not finished loading yet");var r=t||Vm(e),o=r.width,i=r.height,a=Hm({width:o,height:i});return e instanceof n?Um(a).putImageData(e,0,0):Um(a).drawImage(e,0,0,o,i),a}function Gm(e,t){return Qv(this,void 0,void 0,(function(){var n,r,o,i,a,s;return Jv(this,(function(u){switch(u.label){case 0:return n=t||Lm.getEnv().createCanvasElement(),r=e.shape.slice(om(e)?1:0),o=r[0],i=r[1],a=r[2],s=yi((function(){return e.as3D(o,i,a).toInt()})),[4,Dv.toPixels(s,n)];case 1:return u.sent(),s.dispose(),[2,n]}}))}))}function Km(e){var t=Lm.getEnv(),n=t.Image,r=t.Canvas,o=t.Video;return e instanceof n||e instanceof r||e instanceof o}var Xm=function(){function e(e,t){var n=this;if(void 0===t&&(t=!1),this._imageTensors=[],this._canvases=[],this._treatAsBatchInput=!1,this._inputDimensions=[],!Array.isArray(e))throw new Error("NetInput.constructor - expected inputs to be an Array of TResolvedNetInput or to be instanceof tf.Tensor4D, instead have "+e);this._treatAsBatchInput=t,this._batchSize=e.length,e.forEach((function(e,t){if(rm(e))return n._imageTensors[t]=e,void(n._inputDimensions[t]=e.shape);if(om(e)){var r=e.shape[0];if(1!==r)throw new Error("NetInput - tf.Tensor4D with batchSize "+r+" passed, but not supported in input array");return n._imageTensors[t]=e,void(n._inputDimensions[t]=e.shape.slice(1))}var o=e instanceof Lm.getEnv().Canvas?e:qm(e);n._canvases[t]=o,n._inputDimensions[t]=[o.height,o.width,3]}))}return Object.defineProperty(e.prototype,"imageTensors",{get:function(){return this._imageTensors},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canvases",{get:function(){return this._canvases},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isBatchInput",{get:function(){return this.batchSize>1||this._treatAsBatchInput},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"batchSize",{get:function(){return this._batchSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputDimensions",{get:function(){return this._inputDimensions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"reshapedInputDimensions",{get:function(){var e=this;return um(this.batchSize,0,1).map((function(t,n){return e.getReshapedInputDimensions(n)}))},enumerable:!0,configurable:!0}),e.prototype.getInput=function(e){return this.canvases[e]||this.imageTensors[e]},e.prototype.getInputDimensions=function(e){return this._inputDimensions[e]},e.prototype.getInputHeight=function(e){return this._inputDimensions[e][0]},e.prototype.getInputWidth=function(e){return this._inputDimensions[e][1]},e.prototype.getReshapedInputDimensions=function(e){if("number"!==typeof this.inputSize)throw new Error("getReshapedInputDimensions - inputSize not set, toBatchTensor has not been called yet");return function(e,t){var n=e.width,r=e.height,o=t/Math.max(r,n);return new tm(Math.round(n*o),Math.round(r*o))}({width:this.getInputWidth(e),height:this.getInputHeight(e)},this.inputSize)},e.prototype.toBatchTensor=function(e,t){var n=this;return void 0===t&&(t=!0),this._inputSize=e,yi((function(){var r=um(n.batchSize,0,1).map((function(r){var o=n.getInput(r);if(o instanceof Kr){var i=om(o)?o:o.expandDims();return i=function(e,t){return void 0===t&&(t=!1),yi((function(){var n=e.shape.slice(1),r=n[0],o=n[1];if(r===o)return e;var i=Math.abs(r-o),a=Math.round(i*(t?.5:1)),s=r>o?2:1,u=function(t){var n=e.shape.slice();return n[s]=t,Ki(n,0)},c=u(a),l=i-c.shape[s],f=[t&&l?u(l):null,e,c].filter((function(e){return!!e})).map((function(e){return e.toFloat()}));return Qi(f,s)}))}(i,t),i.shape[1]===e&&i.shape[2]===e||(i=dp.resizeBilinear(i,[e,e])),i.as3D(e,e,3)}if(o instanceof Lm.getEnv().Canvas)return Dv.fromPixels(function(e,t,n){void 0===n&&(n=!1);var r=Lm.getEnv(),o=r.Image,i=r.Canvas;if(!(e instanceof o||e instanceof i))throw new Error("imageToSquare - expected arg0 to be HTMLImageElement | HTMLCanvasElement");var a=Vm(e),s=t/Math.max(a.height,a.width),u=s*a.width,c=s*a.height,l=Hm({width:t,height:t}),f=e instanceof i?e:qm(e),h=Math.abs(u-c)/2,d=n&&u<c?h:0,p=n&&c<u?h:0;return Um(l).drawImage(f,d,p,u,c),l}(o,e,t));throw new Error("toBatchTensor - at batchIdx "+r+", expected input to be instanceof tf.Tensor or instanceof HTMLCanvasElement, instead have "+o)})),o=Ua(r.map((function(e){return e.toFloat()}))).as4D(n.batchSize,e,e,3);return o}))},e}();function $m(e){return Qv(this,void 0,void 0,(function(){var t,n,r;return Jv(this,(function(o){switch(o.label){case 0:if(e instanceof Xm)return[2,e];if(!(t=Array.isArray(e)?e:[e]).length)throw new Error("toNetInput - empty array passed as input");return n=function(t){return Array.isArray(e)?" at input index "+t+":":""},(r=t.map(Bm)).forEach((function(e,r){if(!Km(e)&&!rm(e)&&!om(e)){if("string"===typeof t[r])throw new Error("toNetInput -"+n(r)+" string passed, but could not resolve HTMLElement for element id "+t[r]);throw new Error("toNetInput -"+n(r)+" expected media to be of type HTMLImageElement | HTMLVideoElement | HTMLCanvasElement | tf.Tensor3D, or to be an element id")}if(om(e)){var o=e.shape[0];if(1!==o)throw new Error("toNetInput -"+n(r)+" tf.Tensor4D with batchSize "+o+" passed, but not supported in input array")}})),[4,Promise.all(r.map((function(e){return Km(e)&&(t=e,new Promise((function(e,n){if(t instanceof Lm.getEnv().Canvas||zm(t))return e();function r(t){t.currentTarget&&(t.currentTarget.removeEventListener("load",r),t.currentTarget.removeEventListener("error",o),e(t))}function o(e){e.currentTarget&&(e.currentTarget.removeEventListener("load",r),e.currentTarget.removeEventListener("error",o),n(e))}t.addEventListener("load",r),t.addEventListener("error",o)})));var t})))];case 1:return o.sent(),[2,new Xm(r,Array.isArray(e))]}}))}))}function Ym(e,t){return Qv(this,void 0,void 0,(function(){var n,r,o,i,a,s;return Jv(this,(function(u){switch(u.label){case 0:return n=Lm.getEnv().Canvas,r=e,e instanceof n?[3,5]:[4,$m(e)];case 1:if((o=u.sent()).batchSize>1)throw new Error("extractFaces - batchSize > 1 not supported");return(i=o.getInput(0))instanceof n?(a=i,[3,4]):[3,2];case 2:return[4,Gm(i)];case 3:a=u.sent(),u.label=4;case 4:r=a,u.label=5;case 5:return s=Um(r),[2,t.map((function(e){return e instanceof vm?e.forSize(r.width,r.height).box.floor():e})).map((function(e){return e.clipAtImageBorders(r.width,r.height)})).map((function(e){var t=e.x,n=e.y,r=e.width,o=e.height,i=Hm({width:r,height:o});return Um(i).putImageData(s.getImageData(t,n,r,o),0,0),i}))]}}))}))}function Qm(e,t){return Qv(this,void 0,void 0,(function(){return Jv(this,(function(n){if(!rm(e)&&!om(e))throw new Error("extractFaceTensors - expected image tensor to be 3D or 4D");if(om(e)&&e.shape[0]>1)throw new Error("extractFaceTensors - batchSize > 1 not supported");return[2,yi((function(){var n=e.shape.slice(om(e)?1:0),r=n[0],o=n[1],i=n[2],a=t.map((function(e){return e instanceof vm?e.forSize(o,r).box:e})).map((function(e){return e.clipAtImageBorders(o,r)})).map((function(t){var n=t.x,a=t.y,s=t.width,u=t.height;return td(e.as3D(r,o,i),[a,n,0],[u,s,i])}));return a}))]}))}))}function Jm(e,t){return Qv(this,void 0,void 0,(function(){var n;return Jv(this,(function(r){switch(r.label){case 0:return[4,(0,Lm.getEnv().fetch)(e,t)];case 1:if(!((n=r.sent()).status<400))throw new Error("failed to fetch: ("+n.status+") "+n.statusText+", from url: "+n.url);return[2,n]}}))}))}function eg(e){return Qv(this,void 0,void 0,(function(){return Jv(this,(function(t){switch(t.label){case 0:return[4,Jm(e)];case 1:return[2,t.sent().json()]}}))}))}function tg(e,t){var n=t+"-weights_manifest.json";if(!e)return{modelBaseUri:"",manifestUri:n};if("/"===e)return{modelBaseUri:"/",manifestUri:"/"+n};var r=e.startsWith("http://")?"http://":e.startsWith("https://")?"https://":"",o=(e=e.replace(r,"")).split("/").filter((function(e){return e})),i=e.endsWith(".json")?o[o.length-1]:n,a=r+(e.endsWith(".json")?o.slice(0,o.length-1):o).join("/");return{modelBaseUri:a=e.startsWith("/")?"/"+a:a,manifestUri:"/"===a?"/"+i:a+"/"+i}}function ng(e,t){return Qv(this,void 0,void 0,(function(){var n,r,o,i;return Jv(this,(function(a){switch(a.label){case 0:return n=tg(e,t),r=n.manifestUri,o=n.modelBaseUri,[4,eg(r)];case 1:return i=a.sent(),[2,Av.loadWeights(i,o)]}}))}))}var rg=function(){function e(e){this._name=e,this._params=void 0,this._paramMappings=[]}return Object.defineProperty(e.prototype,"params",{get:function(){return this._params},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paramMappings",{get:function(){return this._paramMappings},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isLoaded",{get:function(){return!!this.params},enumerable:!0,configurable:!0}),e.prototype.getParamFromPath=function(e){var t=this.traversePropertyPath(e);return t.obj[t.objProp]},e.prototype.reassignParamFromPath=function(e,t){var n=this.traversePropertyPath(e),r=n.obj,o=n.objProp;r[o].dispose(),r[o]=t},e.prototype.getParamList=function(){var e=this;return this._paramMappings.map((function(t){var n=t.paramPath;return{path:n,tensor:e.getParamFromPath(n)}}))},e.prototype.getTrainableParams=function(){return this.getParamList().filter((function(e){return e.tensor instanceof to}))},e.prototype.getFrozenParams=function(){return this.getParamList().filter((function(e){return!(e.tensor instanceof to)}))},e.prototype.variable=function(){var e=this;this.getFrozenParams().forEach((function(t){var n=t.path,r=t.tensor;e.reassignParamFromPath(n,r.variable())}))},e.prototype.freeze=function(){var e=this;this.getTrainableParams().forEach((function(t){var n=t.path,r=t.tensor,o=Ui(r.dataSync());r.dispose(),e.reassignParamFromPath(n,o)}))},e.prototype.dispose=function(e){void 0===e&&(e=!0),this.getParamList().forEach((function(t){if(e&&t.tensor.isDisposed)throw new Error("param tensor has already been disposed for path "+t.path);t.tensor.dispose()})),this._params=void 0},e.prototype.serializeParams=function(){return new Float32Array(this.getParamList().map((function(e){var t=e.tensor;return Array.from(t.dataSync())})).reduce((function(e,t){return e.concat(t)})))},e.prototype.load=function(e){return Qv(this,void 0,void 0,(function(){return Jv(this,(function(t){switch(t.label){case 0:return e instanceof Float32Array?(this.extractWeights(e),[2]):[4,this.loadFromUri(e)];case 1:return t.sent(),[2]}}))}))},e.prototype.loadFromUri=function(e){return Qv(this,void 0,void 0,(function(){var t;return Jv(this,(function(n){switch(n.label){case 0:if(e&&"string"!==typeof e)throw new Error(this._name+".loadFromUri - expected model uri");return[4,ng(e,this.getDefaultModelName())];case 1:return t=n.sent(),this.loadFromWeightMap(t),[2]}}))}))},e.prototype.loadFromDisk=function(e){return Qv(this,void 0,void 0,(function(){var t,n,r,o,i,a,s,u,c,l;return Jv(this,(function(f){switch(f.label){case 0:if(e&&"string"!==typeof e)throw new Error(this._name+".loadFromDisk - expected model file path");return t=Lm.getEnv().readFile,n=tg(e,this.getDefaultModelName()),r=n.manifestUri,o=n.modelBaseUri,i=function(e){return Promise.all(e.map((function(e){return t(e).then((function(e){return e.buffer}))})))},a=Av.weightsLoaderFactory(i),c=(u=JSON).parse,[4,t(r)];case 1:return s=c.apply(u,[f.sent().toString()]),[4,a(s,o)];case 2:return l=f.sent(),this.loadFromWeightMap(l),[2]}}))}))},e.prototype.loadFromWeightMap=function(e){var t=this.extractParamsFromWeigthMap(e),n=t.paramMappings,r=t.params;this._paramMappings=n,this._params=r},e.prototype.extractWeights=function(e){var t=this.extractParams(e),n=t.paramMappings,r=t.params;this._paramMappings=n,this._params=r},e.prototype.traversePropertyPath=function(e){if(!this.params)throw new Error("traversePropertyPath - model has no loaded params");var t=e.split("/").reduce((function(t,n){if(!t.nextObj.hasOwnProperty(n))throw new Error("traversePropertyPath - object does not have property "+n+", for path "+e);return{obj:t.nextObj,objProp:n,nextObj:t.nextObj[n]}}),{nextObj:this.params}),n=t.obj,r=t.objProp;if(!n||!r||!(n[r]instanceof Kr))throw new Error("traversePropertyPath - parameter is not a tensor, for path "+e);return{obj:n,objProp:r}},e}();function og(e,t,n){return yi((function(){var r=Ph(e,t.depthwise_filter,t.pointwise_filter,n,"same");return r=jf(r,t.bias)}))}function ig(e,t,n){return void 0===n&&(n=!1),yi((function(){var r=yd(n?jf(Ih(e,t.conv0.filters,[2,2],"same"),t.conv0.bias):og(e,t.conv0,[2,2])),o=og(r,t.conv1,[1,1]),i=og(yd(jf(r,o)),t.conv2,[1,1]);return yd(jf(r,jf(o,i)))}))}function ag(e,t,n,r){return void 0===n&&(n=!1),void 0===r&&(r=!0),yi((function(){var o=yd(n?jf(Ih(e,t.conv0.filters,r?[2,2]:[1,1],"same"),t.conv0.bias):og(e,t.conv0,r?[2,2]:[1,1])),i=og(o,t.conv1,[1,1]),a=og(yd(jf(o,i)),t.conv2,[1,1]),s=og(yd(jf(o,jf(i,a))),t.conv3,[1,1]);return yd(jf(o,jf(i,jf(a,s))))}))}function sg(e,t,n,r){return void 0===n&&(n="same"),void 0===r&&(r=!1),yi((function(){var o=jf(Ih(e,t.filters,[1,1],n),t.bias);return r?yd(o):o}))}function ug(e,t){Object.keys(e).forEach((function(n){t.some((function(e){return e.originalPath===n}))||e[n].dispose()}))}function cg(e,t){return function(n,r,o,i){var a=Hi(e(n*r*o*o),[o,o,n,r]),s=Wi(e(r));return t.push({paramPath:i+"/filters"},{paramPath:i+"/bias"}),{filters:a,bias:s}}}function lg(e,t){return function(n,r,o){var i=zi(e(n*r),[n,r]),a=Wi(e(r));return t.push({paramPath:o+"/weights"},{paramPath:o+"/bias"}),{weights:i,bias:a}}}var fg=function(e,t,n){this.depthwise_filter=e,this.pointwise_filter=t,this.bias=n};function hg(e,t){return function(n,r,o){var i=Hi(e(9*n),[3,3,n,1]),a=Hi(e(n*r),[1,1,n,r]),s=Wi(e(r));return t.push({paramPath:o+"/depthwise_filter"},{paramPath:o+"/pointwise_filter"},{paramPath:o+"/bias"}),new fg(i,a,s)}}function dg(e){return function(t){var n=e(t+"/depthwise_filter",4),r=e(t+"/pointwise_filter",4),o=e(t+"/bias",1);return new fg(n,r,o)}}function pg(e,t){return function(n,r,o){var i=e[n];if(!nm(i,r))throw new Error("expected weightMap["+n+"] to be a Tensor"+r+"D, instead have "+i);return t.push({originalPath:n,paramPath:o||n}),i}}function vg(e){var t=e;return{extractWeights:function(e){var n=t.slice(0,e);return t=t.slice(e),n},getRemainingWeights:function(){return t}}}function mg(e,t){var n=cg(e,t),r=hg(e,t);function o(e,t,o,i){return void 0===i&&(i=!1),{conv0:i?n(e,t,3,o+"/conv0"):r(e,t,o+"/conv0"),conv1:r(t,t,o+"/conv1"),conv2:r(t,t,o+"/conv2")}}return{extractDenseBlock3Params:o,extractDenseBlock4Params:function(e,t,n,i){void 0===i&&(i=!1);var a=o(e,t,n,i);return{conv0:a.conv0,conv1:a.conv1,conv2:a.conv2,conv3:r(t,t,n+"/conv3")}}}}function gg(e){return function(t){return{filters:e(t+"/filters",4),bias:e(t+"/bias",1)}}}function yg(e,t){var n=pg(e,t),r=gg(n),o=dg(n);return{extractDenseBlock3Params:function(e,t){return void 0===t&&(t=!1),{conv0:t?r(e+"/conv0"):o(e+"/conv0"),conv1:o(e+"/conv1"),conv2:o(e+"/conv2")}},extractDenseBlock4Params:function(e,t){return void 0===t&&(t=!1),{conv0:t?r(e+"/conv0"):o(e+"/conv0"),conv1:o(e+"/conv1"),conv2:o(e+"/conv2"),conv3:o(e+"/conv3")}}}}var bg=function(e){function t(){return e.call(this,"FaceFeatureExtractor")||this}return $v(t,e),t.prototype.forwardInput=function(e){var t=this.params;if(!t)throw new Error("FaceFeatureExtractor - load model before inference");return yi((function(){var n=ag(ym(e.toBatchTensor(112,!0),[122.782,117.001,104.298]).div(Zi(255)),t.dense0,!0);return n=ag(n,t.dense1),n=ag(n,t.dense2),n=ag(n,t.dense3),n=Kh(n,[7,7],[2,2],"valid")}))},t.prototype.forward=function(e){return Qv(this,void 0,void 0,(function(){var t;return Jv(this,(function(n){switch(n.label){case 0:return t=this.forwardInput,[4,$m(e)];case 1:return[2,t.apply(this,[n.sent()])]}}))}))},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_model"},t.prototype.extractParamsFromWeigthMap=function(e){return function(e){var t=[],n=yg(e,t).extractDenseBlock4Params,r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2"),dense3:n("dense3")};return ug(e,t),{params:r,paramMappings:t}}(e)},t.prototype.extractParams=function(e){return function(e){var t=[],n=vg(e),r=n.extractWeights,o=n.getRemainingWeights,i=mg(r,t).extractDenseBlock4Params,a=i(3,32,"dense0",!0),s=i(32,64,"dense1"),u=i(64,128,"dense2"),c=i(128,256,"dense3");if(0!==o().length)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:t,params:{dense0:a,dense1:s,dense2:u,dense3:c}}}(e)},t}(rg);function wg(e,t){return yi((function(){return jf(Lh(e,t.weights),t.bias)}))}function xg(e){var t={},n={};return Object.keys(e).forEach((function(r){(r.startsWith("fc")?n:t)[r]=e[r]})),{featureExtractorMap:t,classifierMap:n}}var kg=function(e){function t(t,n){var r=e.call(this,t)||this;return r._faceFeatureExtractor=n,r}return $v(t,e),Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(e){var t=this,n=this.params;if(!n)throw new Error(this._name+" - load model before inference");return yi((function(){var r=e instanceof Xm?t.faceFeatureExtractor.forwardInput(e):e;return wg(r.as2D(r.shape[0],-1),n.fc)}))},t.prototype.dispose=function(t){void 0===t&&(t=!0),this.faceFeatureExtractor.dispose(t),e.prototype.dispose.call(this,t)},t.prototype.loadClassifierParams=function(e){var t=this.extractClassifierParams(e),n=t.params,r=t.paramMappings;this._params=n,this._paramMappings=r},t.prototype.extractClassifierParams=function(e){return function(e,t,n){var r=[],o=vg(e),i=o.extractWeights,a=o.getRemainingWeights,s=lg(i,r)(t,n,"fc");if(0!==a().length)throw new Error("weights remaing after extract: "+a().length);return{paramMappings:r,params:{fc:s}}}(e,this.getClassifierChannelsIn(),this.getClassifierChannelsOut())},t.prototype.extractParamsFromWeigthMap=function(e){var t=xg(e),n=t.featureExtractorMap,r=t.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(n),function(e){var t,n=[],r=pg(e,n),o={fc:(t="fc",{weights:r(t+"/weights",2),bias:r(t+"/bias",1)})};return ug(e,n),{params:o,paramMappings:n}}(r)},t.prototype.extractParams=function(e){var t=this.getClassifierChannelsIn(),n=this.getClassifierChannelsOut(),r=n*t+n,o=e.slice(0,e.length-r),i=e.slice(e.length-r);return this.faceFeatureExtractor.extractWeights(o),this.extractClassifierParams(i)},t}(rg),_g=["neutral","happy","sad","angry","fearful","disgusted","surprised"],Eg=function(){function e(e){var t=this;if(7!==e.length)throw new Error("FaceExpressions.constructor - expected probabilities.length to be 7, have: "+e.length);_g.forEach((function(n,r){t[n]=e[r]}))}return e.prototype.asSortedArray=function(){var e=this;return _g.map((function(t){return{expression:t,probability:e[t]}})).sort((function(e,t){return t.probability-e.probability}))},e}(),Cg=function(e){function t(t){return void 0===t&&(t=new bg),e.call(this,"FaceExpressionNet",t)||this}return $v(t,e),t.prototype.forwardInput=function(e){var t=this;return yi((function(){return ss(t.runNet(e))}))},t.prototype.forward=function(e){return Qv(this,void 0,void 0,(function(){var t;return Jv(this,(function(n){switch(n.label){case 0:return t=this.forwardInput,[4,$m(e)];case 1:return[2,t.apply(this,[n.sent()])]}}))}))},t.prototype.predictExpressions=function(e){return Qv(this,void 0,void 0,(function(){var t,n,r,o,i=this;return Jv(this,(function(a){switch(a.label){case 0:return[4,$m(e)];case 1:return t=a.sent(),[4,this.forwardInput(t)];case 2:return n=a.sent(),[4,Promise.all(Wa(n).map((function(e){return Qv(i,void 0,void 0,(function(){var t;return Jv(this,(function(n){switch(n.label){case 0:return[4,e.data()];case 1:return t=n.sent(),e.dispose(),[2,t]}}))}))})))];case 3:return r=a.sent(),n.dispose(),o=r.map((function(e){return new Eg(e)})),[2,t.isBatchInput?o:o[0]]}}))}))},t.prototype.getDefaultModelName=function(){return"face_expression_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t.prototype.getClassifierChannelsOut=function(){return 7},t}(kg);function Sg(e,t){var n={expressions:t};return Object.assign({},e,n)}function Ig(e){return function(e){return e.detection instanceof vm}(e)&&e.landmarks instanceof km&&e.unshiftedLandmarks instanceof km&&e.alignedRect instanceof vm}function Rg(e,t){var n=e.detection.box,r=t.shiftBy(n.x,n.y),o=r.align(),i=e.detection.imageDims,a={landmarks:r,unshiftedLandmarks:t,alignedRect:new vm(e.detection.score,o.rescale(i.reverse()),i)};return Object.assign({},e,a)}function Tg(e,t,n){if(void 0===n&&(n=!1),e.beginPath(),t.slice(1).forEach((function(n,r){var o=n.x,i=n.y,a=t[r];e.moveTo(a.x,a.y),e.lineTo(o,i)})),n){var r=t[t.length-1],o=t[0];if(!r||!o)return;e.moveTo(r.x,r.y),e.lineTo(o.x,o.y)}e.stroke()}var Ag=function(e){void 0===e&&(e={});var t=e.drawLines,n=void 0===t||t,r=e.drawPoints,o=void 0===r||r,i=e.lineWidth,a=e.lineColor,s=e.pointSize,u=e.pointColor;this.drawLines=n,this.drawPoints=o,this.lineWidth=i||1,this.pointSize=s||2,this.lineColor=a||"rgba(0, 255, 255, 1)",this.pointColor=u||"rgba(255, 0, 255, 1)"};!function(){function e(e,t){void 0===t&&(t={}),this.faceLandmarks=e,this.options=new Ag(t)}e.prototype.draw=function(e){var t=Um(e),n=this.options,r=n.drawLines,o=n.drawPoints,i=n.lineWidth,a=n.lineColor,s=n.pointSize,u=n.pointColor;if(r&&this.faceLandmarks instanceof Em&&(t.strokeStyle=a,t.lineWidth=i,Tg(t,this.faceLandmarks.getJawOutline()),Tg(t,this.faceLandmarks.getLeftEyeBrow()),Tg(t,this.faceLandmarks.getRightEyeBrow()),Tg(t,this.faceLandmarks.getNose()),Tg(t,this.faceLandmarks.getLeftEye(),!0),Tg(t,this.faceLandmarks.getRightEye(),!0),Tg(t,this.faceLandmarks.getMouth(),!0)),o){t.strokeStyle=u,t.fillStyle=u;this.faceLandmarks.positions.forEach((function(e){t.beginPath(),t.arc(e.x,e.y,s,0,2*Math.PI),t.fill()}))}}}();function Ng(e,t){var n=[],r=vg(e),o=r.extractWeights,i=r.getRemainingWeights,a=function(e,t){var n=cg(e,t),r=hg(e,t);return{extractConvParams:n,extractSeparableConvParams:r,extractReductionBlockParams:function(e,t,o){return{separable_conv0:r(e,t,o+"/separable_conv0"),separable_conv1:r(t,t,o+"/separable_conv1"),expansion_conv:n(e,t,1,o+"/expansion_conv")}},extractMainBlockParams:function(e,t){return{separable_conv0:r(e,e,t+"/separable_conv0"),separable_conv1:r(e,e,t+"/separable_conv1"),separable_conv2:r(e,e,t+"/separable_conv2")}}}}(o,n),s=a.extractConvParams,u=a.extractSeparableConvParams,c=a.extractReductionBlockParams,l=a.extractMainBlockParams,f={conv_in:s(3,32,3,"entry_flow/conv_in"),reduction_block_0:c(32,64,"entry_flow/reduction_block_0"),reduction_block_1:c(64,128,"entry_flow/reduction_block_1")},h={};um(t,0,1).forEach((function(e){h["main_block_"+e]=l(128,"middle_flow/main_block_"+e)}));var d={reduction_block:c(128,256,"exit_flow/reduction_block"),separable_conv:u(256,512,"exit_flow/separable_conv")};if(0!==i().length)throw new Error("weights remaing after extract: "+i().length);return{paramMappings:n,params:{entry_flow:f,middle_flow:h,exit_flow:d}}}function Og(e,t){var n=[],r=function(e,t){var n=pg(e,t),r=gg(n),o=dg(n);return{extractConvParams:r,extractSeparableConvParams:o,extractReductionBlockParams:function(e){return{separable_conv0:o(e+"/separable_conv0"),separable_conv1:o(e+"/separable_conv1"),expansion_conv:r(e+"/expansion_conv")}},extractMainBlockParams:function(e){return{separable_conv0:o(e+"/separable_conv0"),separable_conv1:o(e+"/separable_conv1"),separable_conv2:o(e+"/separable_conv2")}}}}(e,n),o=r.extractConvParams,i=r.extractSeparableConvParams,a=r.extractReductionBlockParams,s=r.extractMainBlockParams,u={conv_in:o("entry_flow/conv_in"),reduction_block_0:a("entry_flow/reduction_block_0"),reduction_block_1:a("entry_flow/reduction_block_1")},c={};um(t,0,1).forEach((function(e){c["main_block_"+e]=s("middle_flow/main_block_"+e)}));var l={reduction_block:a("exit_flow/reduction_block"),separable_conv:i("exit_flow/separable_conv")};return ug(e,n),{params:{entry_flow:u,middle_flow:c,exit_flow:l},paramMappings:n}}function Dg(e,t,n){return jf(Ih(e,t.filters,n,"same"),t.bias)}function Pg(e,t,n){void 0===n&&(n=!0);var r=n?yd(e):e;return r=og(r,t.separable_conv0,[1,1]),r=og(yd(r),t.separable_conv1,[1,1]),r=Gh(r,[3,3],[2,2],"same"),r=jf(r,Dg(e,t.expansion_conv,[2,2]))}var Mg,Fg=function(e){function t(t){var n=e.call(this,"TinyXception")||this;return n._numMainBlocks=t,n}return $v(t,e),t.prototype.forwardInput=function(e){var t=this,n=this.params;if(!n)throw new Error("TinyXception - load model before inference");return yi((function(){var r=ym(e.toBatchTensor(112,!0),[122.782,117.001,104.298]).div(Zi(256)),o=yd(Dg(r,n.entry_flow.conv_in,[2,2]));return o=Pg(o,n.entry_flow.reduction_block_0,!1),o=Pg(o,n.entry_flow.reduction_block_1),um(t._numMainBlocks,0,1).forEach((function(e){o=function(e,t){var n=og(yd(e),t.separable_conv0,[1,1]);return n=og(yd(n),t.separable_conv1,[1,1]),n=og(yd(n),t.separable_conv2,[1,1]),jf(n,e)}(o,n.middle_flow["main_block_"+e])})),o=Pg(o,n.exit_flow.reduction_block),o=yd(og(o,n.exit_flow.separable_conv,[1,1]))}))},t.prototype.forward=function(e){return Qv(this,void 0,void 0,(function(){var t;return Jv(this,(function(n){switch(n.label){case 0:return t=this.forwardInput,[4,$m(e)];case 1:return[2,t.apply(this,[n.sent()])]}}))}))},t.prototype.getDefaultModelName=function(){return"tiny_xception_model"},t.prototype.extractParamsFromWeigthMap=function(e){return Og(e,this._numMainBlocks)},t.prototype.extractParams=function(e){return Ng(e,this._numMainBlocks)},t}(rg);!function(e){e.FEMALE="female",e.MALE="male"}(Mg||(Mg={}));var Lg=function(e){function t(t){void 0===t&&(t=new Fg(2));var n=e.call(this,"AgeGenderNet")||this;return n._faceFeatureExtractor=t,n}return $v(t,e),Object.defineProperty(t.prototype,"faceFeatureExtractor",{get:function(){return this._faceFeatureExtractor},enumerable:!0,configurable:!0}),t.prototype.runNet=function(e){var t=this,n=this.params;if(!n)throw new Error(this._name+" - load model before inference");return yi((function(){var r=e instanceof Xm?t.faceFeatureExtractor.forwardInput(e):e,o=Kh(r,[7,7],[2,2],"valid").as2D(r.shape[0],-1);return{age:wg(o,n.fc.age).as1D(),gender:wg(o,n.fc.gender)}}))},t.prototype.forwardInput=function(e){var t=this;return yi((function(){var n=t.runNet(e),r=n.age,o=n.gender;return{age:r,gender:ss(o)}}))},t.prototype.forward=function(e){return Qv(this,void 0,void 0,(function(){var t;return Jv(this,(function(n){switch(n.label){case 0:return t=this.forwardInput,[4,$m(e)];case 1:return[2,t.apply(this,[n.sent()])]}}))}))},t.prototype.predictAgeAndGender=function(e){return Qv(this,void 0,void 0,(function(){var t,n,r,o,i,a,s=this;return Jv(this,(function(u){switch(u.label){case 0:return[4,$m(e)];case 1:return t=u.sent(),[4,this.forwardInput(t)];case 2:return n=u.sent(),r=Wa(n.age),o=Wa(n.gender),i=r.map((function(e,t){return{ageTensor:e,genderTensor:o[t]}})),[4,Promise.all(i.map((function(e){var t=e.ageTensor,n=e.genderTensor;return Qv(s,void 0,void 0,(function(){var e,r,o,i,a;return Jv(this,(function(s){switch(s.label){case 0:return[4,t.data()];case 1:return e=s.sent()[0],[4,n.data()];case 2:return r=s.sent()[0],i=(o=r>.5)?Mg.MALE:Mg.FEMALE,a=o?r:1-r,t.dispose(),n.dispose(),[2,{age:e,gender:i,genderProbability:a}]}}))}))})))];case 3:return a=u.sent(),n.age.dispose(),n.gender.dispose(),[2,t.isBatchInput?a:a[0]]}}))}))},t.prototype.getDefaultModelName=function(){return"age_gender_model"},t.prototype.dispose=function(t){void 0===t&&(t=!0),this.faceFeatureExtractor.dispose(t),e.prototype.dispose.call(this,t)},t.prototype.loadClassifierParams=function(e){var t=this.extractClassifierParams(e),n=t.params,r=t.paramMappings;this._params=n,this._paramMappings=r},t.prototype.extractClassifierParams=function(e){return function(e){var t=[],n=vg(e),r=n.extractWeights,o=n.getRemainingWeights,i=lg(r,t),a=i(512,1,"fc/age"),s=i(512,2,"fc/gender");if(0!==o().length)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:t,params:{fc:{age:a,gender:s}}}}(e)},t.prototype.extractParamsFromWeigthMap=function(e){var t=xg(e),n=t.featureExtractorMap,r=t.classifierMap;return this.faceFeatureExtractor.loadFromWeightMap(n),function(e){var t=[],n=pg(e,t);function r(e){return{weights:n(e+"/weights",2),bias:n(e+"/bias",1)}}var o={fc:{age:r("fc/age"),gender:r("fc/gender")}};return ug(e,t),{params:o,paramMappings:t}}(r)},t.prototype.extractParams=function(e){var t=e.slice(0,e.length-1539),n=e.slice(e.length-1539);return this.faceFeatureExtractor.extractWeights(t),this.extractClassifierParams(n)},t}(rg),Bg=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $v(t,e),t.prototype.postProcess=function(e,t,n){var r=n.map((function(e){var n=e.width,r=e.height,o=t/Math.max(r,n);return{width:n*o,height:r*o}})),o=r.length;return yi((function(){var n=function(e,t){return Ua([Ki([68],e),Ki([68],t)],1).as2D(1,136).as1D()},i=function(e,t){var n=r[e],o=n.width,i=n.height;return t(o,i)?Math.abs(o-i)/2:0},a=e.mul(Ki([o,136],t)).sub(Ua(Array.from(Array(o),(function(e,t){return n(function(e){return i(e,(function(e,t){return e<t}))}(t),function(e){return i(e,(function(e,t){return t<e}))}(t))})))).div(Ua(Array.from(Array(o),(function(e,t){return n(r[t].width,r[t].height)}))));return a}))},t.prototype.forwardInput=function(e){var t=this;return yi((function(){var n=t.runNet(e);return t.postProcess(n,e.inputSize,e.inputDimensions.map((function(e){return{height:e[0],width:e[1]}})))}))},t.prototype.forward=function(e){return Qv(this,void 0,void 0,(function(){var t;return Jv(this,(function(n){switch(n.label){case 0:return t=this.forwardInput,[4,$m(e)];case 1:return[2,t.apply(this,[n.sent()])]}}))}))},t.prototype.detectLandmarks=function(e){return Qv(this,void 0,void 0,(function(){var t,n,r,o=this;return Jv(this,(function(i){switch(i.label){case 0:return[4,$m(e)];case 1:return t=i.sent(),n=yi((function(){return Wa(o.forwardInput(t))})),[4,Promise.all(n.map((function(e,n){return Qv(o,void 0,void 0,(function(){var r,o,i,a,s;return Jv(this,(function(u){switch(u.label){case 0:return i=(o=Array).from,[4,e.data()];case 1:return r=i.apply(o,[u.sent()]),a=r.filter((function(e,t){return im(t)})),s=r.filter((function(e,t){return!im(t)})),[2,new Em(Array(68).fill(0).map((function(e,t){return new fm(a[t],s[t])})),{height:t.getInputHeight(n),width:t.getInputWidth(n)})]}}))}))})))];case 2:return r=i.sent(),n.forEach((function(e){return e.dispose()})),[2,t.isBatchInput?r:r[0]]}}))}))},t.prototype.getClassifierChannelsOut=function(){return 136},t}(kg),Ug=function(e){function t(t){return void 0===t&&(t=new bg),e.call(this,"FaceLandmark68Net",t)||this}return $v(t,e),t.prototype.getDefaultModelName=function(){return"face_landmark_68_model"},t.prototype.getClassifierChannelsIn=function(){return 256},t}(Bg);var jg=function(e){function t(){return e.call(this,"TinyFaceFeatureExtractor")||this}return $v(t,e),t.prototype.forwardInput=function(e){var t=this.params;if(!t)throw new Error("TinyFaceFeatureExtractor - load model before inference");return yi((function(){var n=ig(ym(e.toBatchTensor(112,!0),[122.782,117.001,104.298]).div(Zi(255)),t.dense0,!0);return n=ig(n,t.dense1),n=ig(n,t.dense2),n=Kh(n,[14,14],[2,2],"valid")}))},t.prototype.forward=function(e){return Qv(this,void 0,void 0,(function(){var t;return Jv(this,(function(n){switch(n.label){case 0:return t=this.forwardInput,[4,$m(e)];case 1:return[2,t.apply(this,[n.sent()])]}}))}))},t.prototype.getDefaultModelName=function(){return"face_feature_extractor_tiny_model"},t.prototype.extractParamsFromWeigthMap=function(e){return function(e){var t=[],n=yg(e,t).extractDenseBlock3Params,r={dense0:n("dense0",!0),dense1:n("dense1"),dense2:n("dense2")};return ug(e,t),{params:r,paramMappings:t}}(e)},t.prototype.extractParams=function(e){return function(e){var t=[],n=vg(e),r=n.extractWeights,o=n.getRemainingWeights,i=mg(r,t).extractDenseBlock3Params,a=i(3,32,"dense0",!0),s=i(32,64,"dense1"),u=i(64,128,"dense2");if(0!==o().length)throw new Error("weights remaing after extract: "+o().length);return{paramMappings:t,params:{dense0:a,dense1:s,dense2:u}}}(e)},t}(rg),Zg=function(e){function t(t){return void 0===t&&(t=new jg),e.call(this,"FaceLandmark68TinyNet",t)||this}return $v(t,e),t.prototype.getDefaultModelName=function(){return"face_landmark_68_tiny_model"},t.prototype.getClassifierChannelsIn=function(){return 128},t}(Bg);!function(e){function t(){return null!==e&&e.apply(this,arguments)||this}$v(t,e)}(Ug);function Wg(e,t,n,r,o){void 0===o&&(o="same");var i=t.conv,a=i.filters,s=i.bias,u=Ih(e,a,n,o);return u=function(e,t){return jf(eh(e,t.weights),t.biases)}(u=jf(u,s),t.scale),r?yd(u):u}function zg(e,t){return Wg(e,t,[1,1],!1)}function Vg(e,t){return Wg(e,t,[2,2],!0,"valid")}function Hg(e,t){function n(n,r,o,i){var a=function(t,n,r){var o=e(t),i=o.length/(n*r*r);if(i%1!==0)throw new Error("depth has to be an integer: "+i+", weights.length: "+o.length+", numFilters: "+n+", filterSize: "+r);return yi((function(){return xd(Hi(o,[n,i,r,r]),[2,3,1,0])}))}(n,r,o),s=Wi(e(r));return t.push({paramPath:i+"/filters"},{paramPath:i+"/bias"}),{filters:a,bias:s}}function r(r,o,i,a){var s=n(r,o,i,a+"/conv"),u=function(n,r){var o=Wi(e(n)),i=Wi(e(n));return t.push({paramPath:r+"/weights"},{paramPath:r+"/biases"}),{weights:o,biases:i}}(o,a+"/scale");return{conv:s,scale:u}}return{extractConvLayerParams:r,extractResidualLayerParams:function(e,t,n,o,i){return void 0===i&&(i=!1),{conv1:r((i?.5:1)*e,t,n,o+"/conv1"),conv2:r(e,t,n,o+"/conv2")}}}}function qg(e,t){var n=pg(e,t);function r(e){var t=n(e+"/conv/filters",4),r=n(e+"/conv/bias",1),o=function(e){return{weights:n(e+"/scale/weights",1),biases:n(e+"/scale/biases",1)}}(e);return{conv:{filters:t,bias:r},scale:o}}return{extractConvLayerParams:r,extractResidualLayerParams:function(e){return{conv1:r(e+"/conv1"),conv2:r(e+"/conv2")}}}}function Gg(e){var t=[],n=qg(e,t),r=n.extractConvLayerParams,o=n.extractResidualLayerParams,i=r("conv32_down"),a=o("conv32_1"),s=o("conv32_2"),u=o("conv32_3"),c=o("conv64_down"),l=o("conv64_1"),f=o("conv64_2"),h=o("conv64_3"),d=o("conv128_down"),p=o("conv128_1"),v=o("conv128_2"),m=o("conv256_down"),g=o("conv256_1"),y=o("conv256_2"),b=o("conv256_down_out"),w=e.fc;if(t.push({originalPath:"fc",paramPath:"fc"}),!nm(w,2))throw new Error("expected weightMap[fc] to be a Tensor2D, instead have "+w);var x={conv32_down:i,conv32_1:a,conv32_2:s,conv32_3:u,conv64_down:c,conv64_1:l,conv64_2:f,conv64_3:h,conv128_down:d,conv128_1:p,conv128_2:v,conv256_down:m,conv256_1:g,conv256_2:y,conv256_down_out:b,fc:w};return ug(e,t),{params:x,paramMappings:t}}function Kg(e,t){var n=function(e,t){return Wg(e,t,[1,1],!0)}(e,t.conv1);return n=zg(n,t.conv2),n=jf(n,e),n=yd(n)}function Xg(e,t){var n=Vg(e,t.conv1);n=zg(n,t.conv2);var r=Kh(e,2,2,"valid"),o=Gi(r.shape),i=r.shape[3]!==n.shape[3];if(r.shape[1]!==n.shape[1]||r.shape[2]!==n.shape[2]){var a=em(n.shape);a[1]=1;var s=Gi(a),u=em((n=Qi([n,s],1)).shape);u[2]=1;var c=Gi(u);n=Qi([n,c],2)}return r=i?Qi([r,o],3):r,n=jf(r,n),n=yd(n)}var $g=function(e){function t(){return e.call(this,"FaceRecognitionNet")||this}return $v(t,e),t.prototype.forwardInput=function(e){var t=this.params;if(!t)throw new Error("FaceRecognitionNet - load model before inference");return yi((function(){var n=Vg(ym(e.toBatchTensor(150,!0).toFloat(),[122.782,117.001,104.298]).div(Zi(256)),t.conv32_down);n=Kg(n=Gh(n,3,2,"valid"),t.conv32_1),n=Kg(n,t.conv32_2),n=Kg(n,t.conv32_3),n=Kg(n=Xg(n,t.conv64_down),t.conv64_1),n=Kg(n,t.conv64_2),n=Kg(n,t.conv64_3),n=Kg(n=Xg(n,t.conv128_down),t.conv128_1),n=Kg(n,t.conv128_2),n=Kg(n=Xg(n,t.conv256_down),t.conv256_1);var r=(n=Xg(n=Kg(n,t.conv256_2),t.conv256_down_out)).mean([1,2]);return Lh(r,t.fc)}))},t.prototype.forward=function(e){return Qv(this,void 0,void 0,(function(){var t;return Jv(this,(function(n){switch(n.label){case 0:return t=this.forwardInput,[4,$m(e)];case 1:return[2,t.apply(this,[n.sent()])]}}))}))},t.prototype.computeFaceDescriptor=function(e){return Qv(this,void 0,void 0,(function(){var t,n,r,o=this;return Jv(this,(function(i){switch(i.label){case 0:return[4,$m(e)];case 1:return t=i.sent(),n=yi((function(){return Wa(o.forwardInput(t))})),[4,Promise.all(n.map((function(e){return e.data()})))];case 2:return r=i.sent(),n.forEach((function(e){return e.dispose()})),[2,t.isBatchInput?r:r[0]]}}))}))},t.prototype.getDefaultModelName=function(){return"face_recognition_model"},t.prototype.extractParamsFromWeigthMap=function(e){return Gg(e)},t.prototype.extractParams=function(e){return function(e){var t=vg(e),n=t.extractWeights,r=t.getRemainingWeights,o=[],i=Hg(n,o),a=i.extractConvLayerParams,s=i.extractResidualLayerParams,u=a(4704,32,7,"conv32_down"),c=s(9216,32,3,"conv32_1"),l=s(9216,32,3,"conv32_2"),f=s(9216,32,3,"conv32_3"),h=s(36864,64,3,"conv64_down",!0),d=s(36864,64,3,"conv64_1"),p=s(36864,64,3,"conv64_2"),v=s(36864,64,3,"conv64_3"),m=s(147456,128,3,"conv128_down",!0),g=s(147456,128,3,"conv128_1"),y=s(147456,128,3,"conv128_2"),b=s(589824,256,3,"conv256_down",!0),w=s(589824,256,3,"conv256_1"),x=s(589824,256,3,"conv256_2"),k=s(589824,256,3,"conv256_down_out"),_=yi((function(){return xd(zi(n(32768),[128,256]),[1,0])}));if(o.push({paramPath:"fc"}),0!==r().length)throw new Error("weights remaing after extract: "+r().length);return{params:{conv32_down:u,conv32_1:c,conv32_2:l,conv32_3:f,conv64_down:h,conv64_1:d,conv64_2:p,conv64_3:v,conv128_down:m,conv128_1:g,conv128_2:y,conv256_down:b,conv256_1:w,conv256_2:x,conv256_down_out:k,fc:_},paramMappings:o}}(e)},t}(rg);function Yg(e,t,n){var r={gender:t,genderProbability:n};return Object.assign({},e,r)}var Qg=function(){function e(e){var t=void 0===e?{}:e,n=t.minFaceSize,r=t.scaleFactor,o=t.maxNumScales,i=t.scoreThresholds,a=t.scaleSteps;if(this._name="MtcnnOptions",this._minFaceSize=n||20,this._scaleFactor=r||.709,this._maxNumScales=o||10,this._scoreThresholds=i||[.6,.7,.7],this._scaleSteps=a,"number"!==typeof this._minFaceSize||this._minFaceSize<0)throw new Error(this._name+" - expected minFaceSize to be a number > 0");if("number"!==typeof this._scaleFactor||this._scaleFactor<=0||this._scaleFactor>=1)throw new Error(this._name+" - expected scaleFactor to be a number between 0 and 1");if("number"!==typeof this._maxNumScales||this._maxNumScales<0)throw new Error(this._name+" - expected maxNumScales to be a number > 0");if(!Array.isArray(this._scoreThresholds)||3!==this._scoreThresholds.length||this._scoreThresholds.some((function(e){return"number"!==typeof e})))throw new Error(this._name+" - expected scoreThresholds to be an array of numbers of length 3");if(this._scaleSteps&&(!Array.isArray(this._scaleSteps)||this._scaleSteps.some((function(e){return"number"!==typeof e}))))throw new Error(this._name+" - expected scaleSteps to be an array of numbers")}return Object.defineProperty(e.prototype,"minFaceSize",{get:function(){return this._minFaceSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleFactor",{get:function(){return this._scaleFactor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxNumScales",{get:function(){return this._maxNumScales},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scoreThresholds",{get:function(){return this._scoreThresholds},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scaleSteps",{get:function(){return this._scaleSteps},enumerable:!0,configurable:!0}),e}();function Jg(e,t){function n(n,r,o,i,a){var s=Hi(e(n*r*o*o),[o,o,n,r]),u=Wi(e(r));return t.push({paramPath:i+"/filters"},{paramPath:i+"/"+(a?"batch_norm_offset":"bias")}),{filters:s,bias:u}}function r(e,t,r,o){var i=n(e,t,r,o,!0);return{filters:i.filters,batch_norm_offset:i.bias}}function o(n,o,i){var a=function(n,r){var o=Hi(e(9*n),[3,3,n,1]),i=Wi(e(n)),a=Wi(e(n)),s=Wi(e(n)),u=Wi(e(n));return t.push({paramPath:r+"/filters"},{paramPath:r+"/batch_norm_scale"},{paramPath:r+"/batch_norm_offset"},{paramPath:r+"/batch_norm_mean"},{paramPath:r+"/batch_norm_variance"}),{filters:o,batch_norm_scale:i,batch_norm_offset:a,batch_norm_mean:s,batch_norm_variance:u}}(n,i+"/depthwise_conv");return{depthwise_conv:a,pointwise_conv:r(n,o,1,i+"/pointwise_conv")}}return{extractMobilenetV1Params:function(){return{conv_0:r(3,32,3,"mobilenetv1/conv_0"),conv_1:o(32,64,"mobilenetv1/conv_1"),conv_2:o(64,128,"mobilenetv1/conv_2"),conv_3:o(128,128,"mobilenetv1/conv_3"),conv_4:o(128,256,"mobilenetv1/conv_4"),conv_5:o(256,256,"mobilenetv1/conv_5"),conv_6:o(256,512,"mobilenetv1/conv_6"),conv_7:o(512,512,"mobilenetv1/conv_7"),conv_8:o(512,512,"mobilenetv1/conv_8"),conv_9:o(512,512,"mobilenetv1/conv_9"),conv_10:o(512,512,"mobilenetv1/conv_10"),conv_11:o(512,512,"mobilenetv1/conv_11"),conv_12:o(512,1024,"mobilenetv1/conv_12"),conv_13:o(1024,1024,"mobilenetv1/conv_13")}},extractPredictionLayerParams:function(){return{conv_0:r(1024,256,1,"prediction_layer/conv_0"),conv_1:r(256,512,3,"prediction_layer/conv_1"),conv_2:r(512,128,1,"prediction_layer/conv_2"),conv_3:r(128,256,3,"prediction_layer/conv_3"),conv_4:r(256,128,1,"prediction_layer/conv_4"),conv_5:r(128,256,3,"prediction_layer/conv_5"),conv_6:r(256,64,1,"prediction_layer/conv_6"),conv_7:r(64,128,3,"prediction_layer/conv_7"),box_predictor_0:{box_encoding_predictor:n(512,12,1,"prediction_layer/box_predictor_0/box_encoding_predictor"),class_predictor:n(512,9,1,"prediction_layer/box_predictor_0/class_predictor")},box_predictor_1:{box_encoding_predictor:n(1024,24,1,"prediction_layer/box_predictor_1/box_encoding_predictor"),class_predictor:n(1024,18,1,"prediction_layer/box_predictor_1/class_predictor")},box_predictor_2:{box_encoding_predictor:n(512,24,1,"prediction_layer/box_predictor_2/box_encoding_predictor"),class_predictor:n(512,18,1,"prediction_layer/box_predictor_2/class_predictor")},box_predictor_3:{box_encoding_predictor:n(256,24,1,"prediction_layer/box_predictor_3/box_encoding_predictor"),class_predictor:n(256,18,1,"prediction_layer/box_predictor_3/class_predictor")},box_predictor_4:{box_encoding_predictor:n(256,24,1,"prediction_layer/box_predictor_4/box_encoding_predictor"),class_predictor:n(256,18,1,"prediction_layer/box_predictor_4/class_predictor")},box_predictor_5:{box_encoding_predictor:n(128,24,1,"prediction_layer/box_predictor_5/box_encoding_predictor"),class_predictor:n(128,18,1,"prediction_layer/box_predictor_5/class_predictor")}}}}}function ey(e){var t=[],n=function(e,t){var n=pg(e,t);function r(e,t,r){return{filters:n(e+"/Conv2d_"+t+"_pointwise/weights",4,r+"/filters"),batch_norm_offset:n(e+"/Conv2d_"+t+"_pointwise/convolution_bn_offset",1,r+"/batch_norm_offset")}}function o(e){var t="mobilenetv1/conv_"+e,o="MobilenetV1/Conv2d_"+e+"_depthwise",i=t+"/depthwise_conv",a=t+"/pointwise_conv";return{depthwise_conv:{filters:n(o+"/depthwise_weights",4,i+"/filters"),batch_norm_scale:n(o+"/BatchNorm/gamma",1,i+"/batch_norm_scale"),batch_norm_offset:n(o+"/BatchNorm/beta",1,i+"/batch_norm_offset"),batch_norm_mean:n(o+"/BatchNorm/moving_mean",1,i+"/batch_norm_mean"),batch_norm_variance:n(o+"/BatchNorm/moving_variance",1,i+"/batch_norm_variance")},pointwise_conv:r("MobilenetV1",e,a)}}function i(e,t){return{filters:n(e+"/weights",4,t+"/filters"),bias:n(e+"/biases",1,t+"/bias")}}function a(e){return{box_encoding_predictor:i("Prediction/BoxPredictor_"+e+"/BoxEncodingPredictor","prediction_layer/box_predictor_"+e+"/box_encoding_predictor"),class_predictor:i("Prediction/BoxPredictor_"+e+"/ClassPredictor","prediction_layer/box_predictor_"+e+"/class_predictor")}}return{extractMobilenetV1Params:function(){return{conv_0:r("MobilenetV1",0,"mobilenetv1/conv_0"),conv_1:o(1),conv_2:o(2),conv_3:o(3),conv_4:o(4),conv_5:o(5),conv_6:o(6),conv_7:o(7),conv_8:o(8),conv_9:o(9),conv_10:o(10),conv_11:o(11),conv_12:o(12),conv_13:o(13)}},extractPredictionLayerParams:function(){return{conv_0:r("Prediction",0,"prediction_layer/conv_0"),conv_1:r("Prediction",1,"prediction_layer/conv_1"),conv_2:r("Prediction",2,"prediction_layer/conv_2"),conv_3:r("Prediction",3,"prediction_layer/conv_3"),conv_4:r("Prediction",4,"prediction_layer/conv_4"),conv_5:r("Prediction",5,"prediction_layer/conv_5"),conv_6:r("Prediction",6,"prediction_layer/conv_6"),conv_7:r("Prediction",7,"prediction_layer/conv_7"),box_predictor_0:a(0),box_predictor_1:a(1),box_predictor_2:a(2),box_predictor_3:a(3),box_predictor_4:a(4),box_predictor_5:a(5)}}}}(e,t),r=n.extractMobilenetV1Params,o=n.extractPredictionLayerParams,i=e["Output/extra_dim"];if(t.push({originalPath:"Output/extra_dim",paramPath:"output_layer/extra_dim"}),!rm(i))throw new Error("expected weightMap['Output/extra_dim'] to be a Tensor3D, instead have "+i);var a={mobilenetv1:r(),prediction_layer:o(),output_layer:{extra_dim:i}};return ug(e,t),{params:a,paramMappings:t}}function ty(e,t,n){return yi((function(){var r=Ih(e,t.filters,n,"same");return r=jf(r,t.batch_norm_offset),Gl(r,0,6)}))}var ny=.0010000000474974513;function ry(e,t){return yi((function(){var n=null,r=ty(e,t.conv_0,[2,2]);if([t.conv_1,t.conv_2,t.conv_3,t.conv_4,t.conv_5,t.conv_6,t.conv_7,t.conv_8,t.conv_9,t.conv_10,t.conv_11,t.conv_12,t.conv_13].forEach((function(e,t){var o=t+1,i=function(e){return[2,4,6,12].some((function(t){return t===e}))?[2,2]:[1,1]}(o);r=function(e,t,n){return yi((function(){var r=Nh(e,t.filters,n,"same");return r=Af(r,t.batch_norm_mean,t.batch_norm_variance,t.batch_norm_offset,t.batch_norm_scale,ny),Gl(r,0,6)}))}(r,e.depthwise_conv,i),r=ty(r,e.pointwise_conv,[1,1]),11===o&&(n=r)})),null===n)throw new Error("mobileNetV1 - output of conv layer 11 is null");return{out:r,conv11:n}}))}function oy(e,t,n){var r=e.arraySync(),o=Math.min(r[t][0],r[t][2]),i=Math.min(r[t][1],r[t][3]),a=Math.max(r[t][0],r[t][2]),s=Math.max(r[t][1],r[t][3]),u=Math.min(r[n][0],r[n][2]),c=Math.min(r[n][1],r[n][3]),l=Math.max(r[n][0],r[n][2]),f=Math.max(r[n][1],r[n][3]),h=(a-o)*(s-i),d=(l-u)*(f-c);if(h<=0||d<=0)return 0;var p=Math.max(o,u),v=Math.max(i,c),m=Math.min(a,l),g=Math.min(s,f),y=Math.max(m-p,0)*Math.max(g-v,0);return y/(h+d-y)}function iy(e,t){var n=function(e){var t=Wa(xd(e,[1,0])),n=[ih(t[2],t[0]),ih(t[3],t[1])];return{sizes:n,centers:[jf(t[0],Vf(n[0],Zi(2))),jf(t[1],Vf(n[1],Zi(2)))]}}(e),r=n.sizes,o=n.centers,i=Wa(xd(t,[1,0])),a=Vf(eh(Yl(Vf(i[2],Zi(5))),r[0]),Zi(2)),s=jf(eh(Vf(i[0],Zi(10)),r[0]),o[0]),u=Vf(eh(Yl(Vf(i[3],Zi(5))),r[1]),Zi(2)),c=jf(eh(Vf(i[1],Zi(10)),r[1]),o[1]);return xd(Ua([ih(s,a),ih(c,u),jf(s,a),jf(c,u)]),[1,0])}function ay(e,t){return yi((function(){var n=e.shape[0];return{boxPredictionEncoding:Fa(sg(e,t.box_encoding_predictor),[n,-1,1,4]),classPrediction:Fa(sg(e,t.class_predictor),[n,-1,3])}}))}var sy=function(){function e(e){var t=void 0===e?{}:e,n=t.minConfidence,r=t.maxResults;if(this._name="SsdMobilenetv1Options",this._minConfidence=n||.5,this._maxResults=r||100,"number"!==typeof this._minConfidence||this._minConfidence<=0||this._minConfidence>=1)throw new Error(this._name+" - expected minConfidence to be a number between 0 and 1");if("number"!==typeof this._maxResults)throw new Error(this._name+" - expected maxResults to be a number")}return Object.defineProperty(e.prototype,"minConfidence",{get:function(){return this._minConfidence},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxResults",{get:function(){return this._maxResults},enumerable:!0,configurable:!0}),e}(),uy=function(e){function t(){return e.call(this,"SsdMobilenetv1")||this}return $v(t,e),t.prototype.forwardInput=function(e){var t=this.params;if(!t)throw new Error("SsdMobilenetv1 - load model before inference");return yi((function(){var n=e.toBatchTensor(512,!1).toFloat(),r=ry(ih(eh(n,Zi(.007843137718737125)),Zi(1)),t.mobilenetv1),o=function(e,t,n){return yi((function(){var r=ty(e,n.conv_0,[1,1]),o=ty(r,n.conv_1,[2,2]),i=ty(o,n.conv_2,[1,1]),a=ty(i,n.conv_3,[2,2]),s=ty(a,n.conv_4,[1,1]),u=ty(s,n.conv_5,[2,2]),c=ty(u,n.conv_6,[1,1]),l=ty(c,n.conv_7,[2,2]),f=ay(t,n.box_predictor_0),h=ay(e,n.box_predictor_1),d=ay(o,n.box_predictor_2),p=ay(a,n.box_predictor_3),v=ay(u,n.box_predictor_4),m=ay(l,n.box_predictor_5);return{boxPredictions:Qi([f.boxPredictionEncoding,h.boxPredictionEncoding,d.boxPredictionEncoding,p.boxPredictionEncoding,v.boxPredictionEncoding,m.boxPredictionEncoding],1),classPredictions:Qi([f.classPrediction,h.classPrediction,d.classPrediction,p.classPrediction,v.classPrediction,m.classPrediction],1)}}))}(r.out,r.conv11,t.prediction_layer);return function(e,t,n){return yi((function(){var r=e.shape[0],o=iy(Fa(ja(n.extra_dim,[r,1,1]),[-1,4]),Fa(e,[-1,4]));o=Fa(o,[r,o.shape[0]/r,4]);var i=uf(Qh(t,[0,0,1],[-1,-1,-1])),a=Qh(i,[0,0,0],[-1,-1,1]);return a=Fa(a,[r,a.shape[1]]),{boxes:Wa(o),scores:Wa(a)}}))}(o.boxPredictions,o.classPredictions,t.output_layer)}))},t.prototype.forward=function(e){return Qv(this,void 0,void 0,(function(){var t;return Jv(this,(function(n){switch(n.label){case 0:return t=this.forwardInput,[4,$m(e)];case 1:return[2,t.apply(this,[n.sent()])]}}))}))},t.prototype.locateFaces=function(e,t){return void 0===t&&(t={}),Qv(this,void 0,void 0,(function(){var n,r,o,i,a,s,u,c,l,f,h,d,p,v,m,g,y,b,w,x;return Jv(this,(function(k){switch(k.label){case 0:return n=new sy(t),r=n.maxResults,o=n.minConfidence,[4,$m(e)];case 1:for(i=k.sent(),a=this.forwardInput(i),s=a.boxes,u=a.scores,c=s[0],l=u[0],f=1;f<s.length;f++)s[f].dispose(),u[f].dispose();return p=(d=Array).from,[4,l.data()];case 2:return h=p.apply(d,[k.sent()]),.5,v=function(e,t,n,r,o){var i=e.shape[0],a=Math.min(n,i),s=t.map((function(e,t){return{score:e,boxIndex:t}})).filter((function(e){return e.score>o})).sort((function(e,t){return t.score-e.score})),u=function(e){return e<=r?1:0},c=[];return s.forEach((function(t){if(!(c.length>=a)){for(var n=t.score,r=c.length-1;r>=0;--r){var i=oy(e,t.boxIndex,c[r]);if(0!==i&&(t.score*=u(i),t.score<=o))break}n===t.score&&c.push(t.boxIndex)}})),c}(c,h,r,.5,o),m=i.getReshapedInputDimensions(0),g=i.inputSize,y=g/m.width,b=g/m.height,w=c.arraySync(),x=v.map((function(e){var t=[Math.max(0,w[e][0]),Math.min(1,w[e][2])].map((function(e){return e*b})),n=t[0],r=t[1],o=[Math.max(0,w[e][1]),Math.min(1,w[e][3])].map((function(e){return e*y})),a=o[0],s=o[1];return new vm(h[e],new xm(a,n,s-a,r-n),{height:i.getInputHeight(0),width:i.getInputWidth(0)})})),c.dispose(),l.dispose(),[2,x]}}))}))},t.prototype.getDefaultModelName=function(){return"ssd_mobilenetv1_model"},t.prototype.extractParamsFromWeigthMap=function(e){return ey(e)},t.prototype.extractParams=function(e){return function(e){var t=[],n=vg(e),r=n.extractWeights,o=n.getRemainingWeights,i=Jg(r,t),a=i.extractMobilenetV1Params,s=i.extractPredictionLayerParams,u=a(),c=s(),l={extra_dim:Vi(r(20472),[1,5118,4])};if(t.push({paramPath:"output_layer/extra_dim"}),0!==o().length)throw new Error("weights remaing after extract: "+o().length);return{params:{mobilenetv1:u,prediction_layer:c,output_layer:l},paramMappings:t}}(e)},t}(rg);!function(e){function t(){return null!==e&&e.apply(this,arguments)||this}$v(t,e)}(uy);var cy,ly=[new fm(.738768,.874946),new fm(2.42204,2.65704),new fm(4.30971,7.04493),new fm(10.246,4.59428),new fm(12.6868,11.8741)],fy=[new fm(1.603231,2.094468),new fm(6.041143,7.080126),new fm(2.882459,3.518061),new fm(4.266906,5.178857),new fm(9.041765,10.66308)],hy=[117.001,114.697,97.404],dy=function(e){return"number"===typeof e};function py(e){return yi((function(){var t=eh(e,Zi(.10000000149011612));return jf(yd(ih(e,t)),t)}))}function vy(e,t){return yi((function(){var n=Ia(e,[[0,0],[1,1],[1,1],[0,0]]);return n=Ih(n,t.conv.filters,[1,1],"valid"),n=ih(n,t.bn.sub),n=eh(n,t.bn.truediv),py(n=jf(n,t.conv.bias))}))}function my(e,t){return yi((function(){var n=Ia(e,[[0,0],[1,1],[1,1],[0,0]]);return n=Ph(n,t.depthwise_filter,t.pointwise_filter,[1,1],"valid"),py(n=jf(n,t.bias))}))}function gy(e,t){var n=cg(e,t);var r=hg(e,t);return{extractConvParams:n,extractConvWithBatchNormParams:function(r,o,i){var a=n(r,o,3,i+"/conv"),s=function(n,r){var o=Wi(e(n)),i=Wi(e(n));return t.push({paramPath:r+"/sub"},{paramPath:r+"/truediv"}),{sub:o,truediv:i}}(o,i+"/bn");return{conv:a,bn:s}},extractSeparableConvParams:r}}function yy(e,t){var n=pg(e,t);function r(e){return{filters:n(e+"/filters",4),bias:n(e+"/bias",1)}}return{extractConvParams:r,extractConvWithBatchNormParams:function(e){var t=r(e+"/conv"),o=function(e){return{sub:n(e+"/sub",1),truediv:n(e+"/truediv",1)}}(e+"/bn");return{conv:t,bn:o}},extractSeparableConvParams:dg(n)}}!function(e){e[e.XS=224]="XS",e[e.SM=320]="SM",e[e.MD=416]="MD",e[e.LG=608]="LG"}(cy||(cy={}));var by=function(){function e(e){var t=void 0===e?{}:e,n=t.inputSize,r=t.scoreThreshold;if(this._name="TinyYolov2Options",this._inputSize=n||416,this._scoreThreshold=r||.5,"number"!==typeof this._inputSize||this._inputSize%32!==0)throw new Error(this._name+" - expected inputSize to be a number divisible by 32");if("number"!==typeof this._scoreThreshold||this._scoreThreshold<=0||this._scoreThreshold>=1)throw new Error(this._name+" - expected scoreThreshold to be a number between 0 and 1")}return Object.defineProperty(e.prototype,"inputSize",{get:function(){return this._inputSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"scoreThreshold",{get:function(){return this._scoreThreshold},enumerable:!0,configurable:!0}),e}(),wy=function(e){function t(t){var n=e.call(this,"TinyYolov2")||this;return function(e){if(!e)throw new Error("invalid config: "+e);if("boolean"!==typeof e.withSeparableConvs)throw new Error("config.withSeparableConvs has to be a boolean, have: "+e.withSeparableConvs);if(!dy(e.iouThreshold)||e.iouThreshold<0||e.iouThreshold>1)throw new Error("config.iouThreshold has to be a number between [0, 1], have: "+e.iouThreshold);if(!Array.isArray(e.classes)||!e.classes.length||!e.classes.every((function(e){return"string"===typeof e})))throw new Error("config.classes has to be an array class names: string[], have: "+JSON.stringify(e.classes));if(!Array.isArray(e.anchors)||!e.anchors.length||!e.anchors.map((function(e){return e||{}})).every((function(e){return dy(e.x)&&dy(e.y)})))throw new Error("config.anchors has to be an array of { x: number, y: number }, have: "+JSON.stringify(e.anchors));if(e.meanRgb&&(!Array.isArray(e.meanRgb)||3!==e.meanRgb.length||!e.meanRgb.every(dy)))throw new Error("config.meanRgb has to be an array of shape [number, number, number], have: "+JSON.stringify(e.meanRgb))}(t),n._config=t,n}return $v(t,e),Object.defineProperty(t.prototype,"config",{get:function(){return this._config},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"withClassScores",{get:function(){return this.config.withClassScores||this.config.classes.length>1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"boxEncodingSize",{get:function(){return 5+(this.withClassScores?this.config.classes.length:0)},enumerable:!0,configurable:!0}),t.prototype.runTinyYolov2=function(e,t){var n=vy(e,t.conv0);return n=vy(n=Gh(n,[2,2],[2,2],"same"),t.conv1),n=vy(n=Gh(n,[2,2],[2,2],"same"),t.conv2),n=vy(n=Gh(n,[2,2],[2,2],"same"),t.conv3),n=vy(n=Gh(n,[2,2],[2,2],"same"),t.conv4),n=vy(n=Gh(n,[2,2],[2,2],"same"),t.conv5),n=vy(n=Gh(n,[2,2],[1,1],"same"),t.conv6),sg(n=vy(n,t.conv7),t.conv8,"valid",!1)},t.prototype.runMobilenet=function(e,t){var n=this.config.isFirstLayerConv2d?py(sg(e,t.conv0,"valid",!1)):my(e,t.conv0);return n=my(n=Gh(n,[2,2],[2,2],"same"),t.conv1),n=my(n=Gh(n,[2,2],[2,2],"same"),t.conv2),n=my(n=Gh(n,[2,2],[2,2],"same"),t.conv3),n=my(n=Gh(n,[2,2],[2,2],"same"),t.conv4),n=my(n=Gh(n,[2,2],[2,2],"same"),t.conv5),n=Gh(n,[2,2],[1,1],"same"),n=t.conv6?my(n,t.conv6):n,sg(n=t.conv7?my(n,t.conv7):n,t.conv8,"valid",!1)},t.prototype.forwardInput=function(e,t){var n=this,r=this.params;if(!r)throw new Error("TinyYolov2 - load model before inference");return yi((function(){var o=e.toBatchTensor(t,!1).toFloat();return o=(o=n.config.meanRgb?ym(o,n.config.meanRgb):o).div(Zi(256)),n.config.withSeparableConvs?n.runMobilenet(o,r):n.runTinyYolov2(o,r)}))},t.prototype.forward=function(e,t){return Qv(this,void 0,void 0,(function(){var n;return Jv(this,(function(r){switch(r.label){case 0:return n=this.forwardInput,[4,$m(e)];case 1:return[4,n.apply(this,[r.sent(),t])];case 2:return[2,r.sent()]}}))}))},t.prototype.detect=function(e,t){return void 0===t&&(t={}),Qv(this,void 0,void 0,(function(){var n,r,o,i,a,s,u,c,l,f,h,d,p,v=this;return Jv(this,(function(m){switch(m.label){case 0:return n=new by(t),r=n.inputSize,o=n.scoreThreshold,[4,$m(e)];case 1:return i=m.sent(),[4,this.forwardInput(i,r)];case 2:return a=m.sent(),s=yi((function(){return Wa(a)[0].expandDims()})),u={width:i.getInputWidth(0),height:i.getInputHeight(0)},[4,this.extractBoxes(s,i.getReshapedInputDimensions(0),o)];case 3:return c=m.sent(),a.dispose(),s.dispose(),l=c.map((function(e){return e.box})),f=c.map((function(e){return e.score})),h=c.map((function(e){return e.classScore})),d=c.map((function(e){return v.config.classes[e.label]})),p=gm(l.map((function(e){return e.rescale(r)})),f,this.config.iouThreshold,!0),[2,p.map((function(e){return new pm(f[e],h[e],d[e],l[e],u)}))]}}))}))},t.prototype.getDefaultModelName=function(){return""},t.prototype.extractParamsFromWeigthMap=function(e){return function(e,t){var n,r=[],o=yy(e,r),i=o.extractConvParams,a=o.extractConvWithBatchNormParams,s=o.extractSeparableConvParams;if(t.withSeparableConvs){var u=t.filterSizes&&t.filterSizes.length||9;n={conv0:t.isFirstLayerConv2d?i("conv0"):s("conv0"),conv1:s("conv1"),conv2:s("conv2"),conv3:s("conv3"),conv4:s("conv4"),conv5:s("conv5"),conv6:u>7?s("conv6"):void 0,conv7:u>8?s("conv7"):void 0,conv8:i("conv8")}}else n={conv0:a("conv0"),conv1:a("conv1"),conv2:a("conv2"),conv3:a("conv3"),conv4:a("conv4"),conv5:a("conv5"),conv6:a("conv6"),conv7:a("conv7"),conv8:i("conv8")};return ug(e,r),{params:n,paramMappings:r}}(e,this.config)},t.prototype.extractParams=function(e){var n=this.config.filterSizes||t.DEFAULT_FILTER_SIZES,r=n?n.length:void 0;if(7!==r&&8!==r&&9!==r)throw new Error("TinyYolov2 - expected 7 | 8 | 9 convolutional filters, but found "+r+" filterSizes in config");return function(e,t,n,r){var o,i=vg(e),a=i.extractWeights,s=i.getRemainingWeights,u=[],c=gy(a,u),l=c.extractConvParams,f=c.extractConvWithBatchNormParams,h=c.extractSeparableConvParams;if(t.withSeparableConvs){var d=r[0],p=r[1],v=r[2],m=r[3],g=r[4],y=r[5],b=r[6],w=r[7],x=r[8];o={conv0:t.isFirstLayerConv2d?l(d,p,3,"conv0"):h(d,p,"conv0"),conv1:h(p,v,"conv1"),conv2:h(v,m,"conv2"),conv3:h(m,g,"conv3"),conv4:h(g,y,"conv4"),conv5:h(y,b,"conv5"),conv6:w?h(b,w,"conv6"):void 0,conv7:x?h(w,x,"conv7"):void 0,conv8:l(x||w||b,5*n,1,"conv8")}}else d=r[0],p=r[1],v=r[2],m=r[3],g=r[4],y=r[5],b=r[6],w=r[7],x=r[8],o={conv0:f(d,p,"conv0"),conv1:f(p,v,"conv1"),conv2:f(v,m,"conv2"),conv3:f(m,g,"conv3"),conv4:f(g,y,"conv4"),conv5:f(y,b,"conv5"),conv6:f(b,w,"conv6"),conv7:f(w,x,"conv7"),conv8:l(x,5*n,1,"conv8")};if(0!==s().length)throw new Error("weights remaing after extract: "+s().length);return{params:o,paramMappings:u}}(e,this.config,this.boxEncodingSize,n)},t.prototype.extractBoxes=function(e,t,n){return Qv(this,void 0,void 0,(function(){var r,o,i,a,s,u,c,l,f,h,d,p,v,m,g,y,b,w,x,k,_,E,C,S,I,R,T,A,N,O=this;return Jv(this,(function(D){switch(D.label){case 0:return r=t.width,o=t.height,i=Math.max(r,o),a=i/r,s=i/o,u=e.shape[1],c=this.config.anchors.length,l=yi((function(){var t=e.reshape([u,u,c,O.boxEncodingSize]);return[t.slice([0,0,0,0],[u,u,c,4]),t.slice([0,0,0,4],[u,u,c,1]),O.withClassScores?ss(t.slice([0,0,0,5],[u,u,c,O.config.classes.length]),3):Zi(0)]})),f=l[0],h=l[1],d=l[2],p=[],[4,h.array()];case 1:return v=D.sent(),[4,f.array()];case 2:m=D.sent(),g=0,D.label=3;case 3:if(!(g<u))return[3,12];y=0,D.label=4;case 4:if(!(y<u))return[3,11];b=0,D.label=5;case 5:return b<c?(w=bm(v[g][y][b][0]),!n||w>n?(x=(y+bm(m[g][y][b][0]))/u*a,k=(g+bm(m[g][y][b][1]))/u*s,_=Math.exp(m[g][y][b][2])*this.config.anchors[b].x/u*a,E=Math.exp(m[g][y][b][3])*this.config.anchors[b].y/u*s,C=x-_/2,S=k-E/2,I={row:g,col:y,anchor:b},this.withClassScores?[4,this.extractPredictedClass(d,I)]:[3,7]):[3,9]):[3,10];case 6:return N=D.sent(),[3,8];case 7:N={classScore:1,label:0},D.label=8;case 8:T=(R=N).classScore,A=R.label,p.push(Yv({box:new dm(C,S,C+_,S+E),score:w,classScore:w*T,label:A},I)),D.label=9;case 9:return b++,[3,5];case 10:return y++,[3,4];case 11:return g++,[3,3];case 12:return f.dispose(),h.dispose(),d.dispose(),[2,p]}}))}))},t.prototype.extractPredictedClass=function(e,t){return Qv(this,void 0,void 0,(function(){var n,r,o,i;return Jv(this,(function(a){switch(a.label){case 0:return n=t.row,r=t.col,o=t.anchor,[4,e.array()];case 1:return i=a.sent(),[2,Array(this.config.classes.length).fill(0).map((function(e,t){return i[n][r][o][t]})).map((function(e,t){return{classScore:e,label:t}})).reduce((function(e,t){return e.classScore>t.classScore?e:t}))]}}))}))},t.DEFAULT_FILTER_SIZES=[3,16,32,64,128,256,512,1024,1024],t}(rg),xy=function(e){function t(t){void 0===t&&(t=!0);var n=Object.assign({},{withSeparableConvs:t,iouThreshold:.4,classes:["face"]},t?{anchors:fy,meanRgb:hy}:{anchors:ly,withClassScores:!0});return e.call(this,n)||this}return $v(t,e),Object.defineProperty(t.prototype,"withSeparableConvs",{get:function(){return this.config.withSeparableConvs},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(e,t){return Qv(this,void 0,void 0,(function(){return Jv(this,(function(n){switch(n.label){case 0:return[4,this.detect(e,t)];case 1:return[2,n.sent().map((function(e){return new vm(e.score,e.relativeBox,{width:e.imageWidth,height:e.imageHeight})}))]}}))}))},t.prototype.getDefaultModelName=function(){return this.withSeparableConvs?"tiny_yolov2_separable_conv_model":"tiny_yolov2_model"},t.prototype.extractParamsFromWeigthMap=function(t){return e.prototype.extractParamsFromWeigthMap.call(this,t)},t}(wy);var ky=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._name="TinyFaceDetectorOptions",t}return $v(t,e),t}(by),_y=function(){function e(){}return e.prototype.then=function(e){return Qv(this,void 0,void 0,(function(){var t;return Jv(this,(function(n){switch(n.label){case 0:return t=e,[4,this.run()];case 1:return[2,t.apply(void 0,[n.sent()])]}}))}))},e.prototype.run=function(){return Qv(this,void 0,void 0,(function(){return Jv(this,(function(e){throw new Error("ComposableTask - run is not implemented")}))}))},e}();function Ey(e,t){var n={descriptor:t};return Object.assign({},e,n)}function Cy(e,t,n,r,o){return void 0===o&&(o=function(e){return e.alignedRect}),Qv(this,void 0,void 0,(function(){var i,a,s,u,c;return Jv(this,(function(l){switch(l.label){case 0:return i=e.map((function(e){return Ig(e)?o(e):e.detection})),(s=r)?[3,5]:t instanceof Kr?[4,Qm(t,i)]:[3,2];case 1:return u=l.sent(),[3,4];case 2:return[4,Ym(t,i)];case 3:u=l.sent(),l.label=4;case 4:s=u,l.label=5;case 5:return[4,n(a=s)];case 6:return c=l.sent(),a.forEach((function(e){return e instanceof Kr&&e.dispose()})),[2,c]}}))}))}function Sy(e,t,n,r,o){return Qv(this,void 0,void 0,(function(){var i=this;return Jv(this,(function(a){return[2,Cy([e],t,(function(e){return Qv(i,void 0,void 0,(function(){return Jv(this,(function(t){return[2,n(e[0])]}))}))}),r,o)]}))}))}var Iy=2,Ry=12;function Ty(e){var t=vg(e),n=t.extractWeights,r=t.getRemainingWeights,o=[],i=function(e,t){var n=cg(e,t),r=lg(e,t);function o(n,r){var o=Wi(e(n));return t.push({paramPath:r}),o}function i(e,t,r){return void 0===r&&(r=!1),{conv1:n(e[0],e[1],3,t+"/conv1"),prelu1_alpha:o(e[1],t+"/prelu1_alpha"),conv2:n(e[1],e[2],3,t+"/conv2"),prelu2_alpha:o(e[2],t+"/prelu2_alpha"),conv3:n(e[2],e[3],r?2:3,t+"/conv3"),prelu3_alpha:o(e[3],t+"/prelu3_alpha")}}return{extractPNetParams:function(){var e=i([3,10,16,32],"pnet"),t=n(32,2,1,"pnet/conv4_1"),r=n(32,4,1,"pnet/conv4_2");return Yv(Yv({},e),{conv4_1:t,conv4_2:r})},extractRNetParams:function(){var e=i([3,28,48,64],"rnet",!0),t=r(576,128,"rnet/fc1"),n=o(128,"rnet/prelu4_alpha"),a=r(128,2,"rnet/fc2_1"),s=r(128,4,"rnet/fc2_2");return Yv(Yv({},e),{fc1:t,prelu4_alpha:n,fc2_1:a,fc2_2:s})},extractONetParams:function(){var e=i([3,32,64,64],"onet"),t=n(64,128,2,"onet/conv4"),a=o(128,"onet/prelu4_alpha"),s=r(1152,256,"onet/fc1"),u=o(256,"onet/prelu5_alpha"),c=r(256,2,"onet/fc2_1"),l=r(256,4,"onet/fc2_2"),f=r(256,10,"onet/fc2_3");return Yv(Yv({},e),{conv4:t,prelu4_alpha:a,fc1:s,prelu5_alpha:u,fc2_1:c,fc2_2:l,fc2_3:f})}}}(n,o),a=i.extractPNetParams,s=i.extractRNetParams,u=i.extractONetParams,c=a(),l=s(),f=u();if(0!==r().length)throw new Error("weights remaing after extract: "+r().length);return{params:{pnet:c,rnet:l,onet:f},paramMappings:o}}function Ay(e){var t=[],n=function(e,t){var n=pg(e,t);function r(e){return{filters:n(e+"/weights",4,e+"/filters"),bias:n(e+"/bias",1)}}function o(e){return{weights:n(e+"/weights",2),bias:n(e+"/bias",1)}}function i(e){return n(e,1)}function a(e){return{conv1:r(e+"/conv1"),prelu1_alpha:i(e+"/prelu1_alpha"),conv2:r(e+"/conv2"),prelu2_alpha:i(e+"/prelu2_alpha"),conv3:r(e+"/conv3"),prelu3_alpha:i(e+"/prelu3_alpha")}}return{extractPNetParams:function(){var e=a("pnet"),t=r("pnet/conv4_1"),n=r("pnet/conv4_2");return Yv(Yv({},e),{conv4_1:t,conv4_2:n})},extractRNetParams:function(){var e=a("rnet"),t=o("rnet/fc1"),n=i("rnet/prelu4_alpha"),r=o("rnet/fc2_1"),s=o("rnet/fc2_2");return Yv(Yv({},e),{fc1:t,prelu4_alpha:n,fc2_1:r,fc2_2:s})},extractONetParams:function(){var e=a("onet"),t=r("onet/conv4"),n=i("onet/prelu4_alpha"),s=o("onet/fc1"),u=i("onet/prelu5_alpha"),c=o("onet/fc2_1"),l=o("onet/fc2_2"),f=o("onet/fc2_3");return Yv(Yv({},e),{conv4:t,prelu4_alpha:n,fc1:s,prelu5_alpha:u,fc2_1:c,fc2_2:l,fc2_3:f})}}}(e,t),r=n.extractPNetParams,o=n.extractRNetParams,i=n.extractONetParams,a=r(),s=o(),u=i();return ug(e,t),{params:{pnet:a,rnet:s,onet:u},paramMappings:t}}function Ny(e,t){var n=t[0],r=t[1];return{height:Math.floor(n*e),width:Math.floor(r*e)}}var Oy=function(e){function t(t,n,r,o){return e.call(this,{left:t,top:n,right:r,bottom:o},!0)||this}return $v(t,e),t}(hm);function Dy(e){return yi((function(){return eh(ih(e,Zi(127.5)),Zi(.0078125))}))}function Py(e,t){return yi((function(){return jf(yd(e),eh(t,rf(yd(rf(e)))))}))}function My(e,t,n){return void 0===n&&(n=!1),yi((function(){var r=sg(e,t.conv1,"valid");return r=Py(r,t.prelu1_alpha),r=Py(r=sg(r=Gh(r,n?[2,2]:[3,3],[2,2],"same"),t.conv2,"valid"),t.prelu2_alpha),r=Py(r=sg(r=n?r:Gh(r,[3,3],[2,2],"valid"),t.conv3,"valid"),t.prelu3_alpha)}))}function Fy(e,t,n,r,o){o.stage1=[];var i=t.map((function(t){return yi((function(){var n={scale:t},o=function(e,t){return yi((function(){var n=Ny(t,e.shape.slice(1)),r=n.height,o=n.width,i=Dy(dp.resizeBilinear(e,[r,o]));return xd(i,[0,2,1,3])}))}(e,t),i=Date.now(),a=function(e,t){return yi((function(){var n=My(e,t,!0),r=sg(n,t.conv4_1,"valid"),o=_a(cd(r,3),3);return{prob:ss(ih(r,o),3),regions:sg(n,t.conv4_2,"valid")}}))}(o,r),s=a.prob,u=a.regions;return n.pnet=Date.now()-i,{scoresTensor:Wa(Wa(s,3)[1])[0],regionsTensor:Wa(u)[0],scale:t,statsForScale:n}}))})),a=i.map((function(e){var t=e.scoresTensor,r=e.regionsTensor,i=e.scale,a=e.statsForScale,s=function(e,t,n,r){for(var o=[],i=e.arraySync(),a=0;a<e.shape[0];a++)for(var s=0;s<e.shape[1];s++)i[a][s]>=r&&o.push(new fm(s,a));return o.map((function(e){var r=new dm(Math.round((e.y*Iy+1)/n),Math.round((e.x*Iy+1)/n),Math.round((e.y*Iy+Ry)/n),Math.round((e.x*Iy+Ry)/n)),o=i[e.y][e.x],a=t.arraySync();return{cell:r,score:o,region:new Oy(a[e.y][e.x][0],a[e.y][e.x][1],a[e.y][e.x][2],a[e.y][e.x][3])}}))}(t,r,i,n);if(t.dispose(),r.dispose(),!s.length)return o.stage1.push(a),[];var u=Date.now(),c=gm(s.map((function(e){return e.cell})),s.map((function(e){return e.score})),.5);return a.nms=Date.now()-u,a.numBoxes=c.length,o.stage1.push(a),c.map((function(e){return s[e]}))})),s=a.reduce((function(e,t){return e.concat(t)}),[]),u=[],c=[];if(s.length>0){var l=Date.now(),f=gm(s.map((function(e){return e.cell})),s.map((function(e){return e.score})),.7);o.stage1_nms=Date.now()-l,c=f.map((function(e){return s[e].score})),u=f.map((function(e){return s[e]})).map((function(e){var t=e.cell,n=e.region;return new dm(t.left+n.left*t.width,t.top+n.top*t.height,t.right+n.right*t.width,t.bottom+n.bottom*t.height).toSquare().round()}))}return{boxes:u,scores:c}}function Ly(e,t,n){var r=n.width,o=n.height;return Qv(this,void 0,void 0,(function(){var n,i,a,s=this;return Jv(this,(function(u){switch(u.label){case 0:return n=Um(e),[4,Promise.all(t.map((function(t){return Qv(s,void 0,void 0,(function(){var r,o,i,a,s,u,c,l;return Jv(this,(function(f){return r=t.padAtBorders(e.height,e.width),o=r.y,i=r.ey,a=r.x,s=r.ex,u=a-1,c=o-1,l=n.getImageData(u,c,s-u,i-c),[2,Lm.isNodejs()?qm(l):createImageBitmap(l)]}))}))})))];case 1:return i=u.sent(),a=[],i.forEach((function(e){var t=Um(Hm({width:r,height:o}));t.drawImage(e,0,0,r,o);for(var n=t.getImageData(0,0,r,o).data,i=[],s=0;s<n.length;s+=4)i.push(n[s+2]),i.push(n[s+1]),i.push(n[s]);a.push(i)})),[2,a.map((function(e){return yi((function(){return Dy(xd(Hi(e,[1,r,o,3]),[0,2,1,3]).toFloat())}))}))]}}))}))}function By(e,t,n,r,o){return Qv(this,void 0,void 0,(function(){var i,a,s,u,c,l,f,h,d,p,v,m,g,y;return Jv(this,(function(b){switch(b.label){case 0:return i=Date.now(),[4,Ly(e,t,{width:24,height:24})];case 1:return a=b.sent(),o.stage2_extractImagePatches=Date.now()-i,i=Date.now(),s=a.map((function(e){var t=function(e,t){return yi((function(){var n=My(e,t),r=Py(wg(Fa(n,[n.shape[0],t.fc1.weights.shape[0]]),t.fc1),t.prelu4_alpha),o=wg(r,t.fc2_1),i=_a(cd(o,1),1),a=ss(ih(o,i),1),s=wg(r,t.fc2_2);return{scores:Wa(a,1)[1],regions:s}}))}(e,r);return e.dispose(),t})),o.stage2_rnet=Date.now()-i,u=s.length>1?Qi(s.map((function(e){return e.scores}))):s[0].scores,f=(l=Array).from,[4,u.data()];case 2:return c=f.apply(l,[b.sent()]),u.dispose(),h=c.map((function(e,t){return{score:e,idx:t}})).filter((function(e){return e.score>n})).map((function(e){return e.idx})),d=h.map((function(e){return t[e]})),p=h.map((function(e){return c[e]})),v=[],m=[],d.length>0&&(i=Date.now(),g=gm(d,p,.7),o.stage2_nms=Date.now()-i,y=g.map((function(e){var t=s[h[e]].regions.arraySync();return new Oy(t[0][0],t[0][1],t[0][2],t[0][3])})),m=g.map((function(e){return p[e]})),v=g.map((function(e,t){return d[e].calibrate(y[t])}))),s.forEach((function(e){e.regions.dispose(),e.scores.dispose()})),[2,{boxes:v,scores:m}]}}))}))}function Uy(e,t,n,r,o){return Qv(this,void 0,void 0,(function(){var i,a,s,u,c,l,f,h,d,p,v,m,g,y,b;return Jv(this,(function(w){switch(w.label){case 0:return i=Date.now(),[4,Ly(e,t,{width:48,height:48})];case 1:return a=w.sent(),o.stage3_extractImagePatches=Date.now()-i,i=Date.now(),s=a.map((function(e){var t=function(e,t){return yi((function(){var n=My(e,t);n=Py(n=sg(n=Gh(n,[2,2],[2,2],"same"),t.conv4,"valid"),t.prelu4_alpha);var r=Py(wg(Fa(n,[n.shape[0],t.fc1.weights.shape[0]]),t.fc1),t.prelu5_alpha),o=wg(r,t.fc2_1),i=_a(cd(o,1),1),a=ss(ih(o,i),1),s=wg(r,t.fc2_2),u=wg(r,t.fc2_3);return{scores:Wa(a,1)[1],regions:s,points:u}}))}(e,r);return e.dispose(),t})),o.stage3_onet=Date.now()-i,u=s.length>1?Qi(s.map((function(e){return e.scores}))):s[0].scores,f=(l=Array).from,[4,u.data()];case 2:return c=f.apply(l,[w.sent()]),u.dispose(),h=c.map((function(e,t){return{score:e,idx:t}})).filter((function(e){return e.score>n})).map((function(e){return e.idx})),d=h.map((function(e){var t=s[e].regions.arraySync();return new Oy(t[0][0],t[0][1],t[0][2],t[0][3])})),p=h.map((function(e,n){return t[e].calibrate(d[n])})),v=h.map((function(e){return c[e]})),m=[],g=[],y=[],p.length>0&&(i=Date.now(),b=gm(p,v,.7,!1),o.stage3_nms=Date.now()-i,m=b.map((function(e){return p[e]})),g=b.map((function(e){return v[e]})),y=b.map((function(e,t){return Array(5).fill(0).map((function(n,r){var o=s[e].points.arraySync();return new fm(o[0][r]*(m[t].width+1)+m[t].left,o[0][r+5]*(m[t].height+1)+m[t].top)}))}))),s.forEach((function(e){e.regions.dispose(),e.scores.dispose(),e.points.dispose()})),[2,{boxes:m,scores:g,points:y}]}}))}))}var jy=function(e){function t(){return e.call(this,"Mtcnn")||this}return $v(t,e),t.prototype.load=function(t){return Qv(this,void 0,void 0,(function(){return Jv(this,(function(n){return console.warn("mtcnn is deprecated and will be removed soon"),[2,e.prototype.load.call(this,t)]}))}))},t.prototype.loadFromDisk=function(t){return Qv(this,void 0,void 0,(function(){return Jv(this,(function(n){return console.warn("mtcnn is deprecated and will be removed soon"),[2,e.prototype.loadFromDisk.call(this,t)]}))}))},t.prototype.forwardInput=function(e,t){return void 0===t&&(t={}),Qv(this,void 0,void 0,(function(){var n,r,o,i,a,s,u,c,l,f,h,d,p,v,m,g,y,b,w,x,k;return Jv(this,(function(_){switch(_.label){case 0:if(!(n=this.params))throw new Error("Mtcnn - load model before inference");if(!(r=e.canvases[0]))throw new Error("Mtcnn - inputCanvas is not defined, note that passing tensors into Mtcnn.forwardInput is not supported yet.");return o={},i=Date.now(),a=yi((function(){return e=_a(Dv.fromPixels(r)).toFloat(),yi((function(){return Ua(Wa(e,3).reverse(),3)}));var e})),s=function(e){return a.dispose(),o.total=Date.now()-i,e},u=a.shape.slice(1),c=u[0],l=u[1],f=new Qg(t),h=f.minFaceSize,d=f.scaleFactor,p=f.maxNumScales,v=f.scoreThresholds,m=f.scaleSteps,g=(m||function(e,t,n){for(var r=n[0],o=n[1],i=Ry/e,a=[],s=Math.min(r,o)*i,u=0;s>=12;)a.push(i*Math.pow(t,u)),s*=t,u+=1;return a}(h,d,[c,l])).filter((function(e){var t=Ny(e,[c,l]);return Math.min(t.width,t.height)>Ry})).slice(0,p),o.scales=g,o.pyramid=g.map((function(e){return Ny(e,[c,l])})),y=Date.now(),[4,Fy(a,g,v[0],n.pnet,o)];case 1:return b=_.sent(),o.total_stage1=Date.now()-y,b.boxes.length?(o.stage2_numInputBoxes=b.boxes.length,y=Date.now(),[4,By(r,b.boxes,v[1],n.rnet,o)]):[2,s({results:[],stats:o})];case 2:return w=_.sent(),o.total_stage2=Date.now()-y,w.boxes.length?(o.stage3_numInputBoxes=w.boxes.length,y=Date.now(),[4,Uy(r,w.boxes,v[2],n.onet,o)]):[2,s({results:[],stats:o})];case 3:return x=_.sent(),o.total_stage3=Date.now()-y,k=x.boxes.map((function(e,t){return Rg(Rm({},new vm(x.scores[t],new xm(e.left/l,e.top/c,e.width/l,e.height/c),{height:c,width:l})),new _m(x.points[t].map((function(t){return t.sub(new fm(e.left,e.top)).div(new fm(e.width,e.height))})),{width:e.width,height:e.height}))})),[2,s({results:k,stats:o})]}}))}))},t.prototype.forward=function(e,t){return void 0===t&&(t={}),Qv(this,void 0,void 0,(function(){var n;return Jv(this,(function(r){switch(r.label){case 0:return n=this.forwardInput,[4,$m(e)];case 1:return[4,n.apply(this,[r.sent(),t])];case 2:return[2,r.sent().results]}}))}))},t.prototype.forwardWithStats=function(e,t){return void 0===t&&(t={}),Qv(this,void 0,void 0,(function(){var n;return Jv(this,(function(r){switch(r.label){case 0:return n=this.forwardInput,[4,$m(e)];case 1:return[2,n.apply(this,[r.sent(),t])]}}))}))},t.prototype.getDefaultModelName=function(){return"mtcnn_model"},t.prototype.extractParamsFromWeigthMap=function(e){return Ay(e)},t.prototype.extractParams=function(e){return Ty(e)},t}(rg),Zy=[new fm(1.603231,2.094468),new fm(6.041143,7.080126),new fm(2.882459,3.518061),new fm(4.266906,5.178857),new fm(9.041765,10.66308)],Wy=[117.001,114.697,97.404],zy=function(e){function t(){var t={withSeparableConvs:!0,iouThreshold:.4,classes:["face"],anchors:Zy,meanRgb:Wy,isFirstLayerConv2d:!0,filterSizes:[3,16,32,64,128,256,512]};return e.call(this,t)||this}return $v(t,e),Object.defineProperty(t.prototype,"anchors",{get:function(){return this.config.anchors},enumerable:!0,configurable:!0}),t.prototype.locateFaces=function(e,t){return Qv(this,void 0,void 0,(function(){return Jv(this,(function(n){switch(n.label){case 0:return[4,this.detect(e,t)];case 1:return[2,n.sent().map((function(e){return new vm(e.score,e.relativeBox,{width:e.imageWidth,height:e.imageHeight})}))]}}))}))},t.prototype.getDefaultModelName=function(){return"tiny_face_detector_model"},t.prototype.extractParamsFromWeigthMap=function(t){return e.prototype.extractParamsFromWeigthMap.call(this,t)},t}(wy),Vy={ssdMobilenetv1:new uy,tinyFaceDetector:new zy,tinyYolov2:new xy,mtcnn:new jy,faceLandmark68Net:new Ug,faceLandmark68TinyNet:new Zg,faceRecognitionNet:new $g,faceExpressionNet:new Cg,ageGenderNet:new Lg},Hy=function(e){return Vy.ssdMobilenetv1.load(e)};function qy(e,t){var n={age:t};return Object.assign({},e,n)}var Gy=function(e){function t(t,n,r){var o=e.call(this)||this;return o.parentTask=t,o.input=n,o.extractedFaces=r,o}return $v(t,e),t}(_y),Ky=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $v(t,e),t.prototype.run=function(){return Qv(this,void 0,void 0,(function(){var e,t,n=this;return Jv(this,(function(r){switch(r.label){case 0:return[4,this.parentTask];case 1:return[4,Cy(e=r.sent(),this.input,(function(e){return Qv(n,void 0,void 0,(function(){return Jv(this,(function(t){switch(t.label){case 0:return[4,Promise.all(e.map((function(e){return Vy.faceExpressionNet.predictExpressions(e)})))];case 1:return[2,t.sent()]}}))}))}),this.extractedFaces)];case 2:return t=r.sent(),[2,e.map((function(e,n){return Sg(e,t[n])}))]}}))}))},t.prototype.withAgeAndGender=function(){return new Jy(this,this.input)},t}(Gy),Xy=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $v(t,e),t.prototype.run=function(){return Qv(this,void 0,void 0,(function(){var e,t;return Jv(this,(function(n){switch(n.label){case 0:return[4,this.parentTask];case 1:return(e=n.sent())?[4,Sy(e,this.input,(function(e){return Vy.faceExpressionNet.predictExpressions(e)}),this.extractedFaces)]:[2];case 2:return t=n.sent(),[2,Sg(e,t)]}}))}))},t.prototype.withAgeAndGender=function(){return new eb(this,this.input)},t}(Gy),$y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $v(t,e),t.prototype.withAgeAndGender=function(){return new tb(this,this.input)},t.prototype.withFaceDescriptors=function(){return new ob(this,this.input)},t}(Ky),Yy=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $v(t,e),t.prototype.withAgeAndGender=function(){return new nb(this,this.input)},t.prototype.withFaceDescriptor=function(){return new ib(this,this.input)},t}(Xy),Qy=function(e){function t(t,n,r){var o=e.call(this)||this;return o.parentTask=t,o.input=n,o.extractedFaces=r,o}return $v(t,e),t}(_y),Jy=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $v(t,e),t.prototype.run=function(){return Qv(this,void 0,void 0,(function(){var e,t,n=this;return Jv(this,(function(r){switch(r.label){case 0:return[4,this.parentTask];case 1:return[4,Cy(e=r.sent(),this.input,(function(e){return Qv(n,void 0,void 0,(function(){return Jv(this,(function(t){switch(t.label){case 0:return[4,Promise.all(e.map((function(e){return Vy.ageGenderNet.predictAgeAndGender(e)})))];case 1:return[2,t.sent()]}}))}))}),this.extractedFaces)];case 2:return t=r.sent(),[2,e.map((function(e,n){var r=t[n],o=r.age;return qy(Yg(e,r.gender,r.genderProbability),o)}))]}}))}))},t.prototype.withFaceExpressions=function(){return new Ky(this,this.input)},t}(Qy),eb=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $v(t,e),t.prototype.run=function(){return Qv(this,void 0,void 0,(function(){var e,t,n,r,o;return Jv(this,(function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return(e=i.sent())?[4,Sy(e,this.input,(function(e){return Vy.ageGenderNet.predictAgeAndGender(e)}),this.extractedFaces)]:[2];case 2:return t=i.sent(),n=t.age,r=t.gender,o=t.genderProbability,[2,qy(Yg(e,r,o),n)]}}))}))},t.prototype.withFaceExpressions=function(){return new Xy(this,this.input)},t}(Qy),tb=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $v(t,e),t.prototype.withFaceExpressions=function(){return new $y(this,this.input)},t.prototype.withFaceDescriptors=function(){return new ob(this,this.input)},t}(Jy),nb=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $v(t,e),t.prototype.withFaceExpressions=function(){return new Yy(this,this.input)},t.prototype.withFaceDescriptor=function(){return new ib(this,this.input)},t}(eb),rb=function(e){function t(t,n){var r=e.call(this)||this;return r.parentTask=t,r.input=n,r}return $v(t,e),t}(_y),ob=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $v(t,e),t.prototype.run=function(){return Qv(this,void 0,void 0,(function(){var e;return Jv(this,(function(t){switch(t.label){case 0:return[4,this.parentTask];case 1:return[4,Cy(e=t.sent(),this.input,(function(e){return Promise.all(e.map((function(e){return Vy.faceRecognitionNet.computeFaceDescriptor(e)})))}),null,(function(e){return e.landmarks.align(null,{useDlibAlignment:!0})}))];case 2:return[2,t.sent().map((function(t,n){return Ey(e[n],t)}))]}}))}))},t.prototype.withFaceExpressions=function(){return new $y(this,this.input)},t.prototype.withAgeAndGender=function(){return new tb(this,this.input)},t}(rb),ib=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $v(t,e),t.prototype.run=function(){return Qv(this,void 0,void 0,(function(){var e,t;return Jv(this,(function(n){switch(n.label){case 0:return[4,this.parentTask];case 1:return(e=n.sent())?[4,Sy(e,this.input,(function(e){return Vy.faceRecognitionNet.computeFaceDescriptor(e)}),null,(function(e){return e.landmarks.align(null,{useDlibAlignment:!0})}))]:[2];case 2:return t=n.sent(),[2,Ey(e,t)]}}))}))},t.prototype.withFaceExpressions=function(){return new Yy(this,this.input)},t.prototype.withAgeAndGender=function(){return new nb(this,this.input)},t}(rb),ab=function(e){function t(t,n,r){var o=e.call(this)||this;return o.parentTask=t,o.input=n,o.useTinyLandmarkNet=r,o}return $v(t,e),Object.defineProperty(t.prototype,"landmarkNet",{get:function(){return this.useTinyLandmarkNet?Vy.faceLandmark68TinyNet:Vy.faceLandmark68Net},enumerable:!0,configurable:!0}),t}(_y),sb=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $v(t,e),t.prototype.run=function(){return Qv(this,void 0,void 0,(function(){var e,t,n,r,o,i=this;return Jv(this,(function(a){switch(a.label){case 0:return[4,this.parentTask];case 1:return e=a.sent(),t=e.map((function(e){return e.detection})),this.input instanceof Kr?[4,Qm(this.input,t)]:[3,3];case 2:return r=a.sent(),[3,5];case 3:return[4,Ym(this.input,t)];case 4:r=a.sent(),a.label=5;case 5:return n=r,[4,Promise.all(n.map((function(e){return i.landmarkNet.detectLandmarks(e)})))];case 6:return o=a.sent(),n.forEach((function(e){return e instanceof Kr&&e.dispose()})),[2,e.map((function(e,t){return Rg(e,o[t])}))]}}))}))},t.prototype.withFaceExpressions=function(){return new $y(this,this.input)},t.prototype.withAgeAndGender=function(){return new tb(this,this.input)},t.prototype.withFaceDescriptors=function(){return new ob(this,this.input)},t}(ab),ub=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $v(t,e),t.prototype.run=function(){return Qv(this,void 0,void 0,(function(){var e,t,n,r,o;return Jv(this,(function(i){switch(i.label){case 0:return[4,this.parentTask];case 1:return(e=i.sent())?(t=e.detection,this.input instanceof Kr?[4,Qm(this.input,[t])]:[3,3]):[2];case 2:return r=i.sent(),[3,5];case 3:return[4,Ym(this.input,[t])];case 4:r=i.sent(),i.label=5;case 5:return n=r,[4,this.landmarkNet.detectLandmarks(n[0])];case 6:return o=i.sent(),n.forEach((function(e){return e instanceof Kr&&e.dispose()})),[2,Rg(e,o)]}}))}))},t.prototype.withFaceExpressions=function(){return new Yy(this,this.input)},t.prototype.withAgeAndGender=function(){return new nb(this,this.input)},t.prototype.withFaceDescriptor=function(){return new ib(this,this.input)},t}(ab),cb=function(e){function t(t,n){void 0===n&&(n=new sy);var r=e.call(this)||this;return r.input=t,r.options=n,r}return $v(t,e),t}(_y),lb=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $v(t,e),t.prototype.run=function(){return Qv(this,void 0,void 0,(function(){var e,t,n,r;return Jv(this,(function(o){switch(o.label){case 0:return t=(e=this).input,(n=e.options)instanceof Qg?[4,Vy.mtcnn.forward(t,n)]:[3,2];case 1:return[2,o.sent().map((function(e){return e.detection}))];case 2:if(r=n instanceof ky?function(e){return Vy.tinyFaceDetector.locateFaces(e,n)}:n instanceof sy?function(e){return Vy.ssdMobilenetv1.locateFaces(e,n)}:n instanceof by?function(e){return Vy.tinyYolov2.locateFaces(e,n)}:null,!r)throw new Error("detectFaces - expected options to be instance of TinyFaceDetectorOptions | SsdMobilenetv1Options | MtcnnOptions | TinyYolov2Options");return[2,r(t)]}}))}))},t.prototype.runAndExtendWithFaceDetections=function(){var e=this;return new Promise((function(t){return Qv(e,void 0,void 0,(function(){var e;return Jv(this,(function(n){switch(n.label){case 0:return[4,this.run()];case 1:return e=n.sent(),[2,t(e.map((function(e){return Rm({},e)})))]}}))}))}))},t.prototype.withFaceLandmarks=function(e){return void 0===e&&(e=!1),new sb(this.runAndExtendWithFaceDetections(),this.input,e)},t.prototype.withFaceExpressions=function(){return new Ky(this.runAndExtendWithFaceDetections(),this.input)},t.prototype.withAgeAndGender=function(){return new Jy(this.runAndExtendWithFaceDetections(),this.input)},t}(cb),fb=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $v(t,e),t.prototype.run=function(){return Qv(this,void 0,void 0,(function(){var e,t;return Jv(this,(function(n){switch(n.label){case 0:return[4,new lb(this.input,this.options)];case 1:return e=n.sent(),t=e[0],e.forEach((function(e){e.score>t.score&&(t=e)})),[2,t]}}))}))},t.prototype.runAndExtendWithFaceDetection=function(){var e=this;return new Promise((function(t){return Qv(e,void 0,void 0,(function(){var e;return Jv(this,(function(n){switch(n.label){case 0:return[4,this.run()];case 1:return e=n.sent(),[2,t(e?Rm({},e):void 0)]}}))}))}))},t.prototype.withFaceLandmarks=function(e){return void 0===e&&(e=!1),new ub(this.runAndExtendWithFaceDetection(),this.input,e)},t.prototype.withFaceExpressions=function(){return new Xy(this.runAndExtendWithFaceDetection(),this.input)},t.prototype.withAgeAndGender=function(){return new eb(this.runAndExtendWithFaceDetection(),this.input)},t}(cb);function hb(e,t){return void 0===t&&(t=new sy),new fb(e,t)}!function(){function e(e,t){void 0===t&&(t=.6),this._distanceThreshold=t;var n=Array.isArray(e)?e:[e];if(!n.length)throw new Error("FaceRecognizer.constructor - expected atleast one input");var r=1,o=function(){return"person "+r++};this._labeledDescriptors=n.map((function(e){if(e instanceof Im)return e;if(e instanceof Float32Array)return new Im(o(),[e]);if(e.descriptor&&e.descriptor instanceof Float32Array)return new Im(o(),[e.descriptor]);throw new Error("FaceRecognizer.constructor - expected inputs to be of type LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array | Array<LabeledFaceDescriptors | WithFaceDescriptor<any> | Float32Array>")}))}Object.defineProperty(e.prototype,"labeledDescriptors",{get:function(){return this._labeledDescriptors},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"distanceThreshold",{get:function(){return this._distanceThreshold},enumerable:!0,configurable:!0}),e.prototype.computeMeanDistance=function(e,t){return t.map((function(t){return function(e,t){if(e.length!==t.length)throw new Error("euclideanDistance: arr1.length !== arr2.length");var n=Array.from(e),r=Array.from(t);return Math.sqrt(n.map((function(e,t){return e-r[t]})).reduce((function(e,t){return e+Math.pow(t,2)}),0))}(t,e)})).reduce((function(e,t){return e+t}),0)/(t.length||1)},e.prototype.matchDescriptor=function(e){var t=this;return this.labeledDescriptors.map((function(n){var r=n.descriptors,o=n.label;return new Cm(o,t.computeMeanDistance(e,r))})).reduce((function(e,t){return e.distance<t.distance?e:t}))},e.prototype.findBestMatch=function(e){var t=this.matchDescriptor(e);return t.distance<this.distanceThreshold?t:new Cm("unknown",t.distance)},e.prototype.toJSON=function(){return{distanceThreshold:this.distanceThreshold,labeledDescriptors:this.labeledDescriptors.map((function(e){return e.toJSON()}))}},e.fromJSON=function(t){var n=t.labeledDescriptors.map((function(e){return Im.fromJSON(e)}));return new e(n,t.distanceThreshold)}}();var db=n(7326),pb=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var o=e.charCodeAt(r);o<128?t[n++]=o:o<2048?(t[n++]=o>>6|192,t[n++]=63&o|128):55296===(64512&o)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(o=65536+((1023&o)<<10)+(1023&e.charCodeAt(++r)),t[n++]=o>>18|240,t[n++]=o>>12&63|128,t[n++]=o>>6&63|128,t[n++]=63&o|128):(t[n++]=o>>12|224,t[n++]=o>>6&63|128,t[n++]=63&o|128)}return t},vb={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],o=0;o<e.length;o+=3){var i=e[o],a=o+1<e.length,s=a?e[o+1]:0,u=o+2<e.length,c=u?e[o+2]:0,l=i>>2,f=(3&i)<<4|s>>4,h=(15&s)<<2|c>>6,d=63&c;u||(d=64,a||(h=64)),r.push(n[l],n[f],n[h],n[d])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(pb(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){for(var t=[],n=0,r=0;n<e.length;){var o=e[n++];if(o<128)t[r++]=String.fromCharCode(o);else if(o>191&&o<224){var i=e[n++];t[r++]=String.fromCharCode((31&o)<<6|63&i)}else if(o>239&&o<365){var a=((7&o)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(a>>10)),t[r++]=String.fromCharCode(56320+(1023&a))}else{var s=e[n++],u=e[n++];t[r++]=String.fromCharCode((15&o)<<12|(63&s)<<6|63&u)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],o=0;o<e.length;){var i=n[e.charAt(o++)],a=o<e.length?n[e.charAt(o)]:0,s=++o<e.length?n[e.charAt(o)]:64,u=++o<e.length?n[e.charAt(o)]:64;if(++o,null==i||null==a||null==s||null==u)throw new mb;var c=i<<2|a>>4;if(r.push(c),64!==s){var l=a<<4&240|s>>2;if(r.push(l),64!==u){var f=s<<6&192|u;r.push(f)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},mb=function(e){(0,$e.Z)(n,e);var t=(0,Ye.Z)(n);function n(){var e;return(0,V.Z)(this,n),(e=t.apply(this,arguments)).name="DecodeBase64StringError",e}return(0,H.Z)(n)}((0,Qe.Z)(Error)),gb=function(e){return function(e){var t=pb(e);return vb.encodeByteArray(t,!0)}(e).replace(/\./g,"")},yb=function(e){try{return vb.decodeString(e,!0)}catch(Fn){console.error("base64Decode failed: ",Fn)}return null};var bb=function(){return function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__},wb=function(){try{return bb()||function(){if("undefined"!==typeof process){var e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0}}()||function(){if("undefined"!==typeof document){var e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(Fn){return}var t=e&&yb(e[1]);return t&&JSON.parse(t)}}()}catch(Fn){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(Fn))}},xb=function(e){var t,n;return null===(n=null===(t=wb())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},kb=function(){var e;return null===(e=wb())||void 0===e?void 0:e.config},_b=function(e){var t;return null===(t=wb())||void 0===t?void 0:t["_".concat(e)]},Eb=function(){function e(){var t=this;(0,V.Z)(this,e),this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return(0,H.Z)(e,[{key:"wrapCallback",value:function(e){var t=this;return function(n,r){n?t.reject(n):t.resolve(r),"function"===typeof e&&(t.promise.catch((function(){})),1===e.length?e(n):e(n,r))}}}]),e}();function Cb(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function Sb(){var e,t=null===(e=wb())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(Fn){return!1}}function Ib(){try{return"object"===typeof indexedDB}catch(Fn){return!1}}var Rb=function(e){(0,$e.Z)(n,e);var t=(0,Ye.Z)(n);function n(e,r,o){var i;return(0,V.Z)(this,n),(i=t.call(this,r)).code=e,i.customData=o,i.name="FirebaseError",Object.setPrototypeOf((0,db.Z)(i),n.prototype),Error.captureStackTrace&&Error.captureStackTrace((0,db.Z)(i),Tb.prototype.create),i}return(0,H.Z)(n)}((0,Qe.Z)(Error)),Tb=function(){function e(t,n,r){(0,V.Z)(this,e),this.service=t,this.serviceName=n,this.errors=r}return(0,H.Z)(e,[{key:"create",value:function(e){var t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),r=this.errors[e],o=r?function(e,t){return e.replace(Ab,(function(e,n){var r=t[n];return null!=r?String(r):"<".concat(n,"?>")}))}(r,t):"Error",i="".concat(this.serviceName,": ").concat(o," (").concat(n,").");return new Rb(n,i,t)}}]),e}();var Ab=/\{\$([^}]+)}/g;function Nb(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function Ob(e,t){if(e===t)return!0;for(var n=Object.keys(e),r=Object.keys(t),o=0,i=n;o<i.length;o++){var a=i[o];if(!r.includes(a))return!1;var s=e[a],u=t[a];if(Db(s)&&Db(u)){if(!Ob(s,u))return!1}else if(s!==u)return!1}for(var c=0,l=r;c<l.length;c++){var f=l[c];if(!n.includes(f))return!1}return!0}function Db(e){return null!==e&&"object"===typeof e}function Pb(e){for(var t=[],n=function(){var e=(0,o.Z)(i[r],2),n=e[0],a=e[1];Array.isArray(a)?a.forEach((function(e){t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(a))},r=0,i=Object.entries(e);r<i.length;r++)n();return t.length?"&"+t.join("&"):""}function Mb(e){var t={};return e.replace(/^\?/,"").split("&").forEach((function(e){if(e){var n=e.split("="),r=(0,o.Z)(n,2),i=r[0],a=r[1];t[decodeURIComponent(i)]=decodeURIComponent(a)}})),t}function Fb(e){var t=e.indexOf("?");if(!t)return"";var n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}var Lb=function(){function e(t,n){var r=this;(0,V.Z)(this,e),this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then((function(){t(r)})).catch((function(e){r.error(e)}))}return(0,H.Z)(e,[{key:"next",value:function(e){this.forEachObserver((function(t){t.next(e)}))}},{key:"error",value:function(e){this.forEachObserver((function(t){t.error(e)})),this.close(e)}},{key:"complete",value:function(){this.forEachObserver((function(e){e.complete()})),this.close()}},{key:"subscribe",value:function(e,t,n){var r,o=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(e,t){if("object"!==typeof e||null===e)return!1;var n,r=(0,ot.Z)(t);try{for(r.s();!(n=r.n()).done;){var o=n.value;if(o in e&&"function"===typeof e[o])return!0}}catch(i){r.e(i)}finally{r.f()}return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n}).next&&(r.next=Bb),void 0===r.error&&(r.error=Bb),void 0===r.complete&&(r.complete=Bb);var i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{o.finalError?r.error(o.finalError):r.complete()}catch(Fn){}})),this.observers.push(r),i}},{key:"unsubscribeOne",value:function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}},{key:"forEachObserver",value:function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)}},{key:"sendOne",value:function(e,t){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(Fn){"undefined"!==typeof console&&console.error&&console.error(Fn)}}))}},{key:"close",value:function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((function(){t.observers=void 0,t.onNoObservers=void 0})))}}]),e}();function Bb(){}function Ub(e){return e&&e._delegate?e._delegate:e}var jb=function(){function e(t,n,r){(0,V.Z)(this,e),this.name=t,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return(0,H.Z)(e,[{key:"setInstantiationMode",value:function(e){return this.instantiationMode=e,this}},{key:"setMultipleInstances",value:function(e){return this.multipleInstances=e,this}},{key:"setServiceProps",value:function(e){return this.serviceProps=e,this}},{key:"setInstanceCreatedCallback",value:function(e){return this.onInstanceCreated=e,this}}]),e}(),Zb="[DEFAULT]",Wb=function(){function e(t,n){(0,V.Z)(this,e),this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return(0,H.Z)(e,[{key:"get",value:function(e){var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new Eb;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch(Fn){}}return this.instancesDeferred.get(t).promise}},{key:"getImmediate",value:function(e){var t,n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(Fn){if(r)return null;throw Fn}}},{key:"getComponent",value:function(){return this.component}},{key:"setComponent",value:function(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:Zb})}catch(Fn){}var t,n=(0,ot.Z)(this.instancesDeferred.entries());try{for(n.s();!(t=n.n()).done;){var r=(0,o.Z)(t.value,2),i=r[0],a=r[1],s=this.normalizeInstanceIdentifier(i);try{var u=this.getOrInitializeService({instanceIdentifier:s});a.resolve(u)}catch(Fn){}}}catch(c){n.e(c)}finally{n.f()}}}},{key:"clearInstance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Zb;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}},{key:"delete",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Array.from(this.instances.values()),e.next=3,Promise.all([].concat((0,Xe.Z)(t.filter((function(e){return"INTERNAL"in e})).map((function(e){return e.INTERNAL.delete()}))),(0,Xe.Z)(t.filter((function(e){return"_delete"in e})).map((function(e){return e._delete()})))));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"isComponentSet",value:function(){return null!=this.component}},{key:"isInitialized",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Zb;return this.instances.has(e)}},{key:"getOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Zb;return this.instancesOptions.get(e)||{}}},{key:"initialize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.options,n=void 0===t?{}:t,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error("".concat(this.name,"(").concat(r,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));var i,a=this.getOrInitializeService({instanceIdentifier:r,options:n}),s=(0,ot.Z)(this.instancesDeferred.entries());try{for(s.s();!(i=s.n()).done;){var u=(0,o.Z)(i.value,2),c=u[0],l=u[1];r===this.normalizeInstanceIdentifier(c)&&l.resolve(a)}}catch(f){s.e(f)}finally{s.f()}return a}},{key:"onInit",value:function(e,t){var n,r=this.normalizeInstanceIdentifier(t),o=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;o.add(e),this.onInitCallbacks.set(r,o);var i=this.instances.get(r);return i&&e(i,r),function(){o.delete(e)}}},{key:"invokeOnInitCallbacks",value:function(e,t){var n=this.onInitCallbacks.get(t);if(n){var r,o=(0,ot.Z)(n);try{for(o.s();!(r=o.n()).done;){var i=r.value;try{i(e,t)}catch(wu){}}}catch(a){o.e(a)}finally{o.f()}}}},{key:"getOrInitializeService",value:function(e){var t,n=e.instanceIdentifier,r=e.options,o=void 0===r?{}:r,i=this.instances.get(n);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:(t=n,t===Zb?void 0:t),options:o}),this.instances.set(n,i),this.instancesOptions.set(n,o),this.invokeOnInitCallbacks(i,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,i)}catch(wu){}return i||null}},{key:"normalizeInstanceIdentifier",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Zb;return this.component?this.component.multipleInstances?e:Zb:e}},{key:"shouldAutoInitialize",value:function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}]),e}();var zb,Vb,Hb=function(){function e(t){(0,V.Z)(this,e),this.name=t,this.providers=new Map}return(0,H.Z)(e,[{key:"addComponent",value:function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}},{key:"addOrOverwriteComponent",value:function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}},{key:"getProvider",value:function(e){if(this.providers.has(e))return this.providers.get(e);var t=new Wb(e,this);return this.providers.set(e,t),t}},{key:"getProviders",value:function(){return Array.from(this.providers.values())}}]),e}(),qb=[];!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(Vb||(Vb={}));var Gb={debug:Vb.DEBUG,verbose:Vb.VERBOSE,info:Vb.INFO,warn:Vb.WARN,error:Vb.ERROR,silent:Vb.SILENT},Kb=Vb.INFO,Xb=(On(zb={},Vb.DEBUG,"log"),On(zb,Vb.VERBOSE,"log"),On(zb,Vb.INFO,"info"),On(zb,Vb.WARN,"warn"),On(zb,Vb.ERROR,"error"),zb),$b=function(e,t){if(!(t<e.logLevel)){var n=(new Date).toISOString(),r=Xb[t];if(!r)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var o,i=arguments.length,a=new Array(i>2?i-2:0),s=2;s<i;s++)a[s-2]=arguments[s];(o=console)[r].apply(o,["[".concat(n,"]  ").concat(e.name,":")].concat(a))}},Yb=function(){function e(t){(0,V.Z)(this,e),this.name=t,this._logLevel=Kb,this._logHandler=$b,this._userLogHandler=null,qb.push(this)}return(0,H.Z)(e,[{key:"logLevel",get:function(){return this._logLevel},set:function(e){if(!(e in Vb))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}},{key:"setLogLevel",value:function(e){this._logLevel="string"===typeof e?Gb[e]:e}},{key:"logHandler",get:function(){return this._logHandler},set:function(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}},{key:"userLogHandler",get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e}},{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,Vb.DEBUG].concat(t)),this._logHandler.apply(this,[this,Vb.DEBUG].concat(t))}},{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,Vb.VERBOSE].concat(t)),this._logHandler.apply(this,[this,Vb.VERBOSE].concat(t))}},{key:"info",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,Vb.INFO].concat(t)),this._logHandler.apply(this,[this,Vb.INFO].concat(t))}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,Vb.WARN].concat(t)),this._logHandler.apply(this,[this,Vb.WARN].concat(t))}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,Vb.ERROR].concat(t)),this._logHandler.apply(this,[this,Vb.ERROR].concat(t))}}]),e}();var Qb,Jb,ew=function(e,t){return t.some((function(t){return e instanceof t}))};var tw=new WeakMap,nw=new WeakMap,rw=new WeakMap,ow=new WeakMap,iw=new WeakMap;var aw={get:function(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return nw.get(e);if("objectStoreNames"===t)return e.objectStoreNames||rw.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return cw(e[t])},set:function(e,t,n){return e[t]=n,!0},has:function(e,t){return e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e}};function sw(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(Jb||(Jb=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(lw(this),n),cw(tw.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return cw(e.apply(lw(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];var i=e.call.apply(e,[lw(this),t].concat(r));return rw.set(i,t.sort?t.sort():[t]),cw(i)}}function uw(e){return"function"===typeof e?sw(e):(e instanceof IDBTransaction&&function(e){if(!nw.has(e)){var t=new Promise((function(t,n){var r=function(){e.removeEventListener("complete",o),e.removeEventListener("error",i),e.removeEventListener("abort",i)},o=function(){t(),r()},i=function(){n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",o),e.addEventListener("error",i),e.addEventListener("abort",i)}));nw.set(e,t)}}(e),ew(e,Qb||(Qb=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,aw):e)}function cw(e){if(e instanceof IDBRequest)return function(e){var t=new Promise((function(t,n){var r=function(){e.removeEventListener("success",o),e.removeEventListener("error",i)},o=function(){t(cw(e.result)),r()},i=function(){n(e.error),r()};e.addEventListener("success",o),e.addEventListener("error",i)}));return t.then((function(t){t instanceof IDBCursor&&tw.set(t,e)})).catch((function(){})),iw.set(t,e),t}(e);if(ow.has(e))return ow.get(e);var t=uw(e);return t!==e&&(ow.set(e,t),iw.set(t,e)),t}var lw=function(e){return iw.get(e)};var fw,hw,dw=["get","getKey","getAll","getAllKeys","count"],pw=["put","add","delete","clear"],vw=new Map;function mw(e,t){if(e instanceof IDBDatabase&&!(t in e)&&"string"===typeof t){if(vw.get(t))return vw.get(t);var n=t.replace(/FromIndex$/,""),r=t!==n,o=pw.includes(n);if(n in(r?IDBIndex:IDBObjectStore).prototype&&(o||dw.includes(n))){var i=function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var i,a,u,c,l,f,h=arguments;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a=this.transaction(t,o?"readwrite":"readonly"),u=a.store,c=h.length,l=new Array(c>1?c-1:0),f=1;f<c;f++)l[f-1]=h[f];return r&&(u=u.index(l.shift())),e.next=6,Promise.all([(i=u)[n].apply(i,l),o&&a.done]);case 6:return e.abrupt("return",e.sent[0]);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}();return vw.set(t,i),i}}}aw=function(e){return Pn(Pn({},e),{},{get:function(t,n,r){return mw(t,n)||e.get(t,n,r)},has:function(t,n){return!!mw(t,n)||e.has(t,n)}})}(aw);var gw=function(){function e(t){(0,V.Z)(this,e),this.container=t}return(0,H.Z)(e,[{key:"getPlatformInfoString",value:function(){return this.container.getProviders().map((function(e){if(function(e){var t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){var t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null})).filter((function(e){return e})).join(" ")}}]),e}();var yw="@firebase/app",bw="0.9.18",ww=new Yb("@firebase/app"),xw="[DEFAULT]",kw=(On(fw={},yw,"fire-core"),On(fw,"@firebase/app-compat","fire-core-compat"),On(fw,"@firebase/analytics","fire-analytics"),On(fw,"@firebase/analytics-compat","fire-analytics-compat"),On(fw,"@firebase/app-check","fire-app-check"),On(fw,"@firebase/app-check-compat","fire-app-check-compat"),On(fw,"@firebase/auth","fire-auth"),On(fw,"@firebase/auth-compat","fire-auth-compat"),On(fw,"@firebase/database","fire-rtdb"),On(fw,"@firebase/database-compat","fire-rtdb-compat"),On(fw,"@firebase/functions","fire-fn"),On(fw,"@firebase/functions-compat","fire-fn-compat"),On(fw,"@firebase/installations","fire-iid"),On(fw,"@firebase/installations-compat","fire-iid-compat"),On(fw,"@firebase/messaging","fire-fcm"),On(fw,"@firebase/messaging-compat","fire-fcm-compat"),On(fw,"@firebase/performance","fire-perf"),On(fw,"@firebase/performance-compat","fire-perf-compat"),On(fw,"@firebase/remote-config","fire-rc"),On(fw,"@firebase/remote-config-compat","fire-rc-compat"),On(fw,"@firebase/storage","fire-gcs"),On(fw,"@firebase/storage-compat","fire-gcs-compat"),On(fw,"@firebase/firestore","fire-fst"),On(fw,"@firebase/firestore-compat","fire-fst-compat"),On(fw,"fire-js","fire-js"),On(fw,"firebase","fire-js-all"),fw),_w=new Map,Ew=new Map;function Cw(e,t){try{e.container.addComponent(t)}catch(Fn){ww.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),Fn)}}function Sw(e){var t=e.name;if(Ew.has(t))return ww.debug("There were multiple attempts to register component ".concat(t,".")),!1;Ew.set(t,e);var n,r=(0,ot.Z)(_w.values());try{for(r.s();!(n=r.n()).done;){Cw(n.value,e)}}catch(o){r.e(o)}finally{r.f()}return!0}function Iw(e,t){var n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}var Rw=(On(hw={},"no-app","No Firebase App '{$appName}' has been created - call initializeApp() first"),On(hw,"bad-app-name","Illegal App name: '{$appName}"),On(hw,"duplicate-app","Firebase App named '{$appName}' already exists with different options or config"),On(hw,"app-deleted","Firebase App named '{$appName}' already deleted"),On(hw,"no-options","Need to provide options, when not being deployed to hosting via source."),On(hw,"invalid-app-argument","firebase.{$appName}() takes either no argument or a Firebase App instance."),On(hw,"invalid-log-argument","First argument to `onLog` must be null or a function."),On(hw,"idb-open","Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}."),On(hw,"idb-get","Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}."),On(hw,"idb-set","Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}."),On(hw,"idb-delete","Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."),hw),Tw=new Tb("app","Firebase",Rw),Aw=function(){function e(t,n,r){var o=this;(0,V.Z)(this,e),this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new jb("app",(function(){return o}),"PUBLIC"))}return(0,H.Z)(e,[{key:"automaticDataCollectionEnabled",get:function(){return this.checkDestroyed(),this._automaticDataCollectionEnabled},set:function(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}},{key:"name",get:function(){return this.checkDestroyed(),this._name}},{key:"options",get:function(){return this.checkDestroyed(),this._options}},{key:"config",get:function(){return this.checkDestroyed(),this._config}},{key:"container",get:function(){return this._container}},{key:"isDeleted",get:function(){return this._isDeleted},set:function(e){this._isDeleted=e}},{key:"checkDestroyed",value:function(){if(this.isDeleted)throw Tw.create("app-deleted",{appName:this._name})}}]),e}(),Nw="10.3.1";function Ow(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;"object"!==typeof t&&(t={name:t});var r=Object.assign({name:xw,automaticDataCollectionEnabled:!1},t),o=r.name;if("string"!==typeof o||!o)throw Tw.create("bad-app-name",{appName:String(o)});if(n||(n=kb()),!n)throw Tw.create("no-options");var i=_w.get(o);if(i){if(Ob(n,i.options)&&Ob(r,i.config))return i;throw Tw.create("duplicate-app",{appName:o})}var a,s=new Hb(o),u=(0,ot.Z)(Ew.values());try{for(u.s();!(a=u.n()).done;){var c=a.value;s.addComponent(c)}}catch(f){u.e(f)}finally{u.f()}var l=new Aw(n,r,s);return _w.set(o,l),l}function Dw(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xw,t=_w.get(e);if(!t&&e===xw&&kb())return Ow();if(!t)throw Tw.create("no-app",{appName:e});return t}function Pw(e,t,n){var r,o=null!==(r=kw[e])&&void 0!==r?r:e;n&&(o+="-".concat(n));var i=o.match(/\s|\//),a=t.match(/\s|\//);if(i||a){var s=['Unable to register library "'.concat(o,'" with version "').concat(t,'":')];return i&&s.push('library name "'.concat(o,'" contains illegal characters (whitespace or "/")')),i&&a&&s.push("and"),a&&s.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void ww.warn(s.join(" "))}Sw(new jb("".concat(o,"-version"),(function(){return{library:o,version:t}}),"VERSION"))}var Mw="firebase-heartbeat-database",Fw=1,Lw="firebase-heartbeat-store",Bw=null;function Uw(){return Bw||(Bw=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.blocked,o=n.upgrade,i=n.blocking,a=n.terminated,s=indexedDB.open(e,t),u=cw(s);return o&&s.addEventListener("upgradeneeded",(function(e){o(cw(s.result),e.oldVersion,e.newVersion,cw(s.transaction),e)})),r&&s.addEventListener("blocked",(function(e){return r(e.oldVersion,e.newVersion,e)})),u.then((function(e){a&&e.addEventListener("close",(function(){return a()})),i&&e.addEventListener("versionchange",(function(e){return i(e.oldVersion,e.newVersion,e)}))})).catch((function(){})),u}(Mw,Fw,{upgrade:function(e,t){if(0===t)e.createObjectStore(Lw)}}).catch((function(e){throw Tw.create("idb-open",{originalErrorMessage:e.message})}))),Bw}function jw(e){return Zw.apply(this,arguments)}function Zw(){return Zw=(0,u.Z)((0,s.Z)().mark((function e(t){var n,r,o;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Uw();case 3:return n=e.sent,e.next=6,n.transaction(Lw).objectStore(Lw).get(Vw(t));case 6:return r=e.sent,e.abrupt("return",r);case 10:e.prev=10,e.t0=e.catch(0),e.t0 instanceof Rb?ww.warn(e.t0.message):(o=Tw.create("idb-get",{originalErrorMessage:null===e.t0||void 0===e.t0?void 0:e.t0.message}),ww.warn(o.message));case 13:case"end":return e.stop()}}),e,null,[[0,10]])}))),Zw.apply(this,arguments)}function Ww(e,t){return zw.apply(this,arguments)}function zw(){return zw=(0,u.Z)((0,s.Z)().mark((function e(t,n){var r,o,i,a;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Uw();case 3:return r=e.sent,o=r.transaction(Lw,"readwrite"),i=o.objectStore(Lw),e.next=8,i.put(n,Vw(t));case 8:return e.next=10,o.done;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),e.t0 instanceof Rb?ww.warn(e.t0.message):(a=Tw.create("idb-set",{originalErrorMessage:null===e.t0||void 0===e.t0?void 0:e.t0.message}),ww.warn(a.message));case 15:case"end":return e.stop()}}),e,null,[[0,12]])}))),zw.apply(this,arguments)}function Vw(e){return"".concat(e.name,"!").concat(e.options.appId)}var Hw=function(){function e(t){var n=this;(0,V.Z)(this,e),this.container=t,this._heartbeatsCache=null;var r=this.container.getProvider("app").getImmediate();this._storage=new Xw(r),this._heartbeatsCachePromise=this._storage.read().then((function(e){return n._heartbeatsCache=e,e}))}return(0,H.Z)(e,[{key:"triggerHeartbeat",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){var t,n,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.container.getProvider("platform-logger").getImmediate(),n=t.getPlatformInfoString(),r=qw(),null!==this._heartbeatsCache){e.next=7;break}return e.next=6,this._heartbeatsCachePromise;case 6:this._heartbeatsCache=e.sent;case 7:if(this._heartbeatsCache.lastSentHeartbeatDate!==r&&!this._heartbeatsCache.heartbeats.some((function(e){return e.date===r}))){e.next=11;break}return e.abrupt("return");case 11:this._heartbeatsCache.heartbeats.push({date:r,agent:n});case 12:return this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((function(e){var t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),e.abrupt("return",this._storage.overwrite(this._heartbeatsCache));case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getHeartbeatsHeader",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){var t,n,r,o,i;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==this._heartbeatsCache){e.next=3;break}return e.next=3,this._heartbeatsCachePromise;case 3:if(null!==this._heartbeatsCache&&0!==this._heartbeatsCache.heartbeats.length){e.next=5;break}return e.abrupt("return","");case 5:if(t=qw(),n=Gw(this._heartbeatsCache.heartbeats),r=n.heartbeatsToSend,o=n.unsentEntries,i=gb(JSON.stringify({version:2,heartbeats:r})),this._heartbeatsCache.lastSentHeartbeatDate=t,!(o.length>0)){e.next=15;break}return this._heartbeatsCache.heartbeats=o,e.next=13,this._storage.overwrite(this._heartbeatsCache);case 13:e.next=17;break;case 15:this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache);case 17:return e.abrupt("return",i);case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();function qw(){return(new Date).toISOString().substring(0,10)}function Gw(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024,r=[],o=e.slice(),i=(0,ot.Z)(e);try{var a=function(){var e=t.value,i=r.find((function(t){return t.agent===e.agent}));if(i){if(i.dates.push(e.date),$w(r)>n)return i.dates.pop(),0}else if(r.push({agent:e.agent,dates:[e.date]}),$w(r)>n)return r.pop(),0;o=o.slice(1)};for(i.s();!(t=i.n()).done&&0!==a(););}catch(s){i.e(s)}finally{i.f()}return{heartbeatsToSend:r,unsentEntries:o}}var Kw,Xw=function(){function e(t){(0,V.Z)(this,e),this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}return(0,H.Z)(e,[{key:"runIndexedDBEnvironmentCheck",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Ib()){e.next=4;break}return e.abrupt("return",!1);case 4:return e.abrupt("return",new Promise((function(e,t){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(r);o.onsuccess=function(){o.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},o.onupgradeneeded=function(){n=!1},o.onerror=function(){var e;t((null===(e=o.error)||void 0===e?void 0:e.message)||"")}}catch(i){t(i)}})).then((function(){return!0})).catch((function(){return!1})));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"read",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._canUseIndexedDBPromise;case 2:if(e.sent){e.next=7;break}return e.abrupt("return",{heartbeats:[]});case 7:return e.next=9,jw(this.app);case 9:return t=e.sent,e.abrupt("return",t||{heartbeats:[]});case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"overwrite",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var n,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._canUseIndexedDBPromise;case 2:if(e.sent){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,this.read();case 9:return r=e.sent,e.abrupt("return",Ww(this.app,{lastSentHeartbeatDate:null!==(n=t.lastSentHeartbeatDate)&&void 0!==n?n:r.lastSentHeartbeatDate,heartbeats:t.heartbeats}));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"add",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var n,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._canUseIndexedDBPromise;case 2:if(e.sent){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,this.read();case 9:return r=e.sent,e.abrupt("return",Ww(this.app,{lastSentHeartbeatDate:null!==(n=t.lastSentHeartbeatDate)&&void 0!==n?n:r.lastSentHeartbeatDate,heartbeats:[].concat((0,Xe.Z)(r.heartbeats),(0,Xe.Z)(t.heartbeats))}));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function $w(e){return gb(JSON.stringify({version:2,heartbeats:e})).length}Kw="",Sw(new jb("platform-logger",(function(e){return new gw(e)}),"PRIVATE")),Sw(new jb("heartbeat",(function(e){return new Hw(e)}),"PRIVATE")),Pw(yw,bw,Kw),Pw(yw,bw,"esm2017"),Pw("fire-js","");Pw("firebase","10.3.1","app");var Yw,Qw="firebasestorage.googleapis.com",Jw="storageBucket",ex=function(e){(0,$e.Z)(n,e);var t=(0,Ye.Z)(n);function n(e,r){var o,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return(0,V.Z)(this,n),(o=t.call(this,tx(e),"Firebase Storage: ".concat(r," (").concat(tx(e),")"))).status_=i,o.customData={serverResponse:null},o._baseMessage=o.message,Object.setPrototypeOf((0,db.Z)(o),n.prototype),o}return(0,H.Z)(n,[{key:"status",get:function(){return this.status_},set:function(e){this.status_=e}},{key:"_codeEquals",value:function(e){return tx(e)===this.code}},{key:"serverResponse",get:function(){return this.customData.serverResponse},set:function(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message="".concat(this._baseMessage,"\n").concat(this.customData.serverResponse):this.message=this._baseMessage}}]),n}(Rb);function tx(e){return"storage/"+e}function nx(){return new ex(Yw.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function rx(){return new ex(Yw.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function ox(){return new ex(Yw.CANCELED,"User canceled the upload/download.")}function ix(){return new ex(Yw.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function ax(e){return new ex(Yw.INVALID_ARGUMENT,e)}function sx(){return new ex(Yw.APP_DELETED,"The Firebase app was deleted.")}function ux(e,t){return new ex(Yw.INVALID_FORMAT,"String does not match format '"+e+"': "+t)}function cx(e){throw new ex(Yw.INTERNAL_ERROR,"Internal error: "+e)}!function(e){e.UNKNOWN="unknown",e.OBJECT_NOT_FOUND="object-not-found",e.BUCKET_NOT_FOUND="bucket-not-found",e.PROJECT_NOT_FOUND="project-not-found",e.QUOTA_EXCEEDED="quota-exceeded",e.UNAUTHENTICATED="unauthenticated",e.UNAUTHORIZED="unauthorized",e.UNAUTHORIZED_APP="unauthorized-app",e.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",e.INVALID_CHECKSUM="invalid-checksum",e.CANCELED="canceled",e.INVALID_EVENT_NAME="invalid-event-name",e.INVALID_URL="invalid-url",e.INVALID_DEFAULT_BUCKET="invalid-default-bucket",e.NO_DEFAULT_BUCKET="no-default-bucket",e.CANNOT_SLICE_BLOB="cannot-slice-blob",e.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",e.NO_DOWNLOAD_URL="no-download-url",e.INVALID_ARGUMENT="invalid-argument",e.INVALID_ARGUMENT_COUNT="invalid-argument-count",e.APP_DELETED="app-deleted",e.INVALID_ROOT_OPERATION="invalid-root-operation",e.INVALID_FORMAT="invalid-format",e.INTERNAL_ERROR="internal-error",e.UNSUPPORTED_ENVIRONMENT="unsupported-environment"}(Yw||(Yw={}));var lx,fx=function(){function e(t,n){(0,V.Z)(this,e),this.bucket=t,this.path_=n}return(0,H.Z)(e,[{key:"path",get:function(){return this.path_}},{key:"isRoot",get:function(){return 0===this.path.length}},{key:"fullServerUrl",value:function(){var e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}},{key:"bucketOnlyServerUrl",value:function(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}}],[{key:"makeFromBucketSpec",value:function(t,n){var r,o;try{r=e.makeFromUrl(t,n)}catch(Fn){return new e(t,"")}if(""===r.path)return r;throw o=t,new ex(Yw.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+o+"'.")}},{key:"makeFromUrl",value:function(t,n){var r=null,o="([A-Za-z0-9.\\-_]+)";var i=new RegExp("^gs://"+o+"(/(.*))?$","i");function a(e){e.path_=decodeURIComponent(e.path)}for(var s=n.replace(/[.]/g,"\\."),u=[{regex:i,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp("^https?://".concat(s,"/").concat("v[A-Za-z0-9_]+","/b/").concat(o,"/o").concat("(/([^?#]*).*)?$"),"i"),indices:{bucket:1,path:3},postModify:a},{regex:new RegExp("^https?://".concat(n===Qw?"(?:storage.googleapis.com|storage.cloud.google.com)":n,"/").concat(o,"/").concat("([^?#]*)"),"i"),indices:{bucket:1,path:2},postModify:a}],c=0;c<u.length;c++){var l=u[c],f=l.regex.exec(t);if(f){var h=f[l.indices.bucket],d=f[l.indices.path];d||(d=""),r=new e(h,d),l.postModify(r);break}}if(null==r)throw function(e){return new ex(Yw.INVALID_URL,"Invalid URL '"+e+"'.")}(t);return r}}]),e}(),hx=function(){function e(t){(0,V.Z)(this,e),this.promise_=Promise.reject(t)}return(0,H.Z)(e,[{key:"getPromise",value:function(){return this.promise_}},{key:"cancel",value:function(){}}]),e}();function dx(e){return"string"===typeof e||e instanceof String}function px(e){return vx()&&e instanceof Blob}function vx(){return"undefined"!==typeof Blob&&!Sb()}function mx(e,t,n,r){if(r<t)throw ax("Invalid value for '".concat(e,"'. Expected ").concat(t," or greater."));if(r>n)throw ax("Invalid value for '".concat(e,"'. Expected ").concat(n," or less."))}function gx(e,t,n){var r=t;return null==n&&(r="https://".concat(t)),"".concat(n,"://").concat(r,"/v0").concat(e)}function yx(e){var t=encodeURIComponent,n="?";for(var r in e){if(e.hasOwnProperty(r))n=n+(t(r)+"="+t(e[r]))+"&"}return n=n.slice(0,-1)}function bx(e,t){var n=e>=500&&e<600,r=-1!==[408,429].indexOf(e),o=-1!==t.indexOf(e);return n||r||o}!function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"}(lx||(lx={}));var wx=function(){function e(t,n,r,o,i,a,s,u,c,l,f){var h=this,d=!(arguments.length>11&&void 0!==arguments[11])||arguments[11];(0,V.Z)(this,e),this.url_=t,this.method_=n,this.headers_=r,this.body_=o,this.successCodes_=i,this.additionalRetryCodes_=a,this.callback_=s,this.errorCallback_=u,this.timeout_=c,this.progressCallback_=l,this.connectionFactory_=f,this.retry=d,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((function(e,t){h.resolve_=e,h.reject_=t,h.start_()}))}return(0,H.Z)(e,[{key:"start_",value:function(){var e=this,t=function(t,n){var r=e.resolve_,o=e.reject_,i=n.connection;if(n.wasSuccessCode)try{var a=e.callback_(i,i.getResponse());!function(e){return void 0!==e}(a)?r():r(a)}catch(Fn){o(Fn)}else if(null!==i){var s=nx();s.serverResponse=i.getErrorText(),e.errorCallback_?o(e.errorCallback_(i,s)):o(s)}else{if(n.canceled)o(e.appDelete_?sx():ox());else o(rx())}};this.canceled_?t(0,new xx(!1,null,!0)):this.backoffId_=function(e,t,n){var r=1,o=null,i=null,a=!1,s=0;function u(){return 2===s}var c=!1;function l(){if(!c){c=!0;for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];t.apply(null,n)}}function f(t){o=setTimeout((function(){o=null,e(d,u())}),t)}function h(){i&&clearTimeout(i)}function d(e){if(c)h();else{for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];if(e)return h(),void l.call.apply(l,[null,e].concat(n));var i;if(u()||a)return h(),void l.call.apply(l,[null,e].concat(n));r<64&&(r*=2),1===s?(s=2,i=0):i=1e3*(r+Math.random()),f(i)}}var p=!1;function v(e){p||(p=!0,h(),c||(null!==o?(e||(s=2),clearTimeout(o),f(0)):e||(s=1)))}return f(0),i=setTimeout((function(){a=!0,v(!0)}),n),v}((function(t,n){if(n)t(!1,new xx(!1,null,!0));else{var r=e.connectionFactory_();e.pendingConnection_=r;var o=function(t){var n=t.loaded,r=t.lengthComputable?t.total:-1;null!==e.progressCallback_&&e.progressCallback_(n,r)};null!==e.progressCallback_&&r.addUploadProgressListener(o),r.send(e.url_,e.method_,e.body_,e.headers_).then((function(){null!==e.progressCallback_&&r.removeUploadProgressListener(o),e.pendingConnection_=null;var n=r.getErrorCode()===lx.NO_ERROR,i=r.getStatus();if(!n||bx(i,e.additionalRetryCodes_)&&e.retry){var a=r.getErrorCode()===lx.ABORT;t(!1,new xx(!1,null,a))}else{var s=-1!==e.successCodes_.indexOf(i);t(!0,new xx(s,r))}}))}}),t,this.timeout_)}},{key:"getPromise",value:function(){return this.promise_}},{key:"cancel",value:function(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&function(e){e(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}]),e}(),xx=(0,H.Z)((function e(t,n,r){(0,V.Z)(this,e),this.wasSuccessCode=t,this.connection=n,this.canceled=!!r}));function kx(){return"undefined"!==typeof BlobBuilder?BlobBuilder:"undefined"!==typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function _x(){for(var e=kx(),t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];if(void 0!==e){for(var o=new e,i=0;i<n.length;i++)o.append(n[i]);return o.getBlob()}if(vx())return new Blob(n);throw new ex(Yw.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}function Ex(e){if("undefined"===typeof atob)throw t="base-64",new ex(Yw.UNSUPPORTED_ENVIRONMENT,"".concat(t," is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information."));var t;return atob(e)}var Cx={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},Sx=(0,H.Z)((function e(t,n){(0,V.Z)(this,e),this.data=t,this.contentType=n||null}));function Ix(e,t){switch(e){case Cx.RAW:return new Sx(Rx(t));case Cx.BASE64:case Cx.BASE64URL:return new Sx(Tx(e,t));case Cx.DATA_URL:return new Sx(function(e){var t=new Ax(e);return t.base64?Tx(Cx.BASE64,t.rest):function(e){var t;try{t=decodeURIComponent(e)}catch(Fn){throw ux(Cx.DATA_URL,"Malformed data URL.")}return Rx(t)}(t.rest)}(t),new Ax(t).contentType)}throw nx()}function Rx(e){for(var t=[],n=0;n<e.length;n++){var r=e.charCodeAt(n);if(r<=127)t.push(r);else if(r<=2047)t.push(192|r>>6,128|63&r);else if(55296===(64512&r))if(n<e.length-1&&56320===(64512&e.charCodeAt(n+1)))r=65536|(1023&r)<<10|1023&e.charCodeAt(++n),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r);else t.push(239,191,189);else 56320===(64512&r)?t.push(239,191,189):t.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(t)}function Tx(e,t){switch(e){case Cx.BASE64:var n=-1!==t.indexOf("-"),r=-1!==t.indexOf("_");if(n||r)throw ux(e,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?");break;case Cx.BASE64URL:var o=-1!==t.indexOf("+"),i=-1!==t.indexOf("/");if(o||i)throw ux(e,"Invalid character '"+(o?"+":"/")+"' found: is it base64 encoded?");t=t.replace(/-/g,"+").replace(/_/g,"/")}var a;try{a=Ex(t)}catch(Fn){if(Fn.message.includes("polyfill"))throw Fn;throw ux(e,"Invalid character found")}for(var s=new Uint8Array(a.length),u=0;u<a.length;u++)s[u]=a.charCodeAt(u);return s}var Ax=(0,H.Z)((function e(t){(0,V.Z)(this,e),this.base64=!1,this.contentType=null;var n=t.match(/^data:([^,]+)?,/);if(null===n)throw ux(Cx.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");var r=n[1]||null;null!=r&&(this.base64=function(e,t){var n=e.length>=t.length;if(!n)return!1;return e.substring(e.length-t.length)===t}(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=t.substring(t.indexOf(",")+1)}));var Nx=function(){function e(t,n){(0,V.Z)(this,e);var r=0,o="";px(t)?(this.data_=t,r=t.size,o=t.type):t instanceof ArrayBuffer?(n?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),r=this.data_.length):t instanceof Uint8Array&&(n?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),r=t.length),this.size_=r,this.type_=o}return(0,H.Z)(e,[{key:"size",value:function(){return this.size_}},{key:"type",value:function(){return this.type_}},{key:"slice",value:function(t,n){if(px(this.data_)){var r=function(e,t,n){return e.webkitSlice?e.webkitSlice(t,n):e.mozSlice?e.mozSlice(t,n):e.slice?e.slice(t,n):null}(this.data_,t,n);return null===r?null:new e(r)}var o=new Uint8Array(this.data_.buffer,t,n-t);return new e(o,!0)}},{key:"uploadData",value:function(){return this.data_}}],[{key:"getBlob",value:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];if(vx()){var o=n.map((function(t){return t instanceof e?t.data_:t}));return new e(_x.apply(null,o))}var i=n.map((function(e){return dx(e)?Ix(Cx.RAW,e).data:e.data_})),a=0;i.forEach((function(e){a+=e.byteLength}));var s=new Uint8Array(a),u=0;return i.forEach((function(e){for(var t=0;t<e.length;t++)s[u++]=e[t]})),new e(s,!0)}}]),e}();function Ox(e){var t;try{t=JSON.parse(e)}catch(Fn){return null}return function(e){return"object"===typeof e&&!Array.isArray(e)}(t)?t:null}function Dx(e){var t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}function Px(e,t){return t}var Mx=(0,H.Z)((function e(t,n,r,o){(0,V.Z)(this,e),this.server=t,this.local=n||t,this.writable=!!r,this.xform=o||Px})),Fx=null;function Lx(){if(Fx)return Fx;var e=[];e.push(new Mx("bucket")),e.push(new Mx("generation")),e.push(new Mx("metageneration")),e.push(new Mx("name","fullPath",!0));var t=new Mx("name");t.xform=function(e,t){return function(e){return!dx(e)||e.length<2?e:Dx(e)}(t)},e.push(t);var n=new Mx("size");return n.xform=function(e,t){return void 0!==t?Number(t):t},e.push(n),e.push(new Mx("timeCreated")),e.push(new Mx("updated")),e.push(new Mx("md5Hash",null,!0)),e.push(new Mx("cacheControl",null,!0)),e.push(new Mx("contentDisposition",null,!0)),e.push(new Mx("contentEncoding",null,!0)),e.push(new Mx("contentLanguage",null,!0)),e.push(new Mx("contentType",null,!0)),e.push(new Mx("metadata","customMetadata",!0)),Fx=e}function Bx(e,t,n){for(var r={type:"file"},o=n.length,i=0;i<o;i++){var a=n[i];r[a.local]=a.xform(r,t[a.server])}return function(e,t){Object.defineProperty(e,"ref",{get:function(){var n=e.bucket,r=e.fullPath,o=new fx(n,r);return t._makeStorageReference(o)}})}(r,e),r}function Ux(e,t,n){var r=Ox(t);return null===r?null:Bx(e,r,n)}function jx(e,t){for(var n={},r=t.length,o=0;o<r;o++){var i=t[o];i.writable&&(n[i.server]=e[i.local])}return JSON.stringify(n)}var Zx=(0,H.Z)((function e(t,n,r,o){(0,V.Z)(this,e),this.url=t,this.method=n,this.handler=r,this.timeout=o,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}));function Wx(e){if(!e)throw nx()}function zx(e,t){return function(n,r){var o=Ux(e,r,t);return Wx(null!==o),o}}function Vx(e,t){return function(n,r){var o=Ux(e,r,t);return Wx(null!==o),function(e,t,n,r){var o=Ox(t);if(null===o)return null;if(!dx(o.downloadTokens))return null;var i=o.downloadTokens;if(0===i.length)return null;var a=encodeURIComponent;return i.split(",").map((function(t){var o=e.bucket,i=e.fullPath;return gx("/b/"+a(o)+"/o/"+a(i),n,r)+yx({alt:"media",token:t})}))[0]}(o,r,e.host,e._protocol)}}function Hx(e){return function(t,n){var r,o,i;return 401===t.getStatus()?r=t.getErrorText().includes("Firebase App Check token is invalid")?new ex(Yw.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project."):new ex(Yw.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again."):402===t.getStatus()?(i=e.bucket,r=new ex(Yw.QUOTA_EXCEEDED,"Quota for bucket '"+i+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===t.getStatus()?(o=e.path,r=new ex(Yw.UNAUTHORIZED,"User does not have permission to access '"+o+"'.")):r=n,r.status=t.getStatus(),r.serverResponse=n.serverResponse,r}}function qx(e){var t=Hx(e);return function(n,r){var o,i=t(n,r);return 404===n.getStatus()&&(o=e.path,i=new ex(Yw.OBJECT_NOT_FOUND,"Object '"+o+"' does not exist.")),i.serverResponse=r.serverResponse,i}}function Gx(e,t,n){var r=Object.assign({},n);return r.fullPath=e.path,r.size=t.size(),r.contentType||(r.contentType=function(e,t){return e&&e.contentType||t&&t.type()||"application/octet-stream"}(null,t)),r}function Kx(e,t,n,r,o){var i=t.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"};var s=function(){for(var e="",t=0;t<2;t++)e+=Math.random().toString().slice(2);return e}();a["Content-Type"]="multipart/related; boundary="+s;var u=Gx(t,r,o),c="--"+s+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+jx(u,n)+"\r\n--"+s+"\r\nContent-Type: "+u.contentType+"\r\n\r\n",l="\r\n--"+s+"--",f=Nx.getBlob(c,r,l);if(null===f)throw ix();var h={name:u.fullPath},d=gx(i,e.host,e._protocol),p=e.maxUploadRetryTime,v=new Zx(d,"POST",zx(e,n),p);return v.urlParams=h,v.headers=a,v.body=f.uploadData(),v.errorHandler=Hx(t),v}var Xx=null,$x=function(){function e(){var t=this;(0,V.Z)(this,e),this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=lx.NO_ERROR,this.sendPromise_=new Promise((function(e){t.xhr_.addEventListener("abort",(function(){t.errorCode_=lx.ABORT,e()})),t.xhr_.addEventListener("error",(function(){t.errorCode_=lx.NETWORK_ERROR,e()})),t.xhr_.addEventListener("load",(function(){e()}))}))}return(0,H.Z)(e,[{key:"send",value:function(e,t,n,r){if(this.sent_)throw cx("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==r)for(var o in r)r.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,r[o].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_}},{key:"getErrorCode",value:function(){if(!this.sent_)throw cx("cannot .getErrorCode() before sending");return this.errorCode_}},{key:"getStatus",value:function(){if(!this.sent_)throw cx("cannot .getStatus() before sending");try{return this.xhr_.status}catch(Fn){return-1}}},{key:"getResponse",value:function(){if(!this.sent_)throw cx("cannot .getResponse() before sending");return this.xhr_.response}},{key:"getErrorText",value:function(){if(!this.sent_)throw cx("cannot .getErrorText() before sending");return this.xhr_.statusText}},{key:"abort",value:function(){this.xhr_.abort()}},{key:"getResponseHeader",value:function(e){return this.xhr_.getResponseHeader(e)}},{key:"addUploadProgressListener",value:function(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}},{key:"removeUploadProgressListener",value:function(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}]),e}(),Yx=function(e){(0,$e.Z)(n,e);var t=(0,Ye.Z)(n);function n(){return(0,V.Z)(this,n),t.apply(this,arguments)}return(0,H.Z)(n,[{key:"initXhr",value:function(){this.xhr_.responseType="text"}}]),n}($x);function Qx(){return Xx?Xx():new Yx}var Jx=function(){function e(t,n){(0,V.Z)(this,e),this._service=t,this._location=n instanceof fx?n:fx.makeFromUrl(n,t.host)}return(0,H.Z)(e,[{key:"toString",value:function(){return"gs://"+this._location.bucket+"/"+this._location.path}},{key:"_newRef",value:function(t,n){return new e(t,n)}},{key:"root",get:function(){var e=new fx(this._location.bucket,"");return this._newRef(this._service,e)}},{key:"bucket",get:function(){return this._location.bucket}},{key:"fullPath",get:function(){return this._location.path}},{key:"name",get:function(){return Dx(this._location.path)}},{key:"storage",get:function(){return this._service}},{key:"parent",get:function(){var t=function(e){if(0===e.length)return null;var t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}(this._location.path);if(null===t)return null;var n=new fx(this._location.bucket,t);return new e(this._service,n)}},{key:"_throwIfRoot",value:function(e){if(""===this._location.path)throw function(e){return new ex(Yw.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(e)}}]),e}();function ek(e,t,n){e._throwIfRoot("uploadBytes");var r=Kx(e.storage,e._location,Lx(),new Nx(t,!0),n);return e.storage.makeRequestWithTokens(r,Qx).then((function(t){return{metadata:t,ref:e}}))}function tk(e){e._throwIfRoot("getDownloadURL");var t=function(e,t,n){var r=gx(t.fullServerUrl(),e.host,e._protocol),o=e.maxOperationRetryTime,i=new Zx(r,"GET",Vx(e,n),o);return i.errorHandler=qx(t),i}(e.storage,e._location,Lx());return e.storage.makeRequestWithTokens(t,Qx).then((function(e){if(null===e)throw new ex(Yw.NO_DOWNLOAD_URL,"The given file does not have any download URLs.");return e}))}function nk(e,t){var n=function(e,t){var n=t.split("/").filter((function(e){return e.length>0})).join("/");return 0===e.length?n:e+"/"+n}(e._location.path,t),r=new fx(e._location.bucket,n);return new Jx(e.storage,r)}function rk(e,t){if(e instanceof sk){var n=e;if(null==n._bucket)throw new ex(Yw.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Jw+"' property when initializing the app?");var r=new Jx(n,n._bucket);return null!=t?rk(r,t):r}return void 0!==t?nk(e,t):e}function ok(e,t){if(t&&/^[A-Za-z]+:\/\//.test(t)){if(e instanceof sk)return new Jx(e,t);throw ax("To use ref(service, url), the first argument must be a Storage instance.")}return rk(e,t)}function ik(e,t){var n=null===t||void 0===t?void 0:t[Jw];return null==n?null:fx.makeFromBucketSpec(n,e)}function ak(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e.host="".concat(t,":").concat(n),e._protocol="http";var o=r.mockUserToken;o&&(e._overrideAuthToken="string"===typeof o?o:function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=t||"demo-project",r=e.iat||0,o=e.sub||e.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var i=Object.assign({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:r,exp:r+3600,auth_time:r,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},e);return[gb(JSON.stringify({alg:"none",type:"JWT"})),gb(JSON.stringify(i)),""].join(".")}(o,e.app.options.projectId))}var sk=function(){function e(t,n,r,o,i){(0,V.Z)(this,e),this.app=t,this._authProvider=n,this._appCheckProvider=r,this._url=o,this._firebaseVersion=i,this._bucket=null,this._host=Qw,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=o?fx.makeFromBucketSpec(o,this._host):ik(this._host,this.app.options)}return(0,H.Z)(e,[{key:"host",get:function(){return this._host},set:function(e){this._host=e,null!=this._url?this._bucket=fx.makeFromBucketSpec(this._url,e):this._bucket=ik(e,this.app.options)}},{key:"maxUploadRetryTime",get:function(){return this._maxUploadRetryTime},set:function(e){mx("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}},{key:"maxOperationRetryTime",get:function(){return this._maxOperationRetryTime},set:function(e){mx("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}},{key:"_getAuthToken",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){var t,n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._overrideAuthToken){e.next=2;break}return e.abrupt("return",this._overrideAuthToken);case 2:if(!(t=this._authProvider.getImmediate({optional:!0}))){e.next=9;break}return e.next=6,t.getToken();case 6:if(null===(n=e.sent)){e.next=9;break}return e.abrupt("return",n.accessToken);case 9:return e.abrupt("return",null);case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_getAppCheckToken",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){var t,n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this._appCheckProvider.getImmediate({optional:!0}))){e.next=6;break}return e.next=4,t.getToken();case 4:return n=e.sent,e.abrupt("return",n.token);case 6:return e.abrupt("return",null);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_delete",value:function(){return this._deleted||(this._deleted=!0,this._requests.forEach((function(e){return e.cancel()})),this._requests.clear()),Promise.resolve()}},{key:"_makeStorageReference",value:function(e){return new Jx(this,e)}},{key:"_makeRequest",value:function(e,t,n,r){var o=this,i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(this._deleted)return new hx(sx());var a=function(e,t,n,r,o,i){var a=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],s=yx(e.urlParams),u=e.url+s,c=Object.assign({},e.headers);return function(e,t){t&&(e["X-Firebase-GMPID"]=t)}(c,t),function(e,t){null!==t&&t.length>0&&(e.Authorization="Firebase "+t)}(c,n),function(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(null!==t&&void 0!==t?t:"AppManager")}(c,i),function(e,t){null!==t&&(e["X-Firebase-AppCheck"]=t)}(c,r),new wx(u,e.method,c,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,o,a)}(e,this._appId,n,r,t,this._firebaseVersion,i);return this._requests.add(a),a.getPromise().then((function(){return o._requests.delete(a)}),(function(){return o._requests.delete(a)})),a}},{key:"makeRequestWithTokens",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t,n){var r,i,a,u;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this._getAuthToken(),this._getAppCheckToken()]);case 2:return r=e.sent,i=(0,o.Z)(r,2),a=i[0],u=i[1],e.abrupt("return",this._makeRequest(t,n,a,u).getPromise());case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}(),uk="@firebase/storage",ck="0.11.2",lk="storage";function fk(e,t,n,r){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Cx.RAW,r=arguments.length>3?arguments[3]:void 0;e._throwIfRoot("uploadString");var o=Ix(n,t),i=Object.assign({},r);return null==i.contentType&&null!=o.contentType&&(i.contentType=o.contentType),ek(e,o.data,i)}(e=Ub(e),t,n,r)}function hk(e){return tk(e=Ub(e))}function dk(e,t,n){ak(e,t,n,arguments.length>3&&void 0!==arguments[3]?arguments[3]:{})}function pk(e,t){var n=t.instanceIdentifier,r=e.getProvider("app").getImmediate(),o=e.getProvider("auth-internal"),i=e.getProvider("app-check-internal");return new sk(r,o,i,n,Nw)}Sw(new jb(lk,pk,"PUBLIC").setMultipleInstances(!0)),Pw(uk,ck,""),Pw(uk,ck,"esm2017");var vk=n(1752),mk=n(1120);function gk(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}Object.create;Object.create;"function"===typeof SuppressedError&&SuppressedError;var yk;function bk(e){return void 0!==e&&void 0!==e.enterprise}var wk=(0,H.Z)((function e(t){if((0,V.Z)(this,e),this.siteKey="",this.emailPasswordEnabled=!1,void 0===t.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=t.recaptchaKey.split("/")[3],this.emailPasswordEnabled=t.recaptchaEnforcementState.some((function(e){return"EMAIL_PASSWORD_PROVIDER"===e.provider&&"OFF"!==e.enforcementState}))}));function xk(){return On({},"dependent-sdk-initialized-before-auth","Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.")}var kk=xk,_k=new Tb("auth","Firebase",xk()),Ek=new Yb("@firebase/auth");function Ck(e){if(Ek.logLevel<=Vb.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];Ek.warn.apply(Ek,["Auth (".concat(Nw,"): ").concat(e)].concat(n))}}function Sk(e){if(Ek.logLevel<=Vb.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];Ek.error.apply(Ek,["Auth (".concat(Nw,"): ").concat(e)].concat(n))}}function Ik(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw Ak.apply(void 0,[e].concat(n))}function Rk(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Ak.apply(void 0,[e].concat(n))}function Tk(e,t,n){var r=Object.assign(Object.assign({},kk()),On({},t,n));return new Tb("auth","Firebase",r).create(t,{appName:e.name})}function Ak(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!==typeof e){var o,i=n[0],a=(0,Xe.Z)(n.slice(1));return a[0]&&(a[0].appName=e.name),(o=e._errorFactory).create.apply(o,[i].concat((0,Xe.Z)(a)))}return _k.create.apply(_k,[e].concat(n))}function Nk(e,t){if(!e){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];throw Ak.apply(void 0,[t].concat(r))}}function Ok(e){var t="INTERNAL ASSERTION FAILED: "+e;throw Sk(t),new Error(t)}function Dk(e,t){e||Ok(t)}function Pk(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function Mk(){return"http:"===Fk()||"https:"===Fk()}function Fk(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}function Lk(){return!("undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(Mk()||function(){var e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}()||"connection"in navigator))||navigator.onLine}var Bk=function(){function e(t,n){(0,V.Z)(this,e),this.shortDelay=t,this.longDelay=n,Dk(n>t,"Short delay should be less than long delay!"),this.isMobile="undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Cb())||"object"===typeof navigator&&"ReactNative"===navigator.product}return(0,H.Z)(e,[{key:"get",value:function(){return Lk()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}]),e}();function Uk(e,t){Dk(e.emulator,"Emulator should always be set here");var n=e.emulator.url;return t?"".concat(n).concat(t.startsWith("/")?t.slice(1):t):n}var jk=function(){function e(){(0,V.Z)(this,e)}return(0,H.Z)(e,null,[{key:"initialize",value:function(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}},{key:"fetch",value:function(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:void Ok("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}},{key:"headers",value:function(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:void Ok("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}},{key:"response",value:function(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:void Ok("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}]),e}(),Zk=(On(yk={},"CREDENTIAL_MISMATCH","custom-token-mismatch"),On(yk,"MISSING_CUSTOM_TOKEN","internal-error"),On(yk,"INVALID_IDENTIFIER","invalid-email"),On(yk,"MISSING_CONTINUE_URI","internal-error"),On(yk,"INVALID_PASSWORD","wrong-password"),On(yk,"MISSING_PASSWORD","missing-password"),On(yk,"EMAIL_EXISTS","email-already-in-use"),On(yk,"PASSWORD_LOGIN_DISABLED","operation-not-allowed"),On(yk,"INVALID_IDP_RESPONSE","invalid-credential"),On(yk,"INVALID_PENDING_TOKEN","invalid-credential"),On(yk,"FEDERATED_USER_ID_ALREADY_LINKED","credential-already-in-use"),On(yk,"MISSING_REQ_TYPE","internal-error"),On(yk,"EMAIL_NOT_FOUND","user-not-found"),On(yk,"RESET_PASSWORD_EXCEED_LIMIT","too-many-requests"),On(yk,"EXPIRED_OOB_CODE","expired-action-code"),On(yk,"INVALID_OOB_CODE","invalid-action-code"),On(yk,"MISSING_OOB_CODE","internal-error"),On(yk,"CREDENTIAL_TOO_OLD_LOGIN_AGAIN","requires-recent-login"),On(yk,"INVALID_ID_TOKEN","invalid-user-token"),On(yk,"TOKEN_EXPIRED","user-token-expired"),On(yk,"USER_NOT_FOUND","user-token-expired"),On(yk,"TOO_MANY_ATTEMPTS_TRY_LATER","too-many-requests"),On(yk,"PASSWORD_DOES_NOT_MEET_REQUIREMENTS","password-does-not-meet-requirements"),On(yk,"INVALID_CODE","invalid-verification-code"),On(yk,"INVALID_SESSION_INFO","invalid-verification-id"),On(yk,"INVALID_TEMPORARY_PROOF","invalid-credential"),On(yk,"MISSING_SESSION_INFO","missing-verification-id"),On(yk,"SESSION_EXPIRED","code-expired"),On(yk,"MISSING_ANDROID_PACKAGE_NAME","missing-android-pkg-name"),On(yk,"UNAUTHORIZED_DOMAIN","unauthorized-continue-uri"),On(yk,"INVALID_OAUTH_CLIENT_ID","invalid-oauth-client-id"),On(yk,"ADMIN_ONLY_OPERATION","admin-restricted-operation"),On(yk,"INVALID_MFA_PENDING_CREDENTIAL","invalid-multi-factor-session"),On(yk,"MFA_ENROLLMENT_NOT_FOUND","multi-factor-info-not-found"),On(yk,"MISSING_MFA_ENROLLMENT_ID","missing-multi-factor-info"),On(yk,"MISSING_MFA_PENDING_CREDENTIAL","missing-multi-factor-session"),On(yk,"SECOND_FACTOR_EXISTS","second-factor-already-in-use"),On(yk,"SECOND_FACTOR_LIMIT_EXCEEDED","maximum-second-factor-count-exceeded"),On(yk,"BLOCKING_FUNCTION_ERROR_RESPONSE","internal-error"),On(yk,"RECAPTCHA_NOT_ENABLED","recaptcha-not-enabled"),On(yk,"MISSING_RECAPTCHA_TOKEN","missing-recaptcha-token"),On(yk,"INVALID_RECAPTCHA_TOKEN","invalid-recaptcha-token"),On(yk,"INVALID_RECAPTCHA_ACTION","invalid-recaptcha-action"),On(yk,"MISSING_CLIENT_TYPE","missing-client-type"),On(yk,"MISSING_RECAPTCHA_VERSION","missing-recaptcha-version"),On(yk,"INVALID_RECAPTCHA_VERSION","invalid-recaptcha-version"),On(yk,"INVALID_REQ_TYPE","invalid-req-type"),yk),Wk=new Bk(3e4,6e4);function zk(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}function Vk(e,t,n,r){return Hk.apply(this,arguments)}function Hk(){return Hk=(0,u.Z)((0,s.Z)().mark((function e(t,n,r,o){var i,a=arguments;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=a.length>4&&void 0!==a[4]?a[4]:{},e.abrupt("return",qk(t,i,(0,u.Z)((0,s.Z)().mark((function e(){var i,a,u,c;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={},a={},o&&("GET"===n?a=o:i={body:JSON.stringify(o)}),u=Pb(Object.assign({key:t.config.apiKey},a)).slice(1),e.next=6,t._getAdditionalHeaders();case 6:return(c=e.sent)["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode),e.abrupt("return",jk.fetch()($k(t,t.config.apiHost,r,u),Object.assign({method:n,headers:c,referrerPolicy:"no-referrer"},i)));case 10:case"end":return e.stop()}}),e)})))));case 2:case"end":return e.stop()}}),e)}))),Hk.apply(this,arguments)}function qk(e,t,n){return Gk.apply(this,arguments)}function Gk(){return Gk=(0,u.Z)((0,s.Z)().mark((function e(t,n,r){var i,a,u,c,l,f,h,d,p,v;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t._canInitEmulator=!1,i=Object.assign(Object.assign({},Zk),n),e.prev=2,a=new Yk(t),e.next=6,Promise.race([r(),a.promise]);case 6:return u=e.sent,a.clearNetworkTimeout(),e.next=10,u.json();case 10:if(!("needConfirmation"in(c=e.sent))){e.next=13;break}throw Qk(t,"account-exists-with-different-credential",c);case 13:if(!u.ok||"errorMessage"in c){e.next=17;break}return e.abrupt("return",c);case 17:if(l=u.ok?c.errorMessage:c.error.message,f=l.split(" : "),h=(0,o.Z)(f,2),d=h[0],p=h[1],"FEDERATED_USER_ID_ALREADY_LINKED"!==d){e.next=23;break}throw Qk(t,"credential-already-in-use",c);case 23:if("EMAIL_EXISTS"!==d){e.next=27;break}throw Qk(t,"email-already-in-use",c);case 27:if("USER_DISABLED"!==d){e.next=29;break}throw Qk(t,"user-disabled",c);case 29:if(v=i[d]||d.toLowerCase().replace(/[_\s]+/g,"-"),!p){e.next=34;break}throw Tk(t,v,p);case 34:Ik(t,v);case 35:e.next=42;break;case 37:if(e.prev=37,e.t0=e.catch(2),!(e.t0 instanceof Rb)){e.next=41;break}throw e.t0;case 41:Ik(t,"network-request-failed",{message:String(e.t0)});case 42:case"end":return e.stop()}}),e,null,[[2,37]])}))),Gk.apply(this,arguments)}function Kk(e,t,n,r){return Xk.apply(this,arguments)}function Xk(){return Xk=(0,u.Z)((0,s.Z)().mark((function e(t,n,r,o){var i,a,u=arguments;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=u.length>4&&void 0!==u[4]?u[4]:{},e.next=3,Vk(t,n,r,o,i);case 3:return"mfaPendingCredential"in(a=e.sent)&&Ik(t,"multi-factor-auth-required",{_serverResponse:a}),e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)}))),Xk.apply(this,arguments)}function $k(e,t,n,r){var o="".concat(t).concat(n,"?").concat(r);return e.config.emulator?Uk(e.config,o):"".concat(e.config.apiScheme,"://").concat(o)}var Yk=function(){function e(t){var n=this;(0,V.Z)(this,e),this.auth=t,this.timer=null,this.promise=new Promise((function(e,t){n.timer=setTimeout((function(){return t(Rk(n.auth,"network-request-failed"))}),Wk.get())}))}return(0,H.Z)(e,[{key:"clearNetworkTimeout",value:function(){clearTimeout(this.timer)}}]),e}();function Qk(e,t,n){var r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);var o=Rk(e,t,r);return o.customData._tokenResponse=n,o}function Jk(e,t){return e_.apply(this,arguments)}function e_(){return e_=(0,u.Z)((0,s.Z)().mark((function e(t,n){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Vk(t,"GET","/v2/recaptchaConfig",zk(t,n)));case 1:case"end":return e.stop()}}),e)}))),e_.apply(this,arguments)}function t_(e,t){return n_.apply(this,arguments)}function n_(){return n_=(0,u.Z)((0,s.Z)().mark((function e(t,n){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Vk(t,"POST","/v1/accounts:delete",n));case 1:case"end":return e.stop()}}),e)}))),n_.apply(this,arguments)}function r_(e,t){return o_.apply(this,arguments)}function o_(){return o_=(0,u.Z)((0,s.Z)().mark((function e(t,n){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Vk(t,"POST","/v1/accounts:lookup",n));case 1:case"end":return e.stop()}}),e)}))),o_.apply(this,arguments)}function i_(e){if(e)try{var t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(Fn){}}function a_(){return a_=(0,u.Z)((0,s.Z)().mark((function e(t){var n,r,o,i,a,u,c=arguments;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=c.length>1&&void 0!==c[1]&&c[1],r=Ub(t),e.next=4,r.getIdToken(n);case 4:return o=e.sent,Nk((i=u_(o))&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error"),a="object"===typeof i.firebase?i.firebase:void 0,u=null===a||void 0===a?void 0:a.sign_in_provider,e.abrupt("return",{claims:i,token:o,authTime:i_(s_(i.auth_time)),issuedAtTime:i_(s_(i.iat)),expirationTime:i_(s_(i.exp)),signInProvider:u||null,signInSecondFactor:(null===a||void 0===a?void 0:a.sign_in_second_factor)||null});case 10:case"end":return e.stop()}}),e)}))),a_.apply(this,arguments)}function s_(e){return 1e3*Number(e)}function u_(e){var t=e.split("."),n=(0,o.Z)(t,3),r=n[0],i=n[1],a=n[2];if(void 0===r||void 0===i||void 0===a)return Sk("JWT malformed, contained fewer than 3 sections"),null;try{var s=yb(i);return s?JSON.parse(s):(Sk("Failed to decode base64 JWT payload"),null)}catch(Fn){return Sk("Caught error parsing JWT payload as JSON",null===Fn||void 0===Fn?void 0:Fn.toString()),null}}function c_(e,t){return l_.apply(this,arguments)}function l_(){return l_=(0,u.Z)((0,s.Z)().mark((function e(t,n){var r=arguments;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r.length>2&&void 0!==r[2]&&r[2])){e.next=3;break}return e.abrupt("return",n);case 3:return e.prev=3,e.next=6,n;case 6:return e.abrupt("return",e.sent);case 9:if(e.prev=9,e.t0=e.catch(3),!(e.t0 instanceof Rb&&f_(e.t0))){e.next=15;break}if(t.auth.currentUser!==t){e.next=15;break}return e.next=15,t.auth.signOut();case 15:throw e.t0;case 16:case"end":return e.stop()}}),e,null,[[3,9]])}))),l_.apply(this,arguments)}function f_(e){var t=e.code;return t==="auth/".concat("user-disabled")||t==="auth/".concat("user-token-expired")}var h_=function(){function e(t){(0,V.Z)(this,e),this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}return(0,H.Z)(e,[{key:"_start",value:function(){this.isRunning||(this.isRunning=!0,this.schedule())}},{key:"_stop",value:function(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}},{key:"getInterval",value:function(e){var t;if(e){var n=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),n}this.errorBackoff=3e4;var r=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,r)}},{key:"schedule",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isRunning){var n=this.getInterval(t);this.timerId=setTimeout((0,u.Z)((0,s.Z)().mark((function t(){return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.iteration();case 2:case"end":return t.stop()}}),t)}))),n)}}},{key:"iteration",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.user.getIdToken(!0);case 3:e.next=9;break;case 5:return e.prev=5,e.t0=e.catch(0),(null===e.t0||void 0===e.t0?void 0:e.t0.code)==="auth/".concat("network-request-failed")&&this.schedule(!0),e.abrupt("return");case 9:this.schedule();case 10:case"end":return e.stop()}}),e,this,[[0,5]])})));return function(){return e.apply(this,arguments)}}()}]),e}(),d_=function(){function e(t,n){(0,V.Z)(this,e),this.createdAt=t,this.lastLoginAt=n,this._initializeTime()}return(0,H.Z)(e,[{key:"_initializeTime",value:function(){this.lastSignInTime=i_(this.lastLoginAt),this.creationTime=i_(this.createdAt)}},{key:"_copy",value:function(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}},{key:"toJSON",value:function(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}]),e}();function p_(e){return v_.apply(this,arguments)}function v_(){return v_=(0,u.Z)((0,s.Z)().mark((function e(t){var n,r,o,i,a,u,c,l,f,h,d;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.auth,e.next=3,t.getIdToken();case 3:return o=e.sent,e.next=6,c_(t,r_(r,{idToken:o}));case 6:Nk(null===(i=e.sent)||void 0===i?void 0:i.users.length,r,"internal-error"),a=i.users[0],t._notifyReloadListener(a),u=(null===(n=a.providerUserInfo)||void 0===n?void 0:n.length)?a.providerUserInfo.map((function(e){var t=e.providerId,n=gk(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})):[],c=g_(t.providerData,u),l=t.isAnonymous,f=!(t.email&&a.passwordHash)&&!(null===c||void 0===c?void 0:c.length),h=!!l&&f,d={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:c,metadata:new d_(a.createdAt,a.lastLoginAt),isAnonymous:h},Object.assign(t,d);case 17:case"end":return e.stop()}}),e)}))),v_.apply(this,arguments)}function m_(){return(m_=(0,u.Z)((0,s.Z)().mark((function e(t){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Ub(t),e.next=3,p_(n);case 3:return e.next=5,n.auth._persistUserIfCurrent(n);case 5:n.auth._notifyListenersIfCurrent(n);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g_(e,t){var n=e.filter((function(e){return!t.some((function(t){return t.providerId===e.providerId}))}));return[].concat((0,Xe.Z)(n),(0,Xe.Z)(t))}function y_(e,t){return b_.apply(this,arguments)}function b_(){return b_=(0,u.Z)((0,s.Z)().mark((function e(t,n){var r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,qk(t,{},(0,u.Z)((0,s.Z)().mark((function e(){var r,o,i,a,u,c;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Pb({grant_type:"refresh_token",refresh_token:n}).slice(1),o=t.config,i=o.tokenApiHost,a=o.apiKey,u=$k(t,i,"/v1/token","key=".concat(a)),e.next=5,t._getAdditionalHeaders();case 5:return(c=e.sent)["Content-Type"]="application/x-www-form-urlencoded",e.abrupt("return",jk.fetch()(u,{method:"POST",headers:c,body:r}));case 8:case"end":return e.stop()}}),e)}))));case 2:return r=e.sent,e.abrupt("return",{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token});case 4:case"end":return e.stop()}}),e)}))),b_.apply(this,arguments)}var w_=function(){function e(){(0,V.Z)(this,e),this.refreshToken=null,this.accessToken=null,this.expirationTime=null}return(0,H.Z)(e,[{key:"isExpired",get:function(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}},{key:"updateFromServerResponse",value:function(e){Nk(e.idToken,"internal-error"),Nk("undefined"!==typeof e.idToken,"internal-error"),Nk("undefined"!==typeof e.refreshToken,"internal-error");var t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):function(e){var t=u_(e);return Nk(t,"internal-error"),Nk("undefined"!==typeof t.exp,"internal-error"),Nk("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}},{key:"getToken",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var n,r=arguments;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.length>1&&void 0!==r[1]&&r[1],Nk(!this.accessToken||this.refreshToken,t,"user-token-expired"),n||!this.accessToken||this.isExpired){e.next=4;break}return e.abrupt("return",this.accessToken);case 4:if(!this.refreshToken){e.next=8;break}return e.next=7,this.refresh(t,this.refreshToken);case 7:return e.abrupt("return",this.accessToken);case 8:return e.abrupt("return",null);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"clearRefreshToken",value:function(){this.refreshToken=null}},{key:"refresh",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t,n){var r,o,i,a;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y_(t,n);case 2:r=e.sent,o=r.accessToken,i=r.refreshToken,a=r.expiresIn,this.updateTokensAndExpiration(o,i,Number(a));case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"updateTokensAndExpiration",value:function(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}},{key:"toJSON",value:function(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}},{key:"_assign",value:function(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}},{key:"_clone",value:function(){return Object.assign(new e,this.toJSON())}},{key:"_performRefresh",value:function(){return Ok("not implemented")}}],[{key:"fromJSON",value:function(t,n){var r=n.refreshToken,o=n.accessToken,i=n.expirationTime,a=new e;return r&&(Nk("string"===typeof r,"internal-error",{appName:t}),a.refreshToken=r),o&&(Nk("string"===typeof o,"internal-error",{appName:t}),a.accessToken=o),i&&(Nk("number"===typeof i,"internal-error",{appName:t}),a.expirationTime=i),a}}]),e}();function x_(e,t){Nk("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}var k_=function(){function e(t){(0,V.Z)(this,e);var n=t.uid,r=t.auth,o=t.stsTokenManager,i=gk(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new h_(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=o,this.accessToken=o.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?(0,Xe.Z)(i.providerData):[],this.metadata=new d_(i.createdAt||void 0,i.lastLoginAt||void 0)}return(0,H.Z)(e,[{key:"getIdToken",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c_(this,this.stsTokenManager.getToken(this.auth,t));case 2:if(Nk(n=e.sent,this.auth,"internal-error"),this.accessToken===n){e.next=9;break}return this.accessToken=n,e.next=8,this.auth._persistUserIfCurrent(this);case 8:this.auth._notifyListenersIfCurrent(this);case 9:return e.abrupt("return",n);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getIdTokenResult",value:function(e){return function(e){return a_.apply(this,arguments)}(this,e)}},{key:"reload",value:function(){return function(e){return m_.apply(this,arguments)}(this)}},{key:"_assign",value:function(e){this!==e&&(Nk(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((function(e){return Object.assign({},e)})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}},{key:"_clone",value:function(t){var n=new e(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}},{key:"_onReload",value:function(e){Nk(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}},{key:"_notifyReloadListener",value:function(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}},{key:"_startProactiveRefresh",value:function(){this.proactiveRefresh._start()}},{key:"_stopProactiveRefresh",value:function(){this.proactiveRefresh._stop()}},{key:"_updateTokensIfNecessary",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var n,r,o=arguments;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=o.length>1&&void 0!==o[1]&&o[1],r=!1,t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),r=!0),!n){e.next=6;break}return e.next=6,p_(this);case 6:return e.next=8,this.auth._persistUserIfCurrent(this);case 8:r&&this.auth._notifyListenersIfCurrent(this);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getIdToken();case 2:return t=e.sent,e.next=5,c_(this,t_(this.auth,{idToken:t}));case 5:return this.stsTokenManager.clearRefreshToken(),e.abrupt("return",this.auth.signOut());case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toJSON",value:function(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((function(e){return Object.assign({},e)})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}},{key:"refreshToken",get:function(){return this.stsTokenManager.refreshToken||""}}],[{key:"_fromJSON",value:function(t,n){var r,o,i,a,s,u,c,l,f=null!==(r=n.displayName)&&void 0!==r?r:void 0,h=null!==(o=n.email)&&void 0!==o?o:void 0,d=null!==(i=n.phoneNumber)&&void 0!==i?i:void 0,p=null!==(a=n.photoURL)&&void 0!==a?a:void 0,v=null!==(s=n.tenantId)&&void 0!==s?s:void 0,m=null!==(u=n._redirectEventId)&&void 0!==u?u:void 0,g=null!==(c=n.createdAt)&&void 0!==c?c:void 0,y=null!==(l=n.lastLoginAt)&&void 0!==l?l:void 0,b=n.uid,w=n.emailVerified,x=n.isAnonymous,k=n.providerData,_=n.stsTokenManager;Nk(b&&_,t,"internal-error");var E=w_.fromJSON(this.name,_);Nk("string"===typeof b,t,"internal-error"),x_(f,t.name),x_(h,t.name),Nk("boolean"===typeof w,t,"internal-error"),Nk("boolean"===typeof x,t,"internal-error"),x_(d,t.name),x_(p,t.name),x_(v,t.name),x_(m,t.name),x_(g,t.name),x_(y,t.name);var C=new e({uid:b,auth:t,email:h,emailVerified:w,displayName:f,isAnonymous:x,photoURL:p,phoneNumber:d,tenantId:v,stsTokenManager:E,createdAt:g,lastLoginAt:y});return k&&Array.isArray(k)&&(C.providerData=k.map((function(e){return Object.assign({},e)}))),m&&(C._redirectEventId=m),C}},{key:"_fromIdTokenResponse",value:function(){var t=(0,u.Z)((0,s.Z)().mark((function t(n,r){var o,i,a,u=arguments;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=u.length>2&&void 0!==u[2]&&u[2],(i=new w_).updateFromServerResponse(r),a=new e({uid:r.localId,auth:n,stsTokenManager:i,isAnonymous:o}),t.next=6,p_(a);case 6:return t.abrupt("return",a);case 7:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}]),e}(),__=new Map;function E_(e){Dk(e instanceof Function,"Expected a class definition");var t=__.get(e);return t?(Dk(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,__.set(e,t),t)}var C_=function(){function e(){(0,V.Z)(this,e),this.type="NONE",this.storage={}}return(0,H.Z)(e,[{key:"_isAvailable",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"_set",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t,n){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.storage[t]=n;case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_get",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.storage[t],e.abrupt("return",void 0===n?null:n);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_remove",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:delete this.storage[t];case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_addListener",value:function(e,t){}},{key:"_removeListener",value:function(e,t){}}]),e}();C_.type="NONE";var S_=C_;function I_(e,t,n){return"firebase".concat(":",e,":").concat(t,":").concat(n)}var R_=function(){function e(t,n,r){(0,V.Z)(this,e),this.persistence=t,this.auth=n,this.userKey=r;var o=this.auth,i=o.config,a=o.name;this.fullUserKey=I_(this.userKey,i.apiKey,a),this.fullPersistenceKey=I_("persistence",i.apiKey,a),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}return(0,H.Z)(e,[{key:"setCurrentUser",value:function(e){return this.persistence._set(this.fullUserKey,e.toJSON())}},{key:"getCurrentUser",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.persistence._get(this.fullUserKey);case 2:return t=e.sent,e.abrupt("return",t?k_._fromJSON(this.auth,t):null);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"removeCurrentUser",value:function(){return this.persistence._remove(this.fullUserKey)}},{key:"savePersistenceForRedirect",value:function(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}},{key:"setPersistence",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.persistence!==t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.getCurrentUser();case 4:return n=e.sent,e.next=7,this.removeCurrentUser();case 7:if(this.persistence=t,!n){e.next=10;break}return e.abrupt("return",this.setCurrentUser(n));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"delete",value:function(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}}],[{key:"create",value:function(){var t=(0,u.Z)((0,s.Z)().mark((function t(n,r){var o,i,a,c,l,f,h,d,p,v,m,g=arguments;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=g.length>2&&void 0!==g[2]?g[2]:"authUser",r.length){t.next=3;break}return t.abrupt("return",new e(E_(S_),n,o));case 3:return t.next=5,Promise.all(r.map(function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._isAvailable();case 2:if(!e.sent){e.next=4;break}return e.abrupt("return",t);case 4:return e.abrupt("return",void 0);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 5:i=t.sent.filter((function(e){return e})),a=i[0]||E_(S_),c=I_(o,n.config.apiKey,n.name),l=null,f=(0,ot.Z)(r),t.prev=10,f.s();case 12:if((h=f.n()).done){t.next=29;break}return d=h.value,t.prev=14,t.next=17,d._get(c);case 17:if(!(p=t.sent)){t.next=23;break}return v=k_._fromJSON(n,p),d!==a&&(l=v),a=d,t.abrupt("break",29);case 23:t.next=27;break;case 25:t.prev=25,t.t0=t.catch(14);case 27:t.next=12;break;case 29:t.next=34;break;case 31:t.prev=31,t.t1=t.catch(10),f.e(t.t1);case 34:return t.prev=34,f.f(),t.finish(34);case 37:if(m=i.filter((function(e){return e._shouldAllowMigration})),a._shouldAllowMigration&&m.length){t.next=40;break}return t.abrupt("return",new e(a,n,o));case 40:if(a=m[0],!l){t.next=44;break}return t.next=44,a._set(c,l.toJSON());case 44:return t.next=46,Promise.all(r.map(function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t===a){e.next=8;break}return e.prev=1,e.next=4,t._remove(c);case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}()));case 46:return t.abrupt("return",new e(a,n,o));case 47:case"end":return t.stop()}}),t,null,[[10,31,34,37],[14,25]])})));return function(e,n){return t.apply(this,arguments)}}()}]),e}();function T_(e){var t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(D_(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(A_(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(M_(t))return"Blackberry";if(F_(t))return"Webos";if(N_(t))return"Safari";if((t.includes("chrome/")||O_(t))&&!t.includes("edge/"))return"Chrome";if(P_(t))return"Android";var n=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);return 2===(null===n||void 0===n?void 0:n.length)?n[1]:"Other"}function A_(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Cb();return/firefox\//i.test(e)}function N_(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Cb()).toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function O_(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Cb();return/crios\//i.test(e)}function D_(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Cb();return/iemobile/i.test(e)}function P_(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Cb();return/android/i.test(e)}function M_(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Cb();return/blackberry/i.test(e)}function F_(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Cb();return/webos/i.test(e)}function L_(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Cb();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function B_(){return function(){var e=Cb();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()&&10===document.documentMode}function U_(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Cb();return L_(e)||P_(e)||F_(e)||M_(e)||/windows phone/i.test(e)||D_(e)}function j_(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=T_(Cb());break;case"Worker":t="".concat(T_(Cb()),"-").concat(e);break;default:t=e}var r=n.length?n.join(","):"FirebaseCore-web";return"".concat(t,"/","JsCore","/").concat(Nw,"/").concat(r)}var Z_=function(){function e(t){(0,V.Z)(this,e),this.auth=t,this.queue=[]}return(0,H.Z)(e,[{key:"pushCallback",value:function(e,t){var n=this,r=function(t){return new Promise((function(n,r){try{n(e(t))}catch(Fn){r(Fn)}}))};r.onAbort=t,this.queue.push(r);var o=this.queue.length-1;return function(){n.queue[o]=function(){return Promise.resolve()}}}},{key:"runMiddleware",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var n,r,o,i,a,u,c;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.auth.currentUser!==t){e.next=2;break}return e.abrupt("return");case 2:n=[],e.prev=3,r=(0,ot.Z)(this.queue),e.prev=5,r.s();case 7:if((o=r.n()).done){e.next=14;break}return i=o.value,e.next=11,i(t);case 11:i.onAbort&&n.push(i.onAbort);case 12:e.next=7;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(5),r.e(e.t0);case 19:return e.prev=19,r.f(),e.finish(19);case 22:e.next=30;break;case 24:e.prev=24,e.t1=e.catch(3),n.reverse(),a=(0,ot.Z)(n);try{for(a.s();!(u=a.n()).done;){c=u.value;try{c()}catch(lr){}}}catch(s){a.e(s)}finally{a.f()}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===e.t1||void 0===e.t1?void 0:e.t1.message});case 30:case"end":return e.stop()}}),e,this,[[3,24],[5,16,19,22]])})));return function(t){return e.apply(this,arguments)}}()}]),e}();function W_(e){return z_.apply(this,arguments)}function z_(){return z_=(0,u.Z)((0,s.Z)().mark((function e(t){var n,r=arguments;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:{},e.abrupt("return",Vk(t,"GET","/v2/passwordPolicy",zk(t,n)));case 2:case"end":return e.stop()}}),e)}))),z_.apply(this,arguments)}var V_=function(){function e(t){var n,r,o,i;(0,V.Z)(this,e);var a=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(n=a.minPasswordLength)&&void 0!==n?n:6,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),void 0!==a.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),void 0!==a.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),void 0!==a.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),void 0!==a.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(o=null===(r=t.allowedNonAlphanumericCharacters)||void 0===r?void 0:r.join(""))&&void 0!==o?o:"",this.forceUpgradeOnSignin=null!==(i=t.forceUpgradeOnSignin)&&void 0!==i&&i,this.schemaVersion=t.schemaVersion}return(0,H.Z)(e,[{key:"validatePassword",value:function(e){var t,n,r,o,i,a,s={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,s),this.validatePasswordCharacterOptions(e,s),s.isValid&&(s.isValid=null===(t=s.meetsMinPasswordLength)||void 0===t||t),s.isValid&&(s.isValid=null===(n=s.meetsMaxPasswordLength)||void 0===n||n),s.isValid&&(s.isValid=null===(r=s.containsLowercaseLetter)||void 0===r||r),s.isValid&&(s.isValid=null===(o=s.containsUppercaseLetter)||void 0===o||o),s.isValid&&(s.isValid=null===(i=s.containsNumericCharacter)||void 0===i||i),s.isValid&&(s.isValid=null===(a=s.containsNonAlphanumericCharacter)||void 0===a||a),s}},{key:"validatePasswordLengthOptions",value:function(e,t){var n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}},{key:"validatePasswordCharacterOptions",value:function(e,t){var n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(var r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}},{key:"updatePasswordCharacterOptionsStatuses",value:function(e,t,n,r,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}]),e}(),H_=function(){function e(t,n,r,o){(0,V.Z)(this,e),this.app=t,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=o,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new G_(this),this.idTokenSubscription=new G_(this),this.beforeStateQueue=new Z_(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=_k,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=o.sdkClientVersion}return(0,H.Z)(e,[{key:"_initializeWithPersistence",value:function(e,t){var n=this;return t&&(this._popupRedirectResolver=E_(t)),this._initializationPromise=this.queue((0,u.Z)((0,s.Z)().mark((function r(){var o,i;return(0,s.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!n._deleted){r.next=2;break}return r.abrupt("return");case 2:return r.next=4,R_.create(n,e);case 4:if(n.persistenceManager=r.sent,!n._deleted){r.next=7;break}return r.abrupt("return");case 7:if(!(null===(o=n._popupRedirectResolver)||void 0===o?void 0:o._shouldInitProactively)){r.next=15;break}return r.prev=8,r.next=11,n._popupRedirectResolver._initialize(n);case 11:r.next=15;break;case 13:r.prev=13,r.t0=r.catch(8);case 15:return r.next=17,n.initializeCurrentUser(t);case 17:if(n.lastNotifiedUid=(null===(i=n.currentUser)||void 0===i?void 0:i.uid)||null,!n._deleted){r.next=20;break}return r.abrupt("return");case 20:n._isInitialized=!0;case 21:case"end":return r.stop()}}),r,null,[[8,13]])})))),this._initializationPromise}},{key:"_onStorageEvent",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._deleted){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.assertedPersistence.getCurrentUser();case 4:if(t=e.sent,this.currentUser||t){e.next=7;break}return e.abrupt("return");case 7:if(!this.currentUser||!t||this.currentUser.uid!==t.uid){e.next=12;break}return this._currentUser._assign(t),e.next=11,this.currentUser.getIdToken();case 11:return e.abrupt("return");case 12:return e.next=14,this._updateCurrentUser(t,!0);case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initializeCurrentUser",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var n,r,o,i,a,u,c;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.assertedPersistence.getCurrentUser();case 2:if(r=e.sent,o=r,i=!1,!t||!this.config.authDomain){e.next=14;break}return e.next=8,this.getOrInitRedirectPersistenceManager();case 8:return a=null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId,u=null===o||void 0===o?void 0:o._redirectEventId,e.next=12,this.tryRedirectSignIn(t);case 12:c=e.sent,a&&a!==u||!(null===c||void 0===c?void 0:c.user)||(o=c.user,i=!0);case 14:if(o){e.next=16;break}return e.abrupt("return",this.directlySetCurrentUser(null));case 16:if(o._redirectEventId){e.next=32;break}if(!i){e.next=27;break}return e.prev=18,e.next=21,this.beforeStateQueue.runMiddleware(o);case 21:e.next=27;break;case 23:e.prev=23,e.t0=e.catch(18),o=r,this._popupRedirectResolver._overrideRedirectResult(this,(function(){return Promise.reject(e.t0)}));case 27:if(!o){e.next=31;break}return e.abrupt("return",this.reloadAndSetCurrentUserOrClear(o));case 31:return e.abrupt("return",this.directlySetCurrentUser(null));case 32:return Nk(this._popupRedirectResolver,this,"argument-error"),e.next=35,this.getOrInitRedirectPersistenceManager();case 35:if(!this.redirectUser||this.redirectUser._redirectEventId!==o._redirectEventId){e.next=37;break}return e.abrupt("return",this.directlySetCurrentUser(o));case 37:return e.abrupt("return",this.reloadAndSetCurrentUserOrClear(o));case 38:case"end":return e.stop()}}),e,this,[[18,23]])})));return function(t){return e.apply(this,arguments)}}()},{key:"tryRedirectSignIn",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null,e.prev=1,e.next=4,this._popupRedirectResolver._completeRedirectFn(this,t,!0);case 4:n=e.sent,e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(1),e.next=11,this._setRedirectUser(null);case 11:return e.abrupt("return",n);case 12:case"end":return e.stop()}}),e,this,[[1,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"reloadAndSetCurrentUserOrClear",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p_(t);case 3:e.next=9;break;case 5:if(e.prev=5,e.t0=e.catch(0),(null===e.t0||void 0===e.t0?void 0:e.t0.code)==="auth/".concat("network-request-failed")){e.next=9;break}return e.abrupt("return",this.directlySetCurrentUser(null));case 9:return e.abrupt("return",this.directlySetCurrentUser(t));case 10:case"end":return e.stop()}}),e,this,[[0,5]])})));return function(t){return e.apply(this,arguments)}}()},{key:"useDeviceLanguage",value:function(){this.languageCode=function(){if("undefined"===typeof navigator)return null;var e=navigator;return e.languages&&e.languages[0]||e.language||null}()}},{key:"_delete",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._deleted=!0;case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateCurrentUser",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t?Ub(t):null)&&Nk(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),e.abrupt("return",this._updateCurrentUser(n&&n._clone(this)));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_updateCurrentUser",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var n,r=this,o=arguments;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=o.length>1&&void 0!==o[1]&&o[1],!this._deleted){e.next=3;break}return e.abrupt("return");case 3:if(t&&Nk(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),n){e.next=7;break}return e.next=7,this.beforeStateQueue.runMiddleware(t);case 7:return e.abrupt("return",this.queue((0,u.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.directlySetCurrentUser(t);case 2:r.notifyAuthListeners();case 3:case"end":return e.stop()}}),e)})))));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"signOut",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.beforeStateQueue.runMiddleware(null);case 2:if(!this.redirectPersistenceManager&&!this._popupRedirectResolver){e.next=5;break}return e.next=5,this._setRedirectUser(null);case 5:return e.abrupt("return",this._updateCurrentUser(null,!0));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setPersistence",value:function(e){var t=this;return this.queue((0,u.Z)((0,s.Z)().mark((function n(){return(0,s.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.assertedPersistence.setPersistence(E_(e));case 2:case"end":return n.stop()}}),n)}))))}},{key:"_getRecaptchaConfig",value:function(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}},{key:"validatePassword",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._getPasswordPolicyInternal()){e.next=3;break}return e.next=3,this._updatePasswordPolicy();case 3:if((n=this._getPasswordPolicyInternal()).schemaVersion===this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION){e.next=6;break}return e.abrupt("return",Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})));case 6:return e.abrupt("return",n.validatePassword(t));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_getPasswordPolicyInternal",value:function(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}},{key:"_updatePasswordPolicy",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){var t,n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W_(this);case 2:t=e.sent,n=new V_(t),null===this.tenantId?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n;case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_getPersistence",value:function(){return this.assertedPersistence.persistence.type}},{key:"_updateErrorMap",value:function(e){this._errorFactory=new Tb("auth","Firebase",e())}},{key:"onAuthStateChanged",value:function(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}},{key:"beforeAuthStateChanged",value:function(e,t){return this.beforeStateQueue.pushCallback(e,t)}},{key:"onIdTokenChanged",value:function(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}},{key:"authStateReady",value:function(){var e=this;return new Promise((function(t,n){if(e.currentUser)t();else var r=e.onAuthStateChanged((function(){r(),t()}),n)}))}},{key:"toJSON",value:function(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}},{key:"_setRedirectUser",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t,n){var r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getOrInitRedirectPersistenceManager(n);case 2:return r=e.sent,e.abrupt("return",null===t?r.removeCurrentUser():r.setCurrentUser(t));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getOrInitRedirectPersistenceManager",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.redirectPersistenceManager){e.next=9;break}return Nk(n=t&&E_(t)||this._popupRedirectResolver,this,"argument-error"),e.next=5,R_.create(this,[E_(n._redirectPersistence)],"redirectUser");case 5:return this.redirectPersistenceManager=e.sent,e.next=8,this.redirectPersistenceManager.getCurrentUser();case 8:this.redirectUser=e.sent;case 9:return e.abrupt("return",this.redirectPersistenceManager);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_redirectUserForId",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var n,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._isInitialized){e.next=3;break}return e.next=3,this.queue((0,u.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))));case 3:if((null===(n=this._currentUser)||void 0===n?void 0:n._redirectEventId)!==t){e.next=5;break}return e.abrupt("return",this._currentUser);case 5:if((null===(r=this.redirectUser)||void 0===r?void 0:r._redirectEventId)!==t){e.next=7;break}return e.abrupt("return",this.redirectUser);case 7:return e.abrupt("return",null);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_persistUserIfCurrent",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var n=this;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t!==this.currentUser){e.next=2;break}return e.abrupt("return",this.queue((0,u.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.directlySetCurrentUser(t));case 1:case"end":return e.stop()}}),e)})))));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_notifyListenersIfCurrent",value:function(e){e===this.currentUser&&this.notifyAuthListeners()}},{key:"_key",value:function(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}},{key:"_startProactiveRefresh",value:function(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}},{key:"_stopProactiveRefresh",value:function(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}},{key:"_currentUser",get:function(){return this.currentUser}},{key:"notifyAuthListeners",value:function(){var e,t;if(this._isInitialized){this.idTokenSubscription.next(this.currentUser);var n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}}},{key:"registerStateListener",value:function(e,t,n,r){var o=this;if(this._deleted)return function(){};var i="function"===typeof t?t:t.next.bind(t),a=!1,s=this._isInitialized?Promise.resolve():this._initializationPromise;if(Nk(s,this,"internal-error"),s.then((function(){a||i(o.currentUser)})),"function"===typeof t){var u=e.addObserver(t,n,r);return function(){a=!0,u()}}var c=e.addObserver(t);return function(){a=!0,c()}}},{key:"directlySetCurrentUser",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,!t){e.next=8;break}return e.next=6,this.assertedPersistence.setCurrentUser(t);case 6:e.next=10;break;case 8:return e.next=10,this.assertedPersistence.removeCurrentUser();case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"queue",value:function(e){return this.operations=this.operations.then(e,e),this.operations}},{key:"assertedPersistence",get:function(){return Nk(this.persistenceManager,this,"internal-error"),this.persistenceManager}},{key:"_logFramework",value:function(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=j_(this.config.clientPlatform,this._getFrameworks()))}},{key:"_getFrameworks",value:function(){return this.frameworks}},{key:"_getAdditionalHeaders",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){var t,n,r,o;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=On({},"X-Client-Version",this.clientVersion),this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId),e.next=4,null===(t=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getHeartbeatsHeader();case 4:return(r=e.sent)&&(n["X-Firebase-Client"]=r),e.next=8,this._getAppCheckToken();case 8:return(o=e.sent)&&(n["X-Firebase-AppCheck"]=o),e.abrupt("return",n);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_getAppCheckToken",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){var t,n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(t=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getToken();case 2:return(null===(n=e.sent)||void 0===n?void 0:n.error)&&Ck("Error while retrieving App Check token: ".concat(n.error)),e.abrupt("return",null===n||void 0===n?void 0:n.token);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();function q_(e){return Ub(e)}var G_=function(){function e(t){var n=this;(0,V.Z)(this,e),this.auth=t,this.observer=null,this.addObserver=function(e,t){var n=new Lb(e,t);return n.subscribe.bind(n)}((function(e){return n.observer=e}))}return(0,H.Z)(e,[{key:"next",get:function(){return Nk(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}]),e}();function K_(e){return new Promise((function(t,n){var r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=function(e){var t=Rk("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)}))}function X_(e){return"__".concat(e).concat(Math.floor(1e6*Math.random()))}var $_=function(){function e(t){(0,V.Z)(this,e),this.type="recaptcha-enterprise",this.auth=q_(t)}return(0,H.Z)(e,[{key:"verify",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){var t,n,r,o,i,a=this,c=arguments;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=function(e,n,r){var o=window.grecaptcha;bk(o)?o.enterprise.ready((function(){o.enterprise.execute(e,{action:t}).then((function(e){n(e)})).catch((function(){n("NO_RECAPTCHA")}))})):r(Error("No reCAPTCHA enterprise script loaded."))},o=function(){return o=(0,u.Z)((0,s.Z)().mark((function e(t){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=5;break}if(null!=t.tenantId||null==t._agentRecaptchaConfig){e.next=3;break}return e.abrupt("return",t._agentRecaptchaConfig.siteKey);case 3:if(null==t.tenantId||void 0===t._tenantRecaptchaConfigs[t.tenantId]){e.next=5;break}return e.abrupt("return",t._tenantRecaptchaConfigs[t.tenantId].siteKey);case 5:return e.abrupt("return",new Promise(function(){var e=(0,u.Z)((0,s.Z)().mark((function e(n,r){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Jk(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((function(e){if(void 0!==e.recaptchaKey){var o=new wk(e);return null==t.tenantId?t._agentRecaptchaConfig=o:t._tenantRecaptchaConfigs[t.tenantId]=o,n(o.siteKey)}r(new Error("recaptcha Enterprise site key undefined"))})).catch((function(e){r(e)}));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 6:case"end":return e.stop()}}),e)}))),o.apply(this,arguments)},r=function(e){return o.apply(this,arguments)},t=c.length>0&&void 0!==c[0]?c[0]:"verify",n=c.length>1&&void 0!==c[1]&&c[1],e.abrupt("return",new Promise((function(e,t){r(a.auth).then((function(r){if(!n&&bk(window.grecaptcha))i(r,e,t);else{if("undefined"===typeof window)return void t(new Error("RecaptchaVerifier is only supported in browser"));K_("https://www.google.com/recaptcha/enterprise.js?render="+r).then((function(){i(r,e,t)})).catch((function(e){t(e)}))}})).catch((function(e){t(e)}))})));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}();function Y_(e,t,n){return Q_.apply(this,arguments)}function Q_(){return Q_=(0,u.Z)((0,s.Z)().mark((function e(t,n,r){var o,i,a,u,c=arguments;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=c.length>3&&void 0!==c[3]&&c[3],i=new $_(t),e.prev=2,e.next=5,i.verify(r);case 5:a=e.sent,e.next=13;break;case 8:return e.prev=8,e.t0=e.catch(2),e.next=12,i.verify(r,!0);case 12:a=e.sent;case 13:return u=Object.assign({},n),o?Object.assign(u,{captchaResp:a}):Object.assign(u,{captchaResponse:a}),Object.assign(u,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(u,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),e.abrupt("return",u);case 18:case"end":return e.stop()}}),e,null,[[2,8]])}))),Q_.apply(this,arguments)}function J_(e,t,n){var r=q_(e);Nk(r._canInitEmulator,r,"emulator-config-failed"),Nk(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");var i=!!(null===n||void 0===n?void 0:n.disableWarnings),a=eE(t),s=function(e){var t=eE(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};var r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){var a=i[1];return{host:a,port:tE(r.substr(a.length+1))}}var s=r.split(":"),u=(0,o.Z)(s,2);return{host:u[0],port:tE(u[1])}}(t),u=s.host,c=s.port,l=null===c?"":":".concat(c);r.config.emulator={url:"".concat(a,"//").concat(u).concat(l,"/")},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:u,port:c,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||function(){function e(){var e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function eE(e){var t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function tE(e){if(!e)return null;var t=Number(e);return isNaN(t)?null:t}var nE=function(){function e(t,n){(0,V.Z)(this,e),this.providerId=t,this.signInMethod=n}return(0,H.Z)(e,[{key:"toJSON",value:function(){return Ok("not implemented")}},{key:"_getIdTokenResponse",value:function(e){return Ok("not implemented")}},{key:"_linkToIdToken",value:function(e,t){return Ok("not implemented")}},{key:"_getReauthenticationResolver",value:function(e){return Ok("not implemented")}}]),e}();function rE(e,t){return oE.apply(this,arguments)}function oE(){return oE=(0,u.Z)((0,s.Z)().mark((function e(t,n){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Vk(t,"POST","/v1/accounts:update",n));case 1:case"end":return e.stop()}}),e)}))),oE.apply(this,arguments)}function iE(e,t){return aE.apply(this,arguments)}function aE(){return aE=(0,u.Z)((0,s.Z)().mark((function e(t,n){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Kk(t,"POST","/v1/accounts:signInWithPassword",zk(t,n)));case 1:case"end":return e.stop()}}),e)}))),aE.apply(this,arguments)}function sE(e,t){return uE.apply(this,arguments)}function uE(){return uE=(0,u.Z)((0,s.Z)().mark((function e(t,n){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Kk(t,"POST","/v1/accounts:signInWithEmailLink",zk(t,n)));case 1:case"end":return e.stop()}}),e)}))),uE.apply(this,arguments)}function cE(e,t){return lE.apply(this,arguments)}function lE(){return lE=(0,u.Z)((0,s.Z)().mark((function e(t,n){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Kk(t,"POST","/v1/accounts:signInWithEmailLink",zk(t,n)));case 1:case"end":return e.stop()}}),e)}))),lE.apply(this,arguments)}var fE=function(e){(0,$e.Z)(n,e);var t=(0,Ye.Z)(n);function n(e,r,o){var i,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return(0,V.Z)(this,n),(i=t.call(this,"password",o))._email=e,i._password=r,i._tenantId=a,i}return(0,H.Z)(n,[{key:"toJSON",value:function(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}},{key:"_getIdTokenResponse",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var n,r,o;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=this.signInMethod,e.next="password"===e.t0?3:"emailLink"===e.t0?12:13;break;case 3:if(r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},!(null===(n=t._getRecaptchaConfig())||void 0===n?void 0:n.emailPasswordEnabled)){e.next=11;break}return e.next=7,Y_(t,r,"signInWithPassword");case 7:return o=e.sent,e.abrupt("return",iE(t,o));case 11:return e.abrupt("return",iE(t,r).catch(function(){var e=(0,u.Z)((0,s.Z)().mark((function e(n){var o;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.code!=="auth/".concat("missing-recaptcha-token")){e.next=8;break}return console.log("Sign-in with email address and password is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow."),e.next=4,Y_(t,r,"signInWithPassword");case 4:return o=e.sent,e.abrupt("return",iE(t,o));case 8:return e.abrupt("return",Promise.reject(n));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 12:return e.abrupt("return",sE(t,{email:this._email,oobCode:this._password}));case 13:Ik(t,"internal-error");case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_linkToIdToken",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t,n){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=this.signInMethod,e.next="password"===e.t0?3:"emailLink"===e.t0?4:5;break;case 3:return e.abrupt("return",rE(t,{idToken:n,returnSecureToken:!0,email:this._email,password:this._password}));case 4:return e.abrupt("return",cE(t,{idToken:n,email:this._email,oobCode:this._password}));case 5:Ik(t,"internal-error");case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_getReauthenticationResolver",value:function(e){return this._getIdTokenResponse(e)}}],[{key:"_fromEmailAndPassword",value:function(e,t){return new n(e,t,"password")}},{key:"_fromEmailAndCode",value:function(e,t){return new n(e,t,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}},{key:"fromJSON",value:function(e){var t="string"===typeof e?JSON.parse(e):e;if((null===t||void 0===t?void 0:t.email)&&(null===t||void 0===t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}}]),n}(nE);function hE(e,t){return dE.apply(this,arguments)}function dE(){return dE=(0,u.Z)((0,s.Z)().mark((function e(t,n){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Kk(t,"POST","/v1/accounts:signInWithIdp",zk(t,n)));case 1:case"end":return e.stop()}}),e)}))),dE.apply(this,arguments)}var pE=function(e){(0,$e.Z)(n,e);var t=(0,Ye.Z)(n);function n(){var e;return(0,V.Z)(this,n),(e=t.apply(this,arguments)).pendingToken=null,e}return(0,H.Z)(n,[{key:"toJSON",value:function(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}},{key:"_getIdTokenResponse",value:function(e){return hE(e,this.buildRequest())}},{key:"_linkToIdToken",value:function(e,t){var n=this.buildRequest();return n.idToken=t,hE(e,n)}},{key:"_getReauthenticationResolver",value:function(e){var t=this.buildRequest();return t.autoCreate=!1,hE(e,t)}},{key:"buildRequest",value:function(){var e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{var t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Pb(t)}return e}}],[{key:"_fromParams",value:function(e){var t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Ik("argument-error"),t}},{key:"fromJSON",value:function(e){var t="string"===typeof e?JSON.parse(e):e,r=t.providerId,o=t.signInMethod,i=gk(t,["providerId","signInMethod"]);if(!r||!o)return null;var a=new n(r,o);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}}]),n}(nE);function vE(e,t){return mE.apply(this,arguments)}function mE(){return mE=(0,u.Z)((0,s.Z)().mark((function e(t,n){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Vk(t,"POST","/v1/accounts:sendVerificationCode",zk(t,n)));case 1:case"end":return e.stop()}}),e)}))),mE.apply(this,arguments)}function gE(){return gE=(0,u.Z)((0,s.Z)().mark((function e(t,n){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Kk(t,"POST","/v1/accounts:signInWithPhoneNumber",zk(t,n)));case 1:case"end":return e.stop()}}),e)}))),gE.apply(this,arguments)}function yE(){return yE=(0,u.Z)((0,s.Z)().mark((function e(t,n){var r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Kk(t,"POST","/v1/accounts:signInWithPhoneNumber",zk(t,n));case 2:if(!(r=e.sent).temporaryProof){e.next=5;break}throw Qk(t,"account-exists-with-different-credential",r);case 5:return e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)}))),yE.apply(this,arguments)}var bE=On({},"USER_NOT_FOUND","user-not-found");function wE(){return wE=(0,u.Z)((0,s.Z)().mark((function e(t,n){var r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object.assign(Object.assign({},n),{operation:"REAUTH"}),e.abrupt("return",Kk(t,"POST","/v1/accounts:signInWithPhoneNumber",zk(t,r),bE));case 2:case"end":return e.stop()}}),e)}))),wE.apply(this,arguments)}var xE=function(e){(0,$e.Z)(n,e);var t=(0,Ye.Z)(n);function n(e){var r;return(0,V.Z)(this,n),(r=t.call(this,"phone","phone")).params=e,r}return(0,H.Z)(n,[{key:"_getIdTokenResponse",value:function(e){return function(e,t){return gE.apply(this,arguments)}(e,this._makeVerificationRequest())}},{key:"_linkToIdToken",value:function(e,t){return function(e,t){return yE.apply(this,arguments)}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}},{key:"_getReauthenticationResolver",value:function(e){return function(e,t){return wE.apply(this,arguments)}(e,this._makeVerificationRequest())}},{key:"_makeVerificationRequest",value:function(){var e=this.params,t=e.temporaryProof,n=e.phoneNumber,r=e.verificationId,o=e.verificationCode;return t&&n?{temporaryProof:t,phoneNumber:n}:{sessionInfo:r,code:o}}},{key:"toJSON",value:function(){var e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}}],[{key:"_fromVerification",value:function(e,t){return new n({verificationId:e,verificationCode:t})}},{key:"_fromTokenResponse",value:function(e,t){return new n({phoneNumber:e,temporaryProof:t})}},{key:"fromJSON",value:function(e){"string"===typeof e&&(e=JSON.parse(e));var t=e,r=t.verificationId,o=t.verificationCode,i=t.phoneNumber,a=t.temporaryProof;return o||r||i||a?new n({verificationId:r,verificationCode:o,phoneNumber:i,temporaryProof:a}):null}}]),n}(nE);var kE=function(){function e(t){var n,r,o,i,a,s;(0,V.Z)(this,e);var u=Mb(Fb(t)),c=null!==(n=u.apiKey)&&void 0!==n?n:null,l=null!==(r=u.oobCode)&&void 0!==r?r:null,f=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(o=u.mode)&&void 0!==o?o:null);Nk(c&&l&&f,"argument-error"),this.apiKey=c,this.operation=f,this.code=l,this.continueUrl=null!==(i=u.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(a=u.languageCode)&&void 0!==a?a:null,this.tenantId=null!==(s=u.tenantId)&&void 0!==s?s:null}return(0,H.Z)(e,null,[{key:"parseLink",value:function(t){var n=function(e){var t=Mb(Fb(e)).link,n=t?Mb(Fb(t)).deep_link_id:null,r=Mb(Fb(e)).deep_link_id;return(r?Mb(Fb(r)).link:null)||r||n||t||e}(t);try{return new e(n)}catch(wu){return null}}}]),e}();var _E=function(){function e(){(0,V.Z)(this,e),this.providerId=e.PROVIDER_ID}return(0,H.Z)(e,null,[{key:"credential",value:function(e,t){return fE._fromEmailAndPassword(e,t)}},{key:"credentialWithLink",value:function(e,t){var n=kE.parseLink(t);return Nk(n,"argument-error"),fE._fromEmailAndCode(e,n.code,n.tenantId)}}]),e}();_E.PROVIDER_ID="password",_E.EMAIL_PASSWORD_SIGN_IN_METHOD="password",_E.EMAIL_LINK_SIGN_IN_METHOD="emailLink";var EE=function(){function e(t){(0,V.Z)(this,e),this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}return(0,H.Z)(e,[{key:"setDefaultLanguage",value:function(e){this.defaultLanguageCode=e}},{key:"setCustomParameters",value:function(e){return this.customParameters=e,this}},{key:"getCustomParameters",value:function(){return this.customParameters}}]),e}(),CE=function(e){(0,$e.Z)(n,e);var t=(0,Ye.Z)(n);function n(){var e;return(0,V.Z)(this,n),(e=t.apply(this,arguments)).scopes=[],e}return(0,H.Z)(n,[{key:"addScope",value:function(e){return this.scopes.includes(e)||this.scopes.push(e),this}},{key:"getScopes",value:function(){return(0,Xe.Z)(this.scopes)}}]),n}(EE),SE=function(e){(0,$e.Z)(n,e);var t=(0,Ye.Z)(n);function n(){return(0,V.Z)(this,n),t.call(this,"facebook.com")}return(0,H.Z)(n,null,[{key:"credential",value:function(e){return pE._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}},{key:"credentialFromResult",value:function(e){return n.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return n.credential(t.oauthAccessToken)}catch(wu){return null}}}]),n}(CE);SE.FACEBOOK_SIGN_IN_METHOD="facebook.com",SE.PROVIDER_ID="facebook.com";var IE=function(e){(0,$e.Z)(n,e);var t=(0,Ye.Z)(n);function n(){var e;return(0,V.Z)(this,n),(e=t.call(this,"google.com")).addScope("profile"),e}return(0,H.Z)(n,null,[{key:"credential",value:function(e,t){return pE._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}},{key:"credentialFromResult",value:function(e){return n.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var r=t.oauthIdToken,o=t.oauthAccessToken;if(!r&&!o)return null;try{return n.credential(r,o)}catch(wu){return null}}}]),n}(CE);IE.GOOGLE_SIGN_IN_METHOD="google.com",IE.PROVIDER_ID="google.com";var RE=function(e){(0,$e.Z)(n,e);var t=(0,Ye.Z)(n);function n(){return(0,V.Z)(this,n),t.call(this,"github.com")}return(0,H.Z)(n,null,[{key:"credential",value:function(e){return pE._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GITHUB_SIGN_IN_METHOD,accessToken:e})}},{key:"credentialFromResult",value:function(e){return n.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return n.credential(t.oauthAccessToken)}catch(wu){return null}}}]),n}(CE);RE.GITHUB_SIGN_IN_METHOD="github.com",RE.PROVIDER_ID="github.com";var TE=function(e){(0,$e.Z)(n,e);var t=(0,Ye.Z)(n);function n(){return(0,V.Z)(this,n),t.call(this,"twitter.com")}return(0,H.Z)(n,null,[{key:"credential",value:function(e,t){return pE._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}},{key:"credentialFromResult",value:function(e){return n.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var r=t.oauthAccessToken,o=t.oauthTokenSecret;if(!r||!o)return null;try{return n.credential(r,o)}catch(wu){return null}}}]),n}(CE);function AE(e,t){return NE.apply(this,arguments)}function NE(){return NE=(0,u.Z)((0,s.Z)().mark((function e(t,n){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Kk(t,"POST","/v1/accounts:signUp",zk(t,n)));case 1:case"end":return e.stop()}}),e)}))),NE.apply(this,arguments)}TE.TWITTER_SIGN_IN_METHOD="twitter.com",TE.PROVIDER_ID="twitter.com";var OE=function(){function e(t){(0,V.Z)(this,e),this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}return(0,H.Z)(e,null,[{key:"_fromIdTokenResponse",value:function(){var t=(0,u.Z)((0,s.Z)().mark((function t(n,r,o){var i,a,u,c,l=arguments;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=l.length>3&&void 0!==l[3]&&l[3],t.next=3,k_._fromIdTokenResponse(n,o,i);case 3:return a=t.sent,u=DE(o),c=new e({user:a,providerId:u,_tokenResponse:o,operationType:r}),t.abrupt("return",c);case 7:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}()},{key:"_forOperation",value:function(){var t=(0,u.Z)((0,s.Z)().mark((function t(n,r,o){var i;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n._updateTokensIfNecessary(o,!0);case 2:return i=DE(o),t.abrupt("return",new e({user:n,providerId:i,_tokenResponse:o,operationType:r}));case 4:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}()}]),e}();function DE(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}var PE=function(e){(0,$e.Z)(n,e);var t=(0,Ye.Z)(n);function n(e,r,o,i){var a,s;return(0,V.Z)(this,n),(a=t.call(this,r.code,r.message)).operationType=o,a.user=i,Object.setPrototypeOf((0,db.Z)(a),n.prototype),a.customData={appName:e.name,tenantId:null!==(s=e.tenantId)&&void 0!==s?s:void 0,_serverResponse:r.customData._serverResponse,operationType:o},a}return(0,H.Z)(n,null,[{key:"_fromErrorAndOperation",value:function(e,t,r,o){return new n(e,t,r,o)}}]),n}(Rb);function ME(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((function(n){if(n.code==="auth/".concat("multi-factor-auth-required"))throw PE._fromErrorAndOperation(e,n,t,r);throw n}))}function FE(e,t){return LE.apply(this,arguments)}function LE(){return LE=(0,u.Z)((0,s.Z)().mark((function e(t,n){var r,o,i=arguments;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>2&&void 0!==i[2]&&i[2],e.t0=c_,e.t1=t,e.t2=n,e.t3=t.auth,e.next=7,t.getIdToken();case 7:return e.t4=e.sent,e.t5=e.t2._linkToIdToken.call(e.t2,e.t3,e.t4),e.t6=r,e.next=12,(0,e.t0)(e.t1,e.t5,e.t6);case 12:return o=e.sent,e.abrupt("return",OE._forOperation(t,"link",o));case 14:case"end":return e.stop()}}),e)}))),LE.apply(this,arguments)}function BE(e,t){return UE.apply(this,arguments)}function UE(){return UE=(0,u.Z)((0,s.Z)().mark((function e(t,n){var r,o,i,a,u,c,l=arguments;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=l.length>2&&void 0!==l[2]&&l[2],o=t.auth,i="reauthenticate",e.prev=3,e.next=6,c_(t,ME(o,i,n,t),r);case 6:return Nk((a=e.sent).idToken,o,"internal-error"),Nk(u=u_(a.idToken),o,"internal-error"),c=u.sub,Nk(t.uid===c,o,"user-mismatch"),e.abrupt("return",OE._forOperation(t,i,a));case 15:throw e.prev=15,e.t0=e.catch(3),(null===e.t0||void 0===e.t0?void 0:e.t0.code)==="auth/".concat("user-not-found")&&Ik(o,"user-mismatch"),e.t0;case 19:case"end":return e.stop()}}),e,null,[[3,15]])}))),UE.apply(this,arguments)}function jE(e,t){return ZE.apply(this,arguments)}function ZE(){return ZE=(0,u.Z)((0,s.Z)().mark((function e(t,n){var r,o,i,a,u=arguments;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=u.length>2&&void 0!==u[2]&&u[2],o="signIn",e.next=4,ME(t,o,n);case 4:return i=e.sent,e.next=7,OE._fromIdTokenResponse(t,o,i);case 7:if(a=e.sent,r){e.next=11;break}return e.next=11,t._updateCurrentUser(a.user);case 11:return e.abrupt("return",a);case 12:case"end":return e.stop()}}),e)}))),ZE.apply(this,arguments)}function WE(e,t){return zE.apply(this,arguments)}function zE(){return zE=(0,u.Z)((0,s.Z)().mark((function e(t,n){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",jE(q_(t),n));case 1:case"end":return e.stop()}}),e)}))),zE.apply(this,arguments)}function VE(e){return HE.apply(this,arguments)}function HE(){return HE=(0,u.Z)((0,s.Z)().mark((function e(t){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=q_(t))._getPasswordPolicyInternal()){e.next=4;break}return e.next=4,n._updatePasswordPolicy();case 4:case"end":return e.stop()}}),e)}))),HE.apply(this,arguments)}function qE(e,t,n){return GE.apply(this,arguments)}function GE(){return GE=(0,u.Z)((0,s.Z)().mark((function e(t,n,r){var o,i,a,c,l,f,h;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=q_(t),a={returnSecureToken:!0,email:n,password:r,clientType:"CLIENT_TYPE_WEB"},!(null===(o=i._getRecaptchaConfig())||void 0===o?void 0:o.emailPasswordEnabled)){e.next=9;break}return e.next=5,Y_(i,a,"signUpPassword");case 5:l=e.sent,c=AE(i,l),e.next=10;break;case 9:c=AE(i,a).catch(function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.code!=="auth/".concat("missing-recaptcha-token")){e.next=6;break}return console.log("Sign-up is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-up flow."),e.next=4,Y_(i,a,"signUpPassword");case 4:return n=e.sent,e.abrupt("return",AE(i,n));case 6:throw t;case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 10:return e.next=12,c.catch((function(e){throw e.code==="auth/".concat("password-does-not-meet-requirements")&&VE(t),e}));case 12:return f=e.sent,e.next=15,OE._fromIdTokenResponse(i,"signIn",f);case 15:return h=e.sent,e.next=18,i._updateCurrentUser(h.user);case 18:return e.abrupt("return",h);case 19:case"end":return e.stop()}}),e)}))),GE.apply(this,arguments)}function KE(e,t,n){return WE(Ub(e),_E.credential(t,n)).catch(function(){var t=(0,u.Z)((0,s.Z)().mark((function t(n){return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:throw n.code==="auth/".concat("password-does-not-meet-requirements")&&VE(e),n;case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}function XE(e,t){return Vk(e,"POST","/v2/accounts/mfaEnrollment:start",zk(e,t))}function $E(e,t){return Vk(e,"POST","/v2/accounts/mfaEnrollment:start",zk(e,t))}function YE(e,t){return Vk(e,"POST","/v2/accounts/mfaEnrollment:finalize",zk(e,t))}new WeakMap;var QE="__sak",JE=function(){function e(t,n){(0,V.Z)(this,e),this.storageRetriever=t,this.type=n}return(0,H.Z)(e,[{key:"_isAvailable",value:function(){try{return this.storage?(this.storage.setItem(QE,"1"),this.storage.removeItem(QE),Promise.resolve(!0)):Promise.resolve(!1)}catch(wu){return Promise.resolve(!1)}}},{key:"_set",value:function(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}},{key:"_get",value:function(e){var t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}},{key:"_remove",value:function(e){return this.storage.removeItem(e),Promise.resolve()}},{key:"storage",get:function(){return this.storageRetriever()}}]),e}();var eC=function(e){(0,$e.Z)(n,e);var t=(0,Ye.Z)(n);function n(){var e;return(0,V.Z)(this,n),(e=t.call(this,(function(){return window.localStorage}),"LOCAL")).boundEventHandler=function(t,n){return e.onStorageEvent(t,n)},e.listeners={},e.localCache={},e.pollTimer=null,e.safariLocalStorageNotSynced=function(){var e=Cb();return N_(e)||L_(e)}()&&function(){try{return!(!window||window===window.top)}catch(Fn){return!1}}(),e.fallbackToPolling=U_(),e._shouldAllowMigration=!0,e}return(0,H.Z)(n,[{key:"forAllChangedKeys",value:function(e){for(var t=0,n=Object.keys(this.listeners);t<n.length;t++){var r=n[t],o=this.storage.getItem(r),i=this.localCache[r];o!==i&&e(r,i,o)}}},{key:"onStorageEvent",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.key){var r=e.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){var o=this.storage.getItem(r);if(e.newValue!==o)null!==e.newValue?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!n)return}var i=function(){var e=t.storage.getItem(r);(n||t.localCache[r]!==e)&&t.notifyListeners(r,e)},a=this.storage.getItem(r);B_()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,10):i()}else this.forAllChangedKeys((function(e,n,r){t.notifyListeners(e,r)}))}},{key:"notifyListeners",value:function(e,t){this.localCache[e]=t;var n=this.listeners[e];if(n)for(var r=0,o=Array.from(n);r<o.length;r++){(0,o[r])(t?JSON.parse(t):t)}}},{key:"startPolling",value:function(){var e=this;this.stopPolling(),this.pollTimer=setInterval((function(){e.forAllChangedKeys((function(t,n,r){e.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:n,newValue:r}),!0)}))}),1e3)}},{key:"stopPolling",value:function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}},{key:"attachListener",value:function(){window.addEventListener("storage",this.boundEventHandler)}},{key:"detachListener",value:function(){window.removeEventListener("storage",this.boundEventHandler)}},{key:"_addListener",value:function(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}},{key:"_removeListener",value:function(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}},{key:"_set",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t,r){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,vk.Z)((0,mk.Z)(n.prototype),"_set",this).call(this,t,r);case 2:this.localCache[t]=JSON.stringify(r);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_get",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,vk.Z)((0,mk.Z)(n.prototype),"_get",this).call(this,t);case 2:return r=e.sent,this.localCache[t]=JSON.stringify(r),e.abrupt("return",r);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_remove",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,vk.Z)((0,mk.Z)(n.prototype),"_remove",this).call(this,t);case 2:delete this.localCache[t];case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(JE);eC.type="LOCAL";var tC=eC,nC=function(e){(0,$e.Z)(n,e);var t=(0,Ye.Z)(n);function n(){return(0,V.Z)(this,n),t.call(this,(function(){return window.sessionStorage}),"SESSION")}return(0,H.Z)(n,[{key:"_addListener",value:function(e,t){}},{key:"_removeListener",value:function(e,t){}}]),n}(JE);nC.type="SESSION";var rC=nC;function oC(e){return Promise.all(e.map(function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t;case 3:return n=e.sent,e.abrupt("return",{fulfilled:!0,value:n});case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",{fulfilled:!1,reason:e.t0});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()))}var iC=function(){function e(t){(0,V.Z)(this,e),this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}return(0,H.Z)(e,[{key:"isListeningto",value:function(e){return this.eventTarget===e}},{key:"handleEvent",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var n,r,o,i,a,c,l,f;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(n=t).data,o=r.eventId,i=r.eventType,a=r.data,null===(c=this.handlersMap[i])||void 0===c?void 0:c.size){e.next=5;break}return e.abrupt("return");case 5:return n.ports[0].postMessage({status:"ack",eventId:o,eventType:i}),l=Array.from(c).map(function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t(n.origin,a));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=9,oC(l);case 9:f=e.sent,n.ports[0].postMessage({status:"done",eventId:o,eventType:i,response:f});case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_subscribe",value:function(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}},{key:"_unsubscribe",value:function(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}],[{key:"_getInstance",value:function(t){var n=this.receivers.find((function(e){return e.isListeningto(t)}));if(n)return n;var r=new e(t);return this.receivers.push(r),r}}]),e}();function aC(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="",r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}iC.receivers=[];var sC=function(){function e(t){(0,V.Z)(this,e),this.target=t,this.handlers=new Set}return(0,H.Z)(e,[{key:"removeMessageHandler",value:function(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}},{key:"_send",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t,n){var r,o,i,a,u=this,c=arguments;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=c.length>2&&void 0!==c[2]?c[2]:50,o="undefined"!==typeof MessageChannel?new MessageChannel:null){e.next=4;break}throw new Error("connection_unavailable");case 4:return e.abrupt("return",new Promise((function(e,s){var c=aC("",20);o.port1.start();var l=setTimeout((function(){s(new Error("unsupported_event"))}),r);a={messageChannel:o,onMessage:function(t){var n=t;if(n.data.eventId===c)switch(n.data.status){case"ack":clearTimeout(l),i=setTimeout((function(){s(new Error("timeout"))}),3e3);break;case"done":clearTimeout(i),e(n.data.response);break;default:clearTimeout(l),clearTimeout(i),s(new Error("invalid_response"))}}},u.handlers.add(a),o.port1.addEventListener("message",a.onMessage),u.target.postMessage({eventType:t,eventId:c,data:n},[o.port2])})).finally((function(){a&&u.removeMessageHandler(a)})));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}();function uC(){return window}function cC(e){uC().location.href=e}function lC(){return"undefined"!==typeof uC().WorkerGlobalScope&&"function"===typeof uC().importScripts}function fC(){return hC.apply(this,arguments)}function hC(){return(hC=(0,u.Z)((0,s.Z)().mark((function e(){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===navigator||void 0===navigator?void 0:navigator.serviceWorker){e.next=2;break}return e.abrupt("return",null);case 2:return e.prev=2,e.next=5,navigator.serviceWorker.ready;case 5:return t=e.sent,e.abrupt("return",t.active);case 9:return e.prev=9,e.t0=e.catch(2),e.abrupt("return",null);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})))).apply(this,arguments)}function dC(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}var pC="firebaseLocalStorageDb",vC="firebaseLocalStorage",mC="fbase_key",gC=function(){function e(t){(0,V.Z)(this,e),this.request=t}return(0,H.Z)(e,[{key:"toPromise",value:function(){var e=this;return new Promise((function(t,n){e.request.addEventListener("success",(function(){t(e.request.result)})),e.request.addEventListener("error",(function(){n(e.request.error)}))}))}}]),e}();function yC(e,t){return e.transaction([vC],t?"readwrite":"readonly").objectStore(vC)}function bC(){var e=indexedDB.deleteDatabase(pC);return new gC(e).toPromise()}function wC(){var e=indexedDB.open(pC,1);return new Promise((function(t,n){e.addEventListener("error",(function(){n(e.error)})),e.addEventListener("upgradeneeded",(function(){var t=e.result;try{t.createObjectStore(vC,{keyPath:mC})}catch(Fn){n(Fn)}})),e.addEventListener("success",(0,u.Z)((0,s.Z)().mark((function n(){var r;return(0,s.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if((r=e.result).objectStoreNames.contains(vC)){n.next=12;break}return r.close(),n.next=5,bC();case 5:return n.t0=t,n.next=8,wC();case 8:n.t1=n.sent,(0,n.t0)(n.t1),n.next=13;break;case 12:t(r);case 13:case"end":return n.stop()}}),n)}))))}))}function xC(e,t,n){return kC.apply(this,arguments)}function kC(){return(kC=(0,u.Z)((0,s.Z)().mark((function e(t,n,r){var o,i;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=yC(t,!0).put((On(o={},mC,n),On(o,"value",r),o)),e.abrupt("return",new gC(i).toPromise());case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _C(e,t){return EC.apply(this,arguments)}function EC(){return(EC=(0,u.Z)((0,s.Z)().mark((function e(t,n){var r,o;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=yC(t,!1).get(n),e.next=3,new gC(r).toPromise();case 3:return o=e.sent,e.abrupt("return",void 0===o?null:o.value);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function CC(e,t){var n=yC(e,!0).delete(t);return new gC(n).toPromise()}var SC=function(){function e(){(0,V.Z)(this,e),this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((function(){}),(function(){}))}return(0,H.Z)(e,[{key:"_openDb",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.db){e.next=2;break}return e.abrupt("return",this.db);case 2:return e.next=4,wC();case 4:return this.db=e.sent,e.abrupt("return",this.db);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_withRetries",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var n,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0;case 1:return e.prev=2,e.next=5,this._openDb();case 5:return r=e.sent,e.next=8,t(r);case 8:return e.abrupt("return",e.sent);case 11:if(e.prev=11,e.t0=e.catch(2),!(n++>3)){e.next=15;break}throw e.t0;case 15:this.db&&(this.db.close(),this.db=void 0);case 16:e.next=1;break;case 18:case"end":return e.stop()}}),e,this,[[2,11]])})));return function(t){return e.apply(this,arguments)}}()},{key:"initializeServiceWorkerMessaging",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",lC()?this.initializeReceiver():this.initializeSender());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initializeReceiver",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){var t=this;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.receiver=iC._getInstance(lC()?self:null),this.receiver._subscribe("keyChanged",function(){var e=(0,u.Z)((0,s.Z)().mark((function e(n,r){var o;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._poll();case 2:return o=e.sent,e.abrupt("return",{keyProcessed:o.includes(r.key)});case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),this.receiver._subscribe("ping",function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t,n){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",["keyChanged"]);case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initializeSender",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){var t,n,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fC();case 2:if(this.activeServiceWorker=e.sent,this.activeServiceWorker){e.next=5;break}return e.abrupt("return");case 5:return this.sender=new sC(this.activeServiceWorker),e.next=8,this.sender._send("ping",{},800);case 8:if(r=e.sent){e.next=11;break}return e.abrupt("return");case 11:(null===(t=r[0])||void 0===t?void 0:t.fulfilled)&&(null===(n=r[0])||void 0===n?void 0:n.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"notifyServiceWorker",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.sender&&this.activeServiceWorker&&dC()===this.activeServiceWorker){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50);case 5:e.next=9;break;case 7:e.prev=7,e.t0=e.catch(2);case 9:case"end":return e.stop()}}),e,this,[[2,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_isAvailable",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,indexedDB){e.next=3;break}return e.abrupt("return",!1);case 3:return e.next=5,wC();case 5:return t=e.sent,e.next=8,xC(t,QE,"1");case 8:return e.next=10,CC(t,QE);case 10:return e.abrupt("return",!0);case 13:e.prev=13,e.t0=e.catch(0);case 15:return e.abrupt("return",!1);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(){return e.apply(this,arguments)}}()},{key:"_withPendingWrite",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.pendingWrites++,e.prev=1,e.next=4,t();case 4:return e.prev=4,this.pendingWrites--,e.finish(4);case 7:case"end":return e.stop()}}),e,this,[[1,,4,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_set",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t,n){var r=this;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._withPendingWrite((0,u.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r._withRetries((function(e){return xC(e,t,n)}));case 2:return r.localCache[t]=n,e.abrupt("return",r.notifyServiceWorker(t));case 4:case"end":return e.stop()}}),e)})))));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_get",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._withRetries((function(e){return _C(e,t)}));case 2:return n=e.sent,this.localCache[t]=n,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_remove",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var n=this;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._withPendingWrite((0,u.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n._withRetries((function(e){return CC(e,t)}));case 2:return delete n.localCache[t],e.abrupt("return",n.notifyServiceWorker(t));case 4:case"end":return e.stop()}}),e)})))));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_poll",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){var t,n,r,o,i,a,u,c,l,f,h;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._withRetries((function(e){var t=yC(e,!1).getAll();return new gC(t).toPromise()}));case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return",[]);case 5:if(0===this.pendingWrites){e.next=7;break}return e.abrupt("return",[]);case 7:n=[],r=new Set,o=(0,ot.Z)(t);try{for(o.s();!(i=o.n()).done;)a=i.value,u=a.fbase_key,c=a.value,r.add(u),JSON.stringify(this.localCache[u])!==JSON.stringify(c)&&(this.notifyListeners(u,c),n.push(u))}catch(s){o.e(s)}finally{o.f()}for(l=0,f=Object.keys(this.localCache);l<f.length;l++)h=f[l],this.localCache[h]&&!r.has(h)&&(this.notifyListeners(h,null),n.push(h));return e.abrupt("return",n);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"notifyListeners",value:function(e,t){this.localCache[e]=t;var n=this.listeners[e];if(n)for(var r=0,o=Array.from(n);r<o.length;r++){(0,o[r])(t)}}},{key:"startPolling",value:function(){var e=this;this.stopPolling(),this.pollTimer=setInterval((0,u.Z)((0,s.Z)().mark((function t(){return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e._poll());case 1:case"end":return t.stop()}}),t)}))),800)}},{key:"stopPolling",value:function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}},{key:"_addListener",value:function(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}},{key:"_removeListener",value:function(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}]),e}();SC.type="LOCAL";var IC=SC;function RC(e,t){return Vk(e,"POST","/v2/accounts/mfaSignIn:start",zk(e,t))}function TC(e,t){return Vk(e,"POST","/v2/accounts/mfaSignIn:finalize",zk(e,t))}X_("rcb"),new Bk(3e4,6e4);var AC="recaptcha";function NC(e,t,n){return OC.apply(this,arguments)}function OC(){return OC=(0,u.Z)((0,s.Z)().mark((function e(t,n,r){var o,i,a,u,c,l,f,h,d;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.verify();case 2:if(i=e.sent,e.prev=3,Nk("string"===typeof i,t,"argument-error"),Nk(r.type===AC,t,"argument-error"),!("session"in(a="string"===typeof n?{phoneNumber:n}:n))){e.next=26;break}if(u=a.session,!("phoneNumber"in a)){e.next=17;break}return Nk("enroll"===u.type,t,"internal-error"),e.next=13,XE(t,{idToken:u.credential,phoneEnrollmentInfo:{phoneNumber:a.phoneNumber,recaptchaToken:i}});case 13:return c=e.sent,e.abrupt("return",c.phoneSessionInfo.sessionInfo);case 17:return Nk("signin"===u.type,t,"internal-error"),Nk(l=(null===(o=a.multiFactorHint)||void 0===o?void 0:o.uid)||a.multiFactorUid,t,"missing-multi-factor-info"),e.next=22,RC(t,{mfaPendingCredential:u.credential,mfaEnrollmentId:l,phoneSignInInfo:{recaptchaToken:i}});case 22:return f=e.sent,e.abrupt("return",f.phoneResponseInfo.sessionInfo);case 24:e.next=31;break;case 26:return e.next=28,vE(t,{phoneNumber:a.phoneNumber,recaptchaToken:i});case 28:return h=e.sent,d=h.sessionInfo,e.abrupt("return",d);case 31:return e.prev=31,r._reset(),e.finish(31);case 34:case"end":return e.stop()}}),e,null,[[3,,31,34]])}))),OC.apply(this,arguments)}var DC=function(){function e(t){(0,V.Z)(this,e),this.providerId=e.PROVIDER_ID,this.auth=q_(t)}return(0,H.Z)(e,[{key:"verifyPhoneNumber",value:function(e,t){return NC(this.auth,e,Ub(t))}}],[{key:"credential",value:function(e,t){return xE._fromVerification(e,t)}},{key:"credentialFromResult",value:function(t){var n=t;return e.credentialFromTaggedObject(n)}},{key:"credentialFromError",value:function(t){return e.credentialFromTaggedObject(t.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var n=t.phoneNumber,r=t.temporaryProof;return n&&r?xE._fromTokenResponse(n,r):null}}]),e}();function PC(e,t){return t?E_(t):(Nk(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}DC.PROVIDER_ID="phone",DC.PHONE_SIGN_IN_METHOD="phone";var MC=function(e){(0,$e.Z)(n,e);var t=(0,Ye.Z)(n);function n(e){var r;return(0,V.Z)(this,n),(r=t.call(this,"custom","custom")).params=e,r}return(0,H.Z)(n,[{key:"_getIdTokenResponse",value:function(e){return hE(e,this._buildIdpRequest())}},{key:"_linkToIdToken",value:function(e,t){return hE(e,this._buildIdpRequest(t))}},{key:"_getReauthenticationResolver",value:function(e){return hE(e,this._buildIdpRequest())}},{key:"_buildIdpRequest",value:function(e){var t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}]),n}(nE);function FC(e){return jE(e.auth,new MC(e),e.bypassAuthState)}function LC(e){var t=e.auth,n=e.user;return Nk(n,t,"internal-error"),BE(n,new MC(e),e.bypassAuthState)}function BC(e){return UC.apply(this,arguments)}function UC(){return UC=(0,u.Z)((0,s.Z)().mark((function e(t){var n,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.auth,Nk(r=t.user,n,"internal-error"),e.abrupt("return",FE(r,new MC(t),t.bypassAuthState));case 3:case"end":return e.stop()}}),e)}))),UC.apply(this,arguments)}var jC=function(){function e(t,n,r,o){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];(0,V.Z)(this,e),this.auth=t,this.resolver=r,this.user=o,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}return(0,H.Z)(e,[{key:"execute",value:function(){var e=this;return new Promise(function(){var t=(0,u.Z)((0,s.Z)().mark((function t(n,r){return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.pendingPromise={resolve:n,reject:r},t.prev=1,t.next=4,e.resolver._initialize(e.auth);case 4:return e.eventManager=t.sent,t.next=7,e.onExecution();case 7:e.eventManager.registerConsumer(e),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(1),e.reject(t.t0);case 13:case"end":return t.stop()}}),t,null,[[1,10]])})));return function(e,n){return t.apply(this,arguments)}}())}},{key:"onAuthEvent",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var n,r,o,i,a,u,c;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.urlResponse,r=t.sessionId,o=t.postBody,i=t.tenantId,a=t.error,u=t.type,!a){e.next=4;break}return this.reject(a),e.abrupt("return");case 4:return c={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:o||void 0,user:this.user,bypassAuthState:this.bypassAuthState},e.prev=5,e.t0=this,e.next=9,this.getIdpTask(u)(c);case 9:e.t1=e.sent,e.t0.resolve.call(e.t0,e.t1),e.next=16;break;case 13:e.prev=13,e.t2=e.catch(5),this.reject(e.t2);case 16:case"end":return e.stop()}}),e,this,[[5,13]])})));return function(t){return e.apply(this,arguments)}}()},{key:"onError",value:function(e){this.reject(e)}},{key:"getIdpTask",value:function(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return FC;case"linkViaPopup":case"linkViaRedirect":return BC;case"reauthViaPopup":case"reauthViaRedirect":return LC;default:Ik(this.auth,"internal-error")}}},{key:"resolve",value:function(e){Dk(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}},{key:"reject",value:function(e){Dk(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}},{key:"unregisterAndCleanUp",value:function(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}]),e}(),ZC=new Bk(2e3,1e4);var WC=function(e){(0,$e.Z)(n,e);var t=(0,Ye.Z)(n);function n(e,r,o,i,a){var s;return(0,V.Z)(this,n),(s=t.call(this,e,r,i,a)).provider=o,s.authWindow=null,s.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=(0,db.Z)(s),s}return(0,H.Z)(n,[{key:"executeNotNull",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.execute();case 2:return Nk(t=e.sent,this.auth,"internal-error"),e.abrupt("return",t);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onExecution",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){var t,n=this;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Dk(1===this.filter.length,"Popup operations only handle one event"),t=aC(),e.next=4,this.resolver._openPopup(this.auth,this.provider,this.filter[0],t);case 4:this.authWindow=e.sent,this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch((function(e){n.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(function(e){e||n.reject(Rk(n.auth,"web-storage-unsupported"))})),this.pollUserCancellation();case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"eventId",get:function(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}},{key:"cancel",value:function(){this.reject(Rk(this.auth,"cancelled-popup-request"))}},{key:"cleanUp",value:function(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}},{key:"pollUserCancellation",value:function(){var e=this;!function t(){var n,r;(null===(r=null===(n=e.authWindow)||void 0===n?void 0:n.window)||void 0===r?void 0:r.closed)?e.pollId=window.setTimeout((function(){e.pollId=null,e.reject(Rk(e.auth,"popup-closed-by-user"))}),8e3):e.pollId=window.setTimeout(t,ZC.get())}()}}]),n}(jC);WC.currentPopupAction=null;var zC="pendingRedirect",VC=new Map,HC=function(e){(0,$e.Z)(n,e);var t=(0,Ye.Z)(n);function n(e,r){var o,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(0,V.Z)(this,n),(o=t.call(this,e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,i)).eventId=null,o}return(0,H.Z)(n,[{key:"execute",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){var t,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=VC.get(this.auth._key())){e.next=21;break}return e.prev=2,e.next=5,qC(this.resolver,this.auth);case 5:if(!e.sent){e.next=12;break}return e.next=9,(0,vk.Z)((0,mk.Z)(n.prototype),"execute",this).call(this);case 9:e.t0=e.sent,e.next=13;break;case 12:e.t0=null;case 13:r=e.t0,t=function(){return Promise.resolve(r)},e.next=20;break;case 17:e.prev=17,e.t1=e.catch(2),t=function(){return Promise.reject(e.t1)};case 20:VC.set(this.auth._key(),t);case 21:return this.bypassAuthState||VC.set(this.auth._key(),(function(){return Promise.resolve(null)})),e.abrupt("return",t());case 23:case"end":return e.stop()}}),e,this,[[2,17]])})));return function(){return e.apply(this,arguments)}}()},{key:"onAuthEvent",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("signInViaRedirect"!==t.type){e.next=4;break}return e.abrupt("return",(0,vk.Z)((0,mk.Z)(n.prototype),"onAuthEvent",this).call(this,t));case 4:if("unknown"!==t.type){e.next=7;break}return this.resolve(null),e.abrupt("return");case 7:if(!t.eventId){e.next=17;break}return e.next=10,this.auth._redirectUserForId(t.eventId);case 10:if(!(r=e.sent)){e.next=16;break}return this.user=r,e.abrupt("return",(0,vk.Z)((0,mk.Z)(n.prototype),"onAuthEvent",this).call(this,t));case 16:this.resolve(null);case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onExecution",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"cleanUp",value:function(){}}]),n}(jC);function qC(e,t){return GC.apply(this,arguments)}function GC(){return GC=(0,u.Z)((0,s.Z)().mark((function e(t,n){var r,o,i;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=$C(n),o=XC(t),e.next=4,o._isAvailable();case 4:if(e.sent){e.next=6;break}return e.abrupt("return",!1);case 6:return e.next=8,o._get(r);case 8:return e.t0=e.sent,i="true"===e.t0,e.next=12,o._remove(r);case 12:return e.abrupt("return",i);case 13:case"end":return e.stop()}}),e)}))),GC.apply(this,arguments)}function KC(e,t){VC.set(e._key(),t)}function XC(e){return E_(e._redirectPersistence)}function $C(e){return I_(zC,e.config.apiKey,e.name)}function YC(e,t){return QC.apply(this,arguments)}function QC(){return QC=(0,u.Z)((0,s.Z)().mark((function e(t,n){var r,o,i,a,u,c=arguments;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=c.length>2&&void 0!==c[2]&&c[2],o=q_(t),i=PC(o,n),a=new HC(o,i,r),e.next=6,a.execute();case 6:if(!(u=e.sent)||r){e.next=13;break}return delete u.user._redirectEventId,e.next=11,o._persistUserIfCurrent(u.user);case 11:return e.next=13,o._setRedirectUser(null,n);case 13:return e.abrupt("return",u);case 14:case"end":return e.stop()}}),e)}))),QC.apply(this,arguments)}var JC=function(){function e(t){(0,V.Z)(this,e),this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}return(0,H.Z)(e,[{key:"registerConsumer",value:function(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}},{key:"unregisterConsumer",value:function(e){this.consumers.delete(e)}},{key:"onEvent",value:function(e){var t=this;if(this.hasEventBeenHandled(e))return!1;var n=!1;return this.consumers.forEach((function(r){t.isEventForConsumer(e,r)&&(n=!0,t.sendToConsumer(e,r),t.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return tS(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}},{key:"sendToConsumer",value:function(e,t){var n;if(e.error&&!tS(e)){var r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(Rk(this.auth,r))}else t.onAuthEvent(e)}},{key:"isEventForConsumer",value:function(e,t){var n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}},{key:"hasEventBeenHandled",value:function(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(eS(e))}},{key:"saveEventToCache",value:function(e){this.cachedEventUids.add(eS(e)),this.lastProcessedEventTime=Date.now()}}]),e}();function eS(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((function(e){return e})).join("-")}function tS(e){var t=e.type,n=e.error;return"unknown"===t&&(null===n||void 0===n?void 0:n.code)==="auth/".concat("no-auth-event")}function nS(e){return rS.apply(this,arguments)}function rS(){return rS=(0,u.Z)((0,s.Z)().mark((function e(t){var n,r=arguments;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:{},e.abrupt("return",Vk(t,"GET","/v1/projects",n));case 2:case"end":return e.stop()}}),e)}))),rS.apply(this,arguments)}var oS=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,iS=/^https?/;function aS(){return aS=(0,u.Z)((0,s.Z)().mark((function e(t){var n,r,o,i,a;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.config.emulator){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,nS(t);case 4:n=e.sent,r=n.authorizedDomains,o=(0,ot.Z)(r),e.prev=7,o.s();case 9:if((i=o.n()).done){e.next=20;break}if(a=i.value,e.prev=11,!sS(a)){e.next=14;break}return e.abrupt("return");case 14:e.next=18;break;case 16:e.prev=16,e.t0=e.catch(11);case 18:e.next=9;break;case 20:e.next=25;break;case 22:e.prev=22,e.t1=e.catch(7),o.e(e.t1);case 25:return e.prev=25,o.f(),e.finish(25);case 28:Ik(t,"unauthorized-domain");case 29:case"end":return e.stop()}}),e,null,[[7,22,25,28],[11,16]])}))),aS.apply(this,arguments)}function sS(e){var t=Pk(),n=new URL(t),r=n.protocol,o=n.hostname;if(e.startsWith("chrome-extension://")){var i=new URL(e);return""===i.hostname&&""===o?"chrome-extension:"===r&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===r&&i.hostname===o}if(!iS.test(r))return!1;if(oS.test(e))return o===e;var a=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(o)}var uS=new Bk(3e4,6e4);function cS(){var e=uC().___jsl;if(null===e||void 0===e?void 0:e.H)for(var t=0,n=Object.keys(e.H);t<n.length;t++){var r=n[t];if(e.H[r].r=e.H[r].r||[],e.H[r].L=e.H[r].L||[],e.H[r].r=(0,Xe.Z)(e.H[r].L),e.CP)for(var o=0;o<e.CP.length;o++)e.CP[o]=null}}var lS=null;function fS(e){return lS=lS||function(e){return new Promise((function(t,n){var r,o,i;function a(){cS(),gapi.load("gapi.iframes",{callback:function(){t(gapi.iframes.getContext())},ontimeout:function(){cS(),n(Rk(e,"network-request-failed"))},timeout:uS.get()})}if(null===(o=null===(r=uC().gapi)||void 0===r?void 0:r.iframes)||void 0===o?void 0:o.Iframe)t(gapi.iframes.getContext());else{if(!(null===(i=uC().gapi)||void 0===i?void 0:i.load)){var s=X_("iframefcb");return uC()[s]=function(){gapi.load?a():n(Rk(e,"network-request-failed"))},K_("https://apis.google.com/js/api.js?onload=".concat(s)).catch((function(e){return n(e)}))}a()}})).catch((function(e){throw lS=null,e}))}(e),lS}var hS=new Bk(5e3,15e3),dS="__/auth/iframe",pS="emulator/auth/iframe",vS={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},mS=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function gS(e){var t=e.config;Nk(t.authDomain,e,"auth-domain-config-required");var n=t.emulator?Uk(t,pS):"https://".concat(e.config.authDomain,"/").concat(dS),r={apiKey:t.apiKey,appName:e.name,v:Nw},o=mS.get(e.config.apiHost);o&&(r.eid=o);var i=e._getFrameworks();return i.length&&(r.fw=i.join(",")),"".concat(n,"?").concat(Pb(r).slice(1))}function yS(e){return bS.apply(this,arguments)}function bS(){return bS=(0,u.Z)((0,s.Z)().mark((function e(t){var n,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fS(t);case 2:return n=e.sent,Nk(r=uC().gapi,t,"internal-error"),e.abrupt("return",n.open({where:document.body,url:gS(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:vS,dontclear:!0},(function(e){return new Promise(function(){var n=(0,u.Z)((0,s.Z)().mark((function n(r,o){var i,a,u;return(0,s.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return u=function(){uC().clearTimeout(a),r(e)},n.next=3,e.restyle({setHideOnLeave:!1});case 3:i=Rk(t,"network-request-failed"),a=uC().setTimeout((function(){o(i)}),hS.get()),e.ping(u).then(u,(function(){o(i)}));case 6:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())})));case 6:case"end":return e.stop()}}),e)}))),bS.apply(this,arguments)}var wS={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},xS=function(){function e(t){(0,V.Z)(this,e),this.window=t,this.associatedEvent=null}return(0,H.Z)(e,[{key:"close",value:function(){if(this.window)try{this.window.close()}catch(Fn){}}}]),e}();function kS(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600,a=Math.max((window.screen.availHeight-i)/2,0).toString(),s=Math.max((window.screen.availWidth-r)/2,0).toString(),u="",c=Object.assign(Object.assign({},wS),{width:r.toString(),height:i.toString(),top:a,left:s}),l=Cb().toLowerCase();n&&(u=O_(l)?"_blank":n),A_(l)&&(t=t||"http://localhost",c.scrollbars="yes");var f=Object.entries(c).reduce((function(e,t){var n=(0,o.Z)(t,2),r=n[0],i=n[1];return"".concat(e).concat(r,"=").concat(i,",")}),"");if(function(){var e;return L_(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Cb())&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(l)&&"_self"!==u)return function(e,t){var n=document.createElement("a");n.href=e,n.target=t;var r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",u),new xS(null);var h=window.open(t||"",u,f);Nk(h,e,"popup-blocked");try{h.focus()}catch(Fn){}return new xS(h)}var _S="__/auth/handler",ES="emulator/auth/handler",CS=encodeURIComponent("fac");function SS(e,t,n,r,o,i){return IS.apply(this,arguments)}function IS(){return IS=(0,u.Z)((0,s.Z)().mark((function e(t,n,r,i,a,u){var c,l,f,h,d,p,v,m,g,y,b,w,x;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Nk(t.config.authDomain,t,"auth-domain-config-required"),Nk(t.config.apiKey,t,"invalid-api-key"),c={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:i,v:Nw,eventId:a},n instanceof EE)for(n.setDefaultLanguage(t.languageCode),c.providerId=n.providerId||"",Nb(n.getCustomParameters())||(c.customParameters=JSON.stringify(n.getCustomParameters())),l=0,f=Object.entries(u||{});l<f.length;l++)h=(0,o.Z)(f[l],2),d=h[0],p=h[1],c[d]=p;for(n instanceof CE&&(v=n.getScopes().filter((function(e){return""!==e}))).length>0&&(c.scopes=v.join(",")),t.tenantId&&(c.tid=t.tenantId),m=c,g=0,y=Object.keys(m);g<y.length;g++)b=y[g],void 0===m[b]&&delete m[b];return e.next=10,t._getAppCheckToken();case 10:return w=e.sent,x=w?"#".concat(CS,"=").concat(encodeURIComponent(w)):"",e.abrupt("return","".concat(RS(t),"?").concat(Pb(m).slice(1)).concat(x));case 13:case"end":return e.stop()}}),e)}))),IS.apply(this,arguments)}function RS(e){var t=e.config;return t.emulator?Uk(t,ES):"https://".concat(t.authDomain,"/").concat(_S)}var TS="webStorageSupport",AS=function(){function e(){(0,V.Z)(this,e),this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=rC,this._completeRedirectFn=YC,this._overrideRedirectResult=KC}return(0,H.Z)(e,[{key:"_openPopup",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t,n,r,o){var i,a;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Dk(null===(i=this.eventManagers[t._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()"),e.next=3,SS(t,n,r,Pk(),o);case 3:return a=e.sent,e.abrupt("return",kS(t,a,aC()));case 5:case"end":return e.stop()}}),e,this)})));return function(t,n,r,o){return e.apply(this,arguments)}}()},{key:"_openRedirect",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t,n,r,o){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._originValidation(t);case 2:return e.next=4,SS(t,n,r,Pk(),o);case 4:return cC(e.sent),e.abrupt("return",new Promise((function(){})));case 7:case"end":return e.stop()}}),e,this)})));return function(t,n,r,o){return e.apply(this,arguments)}}()},{key:"_initialize",value:function(e){var t=this,n=e._key();if(this.eventManagers[n]){var r=this.eventManagers[n],o=r.manager,i=r.promise;return o?Promise.resolve(o):(Dk(i,"If manager is not set, promise should be"),i)}var a=this.initAndGetManager(e);return this.eventManagers[n]={promise:a},a.catch((function(){delete t.eventManagers[n]})),a}},{key:"initAndGetManager",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var n,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,yS(t);case 2:return n=e.sent,r=new JC(t),n.register("authEvent",(function(e){return Nk(null===e||void 0===e?void 0:e.authEvent,t,"invalid-auth-event"),{status:r.onEvent(e.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:r},this.iframes[t._key()]=n,e.abrupt("return",r);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_isIframeWebStorageSupported",value:function(e,t){this.iframes[e._key()].send(TS,{type:TS},(function(n){var r,o=null===(r=null===n||void 0===n?void 0:n[0])||void 0===r?void 0:r[TS];void 0!==o&&t(!!o),Ik(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}},{key:"_originValidation",value:function(e){var t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=function(e){return aS.apply(this,arguments)}(e)),this.originValidationPromises[t]}},{key:"_shouldInitProactively",get:function(){return U_()||N_()||L_()}}]),e}(),NS=AS,OS=function(){function e(t){(0,V.Z)(this,e),this.factorId=t}return(0,H.Z)(e,[{key:"_process",value:function(e,t,n){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,n);case"signin":return this._finalizeSignIn(e,t.credential);default:return Ok("unexpected MultiFactorSessionType")}}}]),e}(),DS=function(e){(0,$e.Z)(n,e);var t=(0,Ye.Z)(n);function n(e){var r;return(0,V.Z)(this,n),(r=t.call(this,"phone")).credential=e,r}return(0,H.Z)(n,[{key:"_finalizeEnroll",value:function(e,t,n){return function(e,t){return Vk(e,"POST","/v2/accounts/mfaEnrollment:finalize",zk(e,t))}(e,{idToken:t,displayName:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}},{key:"_finalizeSignIn",value:function(e,t){return function(e,t){return Vk(e,"POST","/v2/accounts/mfaSignIn:finalize",zk(e,t))}(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}],[{key:"_fromCredential",value:function(e){return new n(e)}}]),n}(OS);(function(){function e(){(0,V.Z)(this,e)}return(0,H.Z)(e,null,[{key:"assertion",value:function(e){return DS._fromCredential(e)}}]),e}()).FACTOR_ID="phone";var PS=function(){function e(){(0,V.Z)(this,e)}return(0,H.Z)(e,null,[{key:"assertionForEnrollment",value:function(e,t){return MS._fromSecret(e,t)}},{key:"assertionForSignIn",value:function(e,t){return MS._fromEnrollmentId(e,t)}},{key:"generateSecret",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var n,r,o;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Nk("undefined"!==typeof(null===(n=(r=t).user)||void 0===n?void 0:n.auth),"internal-error"),e.next=4,$E(r.user.auth,{idToken:r.credential,totpEnrollmentInfo:{}});case 4:return o=e.sent,e.abrupt("return",FS._fromStartTotpMfaEnrollmentResponse(o,r.user.auth));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}();PS.FACTOR_ID="totp";var MS=function(e){(0,$e.Z)(n,e);var t=(0,Ye.Z)(n);function n(e,r,o){var i;return(0,V.Z)(this,n),(i=t.call(this,"totp")).otp=e,i.enrollmentId=r,i.secret=o,i}return(0,H.Z)(n,[{key:"_finalizeEnroll",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t,n,r){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Nk("undefined"!==typeof this.secret,t,"argument-error"),e.abrupt("return",YE(t,{idToken:n,displayName:r,totpVerificationInfo:this.secret._makeTotpVerificationInfo(this.otp)}));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"_finalizeSignIn",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t,n){var r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Nk(void 0!==this.enrollmentId&&void 0!==this.otp,t,"argument-error"),r={verificationCode:this.otp},e.abrupt("return",TC(t,{mfaPendingCredential:n,mfaEnrollmentId:this.enrollmentId,totpVerificationInfo:r}));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}],[{key:"_fromSecret",value:function(e,t){return new n(t,void 0,e)}},{key:"_fromEnrollmentId",value:function(e,t){return new n(t,e)}}]),n}(OS),FS=function(){function e(t,n,r,o,i,a,s){(0,V.Z)(this,e),this.sessionInfo=a,this.auth=s,this.secretKey=t,this.hashingAlgorithm=n,this.codeLength=r,this.codeIntervalSeconds=o,this.enrollmentCompletionDeadline=i}return(0,H.Z)(e,[{key:"_makeTotpVerificationInfo",value:function(e){return{sessionInfo:this.sessionInfo,verificationCode:e}}},{key:"generateQrCodeUrl",value:function(e,t){var n,r=!1;return(LS(e)||LS(t))&&(r=!0),r&&(LS(e)&&(e=(null===(n=this.auth.currentUser)||void 0===n?void 0:n.email)||"unknownuser"),LS(t)&&(t=this.auth.name)),"otpauth://totp/".concat(t,":").concat(e,"?secret=").concat(this.secretKey,"&issuer=").concat(t,"&algorithm=").concat(this.hashingAlgorithm,"&digits=").concat(this.codeLength)}}],[{key:"_fromStartTotpMfaEnrollmentResponse",value:function(t,n){return new e(t.totpSessionInfo.sharedSecretKey,t.totpSessionInfo.hashingAlgorithm,t.totpSessionInfo.verificationCodeLength,t.totpSessionInfo.periodSec,new Date(t.totpSessionInfo.finalizeEnrollmentTime).toUTCString(),t.totpSessionInfo.sessionInfo,n)}}]),e}();function LS(e){return"undefined"===typeof e||0===(null===e||void 0===e?void 0:e.length)}var BS="@firebase/auth",US="1.3.0",jS=function(){function e(t){(0,V.Z)(this,e),this.auth=t,this.internalListeners=new Map}return(0,H.Z)(e,[{key:"getUid",value:function(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}},{key:"getToken",value:function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.assertAuthConfigured(),e.next=3,this.auth._initializationPromise;case 3:if(this.auth.currentUser){e.next=5;break}return e.abrupt("return",null);case 5:return e.next=7,this.auth.currentUser.getIdToken(t);case 7:return n=e.sent,e.abrupt("return",{accessToken:n});case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"addAuthTokenListener",value:function(e){if(this.assertAuthConfigured(),!this.internalListeners.has(e)){var t=this.auth.onIdTokenChanged((function(t){e((null===t||void 0===t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}}},{key:"removeAuthTokenListener",value:function(e){this.assertAuthConfigured();var t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}},{key:"assertAuthConfigured",value:function(){Nk(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}},{key:"updateProactiveRefresh",value:function(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}]),e}();var ZS,WS=_b("authIdTokenMaxAge")||300,zS=null;ZS="Browser",Sw(new jb("auth",(function(e,t){var n=t.options,r=e.getProvider("app").getImmediate(),o=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),a=r.options,s=a.apiKey,u=a.authDomain;Nk(s&&!s.includes(":"),"invalid-api-key",{appName:r.name});var c={apiKey:s,authDomain:u,clientPlatform:ZS,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:j_(ZS)},l=new H_(r,o,i,c);return function(e,t){var n=(null===t||void 0===t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(E_);(null===t||void 0===t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null===t||void 0===t?void 0:t.popupRedirectResolver)}(l,n),l}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((function(e,t,n){e.getProvider("auth-internal").initialize()}))),Sw(new jb("auth-internal",(function(e){return function(e){return new jS(e)}(q_(e.getProvider("auth").getImmediate()))}),"PRIVATE").setInstantiationMode("EXPLICIT")),Pw(BS,US,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(ZS)),Pw(BS,US,"esm2017");var VS={apiKey:"AIzaSyDyMCcl1mrfVFsh015U_OSZAqnesss5-8c",authDomain:"tindoor-9b981.firebaseapp.com",projectId:"tindoor-9b981",storageBucket:"tindoor-9b981.appspot.com",messagingSenderId:"146678644548",appId:"1:146678644548:web:9364b478820b8c2d442111"},HS=Ow({apiKey:VS.apiKey,authDomain:VS.authDomain,projectId:VS.projectId,storageBucket:VS.storageBucket,messagingSenderId:VS.messagingSenderId,appId:VS.appId}),qS=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Dw(),t=Iw(e,"auth");if(t.isInitialized())return t.getImmediate();var n,r=function(e,t){var n=Iw(e,"auth");if(n.isInitialized()){var r=n.getImmediate();if(Ob(n.getOptions(),null!==t&&void 0!==t?t:{}))return r;Ik(r,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:NS,persistence:[IC,tC,rC]}),o=_b("authTokenSyncURL");if(o){var i=(n=o,function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var r,o,i;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t,!e.t0){e.next=5;break}return e.next=4,t.getIdTokenResult();case 4:e.t0=e.sent;case 5:if(r=e.t0,!((o=r&&((new Date).getTime()-Date.parse(r.issuedAtTime))/1e3)&&o>WS)){e.next=9;break}return e.abrupt("return");case 9:if(i=null===r||void 0===r?void 0:r.token,zS!==i){e.next=12;break}return e.abrupt("return");case 12:return zS=i,e.next=15,fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:"Bearer ".concat(i)}:{}});case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());!function(e,t,n){Ub(e).beforeAuthStateChanged(t,n)}(r,i,(function(){return i(r.currentUser)})),function(e,t,n,r){Ub(e).onIdTokenChanged(t,n,r)}(r,(function(e){return i(e)}))}var a=xb("auth");return a&&J_(r,"http://".concat(a)),r}(),GS=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Dw(),t=arguments.length>1?arguments[1]:void 0,n=Iw(e=Ub(e),lk).getImmediate({identifier:t}),r=function(e){var t=xb(e);if(t){var n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error("Invalid host ".concat(t," with no separate hostname and port!"));var r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]}}("storage");return r&&dk.apply(void 0,[n].concat((0,Xe.Z)(r))),n}(HS),KS=function(){var t=(0,e.useState)(null),n=(0,o.Z)(t,2),r=n[0],c=n[1],l=En(null),f=(0,o.Z)(l,3),h=f[0],d=(f[1],f[2],(0,e.useState)({user_id:h.UserId,first_name:"",dob_day:"",dob_month:"",dob_year:"",show_gender:!1,gender_identity:"man",gender_interest:"woman",url:"",about:"",matches:[],qualities:""})),p=(0,o.Z)(d,2),v=p[0],m=p[1],g=(0,e.useState)(null),y=(0,o.Z)(g,2),b=y[0],w=y[1],x=(0,e.useState)(!1),k=(0,o.Z)(x,2),_=k[0],E=k[1],C=(0,e.useState)(""),S=(0,o.Z)(C,2),I=S[0],R=S[1],T=(0,e.useState)(""),A=(0,o.Z)(T,2),N=A[0],O=A[1],D=(0,e.useState)(!1),P=(0,o.Z)(D,2),M=P[0],F=P[1],L=(0,e.useState)(!1),B=(0,o.Z)(L,2),U=B[0],j=B[1],Z=(0,e.useState)(!1),W=(0,o.Z)(Z,2),z=W[0],V=W[1],H=(0,e.useState)(!0),q=(0,o.Z)(H,2),G=q[0],K=q[1],X=h.UserId,$=function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(X){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,Ke.get("https://tindoor-server.onrender.com/user",{params:{userId:X}});case 5:t=e.sent,c(t.data),m((function(e){return Pn(Pn({},e),{},{first_name:t.data.first_name,dob_day:t.data.dob_day,dob_month:t.data.dob_month,dob_year:t.data.dob_year,show_gender:t.data.show_gender,gender_identity:t.data.gender_identity,gender_interest:t.data.gender_interest,url:t.data.url,qualities:t.data.qualities})})),console.log(t.data),qE(qS,t.data.email,t.data.hashed_password).then((function(e){e.user;console.log("firebase user created")})).catch((function(e){e.code,e.message;console.log(e.message),-1!=e.message.search("email-already-in-use")&&(console.log("email already in use"),KE(qS,t.data.email,t.data.hashed_password).then((function(e){e.user;console.log("firebase user signed in")})).catch((function(e){e.code,e.message;console.log(e)})))})),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(){return e.apply(this,arguments)}}();(0,e.useEffect)((function(){$()}),[]),(0,e.useEffect)((function(){U&&Y()}),[v]);Qt();var Y=function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("submitted"),t&&t.preventDefault(),e.prev=2,e.next=5,Ke.put("https://tindoor-server.onrender.com/user",{formData:v});case 5:n=e.sent,console.log(n),200===n.status&&(console.log("database updated sucessfully"),U?j(!1):window.location.href="../dashboard"),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(2),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[2,11]])})));return function(t){return e.apply(this,arguments)}}(),Q=function(e){console.log("e",e);var t="checkbox"===e.target.type?e.target.checked:e.target.value,n=e.target.name;m((function(e){return Pn(Pn({},e),{},On({},n,t))}))},J=function(e){var t=v.qualities?v.qualities:"",n=e.target.value+" ";e.target.checked?(t+=n,console.log("checked")):(-1!=t.search(n)&&(t=t.replace(n,"")),console.log("not checked")),console.log(t),m((function(e){return Pn(Pn({},e),{},{qualities:t})}))},ee=function(e){return!!v.qualities&&(-1!=v.qualities.search(e)&&"checked")};function te(){return!!Vy.ssdMobilenetv1.params}var ne=function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var n,r,o;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=document.querySelector("#inputVideo"),r=new sy({minConfidence:.5}),e.next=4,hb(n,r).withFaceExpressions();case 4:if("undefined"!==typeof(o=e.sent)&&(o.expressions.angry>.8||o.expressions.disgusted>.8||o.expressions.fearful>.8||o.expressions.surprised>.8)?(R("God you're UGLY!"),E(!0)):(R("Not ugly enough, try harder!"),E(!1)),!n.paused&&!n.ended&&te()){e.next=8;break}return e.abrupt("return",setTimeout((function(){return ne()})));case 8:setTimeout((function(){return ne()}));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),re=function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){var n,r;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return K(!1),n="/models",e.next=4,t=n,Vy.faceExpressionNet.load(t);case 4:return e.next=6,Hy(n);case 6:return e.next=8,navigator.mediaDevices.getUserMedia({video:{}});case 8:r=e.sent,document.querySelector("#inputVideo").srcObject=r,V(!0);case 12:case"end":return e.stop()}var t}),e)})));return function(t){return e.apply(this,arguments)}}(),oe=function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(b){e.next=2;break}return e.abrupt("return");case 2:t=GS,n="avatars/".concat(h.UserId,".jpg"),fk(ok(t=Ub(t),n),b,"data_url").then((function(e){console.log("Uploaded a data_url string!"),hk(e.ref).then(function(){var e=(0,u.Z)((0,s.Z)().mark((function e(t){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("sucess!"),console.log(t),j(!0),F(!1),m((function(e){return Pn(Pn({},e),{},{url:t})}));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}));case 4:case"end":return e.stop()}var t,n}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(a,{minimal:!0,setShowModal:function(){},showModal:!1}),(0,i.jsxs)("div",{className:"onboarding",children:[(0,i.jsx)("h2",{children:r?"Your Profile":"Create Account"}),(0,i.jsx)("form",{onSubmit:Y,children:(0,i.jsxs)("section",{children:[(0,i.jsx)("label",{htmlFor:"url",children:"Profile Photo"}),(0,i.jsx)("div",{className:"photo-container",children:v.url&&(0,i.jsx)("div",{className:"profilePhotoPreview",style:{backgroundImage:"url(".concat(v.url,")")}})}),(0,i.jsx)("span",{onClick:re,className:"ctaButton",children:"Reveal yourself!"}),(0,i.jsx)("br",{}),(0,i.jsxs)("div",{className:"videoContainer",children:[(0,i.jsx)("video",{onLoadedMetadata:ne,id:"inputVideo",autoPlay:!0,muted:!0,playsInline:!0,className:G?"hidden":"visible"}),(0,i.jsxs)("div",{className:"selfieResultOverlay "+(M?"active":"inactive"),children:[(0,i.jsx)("div",{id:"imageToSave",style:{backgroundImage:"url(".concat(b,")")}}),(0,i.jsx)("div",{id:"uploadSelfie",onClick:oe,className:"ctaButton",children:"save"}),(0,i.jsx)("div",{id:"",onClick:function(e){F(!1)},className:"ctaButton",children:"discard"})]})]}),(0,i.jsx)("br",{}),(0,i.jsx)("br",{}),(0,i.jsx)("div",{id:"selfieButton",onClick:function(e){if(_){document.querySelector("#imageToSave");var t=document.querySelector("#screencapture"),n=document.querySelector("#inputVideo");t.getContext("2d").drawImage(n,0,0,300,150);var r=t.toDataURL("image/jpg");w(r),F(!0),V(!1)}else O("animated"),setTimeout((function(){O("")}),300)},className:(_?"active":"inactive")+(z?" visible":" hidden")}),(0,i.jsx)("div",{id:"testExpressionResult",className:(_?"ugly":"notUgly "+N)+(z?" visible":" hidden"),children:I}),(0,i.jsx)("canvas",{id:"screencapture"}),(0,i.jsx)("label",{htmlFor:"first_name",children:"First Name"}),(0,i.jsx)("input",{id:"first_name",type:"text",name:"first_name",placeholder:"First Name",required:!0,value:v.first_name,onChange:Q}),(0,i.jsx)("label",{children:"Birthday"}),(0,i.jsxs)("div",{className:"multiple-input-container dateOfBirth",children:[(0,i.jsx)("input",{id:"dob_day",type:"number",name:"dob_day",placeholder:"DD",required:!0,value:v.dob_day,onChange:Q}),(0,i.jsx)("input",{id:"dob_month",type:"number",name:"dob_month",placeholder:"MM",required:!0,value:v.dob_month,onChange:Q}),(0,i.jsx)("input",{id:"dob_year",type:"number",name:"dob_year",placeholder:"YYYY",required:!0,value:v.dob_year,onChange:Q})]}),(0,i.jsx)("label",{children:"Gender"}),(0,i.jsxs)("div",{className:"multiple-input-container",children:[(0,i.jsx)("input",{id:"man-gender-identity",type:"radio",name:"gender_identity",value:"man",onChange:Q,checked:"man"===v.gender_identity}),(0,i.jsx)("label",{htmlFor:"man-gender-identity",children:"Man"}),(0,i.jsx)("input",{id:"woman-gender-identity",type:"radio",name:"gender_identity",value:"woman",onChange:Q,checked:"woman"===v.gender_identity}),(0,i.jsx)("label",{htmlFor:"woman-gender-identity",children:"Woman"}),(0,i.jsx)("input",{id:"more-gender-identity",type:"radio",name:"gender_identity",value:"more",onChange:Q,checked:"more"===v.gender_identity}),(0,i.jsx)("label",{htmlFor:"more-gender-identity",children:"More"})]}),(0,i.jsxs)("div",{className:"showGenderContainer",children:[(0,i.jsx)("input",{id:"show-gender",type:"checkbox",name:"show_gender",className:"showGender",onChange:Q,checked:v.show_gender}),(0,i.jsx)("label",{htmlFor:"show-gender",children:"Show Gender on my Profile"})]}),(0,i.jsx)("label",{children:"Show Me"}),(0,i.jsxs)("div",{className:"multiple-input-container",children:[(0,i.jsx)("input",{id:"man-gender-interest",type:"radio",name:"gender_interest",value:"man",onChange:Q,checked:"man"===v.gender_interest}),(0,i.jsx)("label",{htmlFor:"man-gender-interest",children:"Man"}),(0,i.jsx)("input",{id:"woman-gender-interest",type:"radio",name:"gender_interest",value:"woman",onChange:Q,checked:"woman"===v.gender_interest}),(0,i.jsx)("label",{htmlFor:"woman-gender-interest",children:"Woman"}),(0,i.jsx)("input",{id:"everyone-gender-interest",type:"radio",name:"gender_interest",value:"everyone",onChange:Q,checked:"everyone"===v.gender_interest}),(0,i.jsx)("label",{htmlFor:"everyone-gender-interest",children:"Everyone"})]}),(0,i.jsx)("label",{htmlFor:"about",children:"About me"}),(0,i.jsx)("div",{className:"multiple-checkboxes",children:function(e){var t=[];return["greedy","envious","arrogant","selfish","cruel","dishonest","hypocritical","lazy","intolerant","ignorant","rude","inflexible","vindictive","jealous","spiteful","stubborn","apathetic","conniving","deceitful","manipulative","narcissistic","obsessive","paranoid","pessimistic","vengeful","aggressive","callous","defensive","evasive","fanatical","insensitive","egotistical","uncaring","untrustworthy","bitter","furtive","hateful","haughty","indifferent","irresponsible","judgmental","macho","materialistic","narrow-minded","obnoxious","overcritical","petty","resentful","sarcastic","scheming","superficial","unappreciative","uncooperative","unreliable","vulgar","whiny","xenophobic","yappy","zealous","devious","fickle","gloomy","insincere","moody","needy","quarrelsome","shifty","timid","volatile"].forEach((function(e,n){t.push((0,i.jsxs)("span",{children:[(0,i.jsx)("input",{type:"checkbox",name:"qualities",value:e,id:e,onChange:J,checked:ee(e)}),(0,i.jsx)("label",{htmlFor:e,children:e})]},n))})),t}()}),(0,i.jsx)("input",{type:"submit"})]})})]}),(0,i.jsx)(Tn,{})]})},XS=function(e){var t=e.user,n=En(["user"]),r=(0,o.Z)(n,3);r[0],r[1],r[2];return(0,i.jsx)("div",{className:"chat-container-header",children:(0,i.jsxs)("div",{className:"profile",children:[(0,i.jsx)("div",{className:"img-container",children:(0,i.jsx)("img",{src:t.url,alt:"photo of "+t.first_name})}),(0,i.jsx)("h3",{children:t.first_name})]})})},$S=function(t){var n=t.matches,r=t.setClickedUser,a=(0,e.useState)(null),c=(0,o.Z)(a,2),l=c[0],f=c[1],h=En(null),d=(0,o.Z)(h,3),p=d[0],v=(d[1],d[2],n.map((function(e){return e.user_id}))),m=p.UserId,g=function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ke.get("https://tindoor-server.onrender.com/users",{params:{userIds:JSON.stringify(v)}});case 3:t=e.sent,f(t.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();(0,e.useEffect)((function(){g()}),[n]);var y=null===l||void 0===l?void 0:l.filter((function(e){return e.matches.filter((function(e){return e.user_id==m})).length>0}));return(0,i.jsx)("div",{className:"matches-display",children:null===y||void 0===y?void 0:y.map((function(e,t){return(0,i.jsxs)("div",{className:"match-card",onClick:function(){return r(e)},children:[(0,i.jsx)("div",{className:"img-container",children:(0,i.jsx)("img",{src:null===e||void 0===e?void 0:e.url,alt:(null===e||void 0===e?void 0:e.first_name)+" profile"})}),(0,i.jsx)("h3",{children:null===e||void 0===e?void 0:e.first_name})]},t)}))})},YS=function(e){var t=e.descendingOrderMessages;return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("div",{className:"chat-display",children:t.map((function(e,t){return(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"chat-message-header",children:[(0,i.jsx)("div",{className:"img-container",children:(0,i.jsx)("img",{src:e.img,alt:e.name+" profile"})}),(0,i.jsx)("p",{children:e.name})]}),(0,i.jsx)("p",{children:e.message})]},t)}))})})},QS=function(t){var n=t.user,r=t.clickedUser,a=t.getUserMessages,c=t.getClickedUsersMessages,l=(0,e.useState)(""),f=(0,o.Z)(l,2),h=f[0],d=f[1],p=null===n||void 0===n?void 0:n.user_id,v=null===r||void 0===r?void 0:r.user_id,m=function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={timestamp:(new Date).toISOString(),from_userId:p,to_userId:v,message:h},e.prev=1,e.next=4,Ke.post("https://tindoor-server.onrender.com/message",{message:t});case 4:a(),c(),d(""),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}();return(0,i.jsxs)("div",{className:"chat-input",children:[(0,i.jsx)("textarea",{value:h,onChange:function(e){return d(e.target.value)}}),(0,i.jsx)("button",{className:"secondary-button",onClick:m,children:"Submit"})]})},JS=function(t){var n=t.user,r=t.clickedUser,a=null===n||void 0===n?void 0:n.user_id,c=null===r||void 0===r?void 0:r.user_id,l=(0,e.useState)(null),f=(0,o.Z)(l,2),h=f[0],d=f[1],p=(0,e.useState)(null),v=(0,o.Z)(p,2),m=v[0],g=v[1],y=function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ke.get("https://tindoor-server.onrender.com/messages",{params:{userId:a,correspondingUserId:c}});case 3:t=e.sent,d(t.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),b=function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ke.get("https://tindoor-server.onrender.com/messages",{params:{userId:c,correspondingUserId:a}});case 3:t=e.sent,g(t.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();(0,e.useEffect)((function(){y(),b()}),[]);var w=[];null===h||void 0===h||h.forEach((function(e){var t={};t.name=null===n||void 0===n?void 0:n.first_name,t.img=null===n||void 0===n?void 0:n.url,t.message=e.message,t.timestamp=e.timestamp,w.push(t)})),null===m||void 0===m||m.forEach((function(e){var t={};t.name=null===r||void 0===r?void 0:r.first_name,t.img=null===r||void 0===r?void 0:r.url,t.message=e.message,t.timestamp=e.timestamp,w.push(t)}));var x=null===w||void 0===w?void 0:w.sort((function(e,t){return e.timestamp.localeCompare(t.timestamp)}));return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(YS,{descendingOrderMessages:x}),(0,i.jsx)(QS,{user:n,clickedUser:r,getUserMessages:y,getClickedUsersMessages:b})]})},eI=function(t){var n=t.user,r=(0,e.useState)(null),a=(0,o.Z)(r,2),s=a[0],u=a[1];return(0,i.jsxs)("div",{className:"chat-container",children:[(0,i.jsx)(XS,{user:n}),(0,i.jsxs)("div",{children:[(0,i.jsx)("button",{className:"option",onClick:function(){return u(null)},children:"Matches"}),(0,i.jsx)("button",{className:"option",disabled:!s,children:"Chat"})]}),!s&&(0,i.jsx)($S,{matches:n.matches,setClickedUser:u}),s&&(0,i.jsx)(JS,{user:n,clickedUser:s})]})},tI=function(){var t=(0,e.useState)(null),n=(0,o.Z)(t,2),r=n[0],a=n[1],c=En(["user"]),l=(0,o.Z)(c,3),f=l[0],h=(l[1],l[2],f.UserId),d=function(){var e=(0,u.Z)((0,s.Z)().mark((function e(){var t;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Ke.get("https://tindoor-server.onrender.com/user",{params:{userId:h}});case 3:t=e.sent,a(t.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return(0,e.useEffect)((function(){d()}),[]),(0,i.jsxs)(i.Fragment,{children:[r?(0,i.jsx)(eI,{user:r}):"",(0,i.jsx)(Tn,{})]})};new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);var nI=t.startTransition;function rI(t){var n,r=t.basename,i=t.children,a=t.future,s=t.window,u=e.useRef();null==u.current&&(u.current=(void 0===(n={window:s,v5Compat:!0})&&(n={}),pt((function(e,t){var n=e.location;return ft("",{pathname:n.pathname,search:n.search,hash:n.hash},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){return"string"===typeof t?t:ht(t)}),null,n)));var c=u.current,l=e.useState({action:c.action,location:c.location}),f=(0,o.Z)(l,2),h=f[0],d=f[1],p=(a||{}).v7_startTransition,v=e.useCallback((function(e){p&&nI?nI((function(){return d(e)})):d(e)}),[d,p]);return e.useLayoutEffect((function(){return c.listen(v)}),[c,v]),e.createElement(hn,{basename:r,children:i,location:h.location,navigationType:h.action,navigator:c})}"undefined"!==typeof window&&"undefined"!==typeof window.document&&window.document.createElement;var oI,iI;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher"})(oI||(oI={})),function(e){e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(iI||(iI={}));var aI=function(){var e=En(["user"]),t=(0,o.Z)(e,3),n=t[0],r=(t[1],t[2],n.AuthToken);return(0,i.jsx)(rI,{children:(0,i.jsxs)(dn,{children:[(0,i.jsx)(fn,{path:"/",element:(0,i.jsx)(Sn,{})}),r&&(0,i.jsx)(fn,{path:"/dashboard",element:(0,i.jsx)(An,{})}),r&&(0,i.jsx)(fn,{path:"/onboarding",element:(0,i.jsx)(KS,{})}),r&&(0,i.jsx)(fn,{path:"/chat",element:(0,i.jsx)(tI,{})})]})})};r.render((0,i.jsx)(e.StrictMode,{children:(0,i.jsx)(aI,{})}),document.getElementById("root"))}()}();
//# sourceMappingURL=main.ac2940ec.js.map